{"version":3,"sources":["../src/types.ts","../src/lok-bindings.ts","../src/converter-node.ts","../src/editor/base.ts","../src/editor/writer.ts","../src/editor/calc.ts","../src/editor/impress.ts","../src/editor/draw.ts","../src/editor/index.ts","../src/subprocess.worker.cts"],"names":["errPtr","path","emFs","start","end","fs","Worker","module"],"mappings":"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","file":"subprocess.worker.cjs","sourcesContent":["/**\n * LibreOffice WASM Document Conversion Types\n * Headless document format conversion toolkit\n */\n\n/**\n * Supported input document formats\n */\nexport type InputFormat =\n  // Microsoft Office formats\n  | 'doc'\n  | 'docx'\n  | 'xls'\n  | 'xlsx'\n  | 'ppt'\n  | 'pptx'\n  // OpenDocument formats\n  | 'odt'\n  | 'ods'\n  | 'odp'\n  | 'odg'\n  | 'odf'\n  // Other formats\n  | 'rtf'\n  | 'txt'\n  | 'html'\n  | 'htm'\n  | 'csv'\n  | 'xml'\n  | 'epub'\n  | 'pdf';\n\n/**\n * Supported output document formats\n */\nexport type OutputFormat =\n  | 'pdf'\n  | 'docx'\n  | 'doc'\n  | 'odt'\n  | 'rtf'\n  | 'txt'\n  | 'html'\n  | 'xlsx'\n  | 'xls'\n  | 'ods'\n  | 'csv'\n  | 'pptx'\n  | 'ppt'\n  | 'odp'\n  | 'png'\n  | 'jpg'\n  | 'svg';\n\n/**\n * Document conversion options\n */\nexport interface ConversionOptions {\n  /**\n   * Output format for the conversion\n   */\n  outputFormat: OutputFormat;\n\n  /**\n   * Input format hint (auto-detected if not provided)\n   */\n  inputFormat?: InputFormat;\n\n  /**\n   * PDF-specific options\n   */\n  pdf?: PdfOptions;\n\n  /**\n   * Image output options (for png, jpg, svg)\n   */\n  image?: ImageOptions;\n\n  /**\n   * Password for encrypted documents\n   */\n  password?: string;\n}\n\n/**\n * PDF-specific conversion options\n */\nexport interface PdfOptions {\n  /**\n   * PDF/A conformance level\n   */\n  pdfaLevel?: 'PDF/A-1b' | 'PDF/A-2b' | 'PDF/A-3b';\n\n  /**\n   * PDF quality (0-100, affects image compression)\n   * @default 90\n   */\n  quality?: number;\n}\n\n/**\n * Image output options\n */\nexport interface ImageOptions {\n  /**\n   * Image width in pixels\n   */\n  width?: number;\n\n  /**\n   * Image height in pixels\n   */\n  height?: number;\n\n  /**\n   * DPI for rendering\n   * @default 150\n   */\n  dpi?: number;\n\n  /**\n   * Page index to export (0-based). Only exports this single page.\n   * If not specified, exports the first page (page 0).\n   * Cannot be used together with `pages`.\n   */\n  pageIndex?: number;\n\n  /**\n   * Array of page indices to export (0-based).\n   * If specified, returns an array of results (one per page).\n   * Cannot be used together with `pageIndex`.\n   */\n  pages?: number[];\n}\n\n/**\n * Result of a document conversion\n */\nexport interface ConversionResult {\n  /**\n   * The converted document data\n   */\n  data: Uint8Array;\n\n  /**\n   * MIME type of the output\n   */\n  mimeType: string;\n\n  /**\n   * Suggested filename with new extension\n   */\n  filename: string;\n\n  /**\n   * Conversion duration in milliseconds\n   */\n  duration: number;\n}\n\n/**\n * WASM loader module interface\n * This is the interface for the loader.cjs module that creates the Emscripten module\n */\nexport interface WasmLoaderModule {\n  createModule: (config: Record<string, unknown>) => Promise<EmscriptenModule>;\n}\n\n/**\n * LibreOffice WASM module initialization options (Node.js)\n */\nexport interface LibreOfficeWasmOptions {\n  /**\n   * Path to WASM files directory\n   * @default './wasm'\n   */\n  wasmPath?: string;\n\n  /**\n   * Path to the worker script (for WorkerConverter)\n   * When not specified, auto-detected based on module location\n   */\n  workerPath?: string;\n\n  /**\n   * Pre-loaded WASM loader module\n   * When provided, bypasses dynamic require of loader.cjs\n   * This is useful for bundlers like Turbopack that can't handle dynamic requires\n   *\n   * @example\n   * ```typescript\n   * // In your code, import the loader statically\n   * import * as wasmLoader from '@matbee/libreoffice-converter/wasm/loader.cjs';\n   *\n   * const converter = new LibreOfficeConverter({\n   *   wasmPath: './wasm',\n   *   wasmLoader,\n   * });\n   * ```\n   */\n  wasmLoader?: WasmLoaderModule;\n\n  /**\n   * Enable verbose logging\n   * @default false\n   */\n  verbose?: boolean;\n\n  /**\n   * Called when WASM module is ready\n   */\n  onReady?: () => void;\n\n  /**\n   * Called on initialization error\n   */\n  onError?: (error: Error) => void;\n\n  /**\n   * Called with progress updates during initialization\n   */\n  onProgress?: (progress: ProgressInfo) => void;\n}\n\n/**\n * Explicit paths to WASM files (Browser)\n * All paths are required when specified explicitly\n */\nexport interface BrowserWasmPaths {\n  /** URL to soffice.js - the main Emscripten loader script */\n  sofficeJs: string;\n  /** URL to soffice.wasm - the WebAssembly binary (~112MB) */\n  sofficeWasm: string;\n  /** URL to soffice.data - the virtual filesystem image (~80MB) */\n  sofficeData: string;\n  /** URL to soffice.worker.js - the Emscripten pthread worker */\n  sofficeWorkerJs: string;\n}\n\n/**\n * Browser converter initialization options\n * All WASM paths are optional and default to /wasm/ via createWasmPaths()\n */\nexport interface BrowserConverterOptions {\n  /** URL to soffice.js - defaults to /wasm/soffice.js */\n  sofficeJs?: string;\n  /** URL to soffice.wasm - defaults to /wasm/soffice.wasm */\n  sofficeWasm?: string;\n  /** URL to soffice.data - defaults to /wasm/soffice.data */\n  sofficeData?: string;\n  /** URL to soffice.worker.js - defaults to /wasm/soffice.worker.js */\n  sofficeWorkerJs?: string;\n\n  /**\n   * Enable verbose logging\n   * @default false\n   */\n  verbose?: boolean;\n\n  /**\n   * Called when WASM module is ready\n   */\n  onReady?: () => void;\n\n  /**\n   * Called on initialization error\n   */\n  onError?: (error: Error) => void;\n\n  /**\n   * Called with progress updates during initialization\n   */\n  onProgress?: (progress: WasmLoadProgress) => void;\n}\n\n/**\n * Worker browser converter initialization options\n * All WASM paths are optional and default to /wasm/ via createWasmPaths()\n */\nexport interface WorkerBrowserConverterOptions extends BrowserConverterOptions {\n  /** URL to browser.worker.js - defaults to /dist/browser.worker.global.js */\n  browserWorkerJs?: string;\n  /**\n   * Enable download progress tracking during WASM initialization\n   * When enabled, intercepts fetch/XHR to track download progress for soffice.wasm and soffice.data\n   * \n   * **WARNING**: This is disabled by default because the fetch interceptor can break\n   * WebAssembly streaming compilation in some environments. Only enable if you need\n   * detailed download progress and have tested it works in your target browsers.\n   * \n   * @default false\n   */\n  enableProgressTracking?: boolean;\n}\n\n/**\n * Internal type for BrowserConverterOptions after defaults are applied\n * All WASM paths are guaranteed to be defined\n */\nexport type ResolvedBrowserConverterOptions = BrowserConverterOptions & BrowserWasmPaths;\n\n/**\n * Internal type for WorkerBrowserConverterOptions after defaults are applied\n * All WASM paths and browserWorkerJs are guaranteed to be defined\n */\nexport type ResolvedWorkerBrowserConverterOptions = WorkerBrowserConverterOptions & BrowserWasmPaths & {\n  browserWorkerJs: string;\n};\n\n/**\n * Default URL for WASM files - relative path for same-origin hosting\n * Users typically serve WASM files from their own server at /wasm/\n */\nexport const DEFAULT_WASM_BASE_URL = '/wasm/';\n\n/**\n * Create WASM file paths from a base URL\n * Convenience helper for users who keep all WASM files in one directory\n *\n * @param baseUrl - Base URL ending with '/' (e.g., '/wasm/', 'https://cdn.example.com/wasm/')\n *                  Defaults to '/wasm/' for same-origin hosting\n * @returns Object with all WASM file paths\n *\n * @example\n * ```typescript\n * // Use default /wasm/ path (same-origin)\n * const converter = new WorkerBrowserConverter({\n *   ...createWasmPaths(),\n *   browserWorkerJs: '/dist/browser.worker.js',\n * });\n *\n * // Or use your own CDN\n * const converter = new WorkerBrowserConverter({\n *   ...createWasmPaths('https://cdn.example.com/wasm/'),\n *   browserWorkerJs: '/dist/browser.worker.js',\n * });\n * ```\n */\nexport function createWasmPaths(baseUrl: string = DEFAULT_WASM_BASE_URL): BrowserWasmPaths {\n  // Ensure baseUrl ends with /\n  const base = baseUrl.endsWith('/') ? baseUrl : `${baseUrl}/`;\n  return {\n    sofficeJs: `${base}soffice.js`,\n    sofficeWasm: `${base}soffice.wasm`,\n    sofficeData: `${base}soffice.data`,\n    sofficeWorkerJs: `${base}soffice.worker.js`,\n  };\n}\n\n/**\n * Loading phases for WASM initialization\n * Used to track detailed progress during the ~80 second browser startup\n */\nexport type WasmLoadPhase =\n  | 'download-wasm'    // Downloading soffice.wasm (~142MB)\n  | 'download-data'    // Downloading soffice.data (~96MB)\n  | 'compile'          // WebAssembly compilation\n  | 'filesystem'       // Emscripten filesystem setup\n  | 'lok-init'         // LibreOfficeKit initialization\n  | 'ready' | 'starting' | 'loading' | 'initializing' | 'converting' | 'complete';           // Complete\n\n/**\n * Extended progress information with download details\n * Backward compatible - existing code using percent/message continues to work\n */\nexport interface WasmLoadProgress {\n  /** Overall progress 0-100 */\n  percent: number;\n  /** Human-readable status message */\n  message: string;\n  /** Current loading phase */\n  phase: WasmLoadPhase;\n  /** Bytes downloaded (present during download phases) */\n  bytesLoaded?: number;\n  /** Total bytes to download (present during download phases) */\n  bytesTotal?: number;\n}\n\n/**\n * Progress information\n * @deprecated Use WasmLoadProgress for richer progress data\n */\nexport interface ProgressInfo {\n  phase: 'loading' | 'initializing' | 'converting' | 'complete';\n  percent: number;\n  message: string;\n}\n\n/**\n * Error codes for conversion failures\n */\nexport enum ConversionErrorCode {\n  UNKNOWN = 'UNKNOWN',\n  INVALID_INPUT = 'INVALID_INPUT',\n  UNSUPPORTED_FORMAT = 'UNSUPPORTED_FORMAT',\n  CORRUPTED_DOCUMENT = 'CORRUPTED_DOCUMENT',\n  PASSWORD_REQUIRED = 'PASSWORD_REQUIRED',\n  WASM_NOT_INITIALIZED = 'WASM_NOT_INITIALIZED',\n  CONVERSION_FAILED = 'CONVERSION_FAILED',\n  LOAD_FAILED = 'LOAD_FAILED',\n}\n\n/**\n * Custom error class for conversion errors\n */\nexport class ConversionError extends Error {\n  public readonly code: ConversionErrorCode;\n  public readonly details?: string;\n\n  constructor(code: ConversionErrorCode, message: string, details?: string) {\n    super(message);\n    this.name = 'ConversionError';\n    this.code = code;\n    this.details = details;\n  }\n}\n\n/**\n * Emscripten Module interface\n */\nexport interface EmscriptenModule {\n  // Core Emscripten functions\n  ccall: (\n    name: string,\n    returnType: string | null,\n    argTypes: string[],\n    args: unknown[]\n  ) => unknown;\n  cwrap: (\n    name: string,\n    returnType: string | null,\n    argTypes: string[]\n  ) => (...args: unknown[]) => unknown;\n\n  // Memory management\n  _malloc: (size: number) => number;\n  _free: (ptr: number) => void;\n  HEAPU8: Uint8Array;\n  HEAP32: Int32Array;\n  HEAPU32: Uint32Array;\n\n  // File system\n  FS: EmscriptenFS;\n\n  // Lifecycle\n  onRuntimeInitialized?: () => void;\n  calledRun?: boolean;\n\n  // LibreOfficeKit hooks (exported C functions)\n  _lok_preinit?: (path: number, args: number) => number;\n  _lok_preinit_2?: (path: number, args: number, callback: number) => number;\n  _libreofficekit_hook?: (path: number) => number;\n  _libreofficekit_hook_2?: (path: number, userProfile: number) => number;\n  _main?: (argc: number, argv: number) => number;\n\n  // WebAssembly function table for indirect calls\n  wasmTable?: WebAssembly.Table;\n\n  // Module locator\n  locateFile?: (path: string) => string;\n  print?: (text: string) => void;\n  printErr?: (text: string) => void;\n\n  // Runtime ready promise (some builds)\n  ready?: Promise<EmscriptenModule>;\n}\n\n/**\n * Emscripten virtual filesystem\n */\nexport interface EmscriptenFS {\n  mkdir: (path: string) => void;\n  writeFile: (path: string, data: Uint8Array | string, opts?: { encoding?: string }) => void;\n  readFile: (path: string, opts?: { encoding?: string }) => Uint8Array | string;\n  unlink: (path: string) => void;\n  readdir: (path: string) => string[];\n  stat: (path: string) => { size: number; isDirectory: () => boolean };\n  rmdir: (path: string) => void;\n  rename: (oldPath: string, newPath: string) => void;\n  open: (path: string, flags: unknown, mode?: unknown) => unknown;\n}\n\n/**\n * Filter name mapping for LibreOffice export\n * Note: For image exports, use getFilterForDocType() instead as filters are document-type specific\n */\nexport const FORMAT_FILTERS: Record<OutputFormat, string> = {\n  pdf: 'writer_pdf_Export',\n  docx: 'MS Word 2007 XML',\n  doc: 'MS Word 97',\n  odt: 'writer8',\n  rtf: 'Rich Text Format',\n  txt: 'Text',\n  html: 'HTML (StarWriter)',\n  xlsx: 'Calc MS Excel 2007 XML',\n  xls: 'MS Excel 97',\n  ods: 'calc8',\n  csv: 'Text - txt - csv (StarCalc)',\n  pptx: 'Impress MS PowerPoint 2007 XML',\n  ppt: 'MS PowerPoint 97',\n  odp: 'impress8',\n  png: 'writer_png_Export',\n  jpg: 'writer_jpg_Export',\n  svg: 'writer_svg_Export',\n};\n\n/**\n * LibreOfficeKit document types (from LibreOfficeKitEnums.h)\n */\nexport enum LOKDocumentType {\n  TEXT = 0,\n  SPREADSHEET = 1,\n  PRESENTATION = 2,\n  DRAWING = 3,\n  OTHER = 4,\n}\n\n/**\n * Document-type-specific filters for image and PDF exports\n * Each document type (Writer, Calc, Impress, Draw) has its own export filters\n */\nexport const DOC_TYPE_FILTERS: Record<LOKDocumentType, Partial<Record<OutputFormat, string>>> = {\n  [LOKDocumentType.TEXT]: {\n    pdf: 'writer_pdf_Export',\n    png: 'writer_png_Export',\n    jpg: 'writer_jpg_Export',\n    svg: 'writer_svg_Export',\n    html: 'HTML (StarWriter)',\n  },\n  [LOKDocumentType.SPREADSHEET]: {\n    pdf: 'calc_pdf_Export',\n    png: 'calc_png_Export',\n    jpg: 'calc_jpg_Export',\n    svg: 'calc_svg_Export',\n    html: 'HTML (StarCalc)',\n  },\n  [LOKDocumentType.PRESENTATION]: {\n    pdf: 'impress_pdf_Export',\n    png: 'impress_png_Export',\n    jpg: 'impress_jpg_Export',\n    svg: 'impress_svg_Export',\n    html: 'impress_html_Export',\n  },\n  [LOKDocumentType.DRAWING]: {\n    pdf: 'draw_pdf_Export',\n    png: 'draw_png_Export',\n    jpg: 'draw_jpg_Export',\n    svg: 'draw_svg_Export',\n    html: 'draw_html_Export',\n  },\n  [LOKDocumentType.OTHER]: {\n    pdf: 'writer_pdf_Export',\n    png: 'writer_png_Export',\n    jpg: 'writer_jpg_Export',\n    svg: 'writer_svg_Export',\n  },\n};\n\n/**\n * Get the correct export filter for a given output format and document type\n * @param outputFormat The desired output format\n * @param docType The LibreOfficeKit document type (use documentGetDocumentType())\n * @returns The filter name to use for saveAs\n */\nexport function getFilterForDocType(outputFormat: OutputFormat, docType: LOKDocumentType | number): string {\n  // Check if there's a document-type-specific filter\n  const docTypeFilters = DOC_TYPE_FILTERS[docType as LOKDocumentType];\n  if (docTypeFilters && docTypeFilters[outputFormat]) {\n    return docTypeFilters[outputFormat];\n  }\n\n  // Fall back to the default filter\n  return FORMAT_FILTERS[outputFormat];\n}\n\n/**\n * MIME types for output formats\n */\nexport const FORMAT_MIME_TYPES: Record<OutputFormat, string> = {\n  pdf: 'application/pdf',\n  docx: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  doc: 'application/msword',\n  odt: 'application/vnd.oasis.opendocument.text',\n  rtf: 'application/rtf',\n  txt: 'text/plain',\n  html: 'text/html',\n  xlsx: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  xls: 'application/vnd.ms-excel',\n  ods: 'application/vnd.oasis.opendocument.spreadsheet',\n  csv: 'text/csv',\n  pptx: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  ppt: 'application/vnd.ms-powerpoint',\n  odp: 'application/vnd.oasis.opendocument.presentation',\n  png: 'image/png',\n  jpg: 'image/jpeg',\n  svg: 'image/svg+xml',\n};\n\n/**\n * File extension to format mapping\n */\nexport const EXTENSION_TO_FORMAT: Record<string, InputFormat> = {\n  doc: 'doc',\n  docx: 'docx',\n  xls: 'xls',\n  xlsx: 'xlsx',\n  ppt: 'ppt',\n  pptx: 'pptx',\n  odt: 'odt',\n  ods: 'ods',\n  odp: 'odp',\n  odg: 'odg',\n  odf: 'odf',\n  rtf: 'rtf',\n  txt: 'txt',\n  html: 'html',\n  htm: 'html',\n  csv: 'csv',\n  xml: 'xml',\n  epub: 'epub',\n  pdf: 'pdf',\n};\n\n/**\n * Map LOK document type to valid output formats\n * This is based on LibreOffice's actual extension maps in desktop/source/lib/init.cxx\n * \n * IMPORTANT: These are the formats that LibreOffice's saveAs() actually supports.\n * The extension maps in init.cxx determine what filters are available per document type.\n * \n * Writer (TEXT): doc, docx, odt, pdf, rtf, txt, html, png, epub\n * Calc (SPREADSHEET): csv, ods, pdf, xls, xlsx, html, png\n * Impress (PRESENTATION): odp, pdf, ppt, pptx, svg, html, png\n * Draw (DRAWING): odg, pdf, svg, html, png\n * \n * NOTE: jpg is NOT in any extension map! Only png is supported for image export.\n * NOTE: svg is only supported for Impress and Draw, not Writer or Calc.\n */\nexport const LOK_DOCTYPE_OUTPUT_FORMATS: Record<LOKDocumentType, OutputFormat[]> = {\n  [LOKDocumentType.TEXT]: ['pdf', 'docx', 'doc', 'odt', 'rtf', 'txt', 'html', 'png'],\n  [LOKDocumentType.SPREADSHEET]: ['pdf', 'xlsx', 'xls', 'ods', 'csv', 'html', 'png'],\n  [LOKDocumentType.PRESENTATION]: ['pdf', 'pptx', 'ppt', 'odp', 'png', 'svg', 'html'],\n  [LOKDocumentType.DRAWING]: ['pdf', 'png', 'svg', 'html'],\n  [LOKDocumentType.OTHER]: ['pdf'],\n};\n\n/**\n * Get valid output formats for a LOK document type\n * Use this after loading a document to get accurate conversion options\n * @param docType The LOK document type (from documentGetDocumentType)\n * @returns Array of valid output formats\n */\nexport function getOutputFormatsForDocType(docType: LOKDocumentType | number): OutputFormat[] {\n  return LOK_DOCTYPE_OUTPUT_FORMATS[docType as LOKDocumentType] || ['pdf'];\n}\n\n/**\n * Map output format to LOK format string\n * These are the format names used by LibreOfficeKit's saveAs\n */\nexport const OUTPUT_FORMAT_TO_LOK: Record<OutputFormat, string> = {\n  pdf: 'pdf',\n  docx: 'docx',\n  doc: 'doc',\n  odt: 'odt',\n  rtf: 'rtf',\n  txt: 'txt',\n  html: 'html',\n  xlsx: 'xlsx',\n  xls: 'xls',\n  ods: 'ods',\n  csv: 'csv',\n  pptx: 'pptx',\n  ppt: 'ppt',\n  odp: 'odp',\n  png: 'png',\n  jpg: 'jpg',\n  svg: 'svg',\n};\n\n/**\n * Filter options for specific format conversions\n * These are passed to LibreOfficeKit's saveAs as the filterOptions parameter\n */\nexport const FORMAT_FILTER_OPTIONS: Partial<Record<OutputFormat, string>> = {\n  // PDF options can include things like:\n  // - SelectPdfVersion (0=PDF 1.4, 1=PDF/A-1, 2=PDF/A-2, 3=PDF/A-3)\n  // - UseLosslessCompression\n  // - Quality\n  pdf: '',\n  // CSV can specify separator, encoding, etc.\n  csv: '44,34,76,1,,0,false,true,false,false,false,-1',\n  // Text encoding\n  txt: 'UTF8',\n};\n\n/**\n * CSV Import filter options for loading CSV files as spreadsheets.\n * \n * The FilterOptions token format (15 tokens, comma-separated):\n * Token 0: Field separator ASCII code (44 = comma, 9 = tab, 59 = semicolon)\n * Token 1: Text delimiter ASCII code (34 = double quote)\n * Token 2: Character set (76 = UTF-8)\n * Token 3: Start row (1 = first row)\n * Token 4: Column format info (empty = auto-detect)\n * Token 5: Language ID (1033 = English US, 0 = system)\n * Token 6: Quoted field as text (true/false)\n * Token 7: Detect special numbers (true/false)\n * Token 8: Save as shown - export only (false)\n * Token 9: Save formulas - export only (false)\n * Token 10: Trim spaces (false)\n * Token 11: Sheet to export - export only (0)\n * Token 12: Evaluate formulas (true)\n * Token 13: Include BOM - export only (false)\n * Token 14: Detect scientific numbers (true)\n * \n * This ensures LibreOffice loads CSV files as Calc spreadsheet documents\n * in headless mode without triggering dialogs.\n */\nexport const CSV_IMPORT_FILTER_OPTIONS = 'FilterName=Text - txt - csv (StarCalc),FilterOptions=44,34,76,1,,1033,false,true,false,false,false,0,true,false,true';\n\n/**\n * Build load options for a document based on format and other options\n * @param inputFormat The input document format\n * @param password Optional password for encrypted documents\n * @returns Load options string for documentLoadWithOptions, or empty string for documentLoad\n */\nexport function buildLoadOptions(inputFormat?: string, password?: string): string {\n  const options: string[] = [];\n  \n  // CSV files need explicit import filter to be recognized as spreadsheets\n  if (inputFormat?.toLowerCase() === 'csv') {\n    options.push(CSV_IMPORT_FILTER_OPTIONS);\n  }\n  \n  // Password-protected documents\n  if (password) {\n    options.push(`Password=${password}`);\n  }\n  \n  return options.join(',');\n}\n\n/**\n * Document type categories for determining valid conversions\n */\nexport type DocumentCategory = 'text' | 'spreadsheet' | 'presentation' | 'drawing' | 'other';\n\n/**\n * Map input formats to their document category\n * This determines which output formats are valid\n */\nexport const INPUT_FORMAT_CATEGORY: Record<InputFormat, DocumentCategory> = {\n  // Text/Writer documents\n  doc: 'text',\n  docx: 'text',\n  odt: 'text',\n  rtf: 'text',\n  txt: 'text',\n  html: 'text',\n  htm: 'text',\n  epub: 'text',\n  xml: 'text',\n  // Spreadsheet/Calc documents\n  xls: 'spreadsheet',\n  xlsx: 'spreadsheet',\n  ods: 'spreadsheet',\n  csv: 'spreadsheet',\n  // Presentation/Impress documents\n  ppt: 'presentation',\n  pptx: 'presentation',\n  odp: 'presentation',\n  // Drawing/Draw documents (PDF imports as Draw)\n  odg: 'drawing',\n  odf: 'drawing',\n  pdf: 'drawing', // PDFs are imported as Draw documents\n};\n\n/**\n * Valid output formats for each document category\n * Based on LibreOffice's actual filter capabilities\n */\nexport const CATEGORY_OUTPUT_FORMATS: Record<DocumentCategory, OutputFormat[]> = {\n  // Writer documents can export to (based on aWriterExtensionMap in init.cxx):\n  // NOTE: jpg and svg are NOT supported for Writer - only png for images\n  text: ['pdf', 'docx', 'doc', 'odt', 'rtf', 'txt', 'html', 'png'],\n  // Calc documents can export to (based on aCalcExtensionMap in init.cxx):\n  // NOTE: jpg and svg are NOT supported for Calc - only png for images\n  spreadsheet: ['pdf', 'xlsx', 'xls', 'ods', 'csv', 'html', 'png'],\n  // Impress documents can export to (based on aImpressExtensionMap in init.cxx):\n  // NOTE: jpg is NOT supported - only png and svg for images\n  presentation: ['pdf', 'pptx', 'ppt', 'odp', 'png', 'svg', 'html'],\n  // Draw documents (including imported PDFs) can export to (based on aDrawExtensionMap in init.cxx):\n  // NOTE: jpg is NOT supported - only png and svg for images\n  drawing: ['pdf', 'png', 'svg', 'html'],\n  // Other/unknown - try PDF only\n  other: ['pdf'],\n};\n\n/**\n * Get valid output formats for a given input format\n * @param inputFormat The input document format\n * @returns Array of valid output formats\n */\nexport function getValidOutputFormats(inputFormat: InputFormat | string): OutputFormat[] {\n  const format = inputFormat.toLowerCase() as InputFormat;\n  const category = INPUT_FORMAT_CATEGORY[format];\n\n  if (!category) {\n    // Unknown format - allow PDF as a safe default\n    return ['pdf'];\n  }\n\n  return CATEGORY_OUTPUT_FORMATS[category];\n}\n\n/**\n * Check if a conversion from input format to output format is valid\n * @param inputFormat The input document format\n * @param outputFormat The desired output format\n * @returns true if the conversion is supported\n */\nexport function isConversionValid(\n  inputFormat: InputFormat | string,\n  outputFormat: OutputFormat | string\n): boolean {\n  const validOutputs = getValidOutputFormats(inputFormat);\n  return validOutputs.includes(outputFormat.toLowerCase() as OutputFormat);\n}\n\n/**\n * Get a human-readable error message for invalid conversions\n * @param inputFormat The input document format\n * @param outputFormat The desired output format\n * @returns Error message explaining why the conversion is not supported\n */\nexport function getConversionErrorMessage(\n  inputFormat: InputFormat | string,\n  outputFormat: OutputFormat | string\n): string {\n  const input = inputFormat.toLowerCase();\n  const output = outputFormat.toLowerCase();\n  const validOutputs = getValidOutputFormats(input as InputFormat);\n\n  const category = INPUT_FORMAT_CATEGORY[input as InputFormat] || 'unknown';\n\n  let reason = '';\n  if (category === 'drawing' && ['docx', 'doc', 'xlsx', 'xls', 'pptx', 'ppt'].includes(output)) {\n    reason = `PDF files are imported as Draw documents and cannot be exported to Office formats. `;\n  } else if (category === 'spreadsheet' && ['docx', 'doc', 'pptx', 'ppt'].includes(output)) {\n    reason = `Spreadsheet documents cannot be converted to word processing or presentation formats. `;\n  } else if (category === 'presentation' && ['docx', 'doc', 'xlsx', 'xls'].includes(output)) {\n    reason = `Presentation documents cannot be converted to word processing or spreadsheet formats. `;\n  } else if (category === 'text' && ['xlsx', 'xls', 'pptx', 'ppt'].includes(output)) {\n    reason = `Text documents cannot be converted to spreadsheet or presentation formats. `;\n  }\n\n  return `Cannot convert ${input.toUpperCase()} to ${output.toUpperCase()}. ${reason}Valid output formats for ${input.toUpperCase()}: ${validOutputs.join(', ')}`;\n}\n\n// ============================================\n// Shared Converter Interface\n// ============================================\n\n/**\n * Page preview data returned by renderPage/renderPagePreviews\n */\nexport interface PagePreview {\n  page: number;\n  data: Uint8Array;\n  width: number;\n  height: number;\n}\n\n/**\n * Document information returned by getDocumentInfo\n */\nexport interface DocumentInfo {\n  documentType: LOKDocumentType | number;\n  documentTypeName: string;\n  validOutputFormats: OutputFormat[];\n  pageCount: number;\n}\n\n/**\n * Options for rendering page previews\n */\nexport interface RenderOptions {\n  /** Width of rendered image in pixels */\n  width?: number;\n  /** Height of rendered image in pixels (0 = auto based on aspect ratio) */\n  height?: number;\n  /** Specific page indices to render (0-based). If empty, renders all pages */\n  pageIndices?: number[];\n  /**\n   * Render in edit mode (shows text input boxes, cursors, etc.)\n   * Default is false - presentations render in view/read mode for clean output\n   */\n  editMode?: boolean;\n}\n\n/**\n * Options for full quality page rendering\n */\nexport interface FullQualityRenderOptions {\n  /** DPI for rendering (default 150, use 300 for print quality) */\n  dpi?: number;\n  /** Maximum dimension (width or height) to prevent memory issues */\n  maxDimension?: number;\n  /**\n   * Render in edit mode (shows text input boxes, cursors, etc.)\n   * Default is false - presentations render in view/read mode for clean output\n   */\n  editMode?: boolean;\n}\n\n/**\n * Full quality page preview with DPI information\n */\nexport interface FullQualityPagePreview extends PagePreview {\n  /** Effective DPI (may differ from requested if capped) */\n  dpi: number;\n}\n\n/**\n * Editor session returned from openDocument\n */\nexport interface EditorSession {\n  sessionId: string;\n  documentType: string;\n  pageCount: number;\n}\n\n/**\n * Result from editor operations\n */\nexport interface EditorOperationResult<T = unknown> {\n  success: boolean;\n  verified?: boolean;\n  data?: T;\n  error?: string;\n  suggestion?: string;\n}\n\n/**\n * Options containing input format for document operations.\n */\nexport type InputFormatOptions = Pick<ConversionOptions, 'inputFormat'>;\n\n/**\n * Common interface for all LibreOffice converter implementations.\n * Ensures consistent API across different threading models (main thread, workers, child processes).\n *\n * All methods returning Promise are async in the interface to allow implementations\n * flexibility in whether they need actual async operations.\n */\nexport interface ILibreOfficeConverter {\n  // ============================================\n  // Lifecycle\n  // ============================================\n\n  /** Initialize the converter. Must be called before any other operations. */\n  initialize(): Promise<void>;\n\n  /** Destroy the converter and release all resources. */\n  destroy(): Promise<void>;\n\n  /** Check if the converter is ready for operations. */\n  isReady(): boolean;\n\n  // ============================================\n  // Core Conversion\n  // ============================================\n\n  /** Convert a document to a different format. */\n  convert(\n    input: Uint8Array | ArrayBuffer,\n    options: ConversionOptions,\n    filename?: string\n  ): Promise<ConversionResult>;\n\n  // ============================================\n  // Document Inspection\n  // ============================================\n\n  /** Get the number of pages in a document. */\n  getPageCount(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions\n  ): Promise<number>;\n\n  /** Get document information including type and valid output formats. */\n  getDocumentInfo(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions\n  ): Promise<DocumentInfo>;\n\n  // ============================================\n  // Page Rendering\n  // ============================================\n\n  /** Render a single page as an image. */\n  renderPage(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    width: number,\n    height?: number\n  ): Promise<PagePreview>;\n\n  /** Render multiple pages as images. */\n  renderPagePreviews(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions,\n    renderOptions?: RenderOptions\n  ): Promise<PagePreview[]>;\n\n  /**\n   * Render a page at full quality (native resolution based on DPI).\n   * Unlike renderPage which scales to a fixed width, this renders at the\n   * document's native resolution converted to pixels at the specified DPI.\n   */\n  renderPageFullQuality(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    renderOptions?: FullQualityRenderOptions\n  ): Promise<FullQualityPagePreview>;\n\n  // ============================================\n  // Editor Operations\n  // ============================================\n\n  /** Open a document for editing and return a session. */\n  openDocument(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions\n  ): Promise<EditorSession>;\n\n  /** Execute an editor operation on an open document. */\n  editorOperation<T = unknown>(\n    sessionId: string,\n    method: string,\n    args?: unknown[]\n  ): Promise<EditorOperationResult<T>>;\n\n  /** Close an editor session and optionally get the modified document. */\n  closeDocument(sessionId: string): Promise<Uint8Array | undefined>;\n}\n","/**\n * LibreOfficeKit Low-Level Bindings\n *\n * This module provides direct access to the LibreOfficeKit C API\n * through the WASM module using the stable lok_* shim exports.\n *\n * Shim functions (C side) should be defined as:\n *   - lok_documentLoad(pKit, pPath)\n *   - lok_documentLoadWithOptions(pKit, pPath, pOptions)\n *   - lok_documentSaveAs(pDoc, pUrl, pFormat, pFilterOptions)\n *   - lok_documentDestroy(pDoc)\n *   - lok_getError(pKit)\n *   - lok_destroy(pKit)          <-- RECOMMENDED to add\n */\n\nimport type { EmscriptenModule } from './types.js';\n\n// Extended module type with our LOK shim exports\ninterface LOKModule extends EmscriptenModule {\n  _lok_documentLoad?: (lok: number, path: number) => number;\n  _lok_documentLoadWithOptions?: (lok: number, path: number, options: number) => number;\n  _lok_documentSaveAs?: (doc: number, url: number, format: number, opts: number) => number;\n  _lok_documentDestroy?: (doc: number) => void;\n  _lok_getError?: (lok: number) => number;\n  _lok_destroy?: (lok: number) => void;\n  // Page rendering shims\n  _lok_documentGetParts?: (doc: number) => number;\n  _lok_documentGetPart?: (doc: number) => number;\n  _lok_documentSetPart?: (doc: number, part: number) => void;\n  _lok_documentGetDocumentType?: (doc: number) => number;\n  _lok_documentGetDocumentSize?: (doc: number, widthPtr: number, heightPtr: number) => void;\n  _lok_documentInitializeForRendering?: (doc: number, args: number) => void;\n  _lok_documentPaintTile?: (\n    doc: number,\n    buffer: number,\n    canvasWidth: number,\n    canvasHeight: number,\n    tilePosX: number,\n    tilePosY: number,\n    tileWidth: number,\n    tileHeight: number\n  ) => void;\n  _lok_documentGetTileMode?: (doc: number) => number;\n  // Text selection and content shims\n  _lok_documentGetTextSelection?: (doc: number, mimeType: number, usedMimeType: number) => number;\n  _lok_documentSetTextSelection?: (doc: number, type: number, x: number, y: number) => void;\n  _lok_documentGetSelectionType?: (doc: number) => number;\n  _lok_documentResetSelection?: (doc: number) => void;\n  // Mouse and keyboard event shims\n  _lok_documentPostMouseEvent?: (doc: number, type: number, x: number, y: number, count: number, buttons: number, modifier: number) => void;\n  _lok_documentPostKeyEvent?: (doc: number, type: number, charCode: number, keyCode: number) => void;\n  // UNO command shims\n  _lok_documentPostUnoCommand?: (doc: number, command: number, args: number, notifyWhenFinished: number) => void;\n  _lok_documentGetCommandValues?: (doc: number, command: number) => number;\n  // Page/Part information shims\n  _lok_documentGetPartPageRectangles?: (doc: number) => number;\n  _lok_documentGetPartInfo?: (doc: number, part: number) => number;\n  _lok_documentGetPartName?: (doc: number, part: number) => number;\n  // Clipboard shims\n  _lok_documentPaste?: (doc: number, mimeType: number, data: number, size: number) => number;\n  // View and zoom shims\n  _lok_documentSetClientZoom?: (doc: number, tilePixelWidth: number, tilePixelHeight: number, tileTwipWidth: number, tileTwipHeight: number) => void;\n  _lok_documentSetClientVisibleArea?: (doc: number, x: number, y: number, width: number, height: number) => void;\n  // Accessibility shims\n  _lok_documentGetA11yFocusedParagraph?: (doc: number) => number;\n  _lok_documentGetA11yCaretPosition?: (doc: number) => number;\n  _lok_documentSetAccessibilityState?: (doc: number, viewId: number, enabled: number) => void;\n  // Spreadsheet-specific shims\n  _lok_documentGetDataArea?: (doc: number, part: number, colPtr: number, rowPtr: number) => void;\n  // Edit mode shim\n  _lok_documentGetEditMode?: (doc: number) => number;\n  _lok_documentSetEditMode?: (doc: number, mode: number) => void;\n  // View management shims\n  _lok_documentCreateView?: (doc: number) => number;\n  _lok_documentCreateViewWithOptions?: (doc: number, options: number) => number;\n  _lok_documentDestroyView?: (doc: number, viewId: number) => void;\n  _lok_documentSetView?: (doc: number, viewId: number) => void;\n  _lok_documentGetView?: (doc: number) => number;\n  _lok_documentGetViewsCount?: (doc: number) => number;\n  // Event loop and callback shims\n  _lok_enableSyncEvents?: () => void;\n  _lok_disableSyncEvents?: () => void;\n  _lok_runLoop?: (lok: number, pollCallback: number, wakeCallback: number, data: number) => void;\n  // Callback queue shims\n  _lok_documentRegisterCallback?: (doc: number) => void;\n  _lok_documentUnregisterCallback?: (doc: number) => void;\n  _lok_hasCallbackEvents?: () => number;\n  _lok_getCallbackEventCount?: () => number;\n  _lok_pollCallback?: (payloadBuffer: number, bufferSize: number, payloadLengthPtr: number) => number;\n  _lok_clearCallbackQueue?: () => void;\n  _lok_flushCallbacks?: (doc: number) => void;\n}\n\n// LOK Mouse Event Types\nexport const LOK_MOUSEEVENT_BUTTONDOWN = 0;\nexport const LOK_MOUSEEVENT_BUTTONUP = 1;\nexport const LOK_MOUSEEVENT_MOVE = 2;\n\n// LOK Key Event Types\nexport const LOK_KEYEVENT_KEYINPUT = 0;\nexport const LOK_KEYEVENT_KEYUP = 1;\n\n// LOK Selection Types\nexport const LOK_SELTYPE_NONE = 0;\nexport const LOK_SELTYPE_TEXT = 1;\nexport const LOK_SELTYPE_CELL = 2;\n\n// LOK Text Selection Types\nexport const LOK_SETTEXTSELECTION_START = 0;\nexport const LOK_SETTEXTSELECTION_END = 1;\nexport const LOK_SETTEXTSELECTION_RESET = 2;\n\n// LOK Document Types\nexport const LOK_DOCTYPE_TEXT = 0;\nexport const LOK_DOCTYPE_SPREADSHEET = 1;\nexport const LOK_DOCTYPE_PRESENTATION = 2;\nexport const LOK_DOCTYPE_DRAWING = 3;\nexport const LOK_DOCTYPE_OTHER = 4;\n\n// LOK Callback Types (from LibreOfficeKitEnums.h)\nexport const LOK_CALLBACK_INVALIDATE_TILES = 0;\nexport const LOK_CALLBACK_INVALIDATE_VISIBLE_CURSOR = 1;\nexport const LOK_CALLBACK_TEXT_SELECTION = 2;\nexport const LOK_CALLBACK_TEXT_SELECTION_START = 3;\nexport const LOK_CALLBACK_TEXT_SELECTION_END = 4;\nexport const LOK_CALLBACK_CURSOR_VISIBLE = 5;\nexport const LOK_CALLBACK_GRAPHIC_SELECTION = 6;\nexport const LOK_CALLBACK_HYPERLINK_CLICKED = 7;\nexport const LOK_CALLBACK_STATE_CHANGED = 8;\nexport const LOK_CALLBACK_STATUS_INDICATOR_START = 9;\nexport const LOK_CALLBACK_STATUS_INDICATOR_SET_VALUE = 10;\nexport const LOK_CALLBACK_STATUS_INDICATOR_FINISH = 11;\nexport const LOK_CALLBACK_SEARCH_NOT_FOUND = 12;\nexport const LOK_CALLBACK_DOCUMENT_SIZE_CHANGED = 13;\nexport const LOK_CALLBACK_SET_PART = 14;\nexport const LOK_CALLBACK_SEARCH_RESULT_SELECTION = 15;\nexport const LOK_CALLBACK_UNO_COMMAND_RESULT = 16;\nexport const LOK_CALLBACK_CELL_CURSOR = 17;\nexport const LOK_CALLBACK_MOUSE_POINTER = 18;\nexport const LOK_CALLBACK_CELL_FORMULA = 19;\nexport const LOK_CALLBACK_DOCUMENT_PASSWORD = 20;\nexport const LOK_CALLBACK_DOCUMENT_PASSWORD_TO_MODIFY = 21;\nexport const LOK_CALLBACK_CONTEXT_MENU = 22;\nexport const LOK_CALLBACK_INVALIDATE_VIEW_CURSOR = 23;\nexport const LOK_CALLBACK_TEXT_VIEW_SELECTION = 24;\nexport const LOK_CALLBACK_CELL_VIEW_CURSOR = 25;\nexport const LOK_CALLBACK_GRAPHIC_VIEW_SELECTION = 26;\nexport const LOK_CALLBACK_VIEW_CURSOR_VISIBLE = 27;\nexport const LOK_CALLBACK_VIEW_LOCK = 28;\nexport const LOK_CALLBACK_REDLINE_TABLE_SIZE_CHANGED = 29;\nexport const LOK_CALLBACK_REDLINE_TABLE_ENTRY_MODIFIED = 30;\nexport const LOK_CALLBACK_COMMENT = 31;\nexport const LOK_CALLBACK_INVALIDATE_HEADER = 32;\nexport const LOK_CALLBACK_CELL_ADDRESS = 33;\n\n// Callback event interface\nexport interface LOKCallbackEvent {\n  type: number;\n  typeName: string;\n  payload: string;\n}\n\n// Map callback type to name\nexport function getCallbackTypeName(type: number): string {\n  const names: Record<number, string> = {\n    [LOK_CALLBACK_INVALIDATE_TILES]: 'INVALIDATE_TILES',\n    [LOK_CALLBACK_INVALIDATE_VISIBLE_CURSOR]: 'INVALIDATE_VISIBLE_CURSOR',\n    [LOK_CALLBACK_TEXT_SELECTION]: 'TEXT_SELECTION',\n    [LOK_CALLBACK_TEXT_SELECTION_START]: 'TEXT_SELECTION_START',\n    [LOK_CALLBACK_TEXT_SELECTION_END]: 'TEXT_SELECTION_END',\n    [LOK_CALLBACK_CURSOR_VISIBLE]: 'CURSOR_VISIBLE',\n    [LOK_CALLBACK_GRAPHIC_SELECTION]: 'GRAPHIC_SELECTION',\n    [LOK_CALLBACK_HYPERLINK_CLICKED]: 'HYPERLINK_CLICKED',\n    [LOK_CALLBACK_STATE_CHANGED]: 'STATE_CHANGED',\n    [LOK_CALLBACK_STATUS_INDICATOR_START]: 'STATUS_INDICATOR_START',\n    [LOK_CALLBACK_STATUS_INDICATOR_SET_VALUE]: 'STATUS_INDICATOR_SET_VALUE',\n    [LOK_CALLBACK_STATUS_INDICATOR_FINISH]: 'STATUS_INDICATOR_FINISH',\n    [LOK_CALLBACK_SEARCH_NOT_FOUND]: 'SEARCH_NOT_FOUND',\n    [LOK_CALLBACK_DOCUMENT_SIZE_CHANGED]: 'DOCUMENT_SIZE_CHANGED',\n    [LOK_CALLBACK_SET_PART]: 'SET_PART',\n    [LOK_CALLBACK_SEARCH_RESULT_SELECTION]: 'SEARCH_RESULT_SELECTION',\n    [LOK_CALLBACK_UNO_COMMAND_RESULT]: 'UNO_COMMAND_RESULT',\n    [LOK_CALLBACK_CELL_CURSOR]: 'CELL_CURSOR',\n    [LOK_CALLBACK_MOUSE_POINTER]: 'MOUSE_POINTER',\n    [LOK_CALLBACK_CELL_FORMULA]: 'CELL_FORMULA',\n    [LOK_CALLBACK_DOCUMENT_PASSWORD]: 'DOCUMENT_PASSWORD',\n    [LOK_CALLBACK_DOCUMENT_PASSWORD_TO_MODIFY]: 'DOCUMENT_PASSWORD_TO_MODIFY',\n    [LOK_CALLBACK_CONTEXT_MENU]: 'CONTEXT_MENU',\n    [LOK_CALLBACK_INVALIDATE_VIEW_CURSOR]: 'INVALIDATE_VIEW_CURSOR',\n    [LOK_CALLBACK_TEXT_VIEW_SELECTION]: 'TEXT_VIEW_SELECTION',\n    [LOK_CALLBACK_CELL_VIEW_CURSOR]: 'CELL_VIEW_CURSOR',\n    [LOK_CALLBACK_GRAPHIC_VIEW_SELECTION]: 'GRAPHIC_VIEW_SELECTION',\n    [LOK_CALLBACK_VIEW_CURSOR_VISIBLE]: 'VIEW_CURSOR_VISIBLE',\n    [LOK_CALLBACK_VIEW_LOCK]: 'VIEW_LOCK',\n    [LOK_CALLBACK_REDLINE_TABLE_SIZE_CHANGED]: 'REDLINE_TABLE_SIZE_CHANGED',\n    [LOK_CALLBACK_REDLINE_TABLE_ENTRY_MODIFIED]: 'REDLINE_TABLE_ENTRY_MODIFIED',\n    [LOK_CALLBACK_COMMENT]: 'COMMENT',\n    [LOK_CALLBACK_INVALIDATE_HEADER]: 'INVALIDATE_HEADER',\n    [LOK_CALLBACK_CELL_ADDRESS]: 'CELL_ADDRESS',\n  };\n  return names[type] || `UNKNOWN(${type})`;\n}\n\n// Fallback offsets for WASM32 (4-byte pointers) if shims not available\nconst LOK_CLASS = {\n  nSize: 0,\n  destroy: 4,\n  documentLoad: 8,\n  getError: 12,\n  documentLoadWithOptions: 16,\n  freeError: 20,\n};\n\nconst DOC_CLASS = {\n  nSize: 0,\n  destroy: 4,\n  saveAs: 8,\n};\n\n// Reuse encoder/decoder\nconst textEncoder = new TextEncoder();\nconst textDecoder = new TextDecoder();\n\nexport class LOKBindings {\n  private module: LOKModule;\n  private lokPtr = 0;\n  private verbose: boolean;\n  private useShims: boolean;\n\n  constructor(module: EmscriptenModule, verbose = false) {\n    this.module = module as LOKModule;\n    this.verbose = verbose;\n\n    this.useShims = typeof this.module._lok_documentLoad === 'function';\n    if (this.useShims) {\n      this.log('Using direct LOK shim exports');\n    } else {\n      this.log('Using vtable traversal (shims not available)');\n    }\n  }\n\n  private log(...args: unknown[]): void {\n    if (this.verbose) {\n      console.log('[LOK]', ...args);\n    }\n  }\n\n  /**\n   * Get fresh heap views (important after memory growth!)\n   */\n  private get HEAPU8(): Uint8Array {\n    return this.module.HEAPU8;\n  }\n\n  private get HEAPU32(): Uint32Array {\n    return this.module.HEAPU32;\n  }\n\n  private get HEAP32(): Int32Array {\n    return this.module.HEAP32;\n  }\n\n  /**\n   * Allocate a null-terminated string in WASM memory\n   */\n  allocString(str: string): number {\n    const bytes = textEncoder.encode(str + '\\0');\n    const ptr = this.module._malloc(bytes.length);\n    // Always get fresh heap view after malloc (might have grown memory)\n    this.HEAPU8.set(bytes, ptr);\n    return ptr;\n  }\n\n  /**\n   * Read a null-terminated string from WASM memory\n   */\n  readString(ptr: number): string | null {\n    if (ptr === 0) return null;\n    // Always get fresh heap view\n    const heap = this.HEAPU8;\n    let end = ptr;\n    while (heap[end] !== 0) end++;\n    // Copy the data to avoid SharedArrayBuffer issues in browsers\n    // TextDecoder.decode() doesn't accept SharedArrayBuffer views in some browsers\n    const slice = heap.slice(ptr, end);\n    return textDecoder.decode(slice);\n  }\n\n  /**\n   * Read a 32-bit pointer from memory (unsigned)\n   */\n  readPtr(addr: number): number {\n    // Always get fresh heap view\n    return this.HEAPU32[addr >> 2] || 0;\n  }\n\n  /**\n   * Get a function from the WASM table (fallback for vtable traversal)\n   */\n  private getFunc<T>(ptr: number): T {\n    const wasmTable = this.module.wasmTable as WebAssembly.Table;\n    return wasmTable.get(ptr) as T;\n  }\n\n  /**\n   * Initialize LibreOfficeKit\n   */\n  initialize(installPath: string = '/instdir/program'): void {\n    this.log('Initializing with path:', installPath);\n    const pathPtr = this.allocString(installPath);\n\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n      const hook = (this.module as any)._libreofficekit_hook as\n        | ((pathPtr: number) => number)\n        | undefined;\n\n      if (typeof hook !== 'function') {\n        throw new Error('libreofficekit_hook export not found on module');\n      }\n\n      this.lokPtr = hook(pathPtr);\n\n      if (this.lokPtr === 0) {\n        throw new Error('Failed to initialize LibreOfficeKit');\n      }\n\n      this.log('LOK initialized, ptr:', this.lokPtr);\n    } finally {\n      this.module._free(pathPtr);\n    }\n  }\n\n  /**\n   * Get the last error message\n   */\n  getError(): string | null {\n    if (this.lokPtr === 0) return null;\n\n    // Prefer shim\n    if (this.useShims && this.module._lok_getError) {\n      const errPtr = this.module._lok_getError(this.lokPtr);\n      return this.readString(errPtr);\n    }\n\n    // Fallback: vtable traversal\n    const lokClassPtr = this.readPtr(this.lokPtr);\n    const getErrorPtr = this.readPtr(lokClassPtr + LOK_CLASS.getError);\n    if (getErrorPtr === 0) return null;\n\n    const getError = this.getFunc<(lok: number) => number>(getErrorPtr);\n    const errPtr = getError(this.lokPtr);\n    return this.readString(errPtr);\n  }\n\n  /**\n   * Get version info\n   */\n  getVersionInfo(): string | null {\n    return 'LibreOffice WASM';\n  }\n\n  /**\n   * Convert a filesystem path to a file:// URL\n   * Required by LibreOffice's getAbsoluteURL() which uses rtl::Uri::convertRelToAbs()\n   */\n  private toFileUrl(path: string): string {\n    if (path.startsWith('file://')) return path;\n    const absolutePath = path.startsWith('/') ? path : '/' + path;\n    return 'file://' + absolutePath;\n  }\n\n  /**\n   * Load a document from the virtual filesystem\n   */\n  documentLoad(path: string): number {\n    if (this.lokPtr === 0) {\n      throw new Error('LOK not initialized');\n    }\n\n    const fileUrl = this.toFileUrl(path);\n    this.log('Loading document:', path, '->', fileUrl);\n    const pathPtr = this.allocString(fileUrl);\n\n    try {\n      const startTime = Date.now();\n      let docPtr: number;\n\n      if (this.useShims && this.module._lok_documentLoad) {\n        // Use direct shim export\n        docPtr = this.module._lok_documentLoad(this.lokPtr, pathPtr);\n      } else {\n        // Fallback: vtable traversal\n        const lokClassPtr = this.readPtr(this.lokPtr);\n        const documentLoadPtr = this.readPtr(lokClassPtr + LOK_CLASS.documentLoad);\n        const documentLoad = this.getFunc<(lok: number, path: number) => number>(documentLoadPtr);\n        docPtr = documentLoad(this.lokPtr, pathPtr);\n      }\n\n      this.log('Document loaded in', Date.now() - startTime, 'ms, ptr:', docPtr);\n\n      if (docPtr === 0) {\n        const error = this.getError();\n        throw new Error(`Failed to load document: ${error || 'unknown error'}`);\n      }\n\n      return docPtr;\n    } finally {\n      this.module._free(pathPtr);\n    }\n  }\n\n  /**\n   * Load a document with options\n   */\n  documentLoadWithOptions(path: string, options: string): number {\n    if (this.lokPtr === 0) {\n      throw new Error('LOK not initialized');\n    }\n\n    const fileUrl = this.toFileUrl(path);\n    this.log('Loading document with options:', path, '->', fileUrl, options);\n    const pathPtr = this.allocString(fileUrl);\n    const optsPtr = this.allocString(options);\n\n    try {\n      let docPtr: number;\n\n      if (this.useShims && this.module._lok_documentLoadWithOptions) {\n        // Use direct shim export\n        docPtr = this.module._lok_documentLoadWithOptions(this.lokPtr, pathPtr, optsPtr);\n      } else {\n        // Fallback: vtable traversal\n        const lokClassPtr = this.readPtr(this.lokPtr);\n        const loadWithOptsPtr = this.readPtr(lokClassPtr + LOK_CLASS.documentLoadWithOptions);\n\n        if (loadWithOptsPtr === 0) {\n          // No special method - fall back to plain load\n          return this.documentLoad(path);\n        }\n\n        const loadWithOpts = this.getFunc<\n          (lok: number, path: number, opts: number) => number\n        >(loadWithOptsPtr);\n        docPtr = loadWithOpts(this.lokPtr, pathPtr, optsPtr);\n      }\n\n      if (docPtr === 0) {\n        const error = this.getError();\n        throw new Error(`Failed to load document: ${error || 'unknown error'}`);\n      }\n\n      this.log('Document loaded, ptr:', docPtr);\n      return docPtr;\n    } finally {\n      this.module._free(pathPtr);\n      this.module._free(optsPtr);\n    }\n  }\n\n  /**\n   * Save a document to a different format\n   */\n  documentSaveAs(\n    docPtr: number,\n    outputPath: string,\n    format: string,\n    filterOptions: string = ''\n  ): void {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    const fileUrl = this.toFileUrl(outputPath);\n    this.log('Saving document to:', outputPath, '->', fileUrl, 'format:', format);\n\n    const urlPtr = this.allocString(fileUrl);\n    const formatPtr = this.allocString(format);\n    const optsPtr = this.allocString(filterOptions);\n\n    try {\n      let result: number;\n\n      if (this.useShims && this.module._lok_documentSaveAs) {\n        // Use direct shim export\n        result = this.module._lok_documentSaveAs(docPtr, urlPtr, formatPtr, optsPtr);\n      } else {\n        // Fallback: vtable traversal\n        const docClassPtr = this.readPtr(docPtr);\n        const saveAsPtr = this.readPtr(docClassPtr + DOC_CLASS.saveAs);\n        const saveAs = this.getFunc<\n          (doc: number, url: number, format: number, opts: number) => number\n        >(saveAsPtr);\n        result = saveAs(docPtr, urlPtr, formatPtr, optsPtr);\n      }\n\n      this.log('Save result:', result);\n\n      if (result === 0) {\n        throw new Error('Failed to save document');\n      }\n    } finally {\n      this.module._free(urlPtr);\n      this.module._free(formatPtr);\n      this.module._free(optsPtr);\n    }\n  }\n\n  /**\n   * Destroy a document\n   */\n  documentDestroy(docPtr: number): void {\n    if (docPtr === 0) return;\n\n    if (this.useShims && this.module._lok_documentDestroy) {\n      // Use direct shim export\n      this.module._lok_documentDestroy(docPtr);\n      this.log('Document destroyed (via shim)');\n      return;\n    }\n\n    // Fallback: vtable traversal\n    const docClassPtr = this.readPtr(docPtr);\n    const destroyPtr = this.readPtr(docClassPtr + DOC_CLASS.destroy);\n\n    if (destroyPtr !== 0) {\n      const destroy = this.getFunc<(doc: number) => void>(destroyPtr);\n      destroy(docPtr);\n      this.log('Document destroyed (via vtable)');\n    }\n  }\n\n  /**\n   * Destroy the LOK instance\n   */\n  destroy(): void {\n    if (this.lokPtr === 0) return;\n\n    try {\n      // Prefer C shim if available\n      if (this.useShims && this.module._lok_destroy) {\n        this.module._lok_destroy(this.lokPtr);\n        this.log('LOK destroyed (via shim)');\n      } else {\n        // Fallback: vtable traversal\n        const lokClassPtr = this.readPtr(this.lokPtr);\n        const destroyPtr = this.readPtr(lokClassPtr + LOK_CLASS.destroy);\n\n        if (destroyPtr !== 0) {\n          const destroy = this.getFunc<(lok: number) => void>(destroyPtr);\n          destroy(this.lokPtr);\n          this.log('LOK destroyed (via vtable)');\n        }\n      }\n    } catch (error) {\n      this.log('LOK destroy error (ignored):', error);\n    }\n\n    this.lokPtr = 0;\n  }\n\n  /**\n   * Check if LOK is initialized\n   */\n  isInitialized(): boolean {\n    return this.lokPtr !== 0;\n  }\n\n  /**\n   * Check if using direct shim exports\n   */\n  isUsingShims(): boolean {\n    return this.useShims;\n  }\n\n  // ==========================================\n  // Page Rendering Methods\n  // ==========================================\n\n  /**\n   * Get the number of parts (pages/slides) in a document\n   */\n  documentGetParts(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetParts) {\n      return this.module._lok_documentGetParts(docPtr);\n    }\n\n    // Fallback not implemented - would need vtable offsets\n    this.log('documentGetParts: shim not available');\n    return 0;\n  }\n\n  /**\n   * Get the current part (page/slide) index\n   */\n  documentGetPart(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetPart) {\n      return this.module._lok_documentGetPart(docPtr);\n    }\n\n    this.log('documentGetPart: shim not available');\n    return 0;\n  }\n\n  /**\n   * Set the current part (page/slide) index\n   */\n  documentSetPart(docPtr: number, part: number): void {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentSetPart) {\n      this.module._lok_documentSetPart(docPtr, part);\n      return;\n    }\n\n    this.log('documentSetPart: shim not available');\n  }\n\n  /**\n   * Get document type (0=text, 1=spreadsheet, 2=presentation, 3=drawing)\n   */\n  documentGetDocumentType(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetDocumentType) {\n      return this.module._lok_documentGetDocumentType(docPtr);\n    }\n\n    this.log('documentGetDocumentType: shim not available');\n    return 0;\n  }\n\n  /**\n   * Get document size in twips (1/1440 inch)\n   */\n  documentGetDocumentSize(docPtr: number): { width: number; height: number } {\n    this.log(`documentGetDocumentSize called with docPtr: ${docPtr}`);\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetDocumentSize) {\n      // Allocate space for two longs (32-bit on WASM)\n      const sizePtr = this.module._malloc(8);\n      try {\n        this.module._lok_documentGetDocumentSize(docPtr, sizePtr, sizePtr + 4);\n        const width = this.HEAP32[sizePtr >> 2] ?? 0;\n        const height = this.HEAP32[(sizePtr + 4) >> 2] ?? 0;\n        this.log(`documentGetDocumentSize: ${width}x${height} twips`);\n        return { width, height };\n      } finally {\n        this.module._free(sizePtr);\n      }\n    }\n\n    this.log('documentGetDocumentSize: shim not available');\n    return { width: 0, height: 0 };\n  }\n\n  /**\n   * Initialize document for rendering\n   */\n  documentInitializeForRendering(docPtr: number, options: string = ''): void {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentInitializeForRendering) {\n      const optsPtr = this.allocString(options);\n      try {\n        this.module._lok_documentInitializeForRendering(docPtr, optsPtr);\n      } finally {\n        this.module._free(optsPtr);\n      }\n      return;\n    }\n\n    this.log('documentInitializeForRendering: shim not available');\n  }\n\n  /**\n   * Paint a tile of the document to a buffer\n   * @param docPtr Document pointer\n   * @param canvasWidth Output width in pixels\n   * @param canvasHeight Output height in pixels\n   * @param tilePosX X position in twips\n   * @param tilePosY Y position in twips\n   * @param tileWidth Width in twips\n   * @param tileHeight Height in twips\n   * @returns RGBA pixel data\n   */\n  documentPaintTile(\n    docPtr: number,\n    canvasWidth: number,\n    canvasHeight: number,\n    tilePosX: number,\n    tilePosY: number,\n    tileWidth: number,\n    tileHeight: number\n  ): Uint8Array {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentPaintTile) {\n      // Allocate RGBA buffer (4 bytes per pixel)\n      const bufferSize = canvasWidth * canvasHeight * 4;\n      const bufferPtr = this.module._malloc(bufferSize);\n\n      if (bufferPtr === 0) {\n        throw new Error(`Failed to allocate ${bufferSize} bytes for tile buffer`);\n      }\n\n      try {\n        this.module._lok_documentPaintTile(\n          docPtr,\n          bufferPtr,\n          canvasWidth,\n          canvasHeight,\n          tilePosX,\n          tilePosY,\n          tileWidth,\n          tileHeight\n        );\n\n        // Copy data out of WASM memory\n        const result = new Uint8Array(bufferSize);\n        result.set(this.HEAPU8.subarray(bufferPtr, bufferPtr + bufferSize));\n        return result;\n      } finally {\n        this.module._free(bufferPtr);\n      }\n    }\n\n    this.log('documentPaintTile: shim not available');\n    return new Uint8Array(0);\n  }\n\n  /**\n   * Get tile mode (0=RGBA, 1=BGRA)\n   */\n  documentGetTileMode(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetTileMode) {\n      return this.module._lok_documentGetTileMode(docPtr);\n    }\n\n    this.log('documentGetTileMode: shim not available');\n    return 0; // Default to RGBA\n  }\n\n  /**\n   * Render a page/slide to an image\n   * @param docPtr Document pointer\n   * @param pageIndex Page/slide index (0-based)\n   * @param width Output width in pixels\n   * @param height Output height in pixels (0 = auto based on aspect ratio)\n   * @returns RGBA pixel data and dimensions\n   */\n  renderPage(\n    docPtr: number,\n    pageIndex: number,\n    width: number,\n    height: number = 0,\n    editMode: boolean = false\n  ): { data: Uint8Array; width: number; height: number } {\n    // Initialize for rendering if not already done\n    this.documentInitializeForRendering(docPtr);\n\n    // Get document type to determine rendering strategy\n    const docType = this.documentGetDocumentType(docPtr);\n\n    // For presentations and drawings, use setPart to select the slide/page\n    // For text documents, we need to use page rectangles\n    if (docType === 2 || docType === 3) { // PRESENTATION or DRAWING\n      console.log(`[LOK] Setting part to ${pageIndex} for presentation/drawing`);\n      this.documentSetPart(docPtr, pageIndex);\n      const currentPart = this.documentGetPart(docPtr);\n      console.log(`[LOK] Current part after setPart: ${currentPart}`);\n\n      // Set view mode (0) for presentations to avoid showing edit UI elements\n      // unless explicitly requested\n      if (!editMode) {\n        this.setEditMode(docPtr, 0);\n        console.log(`[LOK] Set edit mode to 0 (view mode) for presentation rendering`);\n      }\n    }\n\n    // Get document/page size in twips\n    const docSize = this.documentGetDocumentSize(docPtr);\n    this.log('Document size (twips):', docSize);\n\n    if (docSize.width === 0 || docSize.height === 0) {\n      throw new Error('Failed to get document size');\n    }\n\n    // For text documents, get page rectangles to find the specific page\n    let tilePosX = 0;\n    let tilePosY = 0;\n    let tileWidth = docSize.width;\n    let tileHeight = docSize.height;\n\n    if (docType === 0 || docType === 1) { // TEXT or SPREADSHEET\n      // Get page rectangles to find the Y offset for this page\n      const pageRectsStr = this.getPartPageRectangles(docPtr);\n      if (pageRectsStr) {\n        const pageRects = this.parsePageRectangles(pageRectsStr);\n        const pageRect = pageRects[pageIndex];\n        if (pageRect) {\n          tilePosX = pageRect.x;\n          tilePosY = pageRect.y;\n          tileWidth = pageRect.width;\n          tileHeight = pageRect.height;\n          this.log(`Page ${pageIndex} rectangle:`, pageRect);\n        }\n      }\n    }\n\n    // Calculate output dimensions maintaining aspect ratio\n    const aspectRatio = tileHeight / tileWidth;\n    const outputWidth = width;\n    const outputHeight = height > 0 ? height : Math.round(width * aspectRatio);\n\n    console.log(`[LOK] Calling paintTile: ${outputWidth}x${outputHeight} from tile pos (${tilePosX}, ${tilePosY}) size (${tileWidth}x${tileHeight})`);\n\n    // Paint the tile for this specific page\n    const data = this.documentPaintTile(\n      docPtr,\n      outputWidth,\n      outputHeight,\n      tilePosX,\n      tilePosY,\n      tileWidth,\n      tileHeight\n    );\n\n    console.log(`[LOK] paintTile returned ${data.length} bytes`);\n    return { data, width: outputWidth, height: outputHeight };\n  }\n\n  /**\n   * Render a page/slide at full quality (native resolution based on DPI)\n   *\n   * Unlike renderPage which scales to a fixed width, this method renders\n   * at the document's native resolution converted to pixels at the specified DPI.\n   *\n   * @param docPtr Document pointer\n   * @param pageIndex Page/slide index (0-based)\n   * @param dpi Dots per inch for rendering (default 150, use 300 for print quality)\n   * @param maxDimension Optional maximum dimension (width or height) to prevent memory issues\n   * @returns RGBA pixel data and dimensions\n   *\n   * @example\n   * // Render at 150 DPI (good for screen)\n   * const preview = lokBindings.renderPageFullQuality(docPtr, 0, 150);\n   *\n   * // Render at 300 DPI (print quality)\n   * const highRes = lokBindings.renderPageFullQuality(docPtr, 0, 300);\n   *\n   * // Render with max dimension cap to prevent memory issues\n   * const capped = lokBindings.renderPageFullQuality(docPtr, 0, 300, 4096);\n   */\n  renderPageFullQuality(\n    docPtr: number,\n    pageIndex: number,\n    dpi: number = 150,\n    maxDimension?: number,\n    editMode: boolean = false\n  ): { data: Uint8Array; width: number; height: number; dpi: number } {\n    // Initialize for rendering if not already done\n    this.documentInitializeForRendering(docPtr);\n\n    // Get document type to determine rendering strategy\n    const docType = this.documentGetDocumentType(docPtr);\n\n    // For presentations and drawings, use setPart to select the slide/page\n    if (docType === 2 || docType === 3) { // PRESENTATION or DRAWING\n      this.log(`Setting part to ${pageIndex} for presentation/drawing`);\n      this.documentSetPart(docPtr, pageIndex);\n\n      // Set view mode (0) for presentations to avoid showing edit UI elements\n      // unless explicitly requested\n      if (!editMode) {\n        this.setEditMode(docPtr, 0);\n        this.log(`Set edit mode to 0 (view mode) for presentation rendering`);\n      }\n    }\n\n    // Get document/page size in twips\n    const docSize = this.documentGetDocumentSize(docPtr);\n    this.log('Document size (twips):', docSize);\n\n    if (docSize.width === 0 || docSize.height === 0) {\n      throw new Error('Failed to get document size');\n    }\n\n    // For text documents, get page rectangles to find the specific page\n    let tilePosX = 0;\n    let tilePosY = 0;\n    let tileWidth = docSize.width;\n    let tileHeight = docSize.height;\n\n    if (docType === 0 || docType === 1) { // TEXT or SPREADSHEET\n      const pageRectsStr = this.getPartPageRectangles(docPtr);\n      if (pageRectsStr) {\n        const pageRects = this.parsePageRectangles(pageRectsStr);\n        const pageRect = pageRects[pageIndex];\n        if (pageRect) {\n          tilePosX = pageRect.x;\n          tilePosY = pageRect.y;\n          tileWidth = pageRect.width;\n          tileHeight = pageRect.height;\n          this.log(`Page ${pageIndex} rectangle:`, pageRect);\n        }\n      }\n    }\n\n    // Convert twips to pixels at the specified DPI\n    // 1 inch = 1440 twips, so pixels = twips * dpi / 1440\n    const TWIPS_PER_INCH = 1440;\n    let outputWidth = Math.round(tileWidth * dpi / TWIPS_PER_INCH);\n    let outputHeight = Math.round(tileHeight * dpi / TWIPS_PER_INCH);\n    let effectiveDpi = dpi;\n\n    // Apply max dimension cap if specified\n    if (maxDimension && (outputWidth > maxDimension || outputHeight > maxDimension)) {\n      const scale = maxDimension / Math.max(outputWidth, outputHeight);\n      outputWidth = Math.round(outputWidth * scale);\n      outputHeight = Math.round(outputHeight * scale);\n      effectiveDpi = Math.round(dpi * scale);\n      this.log(`Capped dimensions to ${outputWidth}x${outputHeight} (effective DPI: ${effectiveDpi})`);\n    }\n\n    console.log(`[LOK] renderPageFullQuality: ${outputWidth}x${outputHeight} at ${effectiveDpi} DPI from tile (${tilePosX}, ${tilePosY}) size (${tileWidth}x${tileHeight}) twips`);\n\n    // Paint the tile\n    const data = this.documentPaintTile(\n      docPtr,\n      outputWidth,\n      outputHeight,\n      tilePosX,\n      tilePosY,\n      tileWidth,\n      tileHeight\n    );\n\n    console.log(`[LOK] renderPageFullQuality returned ${data.length} bytes`);\n    return { data, width: outputWidth, height: outputHeight, dpi: effectiveDpi };\n  }\n\n  // ==========================================\n  // Text Selection and Content Methods\n  // ==========================================\n\n  /**\n   * Get currently selected text\n   * @param docPtr Document pointer\n   * @param mimeType Desired MIME type. Must include charset, e.g., 'text/plain;charset=utf-8'\n   *                 Note: 'text/plain' without charset is NOT supported by LOK\n   * @returns Selected text or null\n   */\n  getTextSelection(docPtr: number, mimeType: string = 'text/plain;charset=utf-8'): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetTextSelection) {\n      const mimePtr = this.allocString(mimeType);\n      const usedMimePtr = this.module._malloc(4); // pointer to char*\n      try {\n        const resultPtr = this.module._lok_documentGetTextSelection(docPtr, mimePtr, usedMimePtr);\n        if (resultPtr === 0) return null;\n        const result = this.readString(resultPtr);\n        this.module._free(resultPtr);\n        return result;\n      } finally {\n        this.module._free(mimePtr);\n        this.module._free(usedMimePtr);\n      }\n    }\n\n    this.log('getTextSelection: shim not available');\n    return null;\n  }\n\n  /**\n   * Set text selection at coordinates\n   * @param docPtr Document pointer\n   * @param type Selection type (LOK_SETTEXTSELECTION_START, END, or RESET)\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   */\n  setTextSelection(docPtr: number, type: number, x: number, y: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetTextSelection) {\n      this.module._lok_documentSetTextSelection(docPtr, type, x, y);\n      return;\n    }\n\n    this.log('setTextSelection: shim not available');\n  }\n\n  /**\n   * Get current selection type\n   * @param docPtr Document pointer\n   * @returns Selection type (LOK_SELTYPE_NONE, TEXT, or CELL)\n   */\n  getSelectionType(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetSelectionType) {\n      return this.module._lok_documentGetSelectionType(docPtr);\n    }\n\n    this.log('getSelectionType: shim not available');\n    return 0;\n  }\n\n  /**\n   * Reset/clear current selection\n   * @param docPtr Document pointer\n   */\n  resetSelection(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentResetSelection) {\n      this.module._lok_documentResetSelection(docPtr);\n      return;\n    }\n\n    this.log('resetSelection: shim not available');\n  }\n\n  // ==========================================\n  // Mouse and Keyboard Event Methods\n  // ==========================================\n\n  /**\n   * Post a mouse event to the document\n   * @param docPtr Document pointer\n   * @param type Event type (LOK_MOUSEEVENT_BUTTONDOWN, BUTTONUP, MOVE)\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   * @param count Click count (1 for single, 2 for double click)\n   * @param buttons Button mask (1=left, 2=middle, 4=right)\n   * @param modifier Modifier keys mask\n   */\n  postMouseEvent(\n    docPtr: number,\n    type: number,\n    x: number,\n    y: number,\n    count: number = 1,\n    buttons: number = 1,\n    modifier: number = 0\n  ): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPostMouseEvent) {\n      this.module._lok_documentPostMouseEvent(docPtr, type, x, y, count, buttons, modifier);\n      return;\n    }\n\n    this.log('postMouseEvent: shim not available');\n  }\n\n  /**\n   * Post a keyboard event to the document\n   * @param docPtr Document pointer\n   * @param type Event type (LOK_KEYEVENT_KEYINPUT, KEYUP)\n   * @param charCode Character code\n   * @param keyCode Key code\n   */\n  postKeyEvent(docPtr: number, type: number, charCode: number, keyCode: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPostKeyEvent) {\n      this.module._lok_documentPostKeyEvent(docPtr, type, charCode, keyCode);\n      return;\n    }\n\n    this.log('postKeyEvent: shim not available');\n  }\n\n  // ==========================================\n  // UNO Command Methods\n  // ==========================================\n\n  /**\n   * Execute a UNO command\n   * @param docPtr Document pointer\n   * @param command UNO command (e.g., '.uno:SelectAll', '.uno:Copy')\n   * @param args JSON arguments string\n   * @param notifyWhenFinished Whether to notify when command completes\n   */\n  postUnoCommand(\n    docPtr: number,\n    command: string,\n    args: string = '{}',\n    notifyWhenFinished: boolean = false\n  ): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPostUnoCommand) {\n      const cmdPtr = this.allocString(command);\n      const argsPtr = this.allocString(args);\n      try {\n        this.module._lok_documentPostUnoCommand(docPtr, cmdPtr, argsPtr, notifyWhenFinished ? 1 : 0);\n      } finally {\n        this.module._free(cmdPtr);\n        this.module._free(argsPtr);\n      }\n      return;\n    }\n\n    this.log('postUnoCommand: shim not available');\n  }\n\n  /**\n   * Get command values (query document state)\n   * @param docPtr Document pointer\n   * @param command Command to query (e.g., '.uno:CharFontName')\n   * @returns JSON string with command values\n   */\n  getCommandValues(docPtr: number, command: string): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetCommandValues) {\n      const cmdPtr = this.allocString(command);\n      try {\n        const resultPtr = this.module._lok_documentGetCommandValues(docPtr, cmdPtr);\n        if (resultPtr === 0) return null;\n        const result = this.readString(resultPtr);\n        this.module._free(resultPtr);\n        return result;\n      } finally {\n        this.module._free(cmdPtr);\n      }\n    }\n\n    this.log('getCommandValues: shim not available');\n    return null;\n  }\n\n  // ==========================================\n  // Page/Part Information Methods\n  // ==========================================\n\n  /**\n   * Get bounding rectangles for all pages\n   * @param docPtr Document pointer\n   * @returns String with rectangles \"x,y,width,height;x,y,width,height;...\"\n   */\n  getPartPageRectangles(docPtr: number): string | null {\n    this.log(`getPartPageRectangles called with docPtr: ${docPtr}`);\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetPartPageRectangles) {\n      this.log('getPartPageRectangles: using shim');\n      const resultPtr = this.module._lok_documentGetPartPageRectangles(docPtr);\n      this.log(`getPartPageRectangles: resultPtr=${resultPtr}`);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.log(`getPartPageRectangles: result=\"${result?.slice(0, 100)}...\"`);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getPartPageRectangles: shim not available');\n    return null;\n  }\n\n  /**\n   * Get information about a page/slide\n   * @param docPtr Document pointer\n   * @param part Part index\n   * @returns JSON string with part info\n   */\n  getPartInfo(docPtr: number, part: number): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetPartInfo) {\n      const resultPtr = this.module._lok_documentGetPartInfo(docPtr, part);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getPartInfo: shim not available');\n    return null;\n  }\n\n  /**\n   * Get name of a page/slide\n   * @param docPtr Document pointer\n   * @param part Part index\n   * @returns Part name\n   */\n  getPartName(docPtr: number, part: number): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetPartName) {\n      const resultPtr = this.module._lok_documentGetPartName(docPtr, part);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getPartName: shim not available');\n    return null;\n  }\n\n  // ==========================================\n  // Clipboard Methods\n  // ==========================================\n\n  /**\n   * Paste content at current cursor position\n   * @param docPtr Document pointer\n   * @param mimeType MIME type of data\n   * @param data Data to paste\n   * @returns true if successful\n   */\n  paste(docPtr: number, mimeType: string, data: string | Uint8Array): boolean {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPaste) {\n      const mimePtr = this.allocString(mimeType);\n      let dataPtr: number;\n      let dataSize: number;\n\n      if (typeof data === 'string') {\n        const bytes = new TextEncoder().encode(data);\n        dataSize = bytes.length;\n        dataPtr = this.module._malloc(dataSize);\n        this.HEAPU8.set(bytes, dataPtr);\n      } else {\n        dataSize = data.length;\n        dataPtr = this.module._malloc(dataSize);\n        this.HEAPU8.set(data, dataPtr);\n      }\n\n      try {\n        return this.module._lok_documentPaste(docPtr, mimePtr, dataPtr, dataSize) !== 0;\n      } finally {\n        this.module._free(mimePtr);\n        this.module._free(dataPtr);\n      }\n    }\n\n    this.log('paste: shim not available');\n    return false;\n  }\n\n  // ==========================================\n  // View and Zoom Methods\n  // ==========================================\n\n  /**\n   * Set client zoom level\n   * @param docPtr Document pointer\n   * @param tilePixelWidth Tile width in pixels\n   * @param tilePixelHeight Tile height in pixels\n   * @param tileTwipWidth Tile width in twips\n   * @param tileTwipHeight Tile height in twips\n   */\n  setClientZoom(\n    docPtr: number,\n    tilePixelWidth: number,\n    tilePixelHeight: number,\n    tileTwipWidth: number,\n    tileTwipHeight: number\n  ): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetClientZoom) {\n      this.module._lok_documentSetClientZoom(docPtr, tilePixelWidth, tilePixelHeight, tileTwipWidth, tileTwipHeight);\n      return;\n    }\n\n    this.log('setClientZoom: shim not available');\n  }\n\n  /**\n   * Set visible area for the client\n   * @param docPtr Document pointer\n   * @param x X position in twips\n   * @param y Y position in twips\n   * @param width Width in twips\n   * @param height Height in twips\n   */\n  setClientVisibleArea(docPtr: number, x: number, y: number, width: number, height: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetClientVisibleArea) {\n      this.module._lok_documentSetClientVisibleArea(docPtr, x, y, width, height);\n      return;\n    }\n\n    this.log('setClientVisibleArea: shim not available');\n  }\n\n  // ==========================================\n  // Accessibility Methods\n  // ==========================================\n\n  /**\n   * Get the currently focused paragraph text\n   * @param docPtr Document pointer\n   * @returns Focused paragraph text\n   */\n  getA11yFocusedParagraph(docPtr: number): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetA11yFocusedParagraph) {\n      const resultPtr = this.module._lok_documentGetA11yFocusedParagraph(docPtr);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getA11yFocusedParagraph: shim not available');\n    return null;\n  }\n\n  /**\n   * Get caret position in focused paragraph\n   * @param docPtr Document pointer\n   * @returns Caret position or -1\n   */\n  getA11yCaretPosition(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetA11yCaretPosition) {\n      return this.module._lok_documentGetA11yCaretPosition(docPtr);\n    }\n\n    this.log('getA11yCaretPosition: shim not available');\n    return -1;\n  }\n\n  /**\n   * Enable/disable accessibility features\n   * @param docPtr Document pointer\n   * @param viewId View ID\n   * @param enabled Whether to enable accessibility\n   */\n  setAccessibilityState(docPtr: number, viewId: number, enabled: boolean): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetAccessibilityState) {\n      this.module._lok_documentSetAccessibilityState(docPtr, viewId, enabled ? 1 : 0);\n      return;\n    }\n\n    this.log('setAccessibilityState: shim not available');\n  }\n\n  // ==========================================\n  // Spreadsheet-Specific Methods\n  // ==========================================\n\n  /**\n   * Get data area for a spreadsheet (last used row/column)\n   * @param docPtr Document pointer\n   * @param part Sheet index\n   * @returns Object with col and row counts\n   */\n  getDataArea(docPtr: number, part: number): { col: number; row: number } {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetDataArea) {\n      const colPtr = this.module._malloc(8);\n      const rowPtr = this.module._malloc(8);\n      try {\n        this.module._lok_documentGetDataArea(docPtr, part, colPtr, rowPtr);\n        const col = this.HEAP32[colPtr >> 2] ?? 0;\n        const row = this.HEAP32[rowPtr >> 2] ?? 0;\n        return { col, row };\n      } finally {\n        this.module._free(colPtr);\n        this.module._free(rowPtr);\n      }\n    }\n\n    this.log('getDataArea: shim not available');\n    return { col: 0, row: 0 };\n  }\n\n  // ==========================================\n  // Edit Mode Methods\n  // ==========================================\n\n  /**\n   * Get current edit mode\n   * @param docPtr Document pointer\n   * @returns Edit mode value\n   */\n  getEditMode(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetEditMode) {\n      return this.module._lok_documentGetEditMode(docPtr);\n    }\n\n    this.log('getEditMode: shim not available');\n    return 0;\n  }\n\n  /**\n   * Set edit mode for the document\n   * @param docPtr Document pointer\n   * @param mode 0 for view mode, 1 for edit mode\n   */\n  setEditMode(docPtr: number, mode: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetEditMode) {\n      this.log(`setEditMode: setting mode to ${mode}`);\n      this.module._lok_documentSetEditMode(docPtr, mode);\n      return;\n    }\n\n    this.log('setEditMode: shim not available');\n  }\n\n  // ==========================================\n  // View Management Methods\n  // ==========================================\n\n  /**\n   * Create a new view for the document\n   * @param docPtr Document pointer\n   * @returns View ID\n   */\n  createView(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentCreateView) {\n      const viewId = this.module._lok_documentCreateView(docPtr);\n      this.log(`createView: created view ${viewId}`);\n      return viewId;\n    }\n\n    this.log('createView: shim not available');\n    return -1;\n  }\n\n  /**\n   * Create a new view with options\n   * @param docPtr Document pointer\n   * @param options Options string (JSON)\n   * @returns View ID\n   */\n  createViewWithOptions(docPtr: number, options: string): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentCreateViewWithOptions) {\n      const optionsPtr = this.allocString(options);\n      try {\n        const viewId = this.module._lok_documentCreateViewWithOptions(docPtr, optionsPtr);\n        this.log(`createViewWithOptions: created view ${viewId}`);\n        return viewId;\n      } finally {\n        this.module._free(optionsPtr);\n      }\n    }\n\n    this.log('createViewWithOptions: shim not available');\n    return -1;\n  }\n\n  /**\n   * Destroy a view\n   * @param docPtr Document pointer\n   * @param viewId View ID to destroy\n   */\n  destroyView(docPtr: number, viewId: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentDestroyView) {\n      this.log(`destroyView: destroying view ${viewId}`);\n      this.module._lok_documentDestroyView(docPtr, viewId);\n      return;\n    }\n\n    this.log('destroyView: shim not available');\n  }\n\n  /**\n   * Set the current active view\n   * @param docPtr Document pointer\n   * @param viewId View ID to make active\n   */\n  setView(docPtr: number, viewId: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetView) {\n      this.log(`setView: setting active view to ${viewId}`);\n      this.module._lok_documentSetView(docPtr, viewId);\n      return;\n    }\n\n    this.log('setView: shim not available');\n  }\n\n  /**\n   * Get the current active view ID\n   * @param docPtr Document pointer\n   * @returns Current view ID\n   */\n  getView(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetView) {\n      return this.module._lok_documentGetView(docPtr);\n    }\n\n    this.log('getView: shim not available');\n    return -1;\n  }\n\n  /**\n   * Get the number of views\n   * @param docPtr Document pointer\n   * @returns Number of views\n   */\n  getViewsCount(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetViewsCount) {\n      return this.module._lok_documentGetViewsCount(docPtr);\n    }\n\n    this.log('getViewsCount: shim not available');\n    return 0;\n  }\n\n  // ==========================================\n  // Event Loop and Callback Methods\n  // ==========================================\n\n  /**\n   * Enable synchronous event dispatch (Unipoll mode).\n   * This must be called before using postKeyEvent, postMouseEvent, etc.\n   * to ensure events are processed immediately instead of being queued.\n   *\n   * Without this, events posted via postKeyEvent/postMouseEvent are queued\n   * via Application::PostUserEvent() and never processed in headless mode.\n   */\n  enableSyncEvents(): void {\n    if (this.useShims && this.module._lok_enableSyncEvents) {\n      this.module._lok_enableSyncEvents();\n      this.log('enableSyncEvents: Unipoll mode enabled');\n    } else {\n      this.log('enableSyncEvents: shim not available');\n    }\n  }\n\n  /**\n   * Disable synchronous event dispatch.\n   * Call this when done with event-based operations.\n   */\n  disableSyncEvents(): void {\n    if (this.useShims && this.module._lok_disableSyncEvents) {\n      this.module._lok_disableSyncEvents();\n      this.log('disableSyncEvents: Unipoll mode disabled');\n    } else {\n      this.log('disableSyncEvents: shim not available');\n    }\n  }\n\n  // ==========================================\n  // Callback Queue Methods\n  // ==========================================\n\n  /**\n   * Register a callback handler for the document.\n   * Events are queued and can be retrieved via pollCallback().\n   * @param docPtr Document pointer\n   */\n  registerCallback(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentRegisterCallback) {\n      this.module._lok_documentRegisterCallback(docPtr);\n      this.log('registerCallback: callback registered');\n    } else {\n      this.log('registerCallback: shim not available');\n    }\n  }\n\n  /**\n   * Unregister the callback handler for the document.\n   * @param docPtr Document pointer\n   */\n  unregisterCallback(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentUnregisterCallback) {\n      this.module._lok_documentUnregisterCallback(docPtr);\n      this.log('unregisterCallback: callback unregistered');\n    } else {\n      this.log('unregisterCallback: shim not available');\n    }\n  }\n\n  /**\n   * Check if there are any pending callback events.\n   * @returns true if events are pending\n   */\n  hasCallbackEvents(): boolean {\n    if (this.useShims && this.module._lok_hasCallbackEvents) {\n      return this.module._lok_hasCallbackEvents() !== 0;\n    }\n    return false;\n  }\n\n  /**\n   * Get the number of pending callback events.\n   * @returns Number of events in the queue\n   */\n  getCallbackEventCount(): number {\n    if (this.useShims && this.module._lok_getCallbackEventCount) {\n      return this.module._lok_getCallbackEventCount();\n    }\n    return 0;\n  }\n\n  /**\n   * Poll and retrieve the next callback event from the queue.\n   * @returns The next event, or null if queue is empty\n   */\n  pollCallback(): LOKCallbackEvent | null {\n    if (!this.useShims || !this.module._lok_pollCallback) {\n      return null;\n    }\n\n    const bufferSize = 4096;\n    const payloadBuffer = this.module._malloc(bufferSize);\n    const payloadLengthPtr = this.module._malloc(4);\n\n    try {\n      const eventType = this.module._lok_pollCallback(payloadBuffer, bufferSize, payloadLengthPtr);\n\n      if (eventType === -1) {\n        return null; // Queue is empty\n      }\n\n      // Read the payload length\n      const payloadLength = this.module.HEAP32[payloadLengthPtr >> 2] ?? 0;\n\n      // Read the payload string\n      let payload = '';\n      if (payloadLength > 0) {\n        // Copy bytes from HEAPU8 to avoid SharedArrayBuffer issues in browsers\n        // TextDecoder.decode() doesn't accept SharedArrayBuffer views in some browsers\n        const len = Math.min(payloadLength, bufferSize - 1);\n        const bytes = this.module.HEAPU8.slice(payloadBuffer, payloadBuffer + len);\n        payload = textDecoder.decode(bytes);\n      }\n\n      return {\n        type: eventType,\n        typeName: getCallbackTypeName(eventType),\n        payload,\n      };\n    } finally {\n      this.module._free(payloadBuffer);\n      this.module._free(payloadLengthPtr);\n    }\n  }\n\n  /**\n   * Poll all pending callback events.\n   * @returns Array of all pending events\n   */\n  pollAllCallbacks(): LOKCallbackEvent[] {\n    const events: LOKCallbackEvent[] = [];\n    let event = this.pollCallback();\n    while (event !== null) {\n      events.push(event);\n      event = this.pollCallback();\n    }\n    return events;\n  }\n\n  /**\n   * Clear all pending callback events.\n   */\n  clearCallbackQueue(): void {\n    if (this.useShims && this.module._lok_clearCallbackQueue) {\n      this.module._lok_clearCallbackQueue();\n      this.log('clearCallbackQueue: queue cleared');\n    }\n  }\n\n  /**\n   * Force flush pending LOK callbacks for a document.\n   * This is needed in WASM because callbacks are queued via PostUserEvent\n   * but the event loop doesn't run automatically.\n   * Call this after operations that trigger callbacks (e.g., postUnoCommand)\n   * to ensure the callback queue is populated.\n   * @param docPtr Document pointer\n   */\n  flushCallbacks(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    const hasShim = !!this.module._lok_flushCallbacks;\n    this.log(`flushCallbacks: useShims=${this.useShims}, _lok_flushCallbacks exists=${hasShim}`);\n\n    if (this.useShims && this.module._lok_flushCallbacks) {\n      this.module._lok_flushCallbacks(docPtr);\n      this.log('flushCallbacks: callbacks flushed');\n    } else {\n      this.log('flushCallbacks: shim not available');\n    }\n  }\n\n  /**\n   * Poll for STATE_CHANGED callbacks and parse them into a map.\n   * STATE_CHANGED payloads are in format: \".uno:CommandName=value\"\n   * @returns Map of command names to values\n   */\n  pollStateChanges(): Map<string, string> {\n    const states = new Map<string, string>();\n    const events = this.pollAllCallbacks();\n\n    for (const event of events) {\n      if (event.type === LOK_CALLBACK_STATE_CHANGED) {\n        // Parse \".uno:Bold=true\" format\n        const eqIndex = event.payload.indexOf('=');\n        if (eqIndex !== -1) {\n          const key = event.payload.substring(0, eqIndex);\n          const value = event.payload.substring(eqIndex + 1);\n          states.set(key, value);\n        } else {\n          // Some state changes are just the command name (enabled/disabled toggle)\n          states.set(event.payload, '');\n        }\n      }\n    }\n\n    return states;\n  }\n\n  // ==========================================\n  // High-Level Convenience Methods\n  // ==========================================\n\n  /**\n   * Click at a position and get text at that location\n   * @param docPtr Document pointer\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   * @returns Text at the clicked position\n   */\n  clickAndGetText(docPtr: number, x: number, y: number): string | null {\n    // Click down and up to select\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONDOWN, x, y, 1, 1, 0);\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONUP, x, y, 1, 1, 0);\n\n    // Get selected text\n    return this.getTextSelection(docPtr, 'text/plain;charset=utf-8');\n  }\n\n  /**\n   * Double-click to select a word and get it\n   * @param docPtr Document pointer\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   * @returns Selected word\n   */\n  doubleClickAndGetWord(docPtr: number, x: number, y: number): string | null {\n    // Double click to select word\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONDOWN, x, y, 2, 1, 0);\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONUP, x, y, 2, 1, 0);\n\n    // Get selected text\n    return this.getTextSelection(docPtr, 'text/plain;charset=utf-8');\n  }\n\n  /**\n   * Select all content in the document\n   * @param docPtr Document pointer\n   */\n  selectAll(docPtr: number): void {\n    this.postUnoCommand(docPtr, '.uno:SelectAll');\n  }\n\n  /**\n   * Get all text content from the document\n   * @param docPtr Document pointer\n   * @returns All text content\n   */\n  getAllText(docPtr: number): string | null {\n    this.log(`getAllText called with docPtr: ${docPtr}`);\n    this.selectAll(docPtr);\n    const text = this.getTextSelection(docPtr, 'text/plain;charset=utf-8');\n    this.log(`getAllText: text=\"${text?.slice(0, 100)}...\"`);\n    this.resetSelection(docPtr);\n    return text;\n  }\n\n  /**\n   * Parse page rectangles string into array of objects\n   * @param rectanglesStr String from getPartPageRectangles\n   * @returns Array of rectangle objects\n   */\n  parsePageRectangles(rectanglesStr: string): Array<{ x: number; y: number; width: number; height: number }> {\n    if (!rectanglesStr) return [];\n    \n    return rectanglesStr.split(';').filter(s => s.trim()).map(rect => {\n      const parts = rect.split(',').map(Number);\n      return { \n        x: parts[0] ?? 0, \n        y: parts[1] ?? 0, \n        width: parts[2] ?? 0, \n        height: parts[3] ?? 0 \n      };\n    });\n  }\n}\n","/**\n * LibreOffice WASM Document Converter - Node.js Version\n *\n * This is the Node.js-specific version that requires wasmLoader to be provided.\n * For browser usage, use converter.ts instead.\n */\n\nimport {\n  ConversionError,\n  ConversionErrorCode,\n  ConversionOptions,\n  ConversionResult,\n  DocumentInfo,\n  EditorOperationResult,\n  EditorSession,\n  EmscriptenModule,\n  EXTENSION_TO_FORMAT,\n  FORMAT_FILTERS,\n  FORMAT_MIME_TYPES,\n  FORMAT_FILTER_OPTIONS,\n  FullQualityPagePreview,\n  FullQualityRenderOptions,\n  ILibreOfficeConverter,\n  InputFormatOptions,\n  LibreOfficeWasmOptions,\n  LOKDocumentType,\n  OUTPUT_FORMAT_TO_LOK,\n  OutputFormat,\n  PagePreview,\n  ProgressInfo,\n  RenderOptions,\n  isConversionValid,\n  getConversionErrorMessage,\n  getValidOutputFormats,\n  InputFormat,\n  getOutputFormatsForDocType,\n  buildLoadOptions,\n} from './types.js';\nimport { LOKBindings } from './lok-bindings.js';\n\n/** Emscripten worker with Node.js-specific methods */\ninterface EmscriptenWorker {\n  unref?: () => void;\n  terminate?: () => void;\n}\n\n/** Emscripten PThread interface for pthread cleanup */\ninterface EmscriptenPThread {\n  terminateAllThreads?: () => void;\n  runningWorkers?: EmscriptenWorker[];\n  unusedWorkers?: EmscriptenWorker[];\n}\n\n/** Emscripten module with PThread support */\ninterface EmscriptenModuleWithPThread extends EmscriptenModule {\n  PThread?: EmscriptenPThread;\n}\n\n/** Node.js process handle */\ninterface ProcessHandle {\n  unref?: () => void;\n  constructor?: { name?: string };\n  remoteAddress?: string;\n}\n\n/** Node.js process with internal methods */\ninterface ProcessWithHandles {\n  _getActiveHandles?: () => ProcessHandle[];\n}\n\n/**\n * LibreOffice WASM Document Converter - Node.js Version\n *\n * A headless document conversion toolkit that uses LibreOffice\n * compiled to WebAssembly. This version is optimized for Node.js\n * with static imports that work with ESM bundlers.\n */\nexport class LibreOfficeConverter implements ILibreOfficeConverter {\n  private module: EmscriptenModule | null = null;\n  private lokBindings: LOKBindings | null = null;\n  private initialized = false;\n  private initializing = false;\n  private options: LibreOfficeWasmOptions;\n  private corrupted = false;\n  private fsTracked = false;\n\n  constructor(options: LibreOfficeWasmOptions = {}) {\n    this.options = {\n      wasmPath: './wasm',\n      verbose: false,\n      ...options,\n    };\n  }\n\n  /**\n   * Check if an error indicates LOK corruption requiring reinitialization\n   */\n  private isCorruptionError(error: Error | string): boolean {\n    const msg = error instanceof Error ? error.message : error;\n    return msg.includes('memory access out of bounds') ||\n      msg.includes('ComponentContext is not avail') ||\n      msg.includes('unreachable') ||\n      msg.includes('table index is out of bounds') ||\n      msg.includes('null function');\n  }\n\n  /**\n   * Force reinitialization of the converter (for recovery from errors)\n   */\n  async reinitialize(): Promise<void> {\n    if (this.options.verbose) {\n      console.log('[LibreOfficeConverter] Reinitializing due to corruption...');\n    }\n\n    // Clean up existing state\n    if (this.lokBindings) {\n      try {\n        this.lokBindings.destroy();\n      } catch {\n        // Ignore errors during cleanup\n      }\n      this.lokBindings = null;\n    }\n    this.module = null;\n    this.initialized = false;\n    this.corrupted = false;\n\n    // Reinitialize\n    await this.initialize();\n  }\n\n  /**\n   * Initialize with a pre-loaded Emscripten module\n   * This is useful for environments like Web Workers that have their own\n   * WASM loading mechanism (e.g., importScripts with progress tracking)\n   */\n  async initializeWithModule(module: EmscriptenModule): Promise<void> {\n    if (this.initialized) {\n      return;\n    }\n\n    if (this.initializing) {\n      while (this.initializing) {\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      }\n      return;\n    }\n\n    this.initializing = true;\n\n    try {\n      this.module = module;\n\n      // Set up filesystem\n      this.setupFileSystem();\n\n      // Initialize LibreOfficeKit\n      this.initializeLibreOfficeKit();\n\n      this.initialized = true;\n      this.options.onReady?.();\n    } catch (error) {\n      console.error('[LibreOfficeConverter] Initialization error:', error);\n      const convError =\n        error instanceof ConversionError\n          ? error\n          : new ConversionError(\n            ConversionErrorCode.WASM_NOT_INITIALIZED,\n            `Failed to initialize with module: ${String(error)}`\n          );\n      this.options.onError?.(convError);\n      throw convError;\n    } finally {\n      this.initializing = false;\n    }\n  }\n\n  /**\n   * Initialize the LibreOffice WASM module\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) {\n      return;\n    }\n\n    if (this.initializing) {\n      while (this.initializing) {\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      }\n      return;\n    }\n\n    this.initializing = true;\n    this.emitProgress('loading', 0, 'Loading LibreOffice WASM module...');\n\n    try {\n      // Load WASM module (progress 0-45% handled by loader)\n      this.module = await this.loadModule();\n\n      this.emitProgress('initializing', 50, 'Setting up virtual filesystem...');\n\n      // Create directories in virtual filesystem\n      this.setupFileSystem();\n\n      this.emitProgress('initializing', 60, 'Initializing LibreOfficeKit...');\n\n      // Initialize LibreOfficeKit\n      this.initializeLibreOfficeKit();\n\n      this.emitProgress('initializing', 90, 'LibreOfficeKit ready');\n\n      this.initialized = true;\n      this.emitProgress('complete', 100, 'LibreOffice ready');\n      this.options.onReady?.();\n    } catch (error) {\n      console.error('[LibreOfficeConverter] Initialization error:', error);\n      const convError =\n        error instanceof ConversionError\n          ? error\n          : new ConversionError(\n            ConversionErrorCode.WASM_NOT_INITIALIZED,\n            `Failed to initialize WASM module: ${String(error)}`\n          );\n      this.options.onError?.(convError);\n      throw convError;\n    } finally {\n      this.initializing = false;\n    }\n  }\n\n  /**\n   * Load the Emscripten WASM module (Node.js only)\n   * Requires wasmLoader option to be provided for bundler compatibility\n   */\n  private async loadModule(): Promise<EmscriptenModule> {\n    console.log('[LibreOfficeConverter] Loading WASM module...', this.options.wasmPath, this.options.workerPath, this.options.wasmLoader);\n\n    // wasmLoader must be provided - no dynamic require\n    if (!this.options.wasmLoader) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'wasmLoader option is required. Import the loader and pass it:\\n' +\n        '  import wasmLoader from \"@matbee/libreoffice-converter/wasm/loader.cjs\";\\n' +\n        '  new LibreOfficeConverter({ wasmLoader })'\n      );\n    }\n\n    // Build loader config\n    const config = {\n      verbose: this.options.verbose,\n      print: this.options.verbose ? console.log : () => { },\n      printErr: this.options.verbose ? console.error : () => { },\n      onProgress: (_phase: string, percent: number, message: string) => {\n        // Map loader progress to our progress phases\n        this.emitProgress('loading', percent, message);\n      },\n    };\n\n    return await this.options.wasmLoader.createModule(config);\n  }\n\n  /**\n   * Set up the virtual filesystem\n   */\n  private setupFileSystem(): void {\n    if (!this.module?.FS) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Filesystem not available'\n      );\n    }\n\n    const emFs = this.module.FS;\n\n    const tryMkdir = (dirPath: string) => {\n      try {\n        emFs.mkdir(dirPath);\n      } catch {\n        // Directory may already exist\n      }\n    };\n\n    tryMkdir('/tmp');\n    tryMkdir('/tmp/input');\n    tryMkdir('/tmp/output');\n  }\n\n  /**\n   * Initialize LibreOfficeKit\n   */\n  private initializeLibreOfficeKit(): void {\n    if (!this.module) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Module not loaded'\n      );\n    }\n\n    // Debug filesystem contents before LOK init\n    if (this.options.verbose && this.module.FS) {\n      const emFs = this.module.FS as typeof this.module.FS & {\n        trackingDelegate?: Record<string, unknown>;\n        open: (...args: unknown[]) => unknown;\n      };\n\n      if (!this.fsTracked) {\n        this.fsTracked = true;\n\n        if (!emFs.trackingDelegate) {\n          emFs.trackingDelegate = {\n            onOpen: (filePath: string) => {\n              console.log('[FS OPEN]', filePath);\n            },\n            onOpenFile: (filePath: string) => {\n              console.log('[FS OPEN FILE]', filePath);\n            },\n          };\n        }\n\n        if (typeof emFs.open === 'function') {\n          const originalOpen = emFs.open.bind(emFs);\n          emFs.open = ((filePath: string, flags?: unknown, mode?: unknown) => {\n            console.log('[FS OPEN CALL]', filePath);\n            try {\n              return originalOpen(filePath, flags as never, mode as never);\n            } catch (err) {\n              const error = err as { code?: string; message?: string };\n              if (error?.code === 'ENOENT') {\n                console.log('[FS ENOENT]', filePath);\n              }\n              throw err;\n            }\n          }) as typeof emFs.open;\n        }\n      }\n\n      const logDir = (label: string, dirPath: string) => {\n        try {\n          console.log(`[FS] ${label}:`, emFs.readdir(dirPath));\n        } catch (e) {\n          console.log(`[FS] ${label}: ERROR -`, (e as Error).message);\n        }\n      };\n\n      logDir('ROOT', '/');\n      logDir('PROGRAM DIR', '/instdir/program');\n      logDir('SHARE DIR', '/instdir/share');\n      logDir('REGISTRY DIR', '/instdir/share/registry');\n      logDir('FILTER DIR', '/instdir/share/filter');\n      logDir('CONFIG DIR', '/instdir/share/config/soffice.cfg');\n      logDir('CONFIG FILTER', '/instdir/share/config/soffice.cfg/filter');\n      logDir('IMPRESS MODULES', '/instdir/share/config/soffice.cfg/modules/simpress');\n    }\n\n    // Create required directories for LibreOffice user profile\n    // These are needed for temp files, locks, and user settings during LOK initialization\n    const emFs = this.module.FS;\n    const createDir = (dirPath: string) => {\n      try {\n        emFs.mkdir(dirPath);\n        if (this.options.verbose) {\n          console.log('[FS] Created directory:', dirPath);\n        }\n      } catch (e) {\n        // Directory might already exist - ignore EEXIST errors\n        const err = e as { code?: string };\n        if (err.code !== 'EEXIST') {\n          if (this.options.verbose) {\n            console.log('[FS] mkdir failed:', dirPath, (e as Error).message);\n          }\n        }\n      }\n    };\n\n    // Create user profile directories that LibreOffice needs\n    createDir('/instdir/user');\n    createDir('/instdir/user/temp');\n    createDir('/instdir/user/temp/embeddedfonts');\n    createDir('/instdir/user/temp/embeddedfonts/fromdocs');\n    createDir('/instdir/user/temp/embeddedfonts/fromsystem');\n    createDir('/instdir/user/registry');\n    createDir('/instdir/user/registry/data');\n\n    // Create LOK bindings wrapper\n    this.lokBindings = new LOKBindings(this.module, this.options.verbose);\n\n    try {\n      // Initialize LibreOfficeKit through the bindings\n      this.lokBindings.initialize('/instdir/program');\n\n      if (this.options.verbose) {\n        const versionInfo = this.lokBindings.getVersionInfo();\n        if (versionInfo) {\n          console.log('[LOK] Version:', versionInfo);\n        }\n      }\n    } catch (error) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        `Failed to initialize LibreOfficeKit: ${String(error)}`\n      );\n    }\n  }\n\n  /**\n   * Convert a document to a different format\n   */\n  async convert(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    filename = 'document'\n  ): Promise<ConversionResult> {\n    // Check if we need to reinitialize due to previous corruption\n    if (this.corrupted) {\n      await this.reinitialize();\n    }\n\n    if (!this.initialized || !this.module) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'LibreOffice WASM not initialized. Call initialize() first.'\n      );\n    }\n\n    const startTime = Date.now();\n    const inputData = this.normalizeInput(input);\n\n    if (inputData.length === 0) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Empty document provided'\n      );\n    }\n\n    const inputExt = options.inputFormat || this.getExtensionFromFilename(filename) || 'docx';\n    const outputExt = options.outputFormat;\n\n    if (!FORMAT_FILTERS[outputExt]) {\n      throw new ConversionError(\n        ConversionErrorCode.UNSUPPORTED_FORMAT,\n        `Unsupported output format: ${outputExt}`\n      );\n    }\n\n    // Validate that this conversion path is supported\n    if (!isConversionValid(inputExt, outputExt)) {\n      throw new ConversionError(\n        ConversionErrorCode.UNSUPPORTED_FORMAT,\n        getConversionErrorMessage(inputExt, outputExt)\n      );\n    }\n\n    const inputPath = `/tmp/input/doc.${inputExt}`;\n    const outputPath = `/tmp/output/doc.${outputExt}`;\n\n    try {\n      this.emitProgress('converting', 10, 'Writing input document...');\n\n      // Write input file to virtual filesystem\n      this.module.FS.writeFile(inputPath, inputData);\n\n      this.emitProgress('converting', 30, 'Converting document...');\n\n      // Perform conversion\n      const result = await this.performConversion(inputPath, outputPath, options);\n\n      this.emitProgress('complete', 100, 'Conversion complete');\n\n      const baseName = this.getBasename(filename);\n      const outputFilename = `${baseName}.${outputExt}`;\n\n      return {\n        data: result,\n        mimeType: FORMAT_MIME_TYPES[outputExt],\n        filename: outputFilename,\n        duration: Date.now() - startTime,\n      };\n    } catch (error) {\n      // Check if this error indicates corruption\n      if (error instanceof Error && this.isCorruptionError(error)) {\n        this.corrupted = true;\n        if (this.options.verbose) {\n          console.log('[LibreOfficeConverter] Corruption detected, will reinitialize on next convert');\n        }\n      }\n      throw error;\n    } finally {\n      // Cleanup temporary files\n      try {\n        this.module?.FS.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        this.module?.FS.unlink(outputPath);\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Perform the actual conversion using LibreOfficeKit\n   */\n  private async performConversion(\n    inputPath: string,\n    outputPath: string,\n    options: ConversionOptions\n  ): Promise<Uint8Array> {\n    if (!this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Module not loaded'\n      );\n    }\n\n    this.emitProgress('converting', 40, 'Loading document...');\n\n    let docPtr = 0;\n\n    try {\n      // Build load options (e.g., for CSV import filter or password-protected documents)\n      const loadOptions = buildLoadOptions(options.inputFormat, options.password);\n\n      // Debug: verify file exists before LOK load\n      if (this.options.verbose) {\n        try {\n          const stat = this.module.FS.stat(inputPath);\n          console.log('[Convert] File exists before LOK load:', inputPath, 'size:', stat.size);\n        } catch (e) {\n          console.log('[Convert] File NOT found before LOK load:', inputPath, (e as Error).message);\n        }\n        if (loadOptions) {\n          console.log('[Convert] Using load options:', loadOptions);\n        }\n      }\n\n      // Load the document using LibreOfficeKit\n      if (loadOptions) {\n        docPtr = this.lokBindings.documentLoadWithOptions(inputPath, loadOptions);\n      } else {\n        docPtr = this.lokBindings.documentLoad(inputPath);\n      }\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      this.emitProgress('converting', 60, 'Converting format...');\n\n      // Determine the output format string for LOK\n      const lokFormat = OUTPUT_FORMAT_TO_LOK[options.outputFormat];\n\n      // Get filter options for the format\n      let filterOptions = FORMAT_FILTER_OPTIONS[options.outputFormat] || '';\n\n      // Add PDF-specific options if applicable\n      if (options.outputFormat === 'pdf' && options.pdf) {\n        const pdfOpts: string[] = [];\n        if (options.pdf.pdfaLevel) {\n          const levelMap: Record<string, number> = {\n            'PDF/A-1b': 1,\n            'PDF/A-2b': 2,\n            'PDF/A-3b': 3,\n          };\n          pdfOpts.push(`SelectPdfVersion=${levelMap[options.pdf.pdfaLevel] || 0}`);\n        }\n        if (options.pdf.quality !== undefined) {\n          pdfOpts.push(`Quality=${options.pdf.quality}`);\n        }\n        if (pdfOpts.length > 0) {\n          filterOptions = pdfOpts.join(',');\n        }\n      }\n\n      // Add page selection for image exports (png, jpg, svg)\n      if (['png', 'jpg', 'svg'].includes(options.outputFormat) && options.image?.pageIndex !== undefined) {\n        // PageRange is 1-indexed\n        const pageNum = options.image.pageIndex + 1;\n        if (filterOptions) {\n          filterOptions += `;PageRange=${pageNum}-${pageNum}`;\n        } else {\n          filterOptions = `PageRange=${pageNum}-${pageNum}`;\n        }\n      }\n\n      this.emitProgress('converting', 70, 'Saving document...');\n\n      // Save the document in the new format\n      this.lokBindings.documentSaveAs(docPtr, outputPath, lokFormat, filterOptions);\n\n      this.emitProgress('converting', 90, 'Reading output...');\n\n      // Read the converted output file\n      try {\n        const outputData = this.module.FS.readFile(outputPath) as Uint8Array;\n\n        if (outputData.length === 0) {\n          throw new ConversionError(\n            ConversionErrorCode.CONVERSION_FAILED,\n            'Conversion produced empty output'\n          );\n        }\n\n        return outputData;\n      } catch (fsError) {\n        throw new ConversionError(\n          ConversionErrorCode.CONVERSION_FAILED,\n          `Failed to read converted file: ${String(fsError)}`\n        );\n      }\n    } catch (error) {\n      if (error instanceof ConversionError) {\n        throw error;\n      }\n      throw new ConversionError(\n        ConversionErrorCode.CONVERSION_FAILED,\n        `Conversion failed: ${String(error)}`\n      );\n    } finally {\n      // Always clean up the document\n      if (docPtr !== 0 && this.lokBindings) {\n        try {\n          this.lokBindings.documentDestroy(docPtr);\n        } catch {\n          // Ignore cleanup errors\n        }\n      }\n    }\n  }\n\n  /**\n   * Render page previews (thumbnails) for a document\n   */\n  async renderPagePreviews(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    renderOptions: RenderOptions = {}\n  ): Promise<PagePreview[]> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n    const width = renderOptions.width ?? 256;\n    const height = renderOptions.height ?? 0;\n    const pageIndices = renderOptions.pageIndices ?? [];\n\n    const inputPath = `/tmp/preview/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/preview');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document for preview'\n        );\n      }\n\n      try {\n        const numParts = this.lokBindings.documentGetParts(docPtr);\n        if (this.options.verbose) {\n          console.log(`[Preview] Document has ${numParts} pages/parts`);\n        }\n\n        const pagesToRender =\n          pageIndices.length > 0\n            ? pageIndices.filter((i) => i >= 0 && i < numParts)\n            : Array.from({ length: numParts }, (_, i) => i);\n\n        const results: PagePreview[] = [];\n        const editMode = renderOptions.editMode ?? false;\n\n        for (const pageIndex of pagesToRender) {\n          if (this.options.verbose) {\n            console.log(`[Preview] Rendering page ${pageIndex + 1}/${numParts}`);\n          }\n\n          const preview = this.lokBindings.renderPage(docPtr, pageIndex, width, height, editMode);\n          results.push({\n            page: pageIndex,\n            data: preview.data,\n            width: preview.width,\n            height: preview.height,\n          });\n        }\n\n        return results;\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/preview');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Render a page at full quality (native resolution based on DPI)\n   */\n  async renderPageFullQuality(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    renderOptions: FullQualityRenderOptions = {}\n  ): Promise<FullQualityPagePreview> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n    const dpi = renderOptions.dpi ?? 150;\n    const maxDimension = renderOptions.maxDimension;\n\n    const inputPath = `/tmp/fullquality/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/fullquality');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document for full quality render'\n        );\n      }\n\n      try {\n        const numParts = this.lokBindings.documentGetParts(docPtr);\n        if (pageIndex < 0 || pageIndex >= numParts) {\n          throw new ConversionError(\n            ConversionErrorCode.CONVERSION_FAILED,\n            `Page index ${pageIndex} out of range (0-${numParts - 1})`\n          );\n        }\n\n        if (this.options.verbose) {\n          console.log(`[FullQuality] Rendering page ${pageIndex + 1}/${numParts} at ${dpi} DPI`);\n        }\n\n        const editMode = renderOptions.editMode ?? false;\n        const preview = this.lokBindings.renderPageFullQuality(docPtr, pageIndex, dpi, maxDimension, editMode);\n\n        return {\n          page: pageIndex,\n          data: preview.data,\n          width: preview.width,\n          height: preview.height,\n          dpi: preview.dpi,\n        };\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/fullquality');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Get the number of pages/parts in a document\n   */\n  async getPageCount(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<number> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n\n    const inputPath = `/tmp/pagecount/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/pagecount');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        return this.lokBindings.documentGetParts(docPtr);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/pagecount');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Get valid output formats for a document by loading it and checking its type\n   */\n  async getDocumentInfo(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<DocumentInfo> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n\n    const inputPath = `/tmp/docinfo/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/docinfo');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const docType = this.lokBindings.documentGetDocumentType(docPtr) as LOKDocumentType;\n        const pageCount = this.lokBindings.documentGetParts(docPtr);\n        const validOutputFormats = getOutputFormatsForDocType(docType);\n\n        const docTypeNames: Record<LOKDocumentType, string> = {\n          [LOKDocumentType.TEXT]: 'Text Document',\n          [LOKDocumentType.SPREADSHEET]: 'Spreadsheet',\n          [LOKDocumentType.PRESENTATION]: 'Presentation',\n          [LOKDocumentType.DRAWING]: 'Drawing',\n          [LOKDocumentType.OTHER]: 'Other',\n        };\n\n        return {\n          documentType: docType,\n          documentTypeName: docTypeNames[docType] || 'Unknown',\n          validOutputFormats,\n          pageCount,\n        };\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/docinfo');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  // ============================================\n  // Document Inspection Methods\n  // ============================================\n\n  async getDocumentText(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions\n  ): Promise<string | null> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/inspect/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/inspect');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        return this.lokBindings.getAllText(docPtr);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/inspect');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async getPageNames(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions\n  ): Promise<string[]> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/names/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/names');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const numParts = this.lokBindings.documentGetParts(docPtr);\n        const names: string[] = [];\n\n        for (let i = 0; i < numParts; i++) {\n          const name = this.lokBindings.getPartName(docPtr, i);\n          names.push(name || `Page ${i + 1}`);\n        }\n\n        return names;\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/names');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async getPageRectangles(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions\n  ): Promise<Array<{ x: number; y: number; width: number; height: number }>> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/rects/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/rects');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const rectsStr = this.lokBindings.getPartPageRectangles(docPtr);\n        return this.lokBindings.parsePageRectangles(rectsStr || '');\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/rects');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async getSpreadsheetDataArea(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    sheetIndex: number = 0\n  ): Promise<{ col: number; row: number }> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/dataarea/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/dataarea');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        return this.lokBindings.getDataArea(docPtr, sheetIndex);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/dataarea');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async executeUnoCommand(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    command: string,\n    args: string = '{}'\n  ): Promise<void> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/uno/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/uno');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        this.lokBindings.postUnoCommand(docPtr, command, args);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/uno');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  // ============================================\n  // ILibreOfficeConverter Interface Methods\n  // ============================================\n\n  async renderPage(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    width: number,\n    height = 0\n  ): Promise<PagePreview> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n\n    const inputPath = `/tmp/renderpage/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/renderpage');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const preview = this.lokBindings.renderPage(docPtr, pageIndex, width, height);\n        return {\n          page: pageIndex,\n          data: preview.data,\n          width: preview.width,\n          height: preview.height,\n        };\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/renderpage');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  openDocument(\n    _input: Uint8Array | ArrayBuffer,\n    _options: InputFormatOptions\n  ): Promise<EditorSession> {\n    return Promise.reject(new ConversionError(\n      ConversionErrorCode.CONVERSION_FAILED,\n      'Editor sessions not supported by LibreOfficeConverter. Use WorkerConverter or WorkerBrowserConverter.'\n    ));\n  }\n\n  editorOperation<T = unknown>(\n    _sessionId: string,\n    _method: string,\n    _args?: unknown[]\n  ): Promise<EditorOperationResult<T>> {\n    return Promise.reject(new ConversionError(\n      ConversionErrorCode.CONVERSION_FAILED,\n      'Editor operations not supported by LibreOfficeConverter. Use WorkerConverter or WorkerBrowserConverter.'\n    ));\n  }\n\n  closeDocument(_sessionId: string): Promise<Uint8Array | undefined> {\n    return Promise.reject(new ConversionError(\n      ConversionErrorCode.CONVERSION_FAILED,\n      'Editor sessions not supported by LibreOfficeConverter. Use WorkerConverter or WorkerBrowserConverter.'\n    ));\n  }\n\n  getLokBindings(): typeof this.lokBindings {\n    return this.lokBindings;\n  }\n\n  destroy(): Promise<void> {\n    if (this.lokBindings) {\n      try {\n        this.lokBindings.destroy();\n      } catch {\n        // Ignore cleanup errors\n      }\n      this.lokBindings = null;\n    }\n\n    // Terminate Emscripten pthread workers to allow process to exit\n    if (this.module) {\n      try {\n        const mod = this.module as EmscriptenModuleWithPThread;\n\n        if (mod.PThread?.terminateAllThreads) {\n          mod.PThread.terminateAllThreads();\n        }\n\n        if (mod.PThread?.runningWorkers) {\n          for (const worker of mod.PThread.runningWorkers) {\n            if (worker?.unref) {\n              worker.unref();\n            }\n            if (worker?.terminate) {\n              worker.terminate();\n            }\n          }\n          mod.PThread.runningWorkers = [];\n        }\n\n        if (mod.PThread?.unusedWorkers) {\n          for (const worker of mod.PThread.unusedWorkers) {\n            if (worker?.unref) {\n              worker.unref();\n            }\n            if (worker?.terminate) {\n              worker.terminate();\n            }\n          }\n          mod.PThread.unusedWorkers = [];\n        }\n      } catch {\n        // Ignore pthread cleanup errors\n      }\n    }\n\n    // In Node.js, unref any remaining handles to allow process exit\n    if (typeof process !== 'undefined') {\n      try {\n        const proc = process as unknown as ProcessWithHandles;\n        if (proc._getActiveHandles) {\n          const handles = proc._getActiveHandles();\n          for (const handle of handles) {\n            if (handle?.unref) {\n              const name = handle.constructor?.name ?? '';\n              if (name === 'MessagePort' || (name === 'Socket' && !handle.remoteAddress)) {\n                handle.unref();\n              }\n            }\n          }\n        }\n      } catch {\n        // Ignore\n      }\n    }\n\n    this.module = null;\n    this.initialized = false;\n    return Promise.resolve();\n  }\n\n  isReady(): boolean {\n    return this.initialized;\n  }\n\n  getModule(): EmscriptenModule | null {\n    return this.module;\n  }\n\n  static getSupportedInputFormats(): string[] {\n    return Object.keys(EXTENSION_TO_FORMAT);\n  }\n\n  static getSupportedOutputFormats(): OutputFormat[] {\n    return Object.keys(FORMAT_FILTERS) as OutputFormat[];\n  }\n\n  static getValidOutputFormats(inputFormat: string): OutputFormat[] {\n    return getValidOutputFormats(inputFormat as InputFormat);\n  }\n\n  static isConversionSupported(inputFormat: string, outputFormat: string): boolean {\n    return isConversionValid(inputFormat, outputFormat);\n  }\n\n  // ============================================\n  // Private helper methods\n  // ============================================\n\n  private normalizeInput(input: Uint8Array | ArrayBuffer | Buffer): Uint8Array {\n    if (input instanceof Uint8Array) {\n      return input;\n    }\n    if (input instanceof ArrayBuffer) {\n      return new Uint8Array(input);\n    }\n    return new Uint8Array(input);\n  }\n\n  private getExtensionFromFilename(filename: string): string | null {\n    const parts = filename.split('.');\n    if (parts.length > 1) {\n      return parts.pop()?.toLowerCase() || null;\n    }\n    return null;\n  }\n\n  private getBasename(filename: string): string {\n    const lastDot = filename.lastIndexOf('.');\n    if (lastDot > 0) {\n      return filename.substring(0, lastDot);\n    }\n    return filename;\n  }\n\n  private emitProgress(\n    phase: ProgressInfo['phase'],\n    percent: number,\n    message: string\n  ): void {\n    this.options.onProgress?.({ phase, percent, message });\n  }\n}\n","// src/editor/base.ts\nimport type { LOKBindings } from '../lok-bindings.js';\nimport type { OutputFormat } from '../types.js';\nimport type {\n  OperationResult,\n  DocumentStructure,\n  OpenDocumentOptions,\n  SelectionRange,\n  FindOptions,\n  Position,\n  TruncationInfo,\n  CellRef,\n} from './types.js';\n\n/**\n * Abstract base class for all document editors\n */\nexport abstract class OfficeEditor {\n  protected lok: LOKBindings;\n  protected docPtr: number;\n  protected options: Required<Pick<OpenDocumentOptions, 'maxResponseChars'>> & OpenDocumentOptions;\n  protected inputPath: string = '';\n\n  constructor(lok: LOKBindings, docPtr: number, options: OpenDocumentOptions = {}) {\n    this.lok = lok;\n    this.docPtr = docPtr;\n    this.options = {\n      maxResponseChars: options.maxResponseChars ?? 8000,\n      ...options,\n    };\n  }\n\n  // ============================================\n  // Abstract methods (implemented by subclasses)\n  // ============================================\n\n  abstract getStructure(options?: { maxResponseChars?: number }): OperationResult<DocumentStructure>;\n  abstract getDocumentType(): 'writer' | 'calc' | 'impress' | 'draw';\n\n  // ============================================\n  // Accessor methods\n  // ============================================\n\n  /**\n   * Get the document pointer for low-level LOK operations\n   */\n  getDocPtr(): number {\n    return this.docPtr;\n  }\n\n  /**\n   * Get the LOK bindings for low-level operations\n   */\n  getLokBindings(): LOKBindings {\n    return this.lok;\n  }\n\n  // ============================================\n  // Lifecycle methods\n  // ============================================\n\n  save(): OperationResult<{ path: string }> {\n    try {\n      // Save to the original path\n      if (!this.inputPath) {\n        return this.createErrorResult('No input path set', 'Use saveAs() to specify a path');\n      }\n      // LibreOffice auto-saves on document operations, but we can force it\n      this.lok.postUnoCommand(this.docPtr, '.uno:Save');\n      return this.createResult({ path: this.inputPath });\n    } catch (error) {\n      return this.createErrorResult(`Save failed: ${String(error)}`);\n    }\n  }\n\n  saveAs(path: string, format: OutputFormat): OperationResult<{ path: string }> {\n    try {\n      this.lok.documentSaveAs(this.docPtr, path, format, '');\n      return this.createResult({ path });\n    } catch (error) {\n      return this.createErrorResult(`SaveAs failed: ${String(error)}`);\n    }\n  }\n\n  close(): OperationResult<void> {\n    try {\n      this.lok.documentDestroy(this.docPtr);\n      this.docPtr = 0;\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Close failed: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Get the current edit mode of the document\n   * @returns 0 = view mode, 1 = edit mode\n   */\n  getEditMode(): number {\n    return this.lok.getEditMode(this.docPtr);\n  }\n\n  /**\n   * Attempt to enable edit mode for the document\n   * @returns OperationResult with success and verified fields\n   */\n  enableEditMode(): OperationResult<{ editMode: number }> {\n    try {\n      const beforeMode = this.lok.getEditMode(this.docPtr);\n      if (beforeMode === 1) {\n        // Already in edit mode\n        return this.createResult({ editMode: 1 });\n      }\n\n      // Try .uno:Edit command to switch to edit mode\n      this.lok.postUnoCommand(this.docPtr, '.uno:Edit');\n\n      const afterMode = this.lok.getEditMode(this.docPtr);\n      return {\n        success: true,\n        verified: afterMode === 1,\n        data: { editMode: afterMode },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to enable edit mode: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // History methods\n  // ============================================\n\n  undo(): OperationResult<void> {\n    try {\n      this.lok.postUnoCommand(this.docPtr, '.uno:Undo');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Undo failed: ${String(error)}`);\n    }\n  }\n\n  redo(): OperationResult<void> {\n    try {\n      this.lok.postUnoCommand(this.docPtr, '.uno:Redo');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Redo failed: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Search methods\n  // ============================================\n\n  find(text: string, options?: FindOptions): OperationResult<{ matches: number; firstMatch?: Position }> {\n    try {\n      const searchArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: text },\n        'SearchItem.Backward': { type: 'boolean', value: false },\n        'SearchItem.SearchAll': { type: 'boolean', value: true },\n        'SearchItem.MatchCase': { type: 'boolean', value: options?.caseSensitive ?? false },\n        'SearchItem.WordOnly': { type: 'boolean', value: options?.wholeWord ?? false },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', searchArgs);\n\n      // Get search results - this is approximate as LOK doesn't return match count directly\n      const selection = this.lok.getTextSelection(this.docPtr, 'text/plain');\n      const hasMatch = selection !== null && selection.length > 0;\n\n      return this.createResult({\n        matches: hasMatch ? 1 : 0, // LOK doesn't provide count, we report if found\n        firstMatch: hasMatch ? { x: 0, y: 0 } : undefined,\n      });\n    } catch (error) {\n      return this.createErrorResult(`Find failed: ${String(error)}`);\n    }\n  }\n\n  findAndReplaceAll(find: string, replace: string, options?: FindOptions): OperationResult<{ replacements: number }> {\n    try {\n      const searchArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: find },\n        'SearchItem.ReplaceString': { type: 'string', value: replace },\n        'SearchItem.Command': { type: 'long', value: 3 }, // Replace All\n        'SearchItem.MatchCase': { type: 'boolean', value: options?.caseSensitive ?? false },\n        'SearchItem.WordOnly': { type: 'boolean', value: options?.wholeWord ?? false },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', searchArgs);\n\n      // LOK doesn't return replacement count, we assume success\n      return this.createResult({ replacements: -1 }); // -1 indicates unknown count\n    } catch (error) {\n      return this.createErrorResult(`Replace failed: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Callback-based state retrieval\n  // ============================================\n\n  /**\n   * Poll all STATE_CHANGED callback events and return as a map.\n   *\n   * LOK sends STATE_CHANGED events when formatting state changes (e.g., when\n   * the cursor moves over bold text, `.uno:Bold=true` is emitted).\n   *\n   * Pattern for getting current format state:\n   * 1. clearCallbackQueue() - clear any stale events\n   * 2. Perform action that triggers state change (e.g., SelectWord)\n   * 3. flushCallbacks(docPtr) - force LOK to process callbacks\n   * 4. pollStateChanges() - retrieve the events\n   *\n   * @returns Map of UNO command names to their state values\n   *          e.g., Map { '.uno:Bold' => 'true', '.uno:Italic' => 'false' }\n   */\n  getStateChanges(): OperationResult<Map<string, string>> {\n    try {\n      const states = this.lok.pollStateChanges();\n      return this.createResult(states);\n    } catch (error) {\n      return this.createErrorResult(`Failed to poll state changes: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Flush pending LOK callbacks and then poll for state changes.\n   * Convenience method that combines flushCallbacks + pollStateChanges.\n   *\n   * @returns Map of UNO command names to their state values\n   */\n  flushAndPollState(): OperationResult<Map<string, string>> {\n    try {\n      this.lok.flushCallbacks(this.docPtr);\n      const states = this.lok.pollStateChanges();\n      return this.createResult(states);\n    } catch (error) {\n      return this.createErrorResult(`Failed to flush and poll state: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Clear the callback queue, useful before performing operations\n   * where you want to capture only new state changes.\n   */\n  clearCallbackQueue(): void {\n    this.lok.clearCallbackQueue();\n  }\n\n  // ============================================\n  // Selection methods\n  // ============================================\n\n  select(_selection: SelectionRange): OperationResult<{ selected: string }> {\n    try {\n      // Implementation depends on selection type - subclasses may override\n      // Base implementation just returns current selection\n      const text = this.lok.getTextSelection(this.docPtr, 'text/plain');\n      return this.createResult({ selected: text || '' });\n    } catch (error) {\n      return this.createErrorResult(`Select failed: ${String(error)}`);\n    }\n  }\n\n  getSelection(): OperationResult<{ text: string; range: SelectionRange }> {\n    try {\n      const text = this.lok.getTextSelection(this.docPtr, 'text/plain');\n      return this.createResult({\n        text: text || '',\n        range: { type: 'text', start: { paragraph: 0, character: 0 } },\n      });\n    } catch (error) {\n      return this.createErrorResult(`GetSelection failed: ${String(error)}`);\n    }\n  }\n\n  clearSelection(): OperationResult<void> {\n    try {\n      this.lok.resetSelection(this.docPtr);\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`ClearSelection failed: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Protected helper methods\n  // ============================================\n\n  protected createResult<T>(data: T): OperationResult<T> {\n    return {\n      success: true,\n      verified: true,\n      data,\n    };\n  }\n\n  protected createErrorResult<T>(error: string, suggestion?: string): OperationResult<T> {\n    return {\n      success: false,\n      verified: false,\n      error,\n      suggestion,\n    };\n  }\n\n  protected createResultWithTruncation<T>(data: T, truncation?: TruncationInfo): OperationResult<T> {\n    return {\n      success: true,\n      verified: true,\n      data,\n      truncated: truncation,\n    };\n  }\n\n  protected truncateContent(content: string, maxChars?: number): {\n    content: string;\n    truncated: boolean;\n    original: number;\n    returned: number;\n  } {\n    const limit = maxChars ?? this.options.maxResponseChars;\n    const original = content.length;\n\n    if (original <= limit) {\n      return { content, truncated: false, original, returned: original };\n    }\n\n    // Truncate at a word boundary if possible\n    let truncated = content.slice(0, limit);\n    const lastSpace = truncated.lastIndexOf(' ');\n    if (lastSpace > limit * 0.8) {\n      truncated = truncated.slice(0, lastSpace);\n    }\n\n    return {\n      content: truncated,\n      truncated: true,\n      original,\n      returned: truncated.length,\n    };\n  }\n\n  protected truncateArray<T>(items: T[], maxChars: number, itemToString: (item: T) => string): {\n    items: T[];\n    truncated: boolean;\n    original: number;\n    returned: number;\n  } {\n    const original = items.length;\n    let charCount = 0;\n    let includedCount = 0;\n\n    for (const item of items) {\n      const itemStr = itemToString(item);\n      if (charCount + itemStr.length > maxChars) {\n        break;\n      }\n      charCount += itemStr.length;\n      includedCount++;\n    }\n\n    return {\n      items: items.slice(0, includedCount),\n      truncated: includedCount < original,\n      original,\n      returned: includedCount,\n    };\n  }\n\n  // ============================================\n  // Cell address helpers\n  // ============================================\n\n  protected a1ToRowCol(a1: string): { row: number; col: number } {\n    const match = a1.match(/^([A-Z]+)(\\d+)$/i);\n    if (!match) {\n      throw new Error(`Invalid A1 notation: ${a1}`);\n    }\n\n    const colStr = match[1]!.toUpperCase();\n    const rowStr = match[2]!;\n\n    let col = 0;\n    for (let i = 0; i < colStr.length; i++) {\n      col = col * 26 + (colStr.charCodeAt(i) - 64);\n    }\n    col -= 1; // 0-indexed\n\n    const row = parseInt(rowStr, 10) - 1; // 0-indexed\n\n    return { row, col };\n  }\n\n  protected rowColToA1(row: number, col: number): string {\n    let colStr = '';\n    let c = col + 1; // 1-indexed for conversion\n\n    while (c > 0) {\n      const remainder = (c - 1) % 26;\n      colStr = String.fromCharCode(65 + remainder) + colStr;\n      c = Math.floor((c - 1) / 26);\n    }\n\n    return `${colStr}${row + 1}`;\n  }\n\n  protected normalizeCellRef(ref: CellRef): { row: number; col: number } {\n    if (typeof ref === 'string') {\n      return this.a1ToRowCol(ref);\n    }\n    return ref;\n  }\n\n  // ============================================\n  // Internal state\n  // ============================================\n\n  setInputPath(path: string): void {\n    this.inputPath = path;\n  }\n\n  isOpen(): boolean {\n    return this.docPtr !== 0;\n  }\n}\n","// src/editor/writer.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  WriterStructure,\n  Paragraph,\n  TextPosition,\n  TextRange,\n  TextFormat,\n} from './types.js';\n\n/**\n * Editor for Writer (text) documents\n */\nexport class WriterEditor extends OfficeEditor {\n  private cachedParagraphs: string[] | null = null;\n\n  getDocumentType(): 'writer' {\n    return 'writer';\n  }\n\n  getStructure(options?: { maxResponseChars?: number }): OperationResult<WriterStructure> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n      const maxChars = options?.maxResponseChars ?? this.options.maxResponseChars;\n\n      const paragraphInfos = paragraphs.map((text, index) => ({\n        index,\n        preview: text.slice(0, 100) + (text.length > 100 ? '...' : ''),\n        style: 'Normal', // Would need UNO query to get actual style\n        charCount: text.length,\n      }));\n\n      // Truncate if needed\n      const truncResult = this.truncateArray(\n        paragraphInfos,\n        maxChars,\n        (p) => JSON.stringify(p)\n      );\n\n      const structure: WriterStructure = {\n        type: 'writer',\n        paragraphs: truncResult.items,\n        pageCount: this.lok.documentGetParts(this.docPtr),\n        wordCount: paragraphs.join(' ').split(/\\s+/).filter(w => w.length > 0).length,\n      };\n\n      if (truncResult.truncated) {\n        return this.createResultWithTruncation(structure, {\n          original: truncResult.original,\n          returned: truncResult.returned,\n          message: `Showing ${truncResult.returned} of ${truncResult.original} paragraphs. Use getParagraphs(start, count) to paginate.`,\n        });\n      }\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  getParagraph(index: number): OperationResult<Paragraph> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (index < 0 || index >= paragraphs.length) {\n        return this.createErrorResult(\n          `Paragraph index ${index} out of range (0-${paragraphs.length - 1})`,\n          `Use getStructure() to see available paragraphs`\n        );\n      }\n\n      const text = paragraphs[index]!;\n      return this.createResult({\n        index,\n        text,\n        style: 'Normal',\n        charCount: text.length,\n      });\n    } catch (error) {\n      return this.createErrorResult(`Failed to get paragraph: ${String(error)}`);\n    }\n  }\n\n  getParagraphs(start: number, count: number): OperationResult<Paragraph[]> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (start < 0 || start >= paragraphs.length) {\n        return this.createErrorResult(\n          `Start index ${start} out of range`,\n          `Valid range: 0-${paragraphs.length - 1}`\n        );\n      }\n\n      const end = Math.min(start + count, paragraphs.length);\n      const result = paragraphs.slice(start, end).map((text, i) => ({\n        index: start + i,\n        text,\n        style: 'Normal',\n        charCount: text.length,\n      }));\n\n      return this.createResult(result);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get paragraphs: ${String(error)}`);\n    }\n  }\n\n  insertParagraph(text: string, options?: {\n    afterIndex?: number;\n    style?: 'Normal' | 'Heading 1' | 'Heading 2' | 'Heading 3' | 'List';\n  }): OperationResult<{ index: number }> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n      const insertIndex = options?.afterIndex !== undefined\n        ? options.afterIndex + 1\n        : paragraphs.length;\n\n      // Move to end of target paragraph or document end\n      if (insertIndex > 0 && insertIndex <= paragraphs.length) {\n        // Navigate to position\n        this.lok.postUnoCommand(this.docPtr, '.uno:GoToEndOfDoc');\n      }\n\n      // Insert paragraph break and text\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertPara');\n\n      // Insert the text\n      const textArgs = JSON.stringify({\n        Text: { type: 'string', value: text },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', textArgs);\n\n      // Apply style if specified\n      if (options?.style && options.style !== 'Normal') {\n        const styleMap: Record<string, string> = {\n          'Heading 1': 'Heading 1',\n          'Heading 2': 'Heading 2',\n          'Heading 3': 'Heading 3',\n          'List': 'List',\n        };\n        const styleName = styleMap[options.style];\n        if (styleName) {\n          const styleArgs = JSON.stringify({\n            Template: { type: 'string', value: styleName },\n            Family: { type: 'short', value: 2 }, // Paragraph styles\n          });\n          this.lok.postUnoCommand(this.docPtr, '.uno:StyleApply', styleArgs);\n        }\n      }\n\n      // Invalidate cache\n      this.cachedParagraphs = null;\n\n      // Verify by re-reading\n      const newParagraphs = this.getParagraphsInternal();\n      const verified = newParagraphs.length > paragraphs.length;\n\n      return {\n        success: true,\n        verified,\n        data: { index: insertIndex },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert paragraph: ${String(error)}`);\n    }\n  }\n\n  replaceParagraph(index: number, text: string): OperationResult<{ oldText: string }> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (index < 0 || index >= paragraphs.length) {\n        return this.createErrorResult(\n          `Paragraph index ${index} out of range`,\n          `Valid range: 0-${paragraphs.length - 1}`\n        );\n      }\n\n      const oldText = paragraphs[index]!;\n\n      // Select the paragraph and replace\n      // This is a simplified implementation - full implementation would use cursor positioning\n      const findReplaceArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: oldText },\n        'SearchItem.ReplaceString': { type: 'string', value: text },\n        'SearchItem.Command': { type: 'long', value: 2 }, // Replace\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', findReplaceArgs);\n\n      // Invalidate cache\n      this.cachedParagraphs = null;\n\n      return this.createResult({ oldText });\n    } catch (error) {\n      return this.createErrorResult(`Failed to replace paragraph: ${String(error)}`);\n    }\n  }\n\n  deleteParagraph(index: number): OperationResult<{ deletedText: string }> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (index < 0 || index >= paragraphs.length) {\n        return this.createErrorResult(\n          `Paragraph index ${index} out of range`,\n          `Valid range: 0-${paragraphs.length - 1}`\n        );\n      }\n\n      const deletedText = paragraphs[index]!;\n\n      // Replace with empty string\n      const result = this.replaceParagraph(index, '');\n      if (!result.success) {\n        return this.createErrorResult(result.error || 'Failed to delete');\n      }\n\n      return this.createResult({ deletedText });\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete paragraph: ${String(error)}`);\n    }\n  }\n\n  insertText(text: string, _position: TextPosition): OperationResult<void> {\n    try {\n      // TODO: Navigate to position using cursor before inserting\n      const textArgs = JSON.stringify({\n        Text: { type: 'string', value: text },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', textArgs);\n\n      this.cachedParagraphs = null;\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert text: ${String(error)}`);\n    }\n  }\n\n  deleteText(_start: TextPosition, _end: TextPosition): OperationResult<{ deleted: string }> {\n    try {\n      // TODO: Use start/end to select text range before deleting\n      // Get current selection\n      const selection = this.lok.getTextSelection(this.docPtr, 'text/plain');\n\n      // Delete selection\n      this.lok.postUnoCommand(this.docPtr, '.uno:Delete');\n\n      this.cachedParagraphs = null;\n      return this.createResult({ deleted: selection || '' });\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete text: ${String(error)}`);\n    }\n  }\n\n  replaceText(find: string, replace: string, options?: {\n    paragraph?: number;\n    all?: boolean;\n  }): OperationResult<{ replacements: number }> {\n    try {\n      const command = options?.all ? 3 : 2; // 3 = Replace All, 2 = Replace\n\n      const searchArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: find },\n        'SearchItem.ReplaceString': { type: 'string', value: replace },\n        'SearchItem.Command': { type: 'long', value: command },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', searchArgs);\n\n      this.cachedParagraphs = null;\n\n      // LOK doesn't return count, we indicate success\n      return this.createResult({ replacements: -1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to replace text: ${String(error)}`);\n    }\n  }\n\n  formatText(_range: TextRange, format: TextFormat): OperationResult<void> {\n    try {\n      // TODO: Use range to select text before applying format\n      // Apply formatting commands\n      if (format.bold !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Bold');\n      }\n      if (format.italic !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Italic');\n      }\n      if (format.underline !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Underline');\n      }\n      if (format.fontSize !== undefined) {\n        const args = JSON.stringify({\n          FontHeight: { type: 'float', value: format.fontSize },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:FontHeight', args);\n      }\n      if (format.fontName !== undefined) {\n        const args = JSON.stringify({\n          CharFontName: { type: 'string', value: format.fontName },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:CharFontName', args);\n      }\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to format text: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Get the text formatting at the current selection or cursor position.\n   *\n   * Uses LOK callback mechanism to retrieve STATE_CHANGED events which contain\n   * formatting state like `.uno:Bold=true`, `.uno:Italic=false`, etc.\n   *\n   * @param _position - Text position (currently unused, uses current selection)\n   * @returns TextFormat with bold, italic, underline, fontSize, fontName properties\n   */\n  getFormat(_position?: TextPosition): OperationResult<TextFormat> {\n    try {\n      // Clear any existing callback events\n      this.lok.clearCallbackQueue();\n\n      // Trigger a selection change to get current formatting state\n      // Moving cursor slightly and back triggers STATE_CHANGED callbacks\n      this.lok.postUnoCommand(this.docPtr, '.uno:CharRightSel');\n      this.lok.flushCallbacks(this.docPtr);\n      this.lok.postUnoCommand(this.docPtr, '.uno:CharLeft');\n      this.lok.flushCallbacks(this.docPtr);\n\n      // Poll STATE_CHANGED events to get formatting state\n      const states = this.lok.pollStateChanges();\n\n      // Parse the state values into TextFormat\n      const format: TextFormat = {};\n\n      // Bold: .uno:Bold=true or .uno:Bold=false\n      const boldState = states.get('.uno:Bold');\n      if (boldState !== undefined) {\n        format.bold = boldState === 'true';\n      }\n\n      // Italic: .uno:Italic=true or .uno:Italic=false\n      const italicState = states.get('.uno:Italic');\n      if (italicState !== undefined) {\n        format.italic = italicState === 'true';\n      }\n\n      // Underline: .uno:Underline=true or .uno:Underline=false\n      const underlineState = states.get('.uno:Underline');\n      if (underlineState !== undefined) {\n        format.underline = underlineState === 'true';\n      }\n\n      // Font size: .uno:FontHeight=12\n      const fontSizeState = states.get('.uno:FontHeight');\n      if (fontSizeState !== undefined) {\n        const size = parseFloat(fontSizeState);\n        if (!isNaN(size)) {\n          format.fontSize = size;\n        }\n      }\n\n      // Font name: .uno:CharFontName=Arial\n      const fontNameState = states.get('.uno:CharFontName');\n      if (fontNameState !== undefined && fontNameState.length > 0) {\n        format.fontName = fontNameState;\n      }\n\n      return this.createResult(format);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get format: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Get formatting state for the current selection using the callback mechanism.\n   * This is the preferred way to get character formatting as it uses LOK's\n   * STATE_CHANGED callback events.\n   *\n   * @returns Map of UNO command names to their state values\n   */\n  getSelectionFormat(): OperationResult<Map<string, string>> {\n    try {\n      // Poll any existing STATE_CHANGED events (from previous operations)\n      const existingStates = this.lok.pollStateChanges();\n\n      if (existingStates.size === 0) {\n        // No existing states, trigger a selection to get current format\n        this.lok.clearCallbackQueue();\n        this.lok.postUnoCommand(this.docPtr, '.uno:SelectWord');\n        this.lok.flushCallbacks(this.docPtr);\n        const states = this.lok.pollStateChanges();\n        return this.createResult(states);\n      }\n\n      return this.createResult(existingStates);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get selection format: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private getParagraphsInternal(): string[] {\n    if (this.cachedParagraphs) {\n      return this.cachedParagraphs;\n    }\n\n    const allText = this.lok.getAllText(this.docPtr);\n    if (!allText) {\n      return [];\n    }\n\n    // Split by double newlines (paragraph breaks) or single newlines\n    this.cachedParagraphs = allText\n      .split(/\\n\\n|\\r\\n\\r\\n/)\n      .map(p => p.trim())\n      .filter(p => p.length > 0);\n\n    return this.cachedParagraphs;\n  }\n}\n","// src/editor/calc.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  CalcStructure,\n  CellRef,\n  RangeRef,\n  SheetRef,\n  ColRef,\n  CellData,\n  CellValue,\n  CellFormat,\n  SheetInfo,\n} from './types.js';\n\n/**\n * Editor for Calc (spreadsheet) documents\n */\nexport class CalcEditor extends OfficeEditor {\n  getDocumentType(): 'calc' {\n    return 'calc';\n  }\n\n  getStructure(_options?: { maxResponseChars?: number }): OperationResult<CalcStructure> {\n    try {\n      const numSheets = this.lok.documentGetParts(this.docPtr);\n      const sheets: SheetInfo[] = [];\n\n      for (let i = 0; i < numSheets; i++) {\n        const name = this.lok.getPartName(this.docPtr, i) || `Sheet${i + 1}`;\n        const dataArea = this.lok.getDataArea(this.docPtr, i);\n\n        sheets.push({\n          index: i,\n          name,\n          usedRange: dataArea.col > 0 && dataArea.row > 0\n            ? `A1:${this.rowColToA1(dataArea.row - 1, dataArea.col - 1)}`\n            : 'A1',\n          rowCount: dataArea.row,\n          colCount: dataArea.col,\n        });\n      }\n\n      const structure: CalcStructure = {\n        type: 'calc',\n        sheets,\n      };\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  getSheetNames(): OperationResult<string[]> {\n    try {\n      const numSheets = this.lok.documentGetParts(this.docPtr);\n      const names: string[] = [];\n\n      for (let i = 0; i < numSheets; i++) {\n        const name = this.lok.getPartName(this.docPtr, i) || `Sheet${i + 1}`;\n        names.push(name);\n      }\n\n      return this.createResult(names);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get sheet names: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Cell reading\n  // ============================================\n\n  getCell(cell: CellRef, sheet?: SheetRef): OperationResult<CellData> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      // Navigate to cell\n      this.goToCell(address);\n\n      // Get value\n      const value = this.getCellValueInternal();\n      const formula = this.getCellFormulaInternal();\n\n      return this.createResult({\n        address,\n        value,\n        formula: formula || undefined,\n      });\n    } catch (error) {\n      return this.createErrorResult(`Failed to get cell: ${String(error)}`);\n    }\n  }\n\n  getCells(range: RangeRef, sheet?: SheetRef, options?: {\n    maxResponseChars?: number;\n  }): OperationResult<CellData[][]> {\n    try {\n      this.selectSheet(sheet);\n      const { startRow, startCol, endRow, endCol } = this.normalizeRangeRef(range);\n      const maxChars = options?.maxResponseChars ?? this.options.maxResponseChars;\n\n      const cells: CellData[][] = [];\n      let charCount = 0;\n      let truncated = false;\n\n      for (let r = startRow; r <= endRow && !truncated; r++) {\n        const rowData: CellData[] = [];\n\n        for (let c = startCol; c <= endCol && !truncated; c++) {\n          const address = this.rowColToA1(r, c);\n          this.goToCell(address);\n\n          const value = this.getCellValueInternal();\n          const cellData: CellData = { address, value };\n\n          const cellStr = JSON.stringify(cellData);\n          if (charCount + cellStr.length > maxChars) {\n            truncated = true;\n            break;\n          }\n\n          charCount += cellStr.length;\n          rowData.push(cellData);\n        }\n\n        if (rowData.length > 0) {\n          cells.push(rowData);\n        }\n      }\n\n      if (truncated) {\n        return this.createResultWithTruncation(cells, {\n          original: (endRow - startRow + 1) * (endCol - startCol + 1),\n          returned: cells.reduce((sum, row) => sum + row.length, 0),\n          message: 'Range truncated due to size. Use smaller ranges to paginate.',\n        });\n      }\n\n      return this.createResult(cells);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get cells: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Cell writing\n  // ============================================\n\n  setCellValue(cell: CellRef, value: string | number, sheet?: SheetRef): OperationResult<{\n    oldValue: CellValue;\n    newValue: CellValue;\n  }> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      // Get old value first\n      this.goToCell(address);\n      const oldValue = this.getCellValueInternal();\n\n      // Enter the new value\n      const valueStr = typeof value === 'number' ? value.toString() : value;\n      const args = JSON.stringify({\n        StringName: { type: 'string', value: valueStr },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:EnterString', args);\n\n      // Verify by re-reading the cell\n      const newValue = this.getCellValueInternal();\n      const expectedStr = typeof value === 'number' ? value.toString() : value;\n      const verified = newValue === expectedStr || newValue === value;\n\n      return {\n        success: true,\n        verified,\n        data: { oldValue, newValue },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to set cell value: ${String(error)}`);\n    }\n  }\n\n  setCellFormula(cell: CellRef, formula: string, sheet?: SheetRef): OperationResult<{\n    calculatedValue: CellValue;\n  }> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      // Navigate and enter formula\n      this.goToCell(address);\n\n      const args = JSON.stringify({\n        StringName: { type: 'string', value: formula },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:EnterString', args);\n\n      // Get calculated value\n      const calculatedValue = this.getCellValueInternal();\n\n      return this.createResult({ calculatedValue });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set formula: ${String(error)}`);\n    }\n  }\n\n  setCells(range: RangeRef, values: CellValue[][], sheet?: SheetRef): OperationResult<{\n    cellsUpdated: number;\n  }> {\n    try {\n      this.selectSheet(sheet);\n      const { startRow, startCol } = this.normalizeRangeRef(range);\n      let cellsUpdated = 0;\n\n      for (let r = 0; r < values.length; r++) {\n        const rowValues = values[r];\n        if (!rowValues) continue;\n\n        for (let c = 0; c < rowValues.length; c++) {\n          const value = rowValues[c];\n          if (value === null || value === undefined) continue;\n\n          const address = this.rowColToA1(startRow + r, startCol + c);\n          this.goToCell(address);\n\n          const valueStr = typeof value === 'number' ? value.toString() : String(value);\n          const args = JSON.stringify({\n            StringName: { type: 'string', value: valueStr },\n          });\n          this.lok.postUnoCommand(this.docPtr, '.uno:EnterString', args);\n          cellsUpdated++;\n        }\n      }\n\n      return this.createResult({ cellsUpdated });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set cells: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Clear operations\n  // ============================================\n\n  clearCell(cell: CellRef, sheet?: SheetRef): OperationResult<{ oldValue: CellValue }> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      this.goToCell(address);\n      const oldValue = this.getCellValueInternal();\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ClearContents');\n\n      return this.createResult({ oldValue });\n    } catch (error) {\n      return this.createErrorResult(`Failed to clear cell: ${String(error)}`);\n    }\n  }\n\n  clearRange(range: RangeRef, sheet?: SheetRef): OperationResult<{ cellsCleared: number }> {\n    try {\n      this.selectSheet(sheet);\n      const rangeStr = this.normalizeRangeToString(range);\n\n      // Select range and clear\n      this.goToCell(rangeStr);\n      this.lok.postUnoCommand(this.docPtr, '.uno:ClearContents');\n\n      // Count is approximate\n      const { startRow, startCol, endRow, endCol } = this.normalizeRangeRef(range);\n      const cellsCleared = (endRow - startRow + 1) * (endCol - startCol + 1);\n\n      return this.createResult({ cellsCleared });\n    } catch (error) {\n      return this.createErrorResult(`Failed to clear range: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Row/Column operations\n  // ============================================\n\n  insertRow(afterRow: number, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      this.goToCell(this.rowColToA1(afterRow + 1, 0));\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertRows');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert row: ${String(error)}`);\n    }\n  }\n\n  insertColumn(afterCol: ColRef, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const colNum = typeof afterCol === 'string'\n        ? this.a1ToRowCol(afterCol + '1').col + 1\n        : afterCol + 1;\n\n      this.goToCell(this.rowColToA1(0, colNum));\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertColumns');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert column: ${String(error)}`);\n    }\n  }\n\n  deleteRow(row: number, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      this.goToCell(this.rowColToA1(row, 0));\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeleteRows');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete row: ${String(error)}`);\n    }\n  }\n\n  deleteColumn(col: ColRef, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const colNum = typeof col === 'string'\n        ? this.a1ToRowCol(col + '1').col\n        : col;\n\n      this.goToCell(this.rowColToA1(0, colNum));\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeleteColumns');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete column: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Formatting\n  // ============================================\n\n  formatCells(range: RangeRef, format: CellFormat, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const rangeStr = this.normalizeRangeToString(range);\n      this.goToCell(rangeStr);\n\n      if (format.bold !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Bold');\n      }\n      if (format.numberFormat !== undefined) {\n        const args = JSON.stringify({\n          NumberFormatValue: { type: 'string', value: format.numberFormat },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:NumberFormatValue', args);\n      }\n      if (format.backgroundColor !== undefined) {\n        const args = JSON.stringify({\n          BackgroundColor: { type: 'long', value: this.hexToNumber(format.backgroundColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:BackgroundColor', args);\n      }\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to format cells: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Sheet management\n  // ============================================\n\n  addSheet(name: string): OperationResult<{ index: number }> {\n    try {\n      const args = JSON.stringify({\n        Name: { type: 'string', value: name },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:Insert', args);\n\n      const numSheets = this.lok.documentGetParts(this.docPtr);\n      return this.createResult({ index: numSheets - 1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add sheet: ${String(error)}`);\n    }\n  }\n\n  renameSheet(sheet: SheetRef, newName: string): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const args = JSON.stringify({\n        Name: { type: 'string', value: newName },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:RenameTable', args);\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to rename sheet: ${String(error)}`);\n    }\n  }\n\n  deleteSheet(sheet: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      this.lok.postUnoCommand(this.docPtr, '.uno:Remove');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete sheet: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private selectSheet(sheet?: SheetRef): void {\n    if (sheet === undefined) return;\n\n    const index = typeof sheet === 'number'\n      ? sheet\n      : this.getSheetIndexByName(sheet);\n\n    if (index >= 0) {\n      this.lok.documentSetPart(this.docPtr, index);\n    }\n  }\n\n  private getSheetIndexByName(name: string): number {\n    const numSheets = this.lok.documentGetParts(this.docPtr);\n    for (let i = 0; i < numSheets; i++) {\n      if (this.lok.getPartName(this.docPtr, i) === name) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  private goToCell(address: string): void {\n    const args = JSON.stringify({\n      ToPoint: { type: 'string', value: address },\n    });\n    this.lok.postUnoCommand(this.docPtr, '.uno:GoToCell', args);\n  }\n\n  private getCellValueInternal(): CellValue {\n    const text = this.lok.getTextSelection(this.docPtr, 'text/plain');\n    if (!text) return null;\n\n    // Try to parse as number\n    const num = parseFloat(text);\n    if (!isNaN(num) && text.trim() === num.toString()) {\n      return num;\n    }\n\n    // Check for boolean\n    if (text.toLowerCase() === 'true') return true;\n    if (text.toLowerCase() === 'false') return false;\n\n    return text;\n  }\n\n  private getCellFormulaInternal(): string | null {\n    const result = this.lok.getCommandValues(this.docPtr, '.uno:GetFormulaBarText');\n    if (!result) return null;\n\n    try {\n      const parsed = JSON.parse(result) as { value?: string };\n      return parsed.value ?? null;\n    } catch {\n      return null;\n    }\n  }\n\n  private normalizeRangeRef(range: RangeRef): {\n    startRow: number;\n    startCol: number;\n    endRow: number;\n    endCol: number;\n  } {\n    if (typeof range === 'string') {\n      const parts = range.split(':');\n      const start = this.a1ToRowCol(parts[0]!);\n      const end = parts[1] ? this.a1ToRowCol(parts[1]) : start;\n      return {\n        startRow: start.row,\n        startCol: start.col,\n        endRow: end.row,\n        endCol: end.col,\n      };\n    }\n\n    const start = this.normalizeCellRef(range.start);\n    const end = this.normalizeCellRef(range.end);\n    return {\n      startRow: start.row,\n      startCol: start.col,\n      endRow: end.row,\n      endCol: end.col,\n    };\n  }\n\n  private normalizeRangeToString(range: RangeRef): string {\n    if (typeof range === 'string') return range;\n\n    const start = this.normalizeCellRef(range.start);\n    const end = this.normalizeCellRef(range.end);\n    return `${this.rowColToA1(start.row, start.col)}:${this.rowColToA1(end.row, end.col)}`;\n  }\n\n  private hexToNumber(hex: string): number {\n    return parseInt(hex.replace('#', ''), 16);\n  }\n}\n","// src/editor/impress.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  ImpressStructure,\n  SlideData,\n  SlideInfo,\n  SlideLayout,\n  TextFrame,\n} from './types.js';\n\n/**\n * Editor for Impress (presentation) documents\n */\nexport class ImpressEditor extends OfficeEditor {\n  getDocumentType(): 'impress' {\n    return 'impress';\n  }\n\n  getStructure(_options?: { maxResponseChars?: number }): OperationResult<ImpressStructure> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n      const slides: SlideInfo[] = [];\n\n      for (let i = 0; i < numSlides; i++) {\n        const slideData = this.getSlideInfoInternal(i);\n        slides.push(slideData);\n      }\n\n      const structure: ImpressStructure = {\n        type: 'impress',\n        slides,\n        slideCount: numSlides,\n      };\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide reading\n  // ============================================\n\n  getSlide(index: number): OperationResult<SlideData> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide index: ${index}. Valid range: 0-${numSlides - 1}`,\n          'Use getStructure() to see available slides'\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      const text = this.lok.getAllText(this.docPtr) || '';\n      const textFrames = this.parseTextFrames(text);\n\n      const slideData: SlideData = {\n        index,\n        title: textFrames.find(f => f.type === 'title')?.text,\n        textFrames,\n        hasNotes: false, // Could detect from LOK if available\n      };\n\n      return this.createResult(slideData);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get slide: ${String(error)}`);\n    }\n  }\n\n  getSlideCount(): OperationResult<number> {\n    try {\n      const count = this.lok.documentGetParts(this.docPtr);\n      return this.createResult(count);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get slide count: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide management\n  // ============================================\n\n  addSlide(options?: { afterSlide?: number; layout?: SlideLayout }): OperationResult<{ index: number }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      // Navigate to position if specified\n      if (options?.afterSlide !== undefined) {\n        this.lok.documentSetPart(this.docPtr, options.afterSlide);\n      } else {\n        // Go to last slide\n        this.lok.documentSetPart(this.docPtr, numSlides - 1);\n      }\n\n      // Insert new slide\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertPage');\n\n      // Apply layout if specified\n      if (options?.layout) {\n        this.applySlideLayout(options.layout);\n      }\n\n      const newIndex = options?.afterSlide !== undefined\n        ? options.afterSlide + 1\n        : numSlides;\n\n      // Verify by checking slide count increased\n      const newNumSlides = this.lok.documentGetParts(this.docPtr);\n      const verified = newNumSlides > numSlides;\n\n      return {\n        success: true,\n        verified,\n        data: { index: newIndex },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to add slide: ${String(error)}`);\n    }\n  }\n\n  deleteSlide(index: number): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (numSlides <= 1) {\n        return this.createErrorResult(\n          'Cannot delete the last slide',\n          'A presentation must have at least one slide'\n        );\n      }\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide index: ${index}`,\n          `Valid range: 0-${numSlides - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeletePage');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete slide: ${String(error)}`);\n    }\n  }\n\n  duplicateSlide(index: number): OperationResult<{ newIndex: number }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide index: ${index}`,\n          `Valid range: 0-${numSlides - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DuplicatePage');\n\n      return this.createResult({ newIndex: index + 1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to duplicate slide: ${String(error)}`);\n    }\n  }\n\n  moveSlide(fromIndex: number, toIndex: number): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (fromIndex < 0 || fromIndex >= numSlides || toIndex < 0 || toIndex >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide indices. Valid range: 0-${numSlides - 1}`,\n          'Check slide indices are within bounds'\n        );\n      }\n\n      if (fromIndex === toIndex) {\n        return this.createErrorResult(\n          'Source and destination are the same',\n          'Provide different indices to move'\n        );\n      }\n\n      // LOK doesn't have direct slide move - we simulate via cut/paste\n      this.lok.documentSetPart(this.docPtr, fromIndex);\n\n      const args = JSON.stringify({\n        Position: { type: 'long', value: toIndex },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:MovePageFirst', args);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to move slide: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide content editing\n  // ============================================\n\n  setSlideTitle(index: number, title: string): OperationResult<{ oldTitle?: string }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n\n      // Get current title\n      const text = this.lok.getAllText(this.docPtr) || '';\n      const frames = this.parseTextFrames(text);\n      const oldTitle = frames.find(f => f.type === 'title')?.text;\n\n      // Select title placeholder and replace\n      this.lok.postUnoCommand(this.docPtr, '.uno:SelectAll');\n\n      // Enter title text (this replaces first text frame typically)\n      const args = JSON.stringify({\n        Text: { type: 'string', value: title },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      return this.createResult({ oldTitle });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide title: ${String(error)}`);\n    }\n  }\n\n  setSlideBody(index: number, body: string): OperationResult<{ oldBody?: string }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n\n      // Get current body\n      const text = this.lok.getAllText(this.docPtr) || '';\n      const frames = this.parseTextFrames(text);\n      const oldBody = frames.find(f => f.type === 'body')?.text;\n\n      // Navigate to body and replace\n      // Using Tab to move from title to body placeholder\n      this.lok.postUnoCommand(this.docPtr, '.uno:NextObject');\n\n      const args = JSON.stringify({\n        Text: { type: 'string', value: body },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      return this.createResult({ oldBody });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide body: ${String(error)}`);\n    }\n  }\n\n  setSlideNotes(index: number, notes: string): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n\n      // Switch to notes view and insert text\n      this.lok.postUnoCommand(this.docPtr, '.uno:NotesMode');\n\n      const args = JSON.stringify({\n        Text: { type: 'string', value: notes },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      // Switch back to normal view\n      this.lok.postUnoCommand(this.docPtr, '.uno:NormalViewMode');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide notes: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide layout\n  // ============================================\n\n  setSlideLayout(index: number, layout: SlideLayout): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.applySlideLayout(layout);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide layout: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private getSlideInfoInternal(index: number): SlideInfo {\n    this.lok.documentSetPart(this.docPtr, index);\n\n    const text = this.lok.getAllText(this.docPtr) || '';\n    const frames = this.parseTextFrames(text);\n    const titleFrame = frames.find(f => f.type === 'title');\n\n    return {\n      index,\n      title: titleFrame?.text,\n      layout: this.detectLayout(frames),\n      textFrameCount: frames.length,\n    };\n  }\n\n  private parseTextFrames(text: string): TextFrame[] {\n    // Parse text content into frames\n    // In Impress, text is typically separated by paragraph breaks\n    const paragraphs = text.split(/\\n\\n+/).filter(p => p.trim());\n    const frames: TextFrame[] = [];\n\n    paragraphs.forEach((para, idx) => {\n      const type = idx === 0 ? 'title' : (idx === 1 ? 'body' : 'other');\n      frames.push({\n        index: idx,\n        type: type as TextFrame['type'],\n        text: para.trim(),\n        bounds: { x: 0, y: 0, width: 0, height: 0 }, // Would need LOK API for actual bounds\n      });\n    });\n\n    return frames;\n  }\n\n  private detectLayout(frames: TextFrame[]): SlideLayout {\n    if (frames.length === 0) return 'blank';\n    if (frames.length === 1 && frames[0]?.type === 'title') return 'title';\n    if (frames.length >= 2) return 'titleContent';\n    return 'blank';\n  }\n\n  private applySlideLayout(layout: SlideLayout): void {\n    // Map layout names to LOK layout IDs\n    const layoutMap: Record<SlideLayout, number> = {\n      blank: 0,\n      title: 1,\n      titleContent: 2,\n      twoColumn: 3,\n    };\n\n    const layoutId = layoutMap[layout] ?? 0;\n    const args = JSON.stringify({\n      WhatLayout: { type: 'long', value: layoutId },\n    });\n    this.lok.postUnoCommand(this.docPtr, '.uno:AssignLayout', args);\n  }\n}\n","// src/editor/draw.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  DrawStructure,\n  PageData,\n  PageInfo,\n  ShapeData,\n  ShapeType,\n  Rectangle,\n  Size,\n  Position,\n} from './types.js';\n\n/**\n * Editor for Draw (vector graphics) documents\n * Also handles imported PDFs opened for editing\n */\nexport class DrawEditor extends OfficeEditor {\n  private isImportedPdf: boolean = false;\n\n  getDocumentType(): 'draw' {\n    return 'draw';\n  }\n\n  setImportedPdf(value: boolean): void {\n    this.isImportedPdf = value;\n  }\n\n  getStructure(_options?: { maxResponseChars?: number }): OperationResult<DrawStructure> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n      const pages: PageInfo[] = [];\n\n      for (let i = 0; i < numPages; i++) {\n        const pageInfo = this.getPageInfoInternal(i);\n        pages.push(pageInfo);\n      }\n\n      const structure: DrawStructure = {\n        type: 'draw',\n        pages,\n        pageCount: numPages,\n        isImportedPdf: this.isImportedPdf,\n      };\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Page reading\n  // ============================================\n\n  getPage(index: number): OperationResult<PageData> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numPages) {\n        return this.createErrorResult(\n          `Invalid page index: ${index}. Valid range: 0-${numPages - 1}`,\n          'Use getStructure() to see available pages'\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      const size = this.lok.documentGetDocumentSize(this.docPtr);\n      const shapes = this.getShapesOnPage();\n\n      const pageData: PageData = {\n        index,\n        shapes,\n        size: { width: size.width, height: size.height },\n      };\n\n      return this.createResult(pageData);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get page: ${String(error)}`);\n    }\n  }\n\n  getPageCount(): OperationResult<number> {\n    try {\n      const count = this.lok.documentGetParts(this.docPtr);\n      return this.createResult(count);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get page count: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Page management\n  // ============================================\n\n  addPage(options?: { afterPage?: number }): OperationResult<{ index: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      // Navigate to position\n      if (options?.afterPage !== undefined) {\n        this.lok.documentSetPart(this.docPtr, options.afterPage);\n      } else {\n        this.lok.documentSetPart(this.docPtr, numPages - 1);\n      }\n\n      // Insert new page\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertPage');\n\n      const newIndex = options?.afterPage !== undefined\n        ? options.afterPage + 1\n        : numPages;\n\n      return this.createResult({ index: newIndex });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add page: ${String(error)}`);\n    }\n  }\n\n  deletePage(index: number): OperationResult<void> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (numPages <= 1) {\n        return this.createErrorResult(\n          'Cannot delete the last page',\n          'A drawing document must have at least one page'\n        );\n      }\n\n      if (index < 0 || index >= numPages) {\n        return this.createErrorResult(\n          `Invalid page index: ${index}`,\n          `Valid range: 0-${numPages - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeletePage');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete page: ${String(error)}`);\n    }\n  }\n\n  duplicatePage(index: number): OperationResult<{ newIndex: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numPages) {\n        return this.createErrorResult(\n          `Invalid page index: ${index}`,\n          `Valid range: 0-${numPages - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DuplicatePage');\n\n      return this.createResult({ newIndex: index + 1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to duplicate page: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Shape operations\n  // ============================================\n\n  addShape(\n    pageIndex: number,\n    shapeType: ShapeType,\n    bounds: Rectangle,\n    options?: { text?: string; fillColor?: string; lineColor?: string }\n  ): OperationResult<{ shapeIndex: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (pageIndex < 0 || pageIndex >= numPages) {\n        return this.createErrorResult(`Invalid page index: ${pageIndex}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n\n      // Map shape type to UNO command\n      const shapeCommand = this.getShapeCommand(shapeType);\n\n      // Set shape bounds\n      const boundsArgs = JSON.stringify({\n        X: { type: 'long', value: bounds.x },\n        Y: { type: 'long', value: bounds.y },\n        Width: { type: 'long', value: bounds.width },\n        Height: { type: 'long', value: bounds.height },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, shapeCommand, boundsArgs);\n\n      // Set optional properties\n      if (options?.text) {\n        const textArgs = JSON.stringify({\n          Text: { type: 'string', value: options.text },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', textArgs);\n      }\n\n      if (options?.fillColor) {\n        const colorArgs = JSON.stringify({\n          FillColor: { type: 'long', value: this.hexToNumber(options.fillColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:FillColor', colorArgs);\n      }\n\n      if (options?.lineColor) {\n        const colorArgs = JSON.stringify({\n          LineColor: { type: 'long', value: this.hexToNumber(options.lineColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:XLineColor', colorArgs);\n      }\n\n      // Return approximate index (would need LOK API to get actual)\n      return this.createResult({ shapeIndex: 0 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add shape: ${String(error)}`);\n    }\n  }\n\n  addLine(\n    pageIndex: number,\n    start: Position,\n    end: Position,\n    options?: { lineColor?: string; lineWidth?: number }\n  ): OperationResult<{ shapeIndex: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (pageIndex < 0 || pageIndex >= numPages) {\n        return this.createErrorResult(`Invalid page index: ${pageIndex}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n\n      const args = JSON.stringify({\n        StartX: { type: 'long', value: start.x },\n        StartY: { type: 'long', value: start.y },\n        EndX: { type: 'long', value: end.x },\n        EndY: { type: 'long', value: end.y },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:Line', args);\n\n      if (options?.lineColor) {\n        const colorArgs = JSON.stringify({\n          LineColor: { type: 'long', value: this.hexToNumber(options.lineColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:XLineColor', colorArgs);\n      }\n\n      if (options?.lineWidth) {\n        const widthArgs = JSON.stringify({\n          LineWidth: { type: 'long', value: options.lineWidth },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:LineWidth', widthArgs);\n      }\n\n      return this.createResult({ shapeIndex: 0 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add line: ${String(error)}`);\n    }\n  }\n\n  deleteShape(pageIndex: number, shapeIndex: number): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n\n      // Select shape by index (simplified - real impl would use object selection)\n      this.selectShape(shapeIndex);\n      this.lok.postUnoCommand(this.docPtr, '.uno:Delete');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete shape: ${String(error)}`);\n    }\n  }\n\n  setShapeText(pageIndex: number, shapeIndex: number, text: string): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n      this.selectShape(shapeIndex);\n\n      // Enter edit mode for the shape\n      this.lok.postUnoCommand(this.docPtr, '.uno:EnterGroup');\n\n      // Replace text\n      this.lok.postUnoCommand(this.docPtr, '.uno:SelectAll');\n      const args = JSON.stringify({\n        Text: { type: 'string', value: text },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      // Exit edit mode\n      this.lok.postUnoCommand(this.docPtr, '.uno:LeaveGroup');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to set shape text: ${String(error)}`);\n    }\n  }\n\n  moveShape(pageIndex: number, shapeIndex: number, newPosition: Position): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n      this.selectShape(shapeIndex);\n\n      const args = JSON.stringify({\n        X: { type: 'long', value: newPosition.x },\n        Y: { type: 'long', value: newPosition.y },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:SetObjectPosition', args);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to move shape: ${String(error)}`);\n    }\n  }\n\n  resizeShape(pageIndex: number, shapeIndex: number, newSize: Size): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n      this.selectShape(shapeIndex);\n\n      const args = JSON.stringify({\n        Width: { type: 'long', value: newSize.width },\n        Height: { type: 'long', value: newSize.height },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:Size', args);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to resize shape: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private getPageInfoInternal(index: number): PageInfo {\n    this.lok.documentSetPart(this.docPtr, index);\n    const size = this.lok.documentGetDocumentSize(this.docPtr);\n    const shapes = this.getShapesOnPage();\n\n    return {\n      index,\n      shapeCount: shapes.length,\n      size: { width: size.width, height: size.height },\n    };\n  }\n\n  private getShapesOnPage(): ShapeData[] {\n    // In a real implementation, we'd enumerate shapes via LOK\n    // For now, we parse text content as a simple proxy\n    const text = this.lok.getAllText(this.docPtr) || '';\n\n    if (!text.trim()) {\n      return [];\n    }\n\n    // Return a single text shape if there's content\n    return [{\n      index: 0,\n      type: 'text',\n      text,\n      bounds: { x: 0, y: 0, width: 0, height: 0 },\n    }];\n  }\n\n  private selectShape(shapeIndex: number): void {\n    // Navigate to shape - simplified implementation\n    // Real implementation would use object enumeration\n    const args = JSON.stringify({\n      Index: { type: 'long', value: shapeIndex },\n    });\n    this.lok.postUnoCommand(this.docPtr, '.uno:SelectObject', args);\n  }\n\n  private getShapeCommand(shapeType: ShapeType): string {\n    const commands: Record<ShapeType, string> = {\n      rectangle: '.uno:Rect',\n      ellipse: '.uno:Ellipse',\n      line: '.uno:Line',\n      text: '.uno:Text',\n      image: '.uno:InsertGraphic',\n      group: '.uno:FormatGroup',\n      other: '.uno:Rect', // Default to rectangle\n    };\n    return commands[shapeType];\n  }\n\n  private hexToNumber(hex: string): number {\n    return parseInt(hex.replace('#', ''), 16);\n  }\n}\n","// src/editor/index.ts\nimport type { LOKBindings } from '../lok-bindings.js';\nimport { OfficeEditor } from './base.js';\nimport { WriterEditor } from './writer.js';\nimport { CalcEditor } from './calc.js';\nimport { ImpressEditor } from './impress.js';\nimport { DrawEditor } from './draw.js';\nimport type { OpenDocumentOptions } from './types.js';\n\n// LOK document type constants (from LibreOfficeKit)\nconst LOK_DOCTYPE_TEXT = 0;\nconst LOK_DOCTYPE_SPREADSHEET = 1;\nconst LOK_DOCTYPE_PRESENTATION = 2;\nconst LOK_DOCTYPE_DRAWING = 3;\n\n/**\n * Factory function to create the appropriate editor based on document type\n *\n * @param lok - LibreOfficeKit bindings instance\n * @param docPtr - Document pointer from lok.documentLoad()\n * @param options - Editor options (maxResponseChars, etc.)\n * @returns Typed editor instance (WriterEditor, CalcEditor, ImpressEditor, or DrawEditor)\n * @throws Error if document type is unsupported\n *\n * @example\n * ```typescript\n * const docPtr = lok.documentLoad('/tmp/document.docx');\n * const editor = createEditor(lok, docPtr);\n *\n * if (isWriterEditor(editor)) {\n *   // TypeScript knows editor has WriterEditor methods\n *   const result = editor.insertParagraph('Hello World');\n * }\n * ```\n */\nexport function createEditor(\n  lok: LOKBindings,\n  docPtr: number,\n  options?: OpenDocumentOptions\n): OfficeEditor {\n  const docType = lok.documentGetDocumentType(docPtr);\n\n  switch (docType) {\n    case LOK_DOCTYPE_TEXT:\n      return new WriterEditor(lok, docPtr, options);\n\n    case LOK_DOCTYPE_SPREADSHEET:\n      return new CalcEditor(lok, docPtr, options);\n\n    case LOK_DOCTYPE_PRESENTATION:\n      return new ImpressEditor(lok, docPtr, options);\n\n    case LOK_DOCTYPE_DRAWING:\n      return new DrawEditor(lok, docPtr, options);\n\n    default:\n      throw new Error(`Unsupported document type: ${docType}`);\n  }\n}\n\n// ============================================\n// Type Guards\n// ============================================\n\n/**\n * Type guard for WriterEditor\n */\nexport function isWriterEditor(editor: OfficeEditor): editor is WriterEditor {\n  return editor.getDocumentType() === 'writer';\n}\n\n/**\n * Type guard for CalcEditor\n */\nexport function isCalcEditor(editor: OfficeEditor): editor is CalcEditor {\n  return editor.getDocumentType() === 'calc';\n}\n\n/**\n * Type guard for ImpressEditor\n */\nexport function isImpressEditor(editor: OfficeEditor): editor is ImpressEditor {\n  return editor.getDocumentType() === 'impress';\n}\n\n/**\n * Type guard for DrawEditor\n */\nexport function isDrawEditor(editor: OfficeEditor): editor is DrawEditor {\n  return editor.getDocumentType() === 'draw';\n}\n\n// ============================================\n// Re-exports\n// ============================================\n\n// Export all types\nexport type {\n  OperationResult,\n  TruncationInfo,\n  OpenDocumentOptions,\n  TextPosition,\n  TextRange,\n  TextFormat,\n  Paragraph,\n  WriterStructure,\n  CellRef,\n  RangeRef,\n  ColRef,\n  SheetRef,\n  CellValue,\n  CellData,\n  CellFormat,\n  SheetInfo,\n  CalcStructure,\n  SlideLayout,\n  TextFrame,\n  SlideData,\n  SlideInfo,\n  ImpressStructure,\n  ShapeType,\n  ShapeData,\n  PageData,\n  PageInfo,\n  DrawStructure,\n  Rectangle,\n  Size,\n  Position,\n  DocumentMetadata,\n  DocumentStructure,\n  DocumentType,\n  SelectionRange,\n  FindOptions,\n} from './types.js';\n\n// Export all editor classes\nexport { OfficeEditor } from './base.js';\nexport { WriterEditor } from './writer.js';\nexport { CalcEditor } from './calc.js';\nexport { ImpressEditor } from './impress.js';\nexport { DrawEditor } from './draw.js';\n\n// Export LLM tool definitions\nexport {\n  // Tool collections\n  allTools,\n  toolsByName,\n  commonTools,\n  writerTools,\n  calcTools,\n  impressTools,\n  drawTools,\n  documentTools,\n  // Utility functions\n  getToolsForDocumentType,\n  toOpenAIFunction,\n  toAnthropicTool,\n  getOpenAIFunctions,\n  getAnthropicTools,\n} from './tools.js';\n\nexport type {\n  ToolDefinition,\n  CommonToolName,\n  WriterToolName,\n  CalcToolName,\n  ImpressToolName,\n  DrawToolName,\n  DocumentToolName,\n  AllToolName,\n  ToolParameters,\n} from './tools.js';\n","/**\n * Subprocess Worker for LibreOffice WASM\n *\n * This worker runs in a completely separate Node.js process and owns the\n * entire LibreOffice WASM module. It communicates with the main process\n * via IPC message passing.\n *\n * Uses LibreOfficeConverter directly for all operations - same implementation\n * as the main thread and worker thread converters.\n */\n\nimport * as path from 'path';\nimport * as fs from 'fs';\nimport { Worker } from 'worker_threads';\n\nconst wasmPath = process.env.WASM_PATH || './wasm';\nconst verbose = process.env.VERBOSE === 'true';\n\n// WASM_PATH from parent should already be absolute - only resolve if relative\n// This prevents double-pathing issues (e.g., /wasm/wasm) when CWD is already the wasm dir\nconst wasmDir = path.isAbsolute(wasmPath) ? wasmPath : path.resolve(wasmPath);\n\n// Verify the wasm directory exists before attempting to chdir\nif (!fs.existsSync(wasmDir)) {\n  const error = new Error(\n    `WASM directory not found: ${wasmDir}\\n` +\n    `  WASM_PATH env: ${process.env.WASM_PATH || '(not set)'}\\n` +\n    `  CWD: ${process.cwd()}\\n` +\n    `  Resolved to: ${wasmDir}`\n  );\n  console.error('[SubprocessWorker]', error.message);\n  process.send?.({ type: 'error', error: error.message });\n  process.exit(1);\n}\n\n// Change to wasm directory for soffice.data path resolution\nprocess.chdir(wasmDir);\n\nfunction log(...args: unknown[]) {\n  if (verbose) console.error('[SubprocessWorker]', ...args);\n}\n\n// XMLHttpRequest polyfill for Emscripten\nclass NodeXHR {\n  readyState = 0;\n  status = 0;\n  responseType = '';\n  response: unknown = null;\n  responseText = '';\n  onload: (() => void) | null = null;\n  onerror: ((err: Error) => void) | null = null;\n  onreadystatechange: (() => void) | null = null;\n  private _url = '';\n\n  open(_method: string, url: string) {\n    this._url = url;\n    this.readyState = 1;\n  }\n\n  overrideMimeType() { }\n  setRequestHeader() { }\n\n  send() {\n    try {\n      const data = fs.readFileSync(this._url);\n      this.status = 200;\n      this.readyState = 4;\n      if (this.responseType === 'arraybuffer') {\n        this.response = data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n      } else {\n        this.responseText = data.toString('utf8');\n        this.response = this.responseText;\n      }\n      if (this.onload) this.onload();\n      if (this.onreadystatechange) this.onreadystatechange();\n    } catch (err) {\n      this.status = 404;\n      this.readyState = 4;\n      if (this.onerror) this.onerror(err as Error);\n    }\n  }\n}\n\n// Set up global polyfills\n(global as any).XMLHttpRequest = NodeXHR;\n(global as any).Worker = Worker;\n\n// Import converter and editor - these will be bundled by tsup\nimport { LibreOfficeConverter } from './converter-node.js';\nimport { createEditor, OfficeEditor } from './editor/index.js';\nimport type { ConversionOptions, InputFormatOptions, WasmLoaderModule } from './types.js';\nimport { buildLoadOptions } from './types.js';\nimport type { OperationResult } from './editor/types.js';\n\n// Import the WASM loader - path is relative to dist/ after build\n// eslint-disable-next-line @typescript-eslint/no-var-requires\nconst wasmLoader = require('../wasm/loader.cjs') as WasmLoaderModule;\n\n// Converter state\nlet converter: LibreOfficeConverter | null = null;\n\n// Editor session tracking\ninterface EditorSession {\n  sessionId: string;\n  docPtr: number;\n  filePath: string;\n  editor: OfficeEditor;\n  documentType: string;\n}\n\nconst editorSessions = new Map<string, EditorSession>();\nlet sessionCounter = 0;\n\nfunction getRecentOutput(): string {\n  return ''; // Reserved for future error capture\n}\n\n// Message payload types\ninterface ConvertPayload {\n  inputData: number[];\n  inputExt: string;\n  outputFormat: string;\n  filterOptions: string;\n}\n\ninterface DocumentPayload {\n  inputData: number[];\n  inputFormat: string;\n}\n\ninterface RenderPagePayload {\n  inputData: number[];\n  inputFormat: string;\n  pageIndex: number;\n  width: number;\n  height?: number;\n}\n\ninterface RenderPagePreviewsPayload {\n  inputData: number[];\n  inputFormat: string;\n  width: number;\n  height?: number;\n  pageIndices?: number[];\n}\n\ninterface RenderPageFullQualityPayload {\n  inputData: number[];\n  inputFormat: string;\n  pageIndex: number;\n  dpi: number;\n  maxDimension?: number;\n  editMode?: boolean;\n}\n\ninterface OpenDocumentPayload {\n  inputData: number[];\n  inputFormat: string;\n}\n\ninterface EditorOperationPayload {\n  sessionId: string;\n  method: string;\n  args?: unknown[];\n}\n\ninterface CloseDocumentPayload {\n  sessionId: string;\n}\n\ninterface WorkerMessage {\n  type: string;\n  id: string;\n  payload?: unknown;\n}\n\n/**\n * Handle convert request\n */\nasync function handleConvert(payload: ConvertPayload): Promise<number[]> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  const result = await converter.convert(\n    inputData,\n    {\n      inputFormat: payload.inputExt,\n      outputFormat: payload.outputFormat,\n    } as ConversionOptions,\n    'document'\n  );\n\n  return Array.from(result.data);\n}\n\n/**\n * Handle getPageCount request\n */\nasync function handleGetPageCount(payload: DocumentPayload): Promise<number> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  return converter.getPageCount(inputData, {\n    inputFormat: payload.inputFormat,\n    outputFormat: 'pdf',\n  } as ConversionOptions);\n}\n\n/**\n * Handle getDocumentInfo request\n */\nasync function handleGetDocumentInfo(payload: DocumentPayload): Promise<unknown> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  return converter.getDocumentInfo(inputData, {\n    inputFormat: payload.inputFormat,\n    outputFormat: 'pdf',\n  } as ConversionOptions);\n}\n\n/**\n * Handle renderPage request\n */\nasync function handleRenderPage(payload: RenderPagePayload): Promise<{\n  data: number[];\n  width: number;\n  height: number;\n}> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  const previews = await converter.renderPagePreviews(\n    inputData,\n    { inputFormat: payload.inputFormat as InputFormatOptions['inputFormat'] },\n    {\n      width: payload.width,\n      height: payload.height || 0,\n      pageIndices: [payload.pageIndex],\n    }\n  );\n\n  if (previews.length === 0) {\n    throw new Error(`Page ${payload.pageIndex} not found`);\n  }\n\n  const preview = previews[0]!;\n  return {\n    data: Array.from(preview.data),\n    width: preview.width,\n    height: preview.height,\n  };\n}\n\n/**\n * Handle renderPagePreviews request\n */\nasync function handleRenderPagePreviews(payload: RenderPagePreviewsPayload): Promise<Array<{\n  page: number;\n  data: number[];\n  width: number;\n  height: number;\n}>> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  const previews = await converter.renderPagePreviews(\n    inputData,\n    { inputFormat: payload.inputFormat as InputFormatOptions['inputFormat'] },\n    {\n      width: payload.width,\n      height: payload.height || 0,\n      pageIndices: payload.pageIndices,\n    }\n  );\n\n  return previews.map((preview: { page: number; data: Uint8Array; width: number; height: number }) => ({\n    page: preview.page,\n    data: Array.from(preview.data),\n    width: preview.width,\n    height: preview.height,\n  }));\n}\n\n/**\n * Handle renderPageFullQuality request\n */\nasync function handleRenderPageFullQuality(payload: RenderPageFullQualityPayload): Promise<{\n  page: number;\n  data: number[];\n  width: number;\n  height: number;\n  dpi: number;\n}> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  const preview = await converter.renderPageFullQuality(\n    inputData,\n    { inputFormat: payload.inputFormat as InputFormatOptions['inputFormat'] },\n    payload.pageIndex,\n    {\n      dpi: payload.dpi,\n      maxDimension: payload.maxDimension,\n      editMode: payload.editMode ?? false,\n    }\n  );\n\n  return {\n    page: preview.page,\n    data: Array.from(preview.data),\n    width: preview.width,\n    height: preview.height,\n    dpi: preview.dpi,\n  };\n}\n\n/**\n * Handle getDocumentText request\n */\nasync function handleGetDocumentText(payload: DocumentPayload): Promise<string | null> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  return converter.getDocumentText(inputData, {\n    inputFormat: payload.inputFormat,\n    outputFormat: 'pdf',\n  } as ConversionOptions);\n}\n\n/**\n * Handle getPageNames request\n */\nasync function handleGetPageNames(payload: DocumentPayload): Promise<string[]> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const inputData = new Uint8Array(payload.inputData);\n  return converter.getPageNames(inputData, {\n    inputFormat: payload.inputFormat,\n    outputFormat: 'pdf',\n  } as ConversionOptions);\n}\n\n/**\n * Handle openDocument request - opens document for editing\n */\nasync function handleOpenDocument(payload: OpenDocumentPayload): Promise<{\n  sessionId: string;\n  documentType: string;\n  pageCount: number;\n}> {\n  if (!converter?.isReady()) {\n    throw new Error('Worker not initialized');\n  }\n\n  const lokBindings = converter.getLokBindings();\n  const module = converter.getModule();\n\n  if (!lokBindings || !module) {\n    throw new Error('LOK bindings not available');\n  }\n\n  // Generate unique session ID\n  const sessionId = `session_${++sessionCounter}_${Date.now()}`;\n  const filePath = `/tmp/edit_${sessionId}.${payload.inputFormat}`;\n\n  // Write file to virtual FS\n  const inputData = new Uint8Array(payload.inputData);\n  module.FS.writeFile(filePath, inputData);\n\n  // Load document (with CSV import filter options if needed)\n  const loadOptions = buildLoadOptions(payload.inputFormat);\n  let docPtr: number;\n  if (loadOptions) {\n    docPtr = lokBindings.documentLoadWithOptions(filePath, loadOptions);\n  } else {\n    docPtr = lokBindings.documentLoad(filePath);\n  }\n  if (docPtr === 0) {\n    const error = lokBindings.getError();\n    module.FS.unlink(filePath);\n    throw new Error(`Failed to load document: ${String(error)}`);\n  }\n\n  // Initialize for rendering/editing\n  lokBindings.documentInitializeForRendering(docPtr);\n\n  // Create a view and register callback\n  const viewId = lokBindings.createView(docPtr);\n  lokBindings.setView(docPtr, viewId);\n  lokBindings.registerCallback(docPtr);\n\n  // Enable edit mode\n  lokBindings.postUnoCommand(docPtr, '.uno:Edit');\n\n  // Create the appropriate editor using factory\n  const editor = createEditor(lokBindings, docPtr);\n  const documentType = editor.getDocumentType();\n\n  // Get page count\n  const pageCount = lokBindings.documentGetParts(docPtr);\n\n  // Store session\n  editorSessions.set(sessionId, {\n    sessionId,\n    docPtr,\n    filePath,\n    editor,\n    documentType,\n  });\n\n  return {\n    sessionId,\n    documentType,\n    pageCount,\n  };\n}\n\n/**\n * Handle editorOperation request\n */\nasync function handleEditorOperation(payload: EditorOperationPayload): Promise<OperationResult<unknown>> {\n  const session = editorSessions.get(payload.sessionId);\n  if (!session) {\n    throw new Error(`Session not found: ${payload.sessionId}`);\n  }\n\n  const { editor } = session;\n  const args = payload.args || [];\n\n  // Call the method on the editor\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const method = (editor as any)[payload.method];\n  if (typeof method !== 'function') {\n    throw new Error(`Unknown editor method: ${payload.method}`);\n  }\n\n  // Execute the method\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const result = method.apply(editor, args) as OperationResult<any>;\n\n  // Convert Map to object for serialization if needed\n  let serializedData = result.data;\n  if (result.data instanceof Map) {\n    serializedData = Object.fromEntries(result.data);\n  }\n\n  return {\n    success: result.success,\n    verified: result.verified,\n    data: serializedData,\n    error: result.error,\n    suggestion: result.suggestion,\n  };\n}\n\n/**\n * Handle closeDocument request\n */\nasync function handleCloseDocument(payload: CloseDocumentPayload): Promise<number[] | undefined> {\n  const session = editorSessions.get(payload.sessionId);\n  if (!session) {\n    throw new Error(`Session not found: ${payload.sessionId}`);\n  }\n\n  const lokBindings = converter?.getLokBindings();\n  const module = converter?.getModule();\n  const { docPtr, filePath } = session;\n\n  // Get the modified document data before closing\n  let modifiedData: number[] | undefined;\n  if (module && lokBindings) {\n    try {\n      // Save to original path first\n      const ext = filePath.split('.').pop() || 'docx';\n      lokBindings.documentSaveAs(docPtr, filePath, ext, '');\n      const data = module.FS.readFile(filePath) as Uint8Array;\n      modifiedData = Array.from(data);\n    } catch (e) {\n      console.warn('[Worker] Could not save document:', e);\n    }\n  }\n\n  // Cleanup\n  if (lokBindings && docPtr !== 0) {\n    try { lokBindings.unregisterCallback(docPtr); } catch { /* ignore */ }\n    try { lokBindings.documentDestroy(docPtr); } catch { /* ignore */ }\n  }\n  if (module) {\n    try { module.FS.unlink(filePath); } catch { /* ignore */ }\n  }\n\n  // Remove session\n  editorSessions.delete(payload.sessionId);\n\n  return modifiedData;\n}\n\n/**\n * Handle destroy request\n */\nasync function handleDestroy(): Promise<void> {\n  // Close all editor sessions first\n  for (const [, session] of editorSessions) {\n    try {\n      const lokBindings = converter?.getLokBindings();\n      const module = converter?.getModule();\n      if (lokBindings && session.docPtr !== 0) {\n        try { lokBindings.unregisterCallback(session.docPtr); } catch { /* ignore */ }\n        try { lokBindings.documentDestroy(session.docPtr); } catch { /* ignore */ }\n      }\n      if (module) {\n        try { module.FS.unlink(session.filePath); } catch { /* ignore */ }\n      }\n    } catch { /* ignore */ }\n  }\n  editorSessions.clear();\n\n  if (converter) {\n    await converter.destroy();\n    converter = null;\n  }\n\n  // Exit the process after cleanup - use setImmediate to allow response to be sent first\n  log('Destroy complete, exiting process');\n  setImmediate(() => process.exit(0));\n}\n\n/**\n * Handle init message - initialize the converter\n */\nasync function handleInit(): Promise<void> {\n  if (converter?.isReady()) {\n    return;\n  }\n\n  log('Creating LibreOfficeConverter...');\n  converter = new LibreOfficeConverter({\n    wasmPath: wasmDir,\n    verbose,\n    wasmLoader,\n  });\n\n  log('Initializing converter...');\n  await converter.initialize();\n  log('Converter initialized successfully');\n}\n\n// Handle incoming messages\nprocess.on('message', async (msg: WorkerMessage) => {\n  try {\n    let result: unknown;\n\n    switch (msg.type) {\n      case 'init':\n        await handleInit();\n        break;\n\n      case 'convert':\n        result = await handleConvert(msg.payload as ConvertPayload);\n        break;\n\n      case 'getPageCount':\n        result = await handleGetPageCount(msg.payload as DocumentPayload);\n        break;\n\n      case 'getDocumentInfo':\n        result = await handleGetDocumentInfo(msg.payload as DocumentPayload);\n        break;\n\n      case 'renderPage':\n        result = await handleRenderPage(msg.payload as RenderPagePayload);\n        break;\n\n      case 'renderPagePreviews':\n        result = await handleRenderPagePreviews(msg.payload as RenderPagePreviewsPayload);\n        break;\n\n      case 'renderPageFullQuality':\n        result = await handleRenderPageFullQuality(msg.payload as RenderPageFullQualityPayload);\n        break;\n\n      case 'getDocumentText':\n        result = await handleGetDocumentText(msg.payload as DocumentPayload);\n        break;\n\n      case 'getPageNames':\n        result = await handleGetPageNames(msg.payload as DocumentPayload);\n        break;\n\n      case 'openDocument':\n        result = await handleOpenDocument(msg.payload as OpenDocumentPayload);\n        break;\n\n      case 'editorOperation':\n        result = await handleEditorOperation(msg.payload as EditorOperationPayload);\n        break;\n\n      case 'closeDocument':\n        result = await handleCloseDocument(msg.payload as CloseDocumentPayload);\n        break;\n\n      case 'destroy':\n        await handleDestroy();\n        break;\n\n      default:\n        throw new Error(`Unknown message type: ${msg.type}`);\n    }\n\n    process.send?.({ type: 'response', id: msg.id, success: true, data: result });\n  } catch (err) {\n    const errorMsg = (err as Error).message;\n    log('Error:', errorMsg);\n    const recentOutput = getRecentOutput();\n    const fullError = recentOutput ? `${errorMsg}\\n\\nRecent LibreOffice output:\\n${recentOutput}` : errorMsg;\n    process.send?.({ type: 'response', id: msg.id, success: false, error: fullError });\n  }\n});\n\nlog('Subprocess worker started, waiting for init message...');\n\n// Signal that we're ready to receive init\nprocess.send?.({ type: 'ready' });\n\n// Keep process alive\nsetInterval(() => { }, 60000);\n"]}