{"version":3,"sources":["../src/types.ts","../src/lok-bindings.ts","../src/converter-node.ts","../src/node.worker-converter.ts","../src/subprocess.worker-converter.ts","../src/image-utils.ts","../src/editor/base.ts","../src/editor/writer.ts","../src/editor/calc.ts","../src/editor/impress.ts","../src/editor/draw.ts","../src/editor/tools.ts","../src/editor/index.ts","../src/index.ts"],"names":["ConversionErrorCode","LOKDocumentType","errPtr","resolve","emFs","dirname","fileURLToPath","join","existsSync","Worker","randomUUID","fork","deflateSync","start","end","z","LOK_DOCTYPE_TEXT","LOK_DOCTYPE_SPREADSHEET","LOK_DOCTYPE_PRESENTATION","LOK_DOCTYPE_DRAWING","converter"],"mappings":";;;;;;;;;;;;;AAyTO,IAAM,qBAAA,GAAwB;AAyB9B,SAAS,eAAA,CAAgB,UAAkB,qBAAA,EAAyC;AAEzF,EAAA,MAAM,OAAO,OAAA,CAAQ,QAAA,CAAS,GAAG,CAAA,GAAI,OAAA,GAAU,GAAG,OAAO,CAAA,CAAA,CAAA;AACzD,EAAA,OAAO;AAAA,IACL,SAAA,EAAW,GAAG,IAAI,CAAA,UAAA,CAAA;AAAA,IAClB,WAAA,EAAa,GAAG,IAAI,CAAA,YAAA,CAAA;AAAA,IACpB,WAAA,EAAa,GAAG,IAAI,CAAA,YAAA,CAAA;AAAA,IACpB,eAAA,EAAiB,GAAG,IAAI,CAAA,iBAAA;AAAA,GAC1B;AACF;AA4CO,IAAK,mBAAA,qBAAAA,oBAAAA,KAAL;AACL,EAAAA,qBAAA,SAAA,CAAA,GAAU,SAAA;AACV,EAAAA,qBAAA,eAAA,CAAA,GAAgB,eAAA;AAChB,EAAAA,qBAAA,oBAAA,CAAA,GAAqB,oBAAA;AACrB,EAAAA,qBAAA,oBAAA,CAAA,GAAqB,oBAAA;AACrB,EAAAA,qBAAA,mBAAA,CAAA,GAAoB,mBAAA;AACpB,EAAAA,qBAAA,sBAAA,CAAA,GAAuB,sBAAA;AACvB,EAAAA,qBAAA,mBAAA,CAAA,GAAoB,mBAAA;AACpB,EAAAA,qBAAA,aAAA,CAAA,GAAc,aAAA;AARJ,EAAA,OAAAA,oBAAAA;AAAA,CAAA,EAAA,mBAAA,IAAA,EAAA;AAcL,IAAM,eAAA,GAAN,cAA8B,KAAA,CAAM;AAAA,EACzB,IAAA;AAAA,EACA,OAAA;AAAA,EAEhB,WAAA,CAAY,IAAA,EAA2B,OAAA,EAAiB,OAAA,EAAkB;AACxE,IAAA,KAAA,CAAM,OAAO,CAAA;AACb,IAAA,IAAA,CAAK,IAAA,GAAO,iBAAA;AACZ,IAAA,IAAA,CAAK,IAAA,GAAO,IAAA;AACZ,IAAA,IAAA,CAAK,OAAA,GAAU,OAAA;AAAA,EACjB;AACF;AAuEO,IAAM,cAAA,GAA+C;AAAA,EAC1D,GAAA,EAAK,mBAAA;AAAA,EACL,IAAA,EAAM,kBAAA;AAAA,EACN,GAAA,EAAK,YAAA;AAAA,EACL,GAAA,EAAK,SAAA;AAAA,EACL,GAAA,EAAK,kBAAA;AAAA,EACL,GAAA,EAAK,MAAA;AAAA,EACL,IAAA,EAAM,mBAAA;AAAA,EACN,IAAA,EAAM,wBAAA;AAAA,EACN,GAAA,EAAK,aAAA;AAAA,EACL,GAAA,EAAK,OAAA;AAAA,EACL,GAAA,EAAK,6BAAA;AAAA,EACL,IAAA,EAAM,gCAAA;AAAA,EACN,GAAA,EAAK,kBAAA;AAAA,EACL,GAAA,EAAK,UAAA;AAAA,EACL,GAAA,EAAK,mBAAA;AAAA,EACL,GAAA,EAAK,mBAAA;AAAA,EACL,GAAA,EAAK;AACP;AAKO,IAAK,eAAA,qBAAAC,gBAAAA,KAAL;AACL,EAAAA,gBAAAA,CAAAA,gBAAAA,CAAA,UAAO,CAAA,CAAA,GAAP,MAAA;AACA,EAAAA,gBAAAA,CAAAA,gBAAAA,CAAA,iBAAc,CAAA,CAAA,GAAd,aAAA;AACA,EAAAA,gBAAAA,CAAAA,gBAAAA,CAAA,kBAAe,CAAA,CAAA,GAAf,cAAA;AACA,EAAAA,gBAAAA,CAAAA,gBAAAA,CAAA,aAAU,CAAA,CAAA,GAAV,SAAA;AACA,EAAAA,gBAAAA,CAAAA,gBAAAA,CAAA,WAAQ,CAAA,CAAA,GAAR,OAAA;AALU,EAAA,OAAAA,gBAAAA;AAAA,CAAA,EAAA,eAAA,IAAA,EAAA;AAqEL,IAAM,iBAAA,GAAkD;AAAA,EAC7D,GAAA,EAAK,iBAAA;AAAA,EACL,IAAA,EAAM,yEAAA;AAAA,EACN,GAAA,EAAK,oBAAA;AAAA,EACL,GAAA,EAAK,yCAAA;AAAA,EACL,GAAA,EAAK,iBAAA;AAAA,EACL,GAAA,EAAK,YAAA;AAAA,EACL,IAAA,EAAM,WAAA;AAAA,EACN,IAAA,EAAM,mEAAA;AAAA,EACN,GAAA,EAAK,0BAAA;AAAA,EACL,GAAA,EAAK,gDAAA;AAAA,EACL,GAAA,EAAK,UAAA;AAAA,EACL,IAAA,EAAM,2EAAA;AAAA,EACN,GAAA,EAAK,+BAAA;AAAA,EACL,GAAA,EAAK,iDAAA;AAAA,EACL,GAAA,EAAK,WAAA;AAAA,EACL,GAAA,EAAK,YAAA;AAAA,EACL,GAAA,EAAK;AACP;AAKO,IAAM,mBAAA,GAAmD;AAAA,EAC9D,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,MAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK;AACP;AAiBO,IAAM,0BAAA,GAAsE;AAAA,EACjF,CAAC,CAAA,cAAuB,CAAC,KAAA,EAAO,MAAA,EAAQ,KAAA,EAAO,KAAA,EAAO,KAAA,EAAO,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA;AAAA,EACjF,CAAC,CAAA,qBAA8B,CAAC,KAAA,EAAO,QAAQ,KAAA,EAAO,KAAA,EAAO,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA;AAAA,EACjF,CAAC,CAAA,sBAA+B,CAAC,KAAA,EAAO,QAAQ,KAAA,EAAO,KAAA,EAAO,KAAA,EAAO,KAAA,EAAO,MAAM,CAAA;AAAA,EAClF,CAAC,CAAA,iBAA0B,CAAC,KAAA,EAAO,KAAA,EAAO,OAAO,MAAM,CAAA;AAAA,EACvD,CAAC,CAAA,eAAwB,CAAC,KAAK;AACjC;AAQO,SAAS,2BAA2B,OAAA,EAAmD;AAC5F,EAAA,OAAO,0BAAA,CAA2B,OAA0B,CAAA,IAAK,CAAC,KAAK,CAAA;AACzE;AAMO,IAAM,oBAAA,GAAqD;AAAA,EAChE,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK,KAAA;AAAA,EACL,GAAA,EAAK;AACP,CAAA;AAMO,IAAM,qBAAA,GAA+D;AAAA;AAAA;AAAA;AAAA;AAAA,EAK1E,GAAA,EAAK,EAAA;AAAA;AAAA,EAEL,GAAA,EAAK,+CAAA;AAAA;AAAA,EAEL,GAAA,EAAK;AACP,CAAA;AAyBO,IAAM,yBAAA,GAA4B,sHAAA;AAQlC,SAAS,gBAAA,CAAiB,aAAsB,QAAA,EAA2B;AAChF,EAAA,MAAM,UAAoB,EAAC;AAG3B,EAAA,IAAI,WAAA,EAAa,WAAA,EAAY,KAAM,KAAA,EAAO;AACxC,IAAA,OAAA,CAAQ,KAAK,yBAAyB,CAAA;AAAA,EACxC;AAGA,EAAA,IAAI,QAAA,EAAU;AACZ,IAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,SAAA,EAAY,QAAQ,CAAA,CAAE,CAAA;AAAA,EACrC;AAEA,EAAA,OAAO,OAAA,CAAQ,KAAK,GAAG,CAAA;AACzB;AAWO,IAAM,qBAAA,GAA+D;AAAA;AAAA,EAE1E,GAAA,EAAK,MAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,MAAA;AAAA,EACL,GAAA,EAAK,MAAA;AAAA,EACL,GAAA,EAAK,MAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,MAAA;AAAA,EACL,IAAA,EAAM,MAAA;AAAA,EACN,GAAA,EAAK,MAAA;AAAA;AAAA,EAEL,GAAA,EAAK,aAAA;AAAA,EACL,IAAA,EAAM,aAAA;AAAA,EACN,GAAA,EAAK,aAAA;AAAA,EACL,GAAA,EAAK,aAAA;AAAA;AAAA,EAEL,GAAA,EAAK,cAAA;AAAA,EACL,IAAA,EAAM,cAAA;AAAA,EACN,GAAA,EAAK,cAAA;AAAA;AAAA,EAEL,GAAA,EAAK,SAAA;AAAA,EACL,GAAA,EAAK,SAAA;AAAA,EACL,GAAA,EAAK;AAAA;AACP;AAMO,IAAM,uBAAA,GAAoE;AAAA;AAAA;AAAA,EAG/E,IAAA,EAAM,CAAC,KAAA,EAAO,MAAA,EAAQ,OAAO,KAAA,EAAO,KAAA,EAAO,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA;AAAA;AAAA;AAAA,EAG/D,WAAA,EAAa,CAAC,KAAA,EAAO,MAAA,EAAQ,OAAO,KAAA,EAAO,KAAA,EAAO,QAAQ,KAAK,CAAA;AAAA;AAAA;AAAA,EAG/D,YAAA,EAAc,CAAC,KAAA,EAAO,MAAA,EAAQ,OAAO,KAAA,EAAO,KAAA,EAAO,OAAO,MAAM,CAAA;AAAA;AAAA;AAAA,EAGhE,OAAA,EAAS,CAAC,KAAA,EAAO,KAAA,EAAO,OAAO,MAAM,CAAA;AAAA;AAAA,EAErC,KAAA,EAAO,CAAC,KAAK;AACf;AAOO,SAAS,sBAAsB,WAAA,EAAmD;AACvF,EAAA,MAAM,MAAA,GAAS,YAAY,WAAA,EAAY;AACvC,EAAA,MAAM,QAAA,GAAW,sBAAsB,MAAM,CAAA;AAE7C,EAAA,IAAI,CAAC,QAAA,EAAU;AAEb,IAAA,OAAO,CAAC,KAAK,CAAA;AAAA,EACf;AAEA,EAAA,OAAO,wBAAwB,QAAQ,CAAA;AACzC;AAQO,SAAS,iBAAA,CACd,aACA,YAAA,EACS;AACT,EAAA,MAAM,YAAA,GAAe,sBAAsB,WAAW,CAAA;AACtD,EAAA,OAAO,YAAA,CAAa,QAAA,CAAS,YAAA,CAAa,WAAA,EAA6B,CAAA;AACzE;AAQO,SAAS,yBAAA,CACd,aACA,YAAA,EACQ;AACR,EAAA,MAAM,KAAA,GAAQ,YAAY,WAAA,EAAY;AACtC,EAAA,MAAM,MAAA,GAAS,aAAa,WAAA,EAAY;AACxC,EAAA,MAAM,YAAA,GAAe,sBAAsB,KAAoB,CAAA;AAE/D,EAAA,MAAM,QAAA,GAAW,qBAAA,CAAsB,KAAoB,CAAA,IAAK,SAAA;AAEhE,EAAA,IAAI,MAAA,GAAS,EAAA;AACb,EAAA,IAAI,QAAA,KAAa,SAAA,IAAa,CAAC,MAAA,EAAQ,KAAA,EAAO,MAAA,EAAQ,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA,CAAE,QAAA,CAAS,MAAM,CAAA,EAAG;AAC5F,IAAA,MAAA,GAAS,CAAA,mFAAA,CAAA;AAAA,EACX,CAAA,MAAA,IAAW,QAAA,KAAa,aAAA,IAAiB,CAAC,MAAA,EAAQ,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA,CAAE,QAAA,CAAS,MAAM,CAAA,EAAG;AACxF,IAAA,MAAA,GAAS,CAAA,sFAAA,CAAA;AAAA,EACX,CAAA,MAAA,IAAW,QAAA,KAAa,cAAA,IAAkB,CAAC,MAAA,EAAQ,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA,CAAE,QAAA,CAAS,MAAM,CAAA,EAAG;AACzF,IAAA,MAAA,GAAS,CAAA,sFAAA,CAAA;AAAA,EACX,CAAA,MAAA,IAAW,QAAA,KAAa,MAAA,IAAU,CAAC,MAAA,EAAQ,KAAA,EAAO,MAAA,EAAQ,KAAK,CAAA,CAAE,QAAA,CAAS,MAAM,CAAA,EAAG;AACjF,IAAA,MAAA,GAAS,CAAA,2EAAA,CAAA;AAAA,EACX;AAEA,EAAA,OAAO,kBAAkB,KAAA,CAAM,WAAA,EAAa,CAAA,IAAA,EAAO,MAAA,CAAO,aAAa,CAAA,EAAA,EAAK,MAAM,CAAA,yBAAA,EAA4B,MAAM,WAAA,EAAa,KAAK,YAAA,CAAa,IAAA,CAAK,IAAI,CAAC,CAAA,CAAA;AAC/J;;;AC5vBO,IAAM,yBAAA,GAA4B;AAClC,IAAM,uBAAA,GAA0B;AAChC,IAAM,mBAAA,GAAsB;AAG5B,IAAM,qBAAA,GAAwB;AAC9B,IAAM,kBAAA,GAAqB;AAG3B,IAAM,gBAAA,GAAmB;AACzB,IAAM,gBAAA,GAAmB;AACzB,IAAM,gBAAA,GAAmB;AAGzB,IAAM,0BAAA,GAA6B;AACnC,IAAM,wBAAA,GAA2B;AACjC,IAAM,0BAAA,GAA6B;AAGnC,IAAM,gBAAA,GAAmB;AACzB,IAAM,uBAAA,GAA0B;AAChC,IAAM,wBAAA,GAA2B;AACjC,IAAM,mBAAA,GAAsB;AAC5B,IAAM,iBAAA,GAAoB;AAG1B,IAAM,6BAAA,GAAgC,CAAA;AACtC,IAAM,sCAAA,GAAyC,CAAA;AAC/C,IAAM,2BAAA,GAA8B,CAAA;AACpC,IAAM,iCAAA,GAAoC,CAAA;AAC1C,IAAM,+BAAA,GAAkC,CAAA;AACxC,IAAM,2BAAA,GAA8B,CAAA;AACpC,IAAM,8BAAA,GAAiC,CAAA;AACvC,IAAM,8BAAA,GAAiC,CAAA;AACvC,IAAM,0BAAA,GAA6B,CAAA;AACnC,IAAM,mCAAA,GAAsC,CAAA;AAC5C,IAAM,uCAAA,GAA0C,EAAA;AAChD,IAAM,oCAAA,GAAuC,EAAA;AAC7C,IAAM,6BAAA,GAAgC,EAAA;AACtC,IAAM,kCAAA,GAAqC,EAAA;AAC3C,IAAM,qBAAA,GAAwB,EAAA;AAC9B,IAAM,oCAAA,GAAuC,EAAA;AAC7C,IAAM,+BAAA,GAAkC,EAAA;AACxC,IAAM,wBAAA,GAA2B,EAAA;AACjC,IAAM,0BAAA,GAA6B,EAAA;AACnC,IAAM,yBAAA,GAA4B,EAAA;AAClC,IAAM,8BAAA,GAAiC,EAAA;AACvC,IAAM,wCAAA,GAA2C,EAAA;AACjD,IAAM,yBAAA,GAA4B,EAAA;AAClC,IAAM,mCAAA,GAAsC,EAAA;AAC5C,IAAM,gCAAA,GAAmC,EAAA;AACzC,IAAM,6BAAA,GAAgC,EAAA;AACtC,IAAM,mCAAA,GAAsC,EAAA;AAC5C,IAAM,gCAAA,GAAmC,EAAA;AACzC,IAAM,sBAAA,GAAyB,EAAA;AAC/B,IAAM,uCAAA,GAA0C,EAAA;AAChD,IAAM,yCAAA,GAA4C,EAAA;AAClD,IAAM,oBAAA,GAAuB,EAAA;AAC7B,IAAM,8BAAA,GAAiC,EAAA;AACvC,IAAM,yBAAA,GAA4B,EAAA;AAUlC,SAAS,oBAAoB,IAAA,EAAsB;AACxD,EAAA,MAAM,KAAA,GAAgC;AAAA,IACpC,CAAC,6BAA6B,GAAG,kBAAA;AAAA,IACjC,CAAC,sCAAsC,GAAG,2BAAA;AAAA,IAC1C,CAAC,2BAA2B,GAAG,gBAAA;AAAA,IAC/B,CAAC,iCAAiC,GAAG,sBAAA;AAAA,IACrC,CAAC,+BAA+B,GAAG,oBAAA;AAAA,IACnC,CAAC,2BAA2B,GAAG,gBAAA;AAAA,IAC/B,CAAC,8BAA8B,GAAG,mBAAA;AAAA,IAClC,CAAC,8BAA8B,GAAG,mBAAA;AAAA,IAClC,CAAC,0BAA0B,GAAG,eAAA;AAAA,IAC9B,CAAC,mCAAmC,GAAG,wBAAA;AAAA,IACvC,CAAC,uCAAuC,GAAG,4BAAA;AAAA,IAC3C,CAAC,oCAAoC,GAAG,yBAAA;AAAA,IACxC,CAAC,6BAA6B,GAAG,kBAAA;AAAA,IACjC,CAAC,kCAAkC,GAAG,uBAAA;AAAA,IACtC,CAAC,qBAAqB,GAAG,UAAA;AAAA,IACzB,CAAC,oCAAoC,GAAG,yBAAA;AAAA,IACxC,CAAC,+BAA+B,GAAG,oBAAA;AAAA,IACnC,CAAC,wBAAwB,GAAG,aAAA;AAAA,IAC5B,CAAC,0BAA0B,GAAG,eAAA;AAAA,IAC9B,CAAC,yBAAyB,GAAG,cAAA;AAAA,IAC7B,CAAC,8BAA8B,GAAG,mBAAA;AAAA,IAClC,CAAC,wCAAwC,GAAG,6BAAA;AAAA,IAC5C,CAAC,yBAAyB,GAAG,cAAA;AAAA,IAC7B,CAAC,mCAAmC,GAAG,wBAAA;AAAA,IACvC,CAAC,gCAAgC,GAAG,qBAAA;AAAA,IACpC,CAAC,6BAA6B,GAAG,kBAAA;AAAA,IACjC,CAAC,mCAAmC,GAAG,wBAAA;AAAA,IACvC,CAAC,gCAAgC,GAAG,qBAAA;AAAA,IACpC,CAAC,sBAAsB,GAAG,WAAA;AAAA,IAC1B,CAAC,uCAAuC,GAAG,4BAAA;AAAA,IAC3C,CAAC,yCAAyC,GAAG,8BAAA;AAAA,IAC7C,CAAC,oBAAoB,GAAG,SAAA;AAAA,IACxB,CAAC,8BAA8B,GAAG,mBAAA;AAAA,IAClC,CAAC,yBAAyB,GAAG;AAAA,GAC/B;AACA,EAAA,OAAO,KAAA,CAAM,IAAI,CAAA,IAAK,CAAA,QAAA,EAAW,IAAI,CAAA,CAAA,CAAA;AACvC;AAGA,IAAM,SAAA,GAAY;AAAA,EAChB,KAAA,EAAO,CAAA;AAAA,EACP,OAAA,EAAS,CAAA;AAAA,EACT,YAAA,EAAc,CAAA;AAAA,EACd,QAAA,EAAU,EAAA;AAAA,EACV,uBAAA,EAAyB,EAAA;AAAA,EACzB,SAAA,EAAW;AACb,CAAA;AAEA,IAAM,SAAA,GAAY;AAAA,EAChB,KAAA,EAAO,CAAA;AAAA,EACP,OAAA,EAAS,CAAA;AAAA,EACT,MAAA,EAAQ;AACV,CAAA;AAGA,IAAM,WAAA,GAAc,IAAI,WAAA,EAAY;AACpC,IAAM,WAAA,GAAc,IAAI,WAAA,EAAY;AAE7B,IAAM,cAAN,MAAkB;AAAA,EACf,MAAA;AAAA,EACA,MAAA,GAAS,CAAA;AAAA,EACT,OAAA;AAAA,EACA,QAAA;AAAA,EAER,WAAA,CAAY,MAAA,EAA0B,OAAA,GAAU,KAAA,EAAO;AACrD,IAAA,IAAA,CAAK,MAAA,GAAS,MAAA;AACd,IAAA,IAAA,CAAK,OAAA,GAAU,OAAA;AAEf,IAAA,IAAA,CAAK,QAAA,GAAW,OAAO,IAAA,CAAK,MAAA,CAAO,iBAAA,KAAsB,UAAA;AACzD,IAAA,IAAI,KAAK,QAAA,EAAU;AACjB,MAAA,IAAA,CAAK,IAAI,+BAA+B,CAAA;AAAA,IAC1C,CAAA,MAAO;AACL,MAAA,IAAA,CAAK,IAAI,8CAA8C,CAAA;AAAA,IACzD;AAAA,EACF;AAAA,EAEQ,OAAO,IAAA,EAAuB;AACpC,IAAA,IAAI,KAAK,OAAA,EAAS;AAChB,MAAA,OAAA,CAAQ,GAAA,CAAI,OAAA,EAAS,GAAG,IAAI,CAAA;AAAA,IAC9B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,IAAY,MAAA,GAAqB;AAC/B,IAAA,OAAO,KAAK,MAAA,CAAO,MAAA;AAAA,EACrB;AAAA,EAEA,IAAY,OAAA,GAAuB;AACjC,IAAA,OAAO,KAAK,MAAA,CAAO,OAAA;AAAA,EACrB;AAAA,EAEA,IAAY,MAAA,GAAqB;AAC/B,IAAA,OAAO,KAAK,MAAA,CAAO,MAAA;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,GAAA,EAAqB;AAC/B,IAAA,MAAM,KAAA,GAAQ,WAAA,CAAY,MAAA,CAAO,GAAA,GAAM,IAAI,CAAA;AAC3C,IAAA,MAAM,GAAA,GAAM,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,MAAM,MAAM,CAAA;AAE5C,IAAA,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI,KAAA,EAAO,GAAG,CAAA;AAC1B,IAAA,OAAO,GAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,GAAA,EAA4B;AACrC,IAAA,IAAI,GAAA,KAAQ,GAAG,OAAO,IAAA;AAEtB,IAAA,MAAM,OAAO,IAAA,CAAK,MAAA;AAClB,IAAA,IAAI,GAAA,GAAM,GAAA;AACV,IAAA,OAAO,IAAA,CAAK,GAAG,CAAA,KAAM,CAAA,EAAG,GAAA,EAAA;AAGxB,IAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,KAAA,CAAM,GAAA,EAAK,GAAG,CAAA;AACjC,IAAA,OAAO,WAAA,CAAY,OAAO,KAAK,CAAA;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,IAAA,EAAsB;AAE5B,IAAA,OAAO,IAAA,CAAK,OAAA,CAAQ,IAAA,IAAQ,CAAC,CAAA,IAAK,CAAA;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAKQ,QAAW,GAAA,EAAgB;AACjC,IAAA,MAAM,SAAA,GAAY,KAAK,MAAA,CAAO,SAAA;AAC9B,IAAA,OAAO,SAAA,CAAU,IAAI,GAAG,CAAA;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA,EAKA,UAAA,CAAW,cAAsB,kBAAA,EAA0B;AACzD,IAAA,IAAA,CAAK,GAAA,CAAI,2BAA2B,WAAW,CAAA;AAC/C,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,WAAW,CAAA;AAE5C,IAAA,IAAI;AAEF,MAAA,MAAM,IAAA,GAAQ,KAAK,MAAA,CAAe,oBAAA;AAIlC,MAAA,IAAI,OAAO,SAAS,UAAA,EAAY;AAC9B,QAAA,MAAM,IAAI,MAAM,gDAAgD,CAAA;AAAA,MAClE;AAEA,MAAA,IAAA,CAAK,MAAA,GAAS,KAAK,OAAO,CAAA;AAE1B,MAAA,IAAI,IAAA,CAAK,WAAW,CAAA,EAAG;AACrB,QAAA,MAAM,IAAI,MAAM,qCAAqC,CAAA;AAAA,MACvD;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,uBAAA,EAAyB,IAAA,CAAK,MAAM,CAAA;AAAA,IAC/C,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,QAAA,GAA0B;AACxB,IAAA,IAAI,IAAA,CAAK,MAAA,KAAW,CAAA,EAAG,OAAO,IAAA;AAG9B,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,aAAA,EAAe;AAC9C,MAAA,MAAMC,OAAAA,GAAS,IAAA,CAAK,MAAA,CAAO,aAAA,CAAc,KAAK,MAAM,CAAA;AACpD,MAAA,OAAO,IAAA,CAAK,WAAWA,OAAM,CAAA;AAAA,IAC/B;AAGA,IAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,IAAA,CAAK,MAAM,CAAA;AAC5C,IAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,WAAA,GAAc,UAAU,QAAQ,CAAA;AACjE,IAAA,IAAI,WAAA,KAAgB,GAAG,OAAO,IAAA;AAE9B,IAAA,MAAM,QAAA,GAAW,IAAA,CAAK,OAAA,CAAiC,WAAW,CAAA;AAClE,IAAA,MAAM,MAAA,GAAS,QAAA,CAAS,IAAA,CAAK,MAAM,CAAA;AACnC,IAAA,OAAO,IAAA,CAAK,WAAW,MAAM,CAAA;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA,EAKA,cAAA,GAAgC;AAC9B,IAAA,OAAO,kBAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAMQ,UAAU,IAAA,EAAsB;AACtC,IAAA,IAAI,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA,EAAG,OAAO,IAAA;AACvC,IAAA,MAAM,eAAe,IAAA,CAAK,UAAA,CAAW,GAAG,CAAA,GAAI,OAAO,GAAA,GAAM,IAAA;AACzD,IAAA,OAAO,SAAA,GAAY,YAAA;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,IAAA,EAAsB;AACjC,IAAA,IAAI,IAAA,CAAK,WAAW,CAAA,EAAG;AACrB,MAAA,MAAM,IAAI,MAAM,qBAAqB,CAAA;AAAA,IACvC;AAEA,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,SAAA,CAAU,IAAI,CAAA;AACnC,IAAA,IAAA,CAAK,GAAA,CAAI,mBAAA,EAAqB,IAAA,EAAM,IAAA,EAAM,OAAO,CAAA;AACjD,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AAExC,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,KAAK,GAAA,EAAI;AAC3B,MAAA,IAAI,MAAA;AAEJ,MAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,iBAAA,EAAmB;AAElD,QAAA,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,iBAAA,CAAkB,IAAA,CAAK,QAAQ,OAAO,CAAA;AAAA,MAC7D,CAAA,MAAO;AAEL,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,IAAA,CAAK,MAAM,CAAA;AAC5C,QAAA,MAAM,eAAA,GAAkB,IAAA,CAAK,OAAA,CAAQ,WAAA,GAAc,UAAU,YAAY,CAAA;AACzE,QAAA,MAAM,YAAA,GAAe,IAAA,CAAK,OAAA,CAA+C,eAAe,CAAA;AACxF,QAAA,MAAA,GAAS,YAAA,CAAa,IAAA,CAAK,MAAA,EAAQ,OAAO,CAAA;AAAA,MAC5C;AAEA,MAAA,IAAA,CAAK,IAAI,oBAAA,EAAsB,IAAA,CAAK,KAAI,GAAI,SAAA,EAAW,YAAY,MAAM,CAAA;AAEzE,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,KAAA,GAAQ,KAAK,QAAA,EAAS;AAC5B,QAAA,MAAM,IAAI,KAAA,CAAM,CAAA,yBAAA,EAA4B,KAAA,IAAS,eAAe,CAAA,CAAE,CAAA;AAAA,MACxE;AAEA,MAAA,OAAO,MAAA;AAAA,IACT,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,uBAAA,CAAwB,MAAc,OAAA,EAAyB;AAC7D,IAAA,IAAI,IAAA,CAAK,WAAW,CAAA,EAAG;AACrB,MAAA,MAAM,IAAI,MAAM,qBAAqB,CAAA;AAAA,IACvC;AAEA,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,SAAA,CAAU,IAAI,CAAA;AACnC,IAAA,IAAA,CAAK,GAAA,CAAI,gCAAA,EAAkC,IAAA,EAAM,IAAA,EAAM,SAAS,OAAO,CAAA;AACvE,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AACxC,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AAExC,IAAA,IAAI;AACF,MAAA,IAAI,MAAA;AAEJ,MAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,4BAAA,EAA8B;AAE7D,QAAA,MAAA,GAAS,KAAK,MAAA,CAAO,4BAAA,CAA6B,IAAA,CAAK,MAAA,EAAQ,SAAS,OAAO,CAAA;AAAA,MACjF,CAAA,MAAO;AAEL,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,IAAA,CAAK,MAAM,CAAA;AAC5C,QAAA,MAAM,eAAA,GAAkB,IAAA,CAAK,OAAA,CAAQ,WAAA,GAAc,UAAU,uBAAuB,CAAA;AAEpF,QAAA,IAAI,oBAAoB,CAAA,EAAG;AAEzB,UAAA,OAAO,IAAA,CAAK,aAAa,IAAI,CAAA;AAAA,QAC/B;AAEA,QAAA,MAAM,YAAA,GAAe,IAAA,CAAK,OAAA,CAExB,eAAe,CAAA;AACjB,QAAA,MAAA,GAAS,YAAA,CAAa,IAAA,CAAK,MAAA,EAAQ,OAAA,EAAS,OAAO,CAAA;AAAA,MACrD;AAEA,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,KAAA,GAAQ,KAAK,QAAA,EAAS;AAC5B,QAAA,MAAM,IAAI,KAAA,CAAM,CAAA,yBAAA,EAA4B,KAAA,IAAS,eAAe,CAAA,CAAE,CAAA;AAAA,MACxE;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,yBAAyB,MAAM,CAAA;AACxC,MAAA,OAAO,MAAA;AAAA,IACT,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AACzB,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,cAAA,CACE,MAAA,EACA,UAAA,EACA,MAAA,EACA,gBAAwB,EAAA,EAClB;AACN,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,SAAA,CAAU,UAAU,CAAA;AACzC,IAAA,IAAA,CAAK,IAAI,qBAAA,EAAuB,UAAA,EAAY,IAAA,EAAM,OAAA,EAAS,WAAW,MAAM,CAAA;AAE5E,IAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AACvC,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,WAAA,CAAY,MAAM,CAAA;AACzC,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,aAAa,CAAA;AAE9C,IAAA,IAAI;AACF,MAAA,IAAI,MAAA;AAEJ,MAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,mBAAA,EAAqB;AAEpD,QAAA,MAAA,GAAS,KAAK,MAAA,CAAO,mBAAA,CAAoB,MAAA,EAAQ,MAAA,EAAQ,WAAW,OAAO,CAAA;AAAA,MAC7E,CAAA,MAAO;AAEL,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,MAAM,CAAA;AACvC,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,OAAA,CAAQ,WAAA,GAAc,UAAU,MAAM,CAAA;AAC7D,QAAA,MAAM,MAAA,GAAS,IAAA,CAAK,OAAA,CAElB,SAAS,CAAA;AACX,QAAA,MAAA,GAAS,MAAA,CAAO,MAAA,EAAQ,MAAA,EAAQ,SAAA,EAAW,OAAO,CAAA;AAAA,MACpD;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,gBAAgB,MAAM,CAAA;AAE/B,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,MAAM,yBAAyB,CAAA;AAAA,MAC3C;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,MAAM,CAAA;AACxB,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,IAC3B;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,MAAA,EAAsB;AACpC,IAAA,IAAI,WAAW,CAAA,EAAG;AAElB,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,oBAAA,EAAsB;AAErD,MAAA,IAAA,CAAK,MAAA,CAAO,qBAAqB,MAAM,CAAA;AACvC,MAAA,IAAA,CAAK,IAAI,+BAA+B,CAAA;AACxC,MAAA;AAAA,IACF;AAGA,IAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,MAAM,CAAA;AACvC,IAAA,MAAM,UAAA,GAAa,IAAA,CAAK,OAAA,CAAQ,WAAA,GAAc,UAAU,OAAO,CAAA;AAE/D,IAAA,IAAI,eAAe,CAAA,EAAG;AACpB,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,OAAA,CAA+B,UAAU,CAAA;AAC9D,MAAA,OAAA,CAAQ,MAAM,CAAA;AACd,MAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAAA,IAC5C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAA,GAAgB;AACd,IAAA,IAAI,IAAA,CAAK,WAAW,CAAA,EAAG;AAEvB,IAAA,IAAI;AAEF,MAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,YAAA,EAAc;AAC7C,QAAA,IAAA,CAAK,MAAA,CAAO,YAAA,CAAa,IAAA,CAAK,MAAM,CAAA;AACpC,QAAA,IAAA,CAAK,IAAI,0BAA0B,CAAA;AAAA,MACrC,CAAA,MAAO;AAEL,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,OAAA,CAAQ,IAAA,CAAK,MAAM,CAAA;AAC5C,QAAA,MAAM,UAAA,GAAa,IAAA,CAAK,OAAA,CAAQ,WAAA,GAAc,UAAU,OAAO,CAAA;AAE/D,QAAA,IAAI,eAAe,CAAA,EAAG;AACpB,UAAA,MAAM,OAAA,GAAU,IAAA,CAAK,OAAA,CAA+B,UAAU,CAAA;AAC9D,UAAA,OAAA,CAAQ,KAAK,MAAM,CAAA;AACnB,UAAA,IAAA,CAAK,IAAI,4BAA4B,CAAA;AAAA,QACvC;AAAA,MACF;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,IAAA,CAAK,GAAA,CAAI,gCAAgC,KAAK,CAAA;AAAA,IAChD;AAEA,IAAA,IAAA,CAAK,MAAA,GAAS,CAAA;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,aAAA,GAAyB;AACvB,IAAA,OAAO,KAAK,MAAA,KAAW,CAAA;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAA,GAAwB;AACtB,IAAA,OAAO,IAAA,CAAK,QAAA;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,iBAAiB,MAAA,EAAwB;AACvC,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,qBAAA,EAAuB;AACtD,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,qBAAA,CAAsB,MAAM,CAAA;AAAA,IACjD;AAGA,IAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAC/C,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,MAAA,EAAwB;AACtC,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,oBAAA,EAAsB;AACrD,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,oBAAA,CAAqB,MAAM,CAAA;AAAA,IAChD;AAEA,IAAA,IAAA,CAAK,IAAI,qCAAqC,CAAA;AAC9C,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,eAAA,CAAgB,QAAgB,IAAA,EAAoB;AAClD,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,oBAAA,EAAsB;AACrD,MAAA,IAAA,CAAK,MAAA,CAAO,oBAAA,CAAqB,MAAA,EAAQ,IAAI,CAAA;AAC7C,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,qCAAqC,CAAA;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA,EAKA,wBAAwB,MAAA,EAAwB;AAC9C,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,4BAAA,EAA8B;AAC7D,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,4BAAA,CAA6B,MAAM,CAAA;AAAA,IACxD;AAEA,IAAA,IAAA,CAAK,IAAI,6CAA6C,CAAA;AACtD,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,wBAAwB,MAAA,EAAmD;AACzE,IAAA,IAAA,CAAK,GAAA,CAAI,CAAA,4CAAA,EAA+C,MAAM,CAAA,CAAE,CAAA;AAChE,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,4BAAA,EAA8B;AAE7D,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,CAAC,CAAA;AACrC,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAA,CAAO,4BAAA,CAA6B,MAAA,EAAQ,OAAA,EAAS,UAAU,CAAC,CAAA;AACrE,QAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,MAAA,CAAO,OAAA,IAAW,CAAC,CAAA,IAAK,CAAA;AAC3C,QAAA,MAAM,SAAS,IAAA,CAAK,MAAA,CAAQ,OAAA,GAAU,CAAA,IAAM,CAAC,CAAA,IAAK,CAAA;AAClD,QAAA,IAAA,CAAK,GAAA,CAAI,CAAA,yBAAA,EAA4B,KAAK,CAAA,CAAA,EAAI,MAAM,CAAA,MAAA,CAAQ,CAAA;AAC5D,QAAA,OAAO,EAAE,OAAO,MAAA,EAAO;AAAA,MACzB,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,MAC3B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,6CAA6C,CAAA;AACtD,IAAA,OAAO,EAAE,KAAA,EAAO,CAAA,EAAG,MAAA,EAAQ,CAAA,EAAE;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA,EAKA,8BAAA,CAA+B,MAAA,EAAgB,OAAA,GAAkB,EAAA,EAAU;AACzE,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,mCAAA,EAAqC;AACpE,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AACxC,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAA,CAAO,mCAAA,CAAoC,MAAA,EAAQ,OAAO,CAAA;AAAA,MACjE,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,MAC3B;AACA,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,oDAAoD,CAAA;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,kBACE,MAAA,EACA,WAAA,EACA,cACA,QAAA,EACA,QAAA,EACA,WACA,UAAA,EACY;AACZ,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,sBAAA,EAAwB;AAEvD,MAAA,MAAM,UAAA,GAAa,cAAc,YAAA,GAAe,CAAA;AAChD,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,UAAU,CAAA;AAEhD,MAAA,IAAI,cAAc,CAAA,EAAG;AACnB,QAAA,MAAM,IAAI,KAAA,CAAM,CAAA,mBAAA,EAAsB,UAAU,CAAA,sBAAA,CAAwB,CAAA;AAAA,MAC1E;AAEA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAA,CAAO,sBAAA;AAAA,UACV,MAAA;AAAA,UACA,SAAA;AAAA,UACA,WAAA;AAAA,UACA,YAAA;AAAA,UACA,QAAA;AAAA,UACA,QAAA;AAAA,UACA,SAAA;AAAA,UACA;AAAA,SACF;AAGA,QAAA,MAAM,MAAA,GAAS,IAAI,UAAA,CAAW,UAAU,CAAA;AACxC,QAAA,MAAA,CAAO,IAAI,IAAA,CAAK,MAAA,CAAO,SAAS,SAAA,EAAW,SAAA,GAAY,UAAU,CAAC,CAAA;AAClE,QAAA,OAAO,MAAA;AAAA,MACT,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAAA,MAC7B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,uCAAuC,CAAA;AAChD,IAAA,OAAO,IAAI,WAAW,CAAC,CAAA;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,MAAA,EAAwB;AAC1C,IAAA,IAAI,WAAW,CAAA,EAAG;AAChB,MAAA,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAAA,IAC5C;AAEA,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,MAAM,CAAA;AAAA,IACpD;AAEA,IAAA,IAAA,CAAK,IAAI,yCAAyC,CAAA;AAClD,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,WACE,MAAA,EACA,SAAA,EACA,OACA,MAAA,GAAiB,CAAA,EACjB,WAAoB,KAAA,EACiC;AAErD,IAAA,IAAA,CAAK,+BAA+B,MAAM,CAAA;AAG1C,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,uBAAA,CAAwB,MAAM,CAAA;AAInD,IAAA,IAAI,OAAA,KAAY,CAAA,IAAK,OAAA,KAAY,CAAA,EAAG;AAClC,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,sBAAA,EAAyB,SAAS,CAAA,yBAAA,CAA2B,CAAA;AACzE,MAAA,IAAA,CAAK,eAAA,CAAgB,QAAQ,SAAS,CAAA;AACtC,MAAA,MAAM,WAAA,GAAc,IAAA,CAAK,eAAA,CAAgB,MAAM,CAAA;AAC/C,MAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,kCAAA,EAAqC,WAAW,CAAA,CAAE,CAAA;AAI9D,MAAA,IAAI,CAAC,QAAA,EAAU;AACb,QAAA,IAAA,CAAK,WAAA,CAAY,QAAQ,CAAC,CAAA;AAC1B,QAAA,OAAA,CAAQ,IAAI,CAAA,+DAAA,CAAiE,CAAA;AAAA,MAC/E;AAAA,IACF;AAGA,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,uBAAA,CAAwB,MAAM,CAAA;AACnD,IAAA,IAAA,CAAK,GAAA,CAAI,0BAA0B,OAAO,CAAA;AAE1C,IAAA,IAAI,OAAA,CAAQ,KAAA,KAAU,CAAA,IAAK,OAAA,CAAQ,WAAW,CAAA,EAAG;AAC/C,MAAA,MAAM,IAAI,MAAM,6BAA6B,CAAA;AAAA,IAC/C;AAGA,IAAA,IAAI,QAAA,GAAW,CAAA;AACf,IAAA,IAAI,QAAA,GAAW,CAAA;AACf,IAAA,IAAI,YAAY,OAAA,CAAQ,KAAA;AACxB,IAAA,IAAI,aAAa,OAAA,CAAQ,MAAA;AAEzB,IAAA,IAAI,OAAA,KAAY,CAAA,IAAK,OAAA,KAAY,CAAA,EAAG;AAElC,MAAA,MAAM,YAAA,GAAe,IAAA,CAAK,qBAAA,CAAsB,MAAM,CAAA;AACtD,MAAA,IAAI,YAAA,EAAc;AAChB,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,mBAAA,CAAoB,YAAY,CAAA;AACvD,QAAA,MAAM,QAAA,GAAW,UAAU,SAAS,CAAA;AACpC,QAAA,IAAI,QAAA,EAAU;AACZ,UAAA,QAAA,GAAW,QAAA,CAAS,CAAA;AACpB,UAAA,QAAA,GAAW,QAAA,CAAS,CAAA;AACpB,UAAA,SAAA,GAAY,QAAA,CAAS,KAAA;AACrB,UAAA,UAAA,GAAa,QAAA,CAAS,MAAA;AACtB,UAAA,IAAA,CAAK,GAAA,CAAI,CAAA,KAAA,EAAQ,SAAS,CAAA,WAAA,CAAA,EAAe,QAAQ,CAAA;AAAA,QACnD;AAAA,MACF;AAAA,IACF;AAGA,IAAA,MAAM,cAAc,UAAA,GAAa,SAAA;AACjC,IAAA,MAAM,WAAA,GAAc,KAAA;AACpB,IAAA,MAAM,eAAe,MAAA,GAAS,CAAA,GAAI,SAAS,IAAA,CAAK,KAAA,CAAM,QAAQ,WAAW,CAAA;AAEzE,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,yBAAA,EAA4B,WAAW,CAAA,CAAA,EAAI,YAAY,CAAA,gBAAA,EAAmB,QAAQ,CAAA,EAAA,EAAK,QAAQ,CAAA,QAAA,EAAW,SAAS,CAAA,CAAA,EAAI,UAAU,CAAA,CAAA,CAAG,CAAA;AAGhJ,IAAA,MAAM,OAAO,IAAA,CAAK,iBAAA;AAAA,MAChB,MAAA;AAAA,MACA,WAAA;AAAA,MACA,YAAA;AAAA,MACA,QAAA;AAAA,MACA,QAAA;AAAA,MACA,SAAA;AAAA,MACA;AAAA,KACF;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,yBAAA,EAA4B,IAAA,CAAK,MAAM,CAAA,MAAA,CAAQ,CAAA;AAC3D,IAAA,OAAO,EAAE,IAAA,EAAM,KAAA,EAAO,WAAA,EAAa,QAAQ,YAAA,EAAa;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAwBA,sBACE,MAAA,EACA,SAAA,EACA,MAAc,GAAA,EACd,YAAA,EACA,WAAoB,KAAA,EAC8C;AAElE,IAAA,IAAA,CAAK,+BAA+B,MAAM,CAAA;AAG1C,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,uBAAA,CAAwB,MAAM,CAAA;AAGnD,IAAA,IAAI,OAAA,KAAY,CAAA,IAAK,OAAA,KAAY,CAAA,EAAG;AAClC,MAAA,IAAA,CAAK,GAAA,CAAI,CAAA,gBAAA,EAAmB,SAAS,CAAA,yBAAA,CAA2B,CAAA;AAChE,MAAA,IAAA,CAAK,eAAA,CAAgB,QAAQ,SAAS,CAAA;AAItC,MAAA,IAAI,CAAC,QAAA,EAAU;AACb,QAAA,IAAA,CAAK,WAAA,CAAY,QAAQ,CAAC,CAAA;AAC1B,QAAA,IAAA,CAAK,IAAI,CAAA,yDAAA,CAA2D,CAAA;AAAA,MACtE;AAAA,IACF;AAGA,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,uBAAA,CAAwB,MAAM,CAAA;AACnD,IAAA,IAAA,CAAK,GAAA,CAAI,0BAA0B,OAAO,CAAA;AAE1C,IAAA,IAAI,OAAA,CAAQ,KAAA,KAAU,CAAA,IAAK,OAAA,CAAQ,WAAW,CAAA,EAAG;AAC/C,MAAA,MAAM,IAAI,MAAM,6BAA6B,CAAA;AAAA,IAC/C;AAGA,IAAA,IAAI,QAAA,GAAW,CAAA;AACf,IAAA,IAAI,QAAA,GAAW,CAAA;AACf,IAAA,IAAI,YAAY,OAAA,CAAQ,KAAA;AACxB,IAAA,IAAI,aAAa,OAAA,CAAQ,MAAA;AAEzB,IAAA,IAAI,OAAA,KAAY,CAAA,IAAK,OAAA,KAAY,CAAA,EAAG;AAClC,MAAA,MAAM,YAAA,GAAe,IAAA,CAAK,qBAAA,CAAsB,MAAM,CAAA;AACtD,MAAA,IAAI,YAAA,EAAc;AAChB,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,mBAAA,CAAoB,YAAY,CAAA;AACvD,QAAA,MAAM,QAAA,GAAW,UAAU,SAAS,CAAA;AACpC,QAAA,IAAI,QAAA,EAAU;AACZ,UAAA,QAAA,GAAW,QAAA,CAAS,CAAA;AACpB,UAAA,QAAA,GAAW,QAAA,CAAS,CAAA;AACpB,UAAA,SAAA,GAAY,QAAA,CAAS,KAAA;AACrB,UAAA,UAAA,GAAa,QAAA,CAAS,MAAA;AACtB,UAAA,IAAA,CAAK,GAAA,CAAI,CAAA,KAAA,EAAQ,SAAS,CAAA,WAAA,CAAA,EAAe,QAAQ,CAAA;AAAA,QACnD;AAAA,MACF;AAAA,IACF;AAIA,IAAA,MAAM,cAAA,GAAiB,IAAA;AACvB,IAAA,IAAI,WAAA,GAAc,IAAA,CAAK,KAAA,CAAM,SAAA,GAAY,MAAM,cAAc,CAAA;AAC7D,IAAA,IAAI,YAAA,GAAe,IAAA,CAAK,KAAA,CAAM,UAAA,GAAa,MAAM,cAAc,CAAA;AAC/D,IAAA,IAAI,YAAA,GAAe,GAAA;AAGnB,IAAA,IAAI,YAAA,KAAiB,WAAA,GAAc,YAAA,IAAgB,YAAA,GAAe,YAAA,CAAA,EAAe;AAC/E,MAAA,MAAM,KAAA,GAAQ,YAAA,GAAe,IAAA,CAAK,GAAA,CAAI,aAAa,YAAY,CAAA;AAC/D,MAAA,WAAA,GAAc,IAAA,CAAK,KAAA,CAAM,WAAA,GAAc,KAAK,CAAA;AAC5C,MAAA,YAAA,GAAe,IAAA,CAAK,KAAA,CAAM,YAAA,GAAe,KAAK,CAAA;AAC9C,MAAA,YAAA,GAAe,IAAA,CAAK,KAAA,CAAM,GAAA,GAAM,KAAK,CAAA;AACrC,MAAA,IAAA,CAAK,IAAI,CAAA,qBAAA,EAAwB,WAAW,IAAI,YAAY,CAAA,iBAAA,EAAoB,YAAY,CAAA,CAAA,CAAG,CAAA;AAAA,IACjG;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,6BAAA,EAAgC,WAAW,CAAA,CAAA,EAAI,YAAY,CAAA,IAAA,EAAO,YAAY,CAAA,gBAAA,EAAmB,QAAQ,KAAK,QAAQ,CAAA,QAAA,EAAW,SAAS,CAAA,CAAA,EAAI,UAAU,CAAA,OAAA,CAAS,CAAA;AAG7K,IAAA,MAAM,OAAO,IAAA,CAAK,iBAAA;AAAA,MAChB,MAAA;AAAA,MACA,WAAA;AAAA,MACA,YAAA;AAAA,MACA,QAAA;AAAA,MACA,QAAA;AAAA,MACA,SAAA;AAAA,MACA;AAAA,KACF;AAEA,IAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,qCAAA,EAAwC,IAAA,CAAK,MAAM,CAAA,MAAA,CAAQ,CAAA;AACvE,IAAA,OAAO,EAAE,IAAA,EAAM,KAAA,EAAO,aAAa,MAAA,EAAQ,YAAA,EAAc,KAAK,YAAA,EAAa;AAAA,EAC7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,gBAAA,CAAiB,MAAA,EAAgB,QAAA,GAAmB,0BAAA,EAA2C;AAC7F,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,EAA+B;AAC9D,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,QAAQ,CAAA;AACzC,MAAA,MAAM,WAAA,GAAc,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,CAAC,CAAA;AACzC,MAAA,IAAI;AACF,QAAA,MAAM,YAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,CAA8B,MAAA,EAAQ,SAAS,WAAW,CAAA;AACxF,QAAA,IAAI,SAAA,KAAc,GAAG,OAAO,IAAA;AAC5B,QAAA,MAAM,MAAA,GAAS,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA;AACxC,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,QAAA,OAAO,MAAA;AAAA,MACT,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AACzB,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,WAAW,CAAA;AAAA,MAC/B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAC/C,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,gBAAA,CAAiB,MAAA,EAAgB,IAAA,EAAc,CAAA,EAAW,CAAA,EAAiB;AACzE,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,EAA+B;AAC9D,MAAA,IAAA,CAAK,MAAA,CAAO,6BAAA,CAA8B,MAAA,EAAQ,IAAA,EAAM,GAAG,CAAC,CAAA;AAC5D,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,iBAAiB,MAAA,EAAwB;AACvC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,EAA+B;AAC9D,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,6BAAA,CAA8B,MAAM,CAAA;AAAA,IACzD;AAEA,IAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAC/C,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,eAAe,MAAA,EAAsB;AACnC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,2BAAA,EAA6B;AAC5D,MAAA,IAAA,CAAK,MAAA,CAAO,4BAA4B,MAAM,CAAA;AAC9C,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,oCAAoC,CAAA;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,cAAA,CACE,MAAA,EACA,IAAA,EACA,CAAA,EACA,CAAA,EACA,QAAgB,CAAA,EAChB,OAAA,GAAkB,CAAA,EAClB,QAAA,GAAmB,CAAA,EACb;AACN,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,2BAAA,EAA6B;AAC5D,MAAA,IAAA,CAAK,MAAA,CAAO,4BAA4B,MAAA,EAAQ,IAAA,EAAM,GAAG,CAAA,EAAG,KAAA,EAAO,SAAS,QAAQ,CAAA;AACpF,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,oCAAoC,CAAA;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,YAAA,CAAa,MAAA,EAAgB,IAAA,EAAc,QAAA,EAAkB,OAAA,EAAuB;AAClF,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,yBAAA,EAA2B;AAC1D,MAAA,IAAA,CAAK,MAAA,CAAO,yBAAA,CAA0B,MAAA,EAAQ,IAAA,EAAM,UAAU,OAAO,CAAA;AACrE,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,kCAAkC,CAAA;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,eACE,MAAA,EACA,OAAA,EACA,IAAA,GAAe,IAAA,EACf,qBAA8B,KAAA,EACxB;AACN,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,2BAAA,EAA6B;AAC5D,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AACvC,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,IAAI,CAAA;AACrC,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,2BAAA,CAA4B,MAAA,EAAQ,QAAQ,OAAA,EAAS,kBAAA,GAAqB,IAAI,CAAC,CAAA;AAAA,MAC7F,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,MAAM,CAAA;AACxB,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,MAC3B;AACA,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,oCAAoC,CAAA;AAAA,EAC/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,gBAAA,CAAiB,QAAgB,OAAA,EAAgC;AAC/D,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,EAA+B;AAC9D,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AACvC,MAAA,IAAI;AACF,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,CAA8B,QAAQ,MAAM,CAAA;AAC1E,QAAA,IAAI,SAAA,KAAc,GAAG,OAAO,IAAA;AAC5B,QAAA,MAAM,MAAA,GAAS,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA;AACxC,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,QAAA,OAAO,MAAA;AAAA,MACT,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,MAAM,CAAA;AAAA,MAC1B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAC/C,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,sBAAsB,MAAA,EAA+B;AACnD,IAAA,IAAA,CAAK,GAAA,CAAI,CAAA,0CAAA,EAA6C,MAAM,CAAA,CAAE,CAAA;AAC9D,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,kCAAA,EAAoC;AACnE,MAAA,IAAA,CAAK,IAAI,mCAAmC,CAAA;AAC5C,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,MAAA,CAAO,kCAAA,CAAmC,MAAM,CAAA;AACvE,MAAA,IAAA,CAAK,GAAA,CAAI,CAAA,iCAAA,EAAoC,SAAS,CAAA,CAAE,CAAA;AACxD,MAAA,IAAI,SAAA,KAAc,GAAG,OAAO,IAAA;AAC5B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA;AACxC,MAAA,IAAA,CAAK,IAAI,CAAA,+BAAA,EAAkC,MAAA,EAAQ,MAAM,CAAA,EAAG,GAAG,CAAC,CAAA,IAAA,CAAM,CAAA;AACtE,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,MAAA,OAAO,MAAA;AAAA,IACT;AAEA,IAAA,IAAA,CAAK,IAAI,2CAA2C,CAAA;AACpD,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,WAAA,CAAY,QAAgB,IAAA,EAA6B;AACvD,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,QAAQ,IAAI,CAAA;AACnE,MAAA,IAAI,SAAA,KAAc,GAAG,OAAO,IAAA;AAC5B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA;AACxC,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,MAAA,OAAO,MAAA;AAAA,IACT;AAEA,IAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAC1C,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,WAAA,CAAY,QAAgB,IAAA,EAA6B;AACvD,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,QAAQ,IAAI,CAAA;AACnE,MAAA,IAAI,SAAA,KAAc,GAAG,OAAO,IAAA;AAC5B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA;AACxC,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,MAAA,OAAO,MAAA;AAAA,IACT;AAEA,IAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAC1C,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,KAAA,CAAM,MAAA,EAAgB,QAAA,EAAkB,IAAA,EAAoC;AAC1E,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,kBAAA,EAAoB;AACnD,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,QAAQ,CAAA;AACzC,MAAA,IAAI,OAAA;AACJ,MAAA,IAAI,QAAA;AAEJ,MAAA,IAAI,OAAO,SAAS,QAAA,EAAU;AAC5B,QAAA,MAAM,KAAA,GAAQ,IAAI,WAAA,EAAY,CAAE,OAAO,IAAI,CAAA;AAC3C,QAAA,QAAA,GAAW,KAAA,CAAM,MAAA;AACjB,QAAA,OAAA,GAAU,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,QAAQ,CAAA;AACtC,QAAA,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI,KAAA,EAAO,OAAO,CAAA;AAAA,MAChC,CAAA,MAAO;AACL,QAAA,QAAA,GAAW,IAAA,CAAK,MAAA;AAChB,QAAA,OAAA,GAAU,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,QAAQ,CAAA;AACtC,QAAA,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI,IAAA,EAAM,OAAO,CAAA;AAAA,MAC/B;AAEA,MAAA,IAAI;AACF,QAAA,OAAO,KAAK,MAAA,CAAO,kBAAA,CAAmB,QAAQ,OAAA,EAAS,OAAA,EAAS,QAAQ,CAAA,KAAM,CAAA;AAAA,MAChF,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AACzB,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,OAAO,CAAA;AAAA,MAC3B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,2BAA2B,CAAA;AACpC,IAAA,OAAO,KAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,aAAA,CACE,MAAA,EACA,cAAA,EACA,eAAA,EACA,eACA,cAAA,EACM;AACN,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,0BAAA,EAA4B;AAC3D,MAAA,IAAA,CAAK,OAAO,0BAAA,CAA2B,MAAA,EAAQ,cAAA,EAAgB,eAAA,EAAiB,eAAe,cAAc,CAAA;AAC7G,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,mCAAmC,CAAA;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,oBAAA,CAAqB,MAAA,EAAgB,CAAA,EAAW,CAAA,EAAW,OAAe,MAAA,EAAsB;AAC9F,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,iCAAA,EAAmC;AAClE,MAAA,IAAA,CAAK,OAAO,iCAAA,CAAkC,MAAA,EAAQ,CAAA,EAAG,CAAA,EAAG,OAAO,MAAM,CAAA;AACzE,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,0CAA0C,CAAA;AAAA,EACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,wBAAwB,MAAA,EAA+B;AACrD,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,oCAAA,EAAsC;AACrE,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,MAAA,CAAO,oCAAA,CAAqC,MAAM,CAAA;AACzE,MAAA,IAAI,SAAA,KAAc,GAAG,OAAO,IAAA;AAC5B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,UAAA,CAAW,SAAS,CAAA;AACxC,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,SAAS,CAAA;AAC3B,MAAA,OAAO,MAAA;AAAA,IACT;AAEA,IAAA,IAAA,CAAK,IAAI,6CAA6C,CAAA;AACtD,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,qBAAqB,MAAA,EAAwB;AAC3C,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,iCAAA,EAAmC;AAClE,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,iCAAA,CAAkC,MAAM,CAAA;AAAA,IAC7D;AAEA,IAAA,IAAA,CAAK,IAAI,0CAA0C,CAAA;AACnD,IAAA,OAAO,EAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,qBAAA,CAAsB,MAAA,EAAgB,MAAA,EAAgB,OAAA,EAAwB;AAC5E,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,kCAAA,EAAoC;AACnE,MAAA,IAAA,CAAK,OAAO,kCAAA,CAAmC,MAAA,EAAQ,MAAA,EAAQ,OAAA,GAAU,IAAI,CAAC,CAAA;AAC9E,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,2CAA2C,CAAA;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYA,WAAA,CAAY,QAAgB,IAAA,EAA4C;AACtE,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,CAAC,CAAA;AACpC,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,CAAC,CAAA;AACpC,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,MAAA,EAAQ,IAAA,EAAM,QAAQ,MAAM,CAAA;AACjE,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,MAAA,CAAO,MAAA,IAAU,CAAC,CAAA,IAAK,CAAA;AACxC,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,MAAA,CAAO,MAAA,IAAU,CAAC,CAAA,IAAK,CAAA;AACxC,QAAA,OAAO,EAAE,KAAK,GAAA,EAAI;AAAA,MACpB,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,MAAM,CAAA;AACxB,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,MAAM,CAAA;AAAA,MAC1B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAC1C,IAAA,OAAO,EAAE,GAAA,EAAK,CAAA,EAAG,GAAA,EAAK,CAAA,EAAE;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,YAAY,MAAA,EAAwB;AAClC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,MAAM,CAAA;AAAA,IACpD;AAEA,IAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAC1C,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,WAAA,CAAY,QAAgB,IAAA,EAAoB;AAC9C,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,IAAA,CAAK,GAAA,CAAI,CAAA,6BAAA,EAAgC,IAAI,CAAA,CAAE,CAAA;AAC/C,MAAA,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,MAAA,EAAQ,IAAI,CAAA;AACjD,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,WAAW,MAAA,EAAwB;AACjC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,uBAAA,EAAyB;AACxD,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,uBAAA,CAAwB,MAAM,CAAA;AACzD,MAAA,IAAA,CAAK,GAAA,CAAI,CAAA,yBAAA,EAA4B,MAAM,CAAA,CAAE,CAAA;AAC7C,MAAA,OAAO,MAAA;AAAA,IACT;AAEA,IAAA,IAAA,CAAK,IAAI,gCAAgC,CAAA;AACzC,IAAA,OAAO,EAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,qBAAA,CAAsB,QAAgB,OAAA,EAAyB;AAC7D,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,kCAAA,EAAoC;AACnE,MAAA,MAAM,UAAA,GAAa,IAAA,CAAK,WAAA,CAAY,OAAO,CAAA;AAC3C,MAAA,IAAI;AACF,QAAA,MAAM,MAAA,GAAS,IAAA,CAAK,MAAA,CAAO,kCAAA,CAAmC,QAAQ,UAAU,CAAA;AAChF,QAAA,IAAA,CAAK,GAAA,CAAI,CAAA,oCAAA,EAAuC,MAAM,CAAA,CAAE,CAAA;AACxD,QAAA,OAAO,MAAA;AAAA,MACT,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,MAAA,CAAO,MAAM,UAAU,CAAA;AAAA,MAC9B;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,2CAA2C,CAAA;AACpD,IAAA,OAAO,EAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,WAAA,CAAY,QAAgB,MAAA,EAAsB;AAChD,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,wBAAA,EAA0B;AACzD,MAAA,IAAA,CAAK,GAAA,CAAI,CAAA,6BAAA,EAAgC,MAAM,CAAA,CAAE,CAAA;AACjD,MAAA,IAAA,CAAK,MAAA,CAAO,wBAAA,CAAyB,MAAA,EAAQ,MAAM,CAAA;AACnD,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,iCAAiC,CAAA;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,OAAA,CAAQ,QAAgB,MAAA,EAAsB;AAC5C,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,oBAAA,EAAsB;AACrD,MAAA,IAAA,CAAK,GAAA,CAAI,CAAA,gCAAA,EAAmC,MAAM,CAAA,CAAE,CAAA;AACpD,MAAA,IAAA,CAAK,MAAA,CAAO,oBAAA,CAAqB,MAAA,EAAQ,MAAM,CAAA;AAC/C,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,IAAI,6BAA6B,CAAA;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,QAAQ,MAAA,EAAwB;AAC9B,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,oBAAA,EAAsB;AACrD,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,oBAAA,CAAqB,MAAM,CAAA;AAAA,IAChD;AAEA,IAAA,IAAA,CAAK,IAAI,6BAA6B,CAAA;AACtC,IAAA,OAAO,EAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,cAAc,MAAA,EAAwB;AACpC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,0BAAA,EAA4B;AAC3D,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,0BAAA,CAA2B,MAAM,CAAA;AAAA,IACtD;AAEA,IAAA,IAAA,CAAK,IAAI,mCAAmC,CAAA;AAC5C,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,gBAAA,GAAyB;AACvB,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,qBAAA,EAAuB;AACtD,MAAA,IAAA,CAAK,OAAO,qBAAA,EAAsB;AAClC,MAAA,IAAA,CAAK,IAAI,wCAAwC,CAAA;AAAA,IACnD,CAAA,MAAO;AACL,MAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAAA,IACjD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,iBAAA,GAA0B;AACxB,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,sBAAA,EAAwB;AACvD,MAAA,IAAA,CAAK,OAAO,sBAAA,EAAuB;AACnC,MAAA,IAAA,CAAK,IAAI,0CAA0C,CAAA;AAAA,IACrD,CAAA,MAAO;AACL,MAAA,IAAA,CAAK,IAAI,uCAAuC,CAAA;AAAA,IAClD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,iBAAiB,MAAA,EAAsB;AACrC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,6BAAA,EAA+B;AAC9D,MAAA,IAAA,CAAK,MAAA,CAAO,8BAA8B,MAAM,CAAA;AAChD,MAAA,IAAA,CAAK,IAAI,uCAAuC,CAAA;AAAA,IAClD,CAAA,MAAO;AACL,MAAA,IAAA,CAAK,IAAI,sCAAsC,CAAA;AAAA,IACjD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,mBAAmB,MAAA,EAAsB;AACvC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,+BAAA,EAAiC;AAChE,MAAA,IAAA,CAAK,MAAA,CAAO,gCAAgC,MAAM,CAAA;AAClD,MAAA,IAAA,CAAK,IAAI,2CAA2C,CAAA;AAAA,IACtD,CAAA,MAAO;AACL,MAAA,IAAA,CAAK,IAAI,wCAAwC,CAAA;AAAA,IACnD;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,iBAAA,GAA6B;AAC3B,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,sBAAA,EAAwB;AACvD,MAAA,OAAO,IAAA,CAAK,MAAA,CAAO,sBAAA,EAAuB,KAAM,CAAA;AAAA,IAClD;AACA,IAAA,OAAO,KAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,qBAAA,GAAgC;AAC9B,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,0BAAA,EAA4B;AAC3D,MAAA,OAAO,IAAA,CAAK,OAAO,0BAAA,EAA2B;AAAA,IAChD;AACA,IAAA,OAAO,CAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,YAAA,GAAwC;AACtC,IAAA,IAAI,CAAC,IAAA,CAAK,QAAA,IAAY,CAAC,IAAA,CAAK,OAAO,iBAAA,EAAmB;AACpD,MAAA,OAAO,IAAA;AAAA,IACT;AAEA,IAAA,MAAM,UAAA,GAAa,IAAA;AACnB,IAAA,MAAM,aAAA,GAAgB,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,UAAU,CAAA;AACpD,IAAA,MAAM,gBAAA,GAAmB,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,CAAC,CAAA;AAE9C,IAAA,IAAI;AACF,MAAA,MAAM,YAAY,IAAA,CAAK,MAAA,CAAO,iBAAA,CAAkB,aAAA,EAAe,YAAY,gBAAgB,CAAA;AAE3F,MAAA,IAAI,cAAc,CAAA,CAAA,EAAI;AACpB,QAAA,OAAO,IAAA;AAAA,MACT;AAGA,MAAA,MAAM,gBAAgB,IAAA,CAAK,MAAA,CAAO,MAAA,CAAO,gBAAA,IAAoB,CAAC,CAAA,IAAK,CAAA;AAGnE,MAAA,IAAI,OAAA,GAAU,EAAA;AACd,MAAA,IAAI,gBAAgB,CAAA,EAAG;AAGrB,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,GAAA,CAAI,aAAA,EAAe,aAAa,CAAC,CAAA;AAClD,QAAA,MAAM,QAAQ,IAAA,CAAK,MAAA,CAAO,OAAO,KAAA,CAAM,aAAA,EAAe,gBAAgB,GAAG,CAAA;AACzE,QAAA,OAAA,GAAU,WAAA,CAAY,OAAO,KAAK,CAAA;AAAA,MACpC;AAEA,MAAA,OAAO;AAAA,QACL,IAAA,EAAM,SAAA;AAAA,QACN,QAAA,EAAU,oBAAoB,SAAS,CAAA;AAAA,QACvC;AAAA,OACF;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,aAAa,CAAA;AAC/B,MAAA,IAAA,CAAK,MAAA,CAAO,MAAM,gBAAgB,CAAA;AAAA,IACpC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,gBAAA,GAAuC;AACrC,IAAA,MAAM,SAA6B,EAAC;AACpC,IAAA,IAAI,KAAA,GAAQ,KAAK,YAAA,EAAa;AAC9B,IAAA,OAAO,UAAU,IAAA,EAAM;AACrB,MAAA,MAAA,CAAO,KAAK,KAAK,CAAA;AACjB,MAAA,KAAA,GAAQ,KAAK,YAAA,EAAa;AAAA,IAC5B;AACA,IAAA,OAAO,MAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAA,GAA2B;AACzB,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,uBAAA,EAAyB;AACxD,MAAA,IAAA,CAAK,OAAO,uBAAA,EAAwB;AACpC,MAAA,IAAA,CAAK,IAAI,mCAAmC,CAAA;AAAA,IAC9C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,eAAe,MAAA,EAAsB;AACnC,IAAA,IAAI,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,MAAM,0BAA0B,CAAA;AAE5D,IAAA,MAAM,OAAA,GAAU,CAAC,CAAC,IAAA,CAAK,MAAA,CAAO,mBAAA;AAC9B,IAAA,IAAA,CAAK,IAAI,CAAA,yBAAA,EAA4B,IAAA,CAAK,QAAQ,CAAA,6BAAA,EAAgC,OAAO,CAAA,CAAE,CAAA;AAE3F,IAAA,IAAI,IAAA,CAAK,QAAA,IAAY,IAAA,CAAK,MAAA,CAAO,mBAAA,EAAqB;AACpD,MAAA,IAAA,CAAK,MAAA,CAAO,oBAAoB,MAAM,CAAA;AACtC,MAAA,IAAA,CAAK,IAAI,mCAAmC,CAAA;AAAA,IAC9C,CAAA,MAAO;AACL,MAAA,IAAA,CAAK,IAAI,oCAAoC,CAAA;AAAA,IAC/C;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,gBAAA,GAAwC;AACtC,IAAA,MAAM,MAAA,uBAAa,GAAA,EAAoB;AACvC,IAAA,MAAM,MAAA,GAAS,KAAK,gBAAA,EAAiB;AAErC,IAAA,KAAA,MAAW,SAAS,MAAA,EAAQ;AAC1B,MAAA,IAAI,KAAA,CAAM,SAAS,0BAAA,EAA4B;AAE7C,QAAA,MAAM,OAAA,GAAU,KAAA,CAAM,OAAA,CAAQ,OAAA,CAAQ,GAAG,CAAA;AACzC,QAAA,IAAI,YAAY,EAAA,EAAI;AAClB,UAAA,MAAM,GAAA,GAAM,KAAA,CAAM,OAAA,CAAQ,SAAA,CAAU,GAAG,OAAO,CAAA;AAC9C,UAAA,MAAM,KAAA,GAAQ,KAAA,CAAM,OAAA,CAAQ,SAAA,CAAU,UAAU,CAAC,CAAA;AACjD,UAAA,MAAA,CAAO,GAAA,CAAI,KAAK,KAAK,CAAA;AAAA,QACvB,CAAA,MAAO;AAEL,UAAA,MAAA,CAAO,GAAA,CAAI,KAAA,CAAM,OAAA,EAAS,EAAE,CAAA;AAAA,QAC9B;AAAA,MACF;AAAA,IACF;AAEA,IAAA,OAAO,MAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,eAAA,CAAgB,MAAA,EAAgB,CAAA,EAAW,CAAA,EAA0B;AAEnE,IAAA,IAAA,CAAK,eAAe,MAAA,EAAQ,yBAAA,EAA2B,GAAG,CAAA,EAAG,CAAA,EAAG,GAAG,CAAC,CAAA;AACpE,IAAA,IAAA,CAAK,eAAe,MAAA,EAAQ,uBAAA,EAAyB,GAAG,CAAA,EAAG,CAAA,EAAG,GAAG,CAAC,CAAA;AAGlE,IAAA,OAAO,IAAA,CAAK,gBAAA,CAAiB,MAAA,EAAQ,0BAA0B,CAAA;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,qBAAA,CAAsB,MAAA,EAAgB,CAAA,EAAW,CAAA,EAA0B;AAEzE,IAAA,IAAA,CAAK,eAAe,MAAA,EAAQ,yBAAA,EAA2B,GAAG,CAAA,EAAG,CAAA,EAAG,GAAG,CAAC,CAAA;AACpE,IAAA,IAAA,CAAK,eAAe,MAAA,EAAQ,uBAAA,EAAyB,GAAG,CAAA,EAAG,CAAA,EAAG,GAAG,CAAC,CAAA;AAGlE,IAAA,OAAO,IAAA,CAAK,gBAAA,CAAiB,MAAA,EAAQ,0BAA0B,CAAA;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,UAAU,MAAA,EAAsB;AAC9B,IAAA,IAAA,CAAK,cAAA,CAAe,QAAQ,gBAAgB,CAAA;AAAA,EAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,WAAW,MAAA,EAA+B;AACxC,IAAA,IAAA,CAAK,GAAA,CAAI,CAAA,+BAAA,EAAkC,MAAM,CAAA,CAAE,CAAA;AACnD,IAAA,IAAA,CAAK,UAAU,MAAM,CAAA;AACrB,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,gBAAA,CAAiB,MAAA,EAAQ,0BAA0B,CAAA;AACrE,IAAA,IAAA,CAAK,IAAI,CAAA,kBAAA,EAAqB,IAAA,EAAM,MAAM,CAAA,EAAG,GAAG,CAAC,CAAA,IAAA,CAAM,CAAA;AACvD,IAAA,IAAA,CAAK,eAAe,MAAM,CAAA;AAC1B,IAAA,OAAO,IAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,oBAAoB,aAAA,EAAuF;AACzG,IAAA,IAAI,CAAC,aAAA,EAAe,OAAO,EAAC;AAE5B,IAAA,OAAO,aAAA,CAAc,KAAA,CAAM,GAAG,CAAA,CAAE,MAAA,CAAO,CAAA,CAAA,KAAK,CAAA,CAAE,IAAA,EAAM,CAAA,CAAE,GAAA,CAAI,CAAA,IAAA,KAAQ;AAChE,MAAA,MAAM,QAAQ,IAAA,CAAK,KAAA,CAAM,GAAG,CAAA,CAAE,IAAI,MAAM,CAAA;AACxC,MAAA,OAAO;AAAA,QACL,CAAA,EAAG,KAAA,CAAM,CAAC,CAAA,IAAK,CAAA;AAAA,QACf,CAAA,EAAG,KAAA,CAAM,CAAC,CAAA,IAAK,CAAA;AAAA,QACf,KAAA,EAAO,KAAA,CAAM,CAAC,CAAA,IAAK,CAAA;AAAA,QACnB,MAAA,EAAQ,KAAA,CAAM,CAAC,CAAA,IAAK;AAAA,OACtB;AAAA,IACF,CAAC,CAAA;AAAA,EACH;AACF,CAAA;;;ACluDO,IAAM,uBAAN,MAA4D;AAAA,EACzD,MAAA,GAAkC,IAAA;AAAA,EAClC,WAAA,GAAkC,IAAA;AAAA,EAClC,WAAA,GAAc,KAAA;AAAA,EACd,YAAA,GAAe,KAAA;AAAA,EACf,OAAA;AAAA,EACA,SAAA,GAAY,KAAA;AAAA,EACZ,SAAA,GAAY,KAAA;AAAA,EAEpB,WAAA,CAAY,OAAA,GAAkC,EAAC,EAAG;AAChD,IAAA,IAAA,CAAK,OAAA,GAAU;AAAA,MACb,QAAA,EAAU,QAAA;AAAA,MACV,OAAA,EAAS,KAAA;AAAA,MACT,GAAG;AAAA,KACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,kBAAkB,KAAA,EAAgC;AACxD,IAAA,MAAM,GAAA,GAAM,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,KAAA;AACrD,IAAA,OAAO,IAAI,QAAA,CAAS,6BAA6B,KAC/C,GAAA,CAAI,QAAA,CAAS,+BAA+B,CAAA,IAC5C,GAAA,CAAI,QAAA,CAAS,aAAa,KAC1B,GAAA,CAAI,QAAA,CAAS,8BAA8B,CAAA,IAC3C,GAAA,CAAI,SAAS,eAAe,CAAA;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAA,GAA8B;AAClC,IAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,MAAA,OAAA,CAAQ,IAAI,4DAA4D,CAAA;AAAA,IAC1E;AAGA,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,YAAY,OAAA,EAAQ;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AAAA,IACrB;AACA,IAAA,IAAA,CAAK,MAAA,GAAS,IAAA;AACd,IAAA,IAAA,CAAK,WAAA,GAAc,KAAA;AACnB,IAAA,IAAA,CAAK,SAAA,GAAY,KAAA;AAGjB,IAAA,MAAM,KAAK,UAAA,EAAW;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,qBAAqB,MAAA,EAAyC;AAClE,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA;AAAA,IACF;AAEA,IAAA,IAAI,KAAK,YAAA,EAAc;AACrB,MAAA,OAAO,KAAK,YAAA,EAAc;AACxB,QAAA,MAAM,IAAI,OAAA,CAAQ,CAACC,aAAY,UAAA,CAAWA,QAAAA,EAAS,GAAG,CAAC,CAAA;AAAA,MACzD;AACA,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,YAAA,GAAe,IAAA;AAEpB,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,MAAA,GAAS,MAAA;AAGd,MAAA,IAAA,CAAK,eAAA,EAAgB;AAGrB,MAAA,IAAA,CAAK,wBAAA,EAAyB;AAE9B,MAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AACnB,MAAA,IAAA,CAAK,QAAQ,OAAA,IAAU;AAAA,IACzB,SAAS,KAAA,EAAO;AACd,MAAA,OAAA,CAAQ,KAAA,CAAM,gDAAgD,KAAK,CAAA;AACnE,MAAA,MAAM,SAAA,GACJ,KAAA,YAAiB,eAAA,GACb,KAAA,GACA,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAEJ,CAAA,kCAAA,EAAqC,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,OACpD;AACJ,MAAA,IAAA,CAAK,OAAA,CAAQ,UAAU,SAAS,CAAA;AAChC,MAAA,MAAM,SAAA;AAAA,IACR,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,YAAA,GAAe,KAAA;AAAA,IACtB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAA,GAA4B;AAChC,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA;AAAA,IACF;AAEA,IAAA,IAAI,KAAK,YAAA,EAAc;AACrB,MAAA,OAAO,KAAK,YAAA,EAAc;AACxB,QAAA,MAAM,IAAI,OAAA,CAAQ,CAACA,aAAY,UAAA,CAAWA,QAAAA,EAAS,GAAG,CAAC,CAAA;AAAA,MACzD;AACA,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,YAAA,GAAe,IAAA;AACpB,IAAA,IAAA,CAAK,YAAA,CAAa,SAAA,EAAW,CAAA,EAAG,oCAAoC,CAAA;AAEpE,IAAA,IAAI;AAEF,MAAA,IAAA,CAAK,MAAA,GAAS,MAAM,IAAA,CAAK,UAAA,EAAW;AAEpC,MAAA,IAAA,CAAK,YAAA,CAAa,cAAA,EAAgB,EAAA,EAAI,kCAAkC,CAAA;AAGxE,MAAA,IAAA,CAAK,eAAA,EAAgB;AAErB,MAAA,IAAA,CAAK,YAAA,CAAa,cAAA,EAAgB,EAAA,EAAI,gCAAgC,CAAA;AAGtE,MAAA,IAAA,CAAK,wBAAA,EAAyB;AAE9B,MAAA,IAAA,CAAK,YAAA,CAAa,cAAA,EAAgB,EAAA,EAAI,sBAAsB,CAAA;AAE5D,MAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AACnB,MAAA,IAAA,CAAK,YAAA,CAAa,UAAA,EAAY,GAAA,EAAK,mBAAmB,CAAA;AACtD,MAAA,IAAA,CAAK,QAAQ,OAAA,IAAU;AAAA,IACzB,SAAS,KAAA,EAAO;AACd,MAAA,OAAA,CAAQ,KAAA,CAAM,gDAAgD,KAAK,CAAA;AACnE,MAAA,MAAM,SAAA,GACJ,KAAA,YAAiB,eAAA,GACb,KAAA,GACA,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAEJ,CAAA,kCAAA,EAAqC,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,OACpD;AACJ,MAAA,IAAA,CAAK,OAAA,CAAQ,UAAU,SAAS,CAAA;AAChC,MAAA,MAAM,SAAA;AAAA,IACR,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,YAAA,GAAe,KAAA;AAAA,IACtB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,UAAA,GAAwC;AACpD,IAAA,OAAA,CAAQ,GAAA,CAAI,+CAAA,EAAiD,IAAA,CAAK,OAAA,CAAQ,QAAA,EAAU,KAAK,OAAA,CAAQ,UAAA,EAAY,IAAA,CAAK,OAAA,CAAQ,UAAU,CAAA;AAGpI,IAAA,IAAI,CAAC,IAAA,CAAK,OAAA,CAAQ,UAAA,EAAY;AAC5B,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OAGF;AAAA,IACF;AAGA,IAAA,MAAM,MAAA,GAAS;AAAA,MACb,OAAA,EAAS,KAAK,OAAA,CAAQ,OAAA;AAAA,MACtB,OAAO,IAAA,CAAK,OAAA,CAAQ,OAAA,GAAU,OAAA,CAAQ,MAAM,MAAM;AAAA,MAAE,CAAA;AAAA,MACpD,UAAU,IAAA,CAAK,OAAA,CAAQ,OAAA,GAAU,OAAA,CAAQ,QAAQ,MAAM;AAAA,MAAE,CAAA;AAAA,MACzD,UAAA,EAAY,CAAC,MAAA,EAAgB,OAAA,EAAiB,OAAA,KAAoB;AAEhE,QAAA,IAAA,CAAK,YAAA,CAAa,SAAA,EAAW,OAAA,EAAS,OAAO,CAAA;AAAA,MAC/C;AAAA,KACF;AAEA,IAAA,OAAO,MAAM,IAAA,CAAK,OAAA,CAAQ,UAAA,CAAW,aAAa,MAAM,CAAA;AAAA,EAC1D;AAAA;AAAA;AAAA;AAAA,EAKQ,eAAA,GAAwB;AAC9B,IAAA,IAAI,CAAC,IAAA,CAAK,MAAA,EAAQ,EAAA,EAAI;AACpB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,MAAM,QAAA,GAAW,CAAC,OAAA,KAAoB;AACpC,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,OAAO,CAAA;AAAA,MACpB,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF,CAAA;AAEA,IAAA,QAAA,CAAS,MAAM,CAAA;AACf,IAAA,QAAA,CAAS,YAAY,CAAA;AACrB,IAAA,QAAA,CAAS,aAAa,CAAA;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKQ,wBAAA,GAAiC;AACvC,IAAA,IAAI,CAAC,KAAK,MAAA,EAAQ;AAChB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAGA,IAAA,IAAI,IAAA,CAAK,OAAA,CAAQ,OAAA,IAAW,IAAA,CAAK,OAAO,EAAA,EAAI;AAC1C,MAAA,MAAMC,KAAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAKzB,MAAA,IAAI,CAAC,KAAK,SAAA,EAAW;AACnB,QAAA,IAAA,CAAK,SAAA,GAAY,IAAA;AAEjB,QAAA,IAAI,CAACA,MAAK,gBAAA,EAAkB;AAC1B,UAAAA,MAAK,gBAAA,GAAmB;AAAA,YACtB,MAAA,EAAQ,CAAC,QAAA,KAAqB;AAC5B,cAAA,OAAA,CAAQ,GAAA,CAAI,aAAa,QAAQ,CAAA;AAAA,YACnC,CAAA;AAAA,YACA,UAAA,EAAY,CAAC,QAAA,KAAqB;AAChC,cAAA,OAAA,CAAQ,GAAA,CAAI,kBAAkB,QAAQ,CAAA;AAAA,YACxC;AAAA,WACF;AAAA,QACF;AAEA,QAAA,IAAI,OAAOA,KAAAA,CAAK,IAAA,KAAS,UAAA,EAAY;AACnC,UAAA,MAAM,YAAA,GAAeA,KAAAA,CAAK,IAAA,CAAK,IAAA,CAAKA,KAAI,CAAA;AACxC,UAAAA,KAAAA,CAAK,IAAA,IAAQ,CAAC,QAAA,EAAkB,OAAiB,IAAA,KAAmB;AAClE,YAAA,OAAA,CAAQ,GAAA,CAAI,kBAAkB,QAAQ,CAAA;AACtC,YAAA,IAAI;AACF,cAAA,OAAO,YAAA,CAAa,QAAA,EAAU,KAAA,EAAgB,IAAa,CAAA;AAAA,YAC7D,SAAS,GAAA,EAAK;AACZ,cAAA,MAAM,KAAA,GAAQ,GAAA;AACd,cAAA,IAAI,KAAA,EAAO,SAAS,QAAA,EAAU;AAC5B,gBAAA,OAAA,CAAQ,GAAA,CAAI,eAAe,QAAQ,CAAA;AAAA,cACrC;AACA,cAAA,MAAM,GAAA;AAAA,YACR;AAAA,UACF,CAAA,CAAA;AAAA,QACF;AAAA,MACF;AAEA,MAAA,MAAM,MAAA,GAAS,CAAC,KAAA,EAAe,OAAA,KAAoB;AACjD,QAAA,IAAI;AACF,UAAA,OAAA,CAAQ,IAAI,CAAA,KAAA,EAAQ,KAAK,KAAKA,KAAAA,CAAK,OAAA,CAAQ,OAAO,CAAC,CAAA;AAAA,QACrD,SAAS,CAAA,EAAG;AACV,UAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,KAAA,EAAQ,KAAK,CAAA,SAAA,CAAA,EAAc,EAAY,OAAO,CAAA;AAAA,QAC5D;AAAA,MACF,CAAA;AAEA,MAAA,MAAA,CAAO,QAAQ,GAAG,CAAA;AAClB,MAAA,MAAA,CAAO,eAAe,kBAAkB,CAAA;AACxC,MAAA,MAAA,CAAO,aAAa,gBAAgB,CAAA;AACpC,MAAA,MAAA,CAAO,gBAAgB,yBAAyB,CAAA;AAChD,MAAA,MAAA,CAAO,cAAc,uBAAuB,CAAA;AAC5C,MAAA,MAAA,CAAO,cAAc,mCAAmC,CAAA;AACxD,MAAA,MAAA,CAAO,iBAAiB,0CAA0C,CAAA;AAClE,MAAA,MAAA,CAAO,mBAAmB,oDAAoD,CAAA;AAAA,IAChF;AAIA,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AACzB,IAAA,MAAM,SAAA,GAAY,CAAC,OAAA,KAAoB;AACrC,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,OAAO,CAAA;AAClB,QAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,UAAA,OAAA,CAAQ,GAAA,CAAI,2BAA2B,OAAO,CAAA;AAAA,QAChD;AAAA,MACF,SAAS,CAAA,EAAG;AAEV,QAAA,MAAM,GAAA,GAAM,CAAA;AACZ,QAAA,IAAI,GAAA,CAAI,SAAS,QAAA,EAAU;AACzB,UAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,YAAA,OAAA,CAAQ,GAAA,CAAI,oBAAA,EAAsB,OAAA,EAAU,CAAA,CAAY,OAAO,CAAA;AAAA,UACjE;AAAA,QACF;AAAA,MACF;AAAA,IACF,CAAA;AAGA,IAAA,SAAA,CAAU,eAAe,CAAA;AACzB,IAAA,SAAA,CAAU,oBAAoB,CAAA;AAC9B,IAAA,SAAA,CAAU,kCAAkC,CAAA;AAC5C,IAAA,SAAA,CAAU,2CAA2C,CAAA;AACrD,IAAA,SAAA,CAAU,6CAA6C,CAAA;AACvD,IAAA,SAAA,CAAU,wBAAwB,CAAA;AAClC,IAAA,SAAA,CAAU,6BAA6B,CAAA;AAGvC,IAAA,IAAA,CAAK,cAAc,IAAI,WAAA,CAAY,KAAK,MAAA,EAAQ,IAAA,CAAK,QAAQ,OAAO,CAAA;AAEpE,IAAA,IAAI;AAEF,MAAA,IAAA,CAAK,WAAA,CAAY,WAAW,kBAAkB,CAAA;AAE9C,MAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,QAAA,MAAM,WAAA,GAAc,IAAA,CAAK,WAAA,CAAY,cAAA,EAAe;AACpD,QAAA,IAAI,WAAA,EAAa;AACf,UAAA,OAAA,CAAQ,GAAA,CAAI,kBAAkB,WAAW,CAAA;AAAA,QAC3C;AAAA,MACF;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER,CAAA,qCAAA,EAAwC,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,OACvD;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAA,CACJ,KAAA,EACA,OAAA,EACA,WAAW,UAAA,EACgB;AAE3B,IAAA,IAAI,KAAK,SAAA,EAAW;AAClB,MAAA,MAAM,KAAK,YAAA,EAAa;AAAA,IAC1B;AAEA,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,KAAK,GAAA,EAAI;AAC3B,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAE3C,IAAA,IAAI,SAAA,CAAU,WAAW,CAAA,EAAG;AAC1B,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,WAAW,OAAA,CAAQ,WAAA,IAAe,IAAA,CAAK,wBAAA,CAAyB,QAAQ,CAAA,IAAK,MAAA;AACnF,IAAA,MAAM,YAAY,OAAA,CAAQ,YAAA;AAE1B,IAAA,IAAI,CAAC,cAAA,CAAe,SAAS,CAAA,EAAG;AAC9B,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,oBAAA;AAAA,QAER,8BAA8B,SAAS,CAAA;AAAA,OACzC;AAAA,IACF;AAGA,IAAA,IAAI,CAAC,iBAAA,CAAkB,QAAA,EAAU,SAAS,CAAA,EAAG;AAC3C,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,oBAAA;AAAA,QAER,yBAAA,CAA0B,UAAU,SAAS;AAAA,OAC/C;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,kBAAkB,QAAQ,CAAA,CAAA;AAC5C,IAAA,MAAM,UAAA,GAAa,mBAAmB,SAAS,CAAA,CAAA;AAE/C,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAA,CAAa,YAAA,EAAc,EAAA,EAAI,2BAA2B,CAAA;AAG/D,MAAA,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,SAAA,CAAU,SAAA,EAAW,SAAS,CAAA;AAE7C,MAAA,IAAA,CAAK,YAAA,CAAa,YAAA,EAAc,EAAA,EAAI,wBAAwB,CAAA;AAG5D,MAAA,MAAM,SAAS,MAAM,IAAA,CAAK,iBAAA,CAAkB,SAAA,EAAW,YAAY,OAAO,CAAA;AAE1E,MAAA,IAAA,CAAK,YAAA,CAAa,UAAA,EAAY,GAAA,EAAK,qBAAqB,CAAA;AAExD,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,WAAA,CAAY,QAAQ,CAAA;AAC1C,MAAA,MAAM,cAAA,GAAiB,CAAA,EAAG,QAAQ,CAAA,CAAA,EAAI,SAAS,CAAA,CAAA;AAE/C,MAAA,OAAO;AAAA,QACL,IAAA,EAAM,MAAA;AAAA,QACN,QAAA,EAAU,kBAAkB,SAAS,CAAA;AAAA,QACrC,QAAA,EAAU,cAAA;AAAA,QACV,QAAA,EAAU,IAAA,CAAK,GAAA,EAAI,GAAI;AAAA,OACzB;AAAA,IACF,SAAS,KAAA,EAAO;AAEd,MAAA,IAAI,KAAA,YAAiB,KAAA,IAAS,IAAA,CAAK,iBAAA,CAAkB,KAAK,CAAA,EAAG;AAC3D,QAAA,IAAA,CAAK,SAAA,GAAY,IAAA;AACjB,QAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,UAAA,OAAA,CAAQ,IAAI,+EAA+E,CAAA;AAAA,QAC7F;AAAA,MACF;AACA,MAAA,MAAM,KAAA;AAAA,IACR,CAAA,SAAE;AAEA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAA,EAAQ,EAAA,CAAG,MAAA,CAAO,SAAS,CAAA;AAAA,MAClC,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAA,EAAQ,EAAA,CAAG,MAAA,CAAO,UAAU,CAAA;AAAA,MACnC,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,iBAAA,CACZ,SAAA,EACA,UAAA,EACA,OAAA,EACqB;AACrB,IAAA,IAAI,CAAC,IAAA,CAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,YAAA,CAAa,YAAA,EAAc,EAAA,EAAI,qBAAqB,CAAA;AAEzD,IAAA,IAAI,MAAA,GAAS,CAAA;AAEb,IAAA,IAAI;AAEF,MAAA,MAAM,WAAA,GAAc,gBAAA,CAAiB,OAAA,CAAQ,WAAA,EAAa,QAAQ,QAAQ,CAAA;AAG1E,MAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,QAAA,IAAI;AACF,UAAA,MAAM,IAAA,GAAO,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,KAAK,SAAS,CAAA;AAC1C,UAAA,OAAA,CAAQ,GAAA,CAAI,wCAAA,EAA0C,SAAA,EAAW,OAAA,EAAS,KAAK,IAAI,CAAA;AAAA,QACrF,SAAS,CAAA,EAAG;AACV,UAAA,OAAA,CAAQ,GAAA,CAAI,2CAAA,EAA6C,SAAA,EAAY,CAAA,CAAY,OAAO,CAAA;AAAA,QAC1F;AACA,QAAA,IAAI,WAAA,EAAa;AACf,UAAA,OAAA,CAAQ,GAAA,CAAI,iCAAiC,WAAW,CAAA;AAAA,QAC1D;AAAA,MACF;AAGA,MAAA,IAAI,WAAA,EAAa;AACf,QAAA,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,uBAAA,CAAwB,SAAA,EAAW,WAAW,CAAA;AAAA,MAC1E,CAAA,MAAO;AACL,QAAA,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAAA,MAClD;AAEA,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,YAAA,CAAa,YAAA,EAAc,EAAA,EAAI,sBAAsB,CAAA;AAG1D,MAAA,MAAM,SAAA,GAAY,oBAAA,CAAqB,OAAA,CAAQ,YAAY,CAAA;AAG3D,MAAA,IAAI,aAAA,GAAgB,qBAAA,CAAsB,OAAA,CAAQ,YAAY,CAAA,IAAK,EAAA;AAGnE,MAAA,IAAI,OAAA,CAAQ,YAAA,KAAiB,KAAA,IAAS,OAAA,CAAQ,GAAA,EAAK;AACjD,QAAA,MAAM,UAAoB,EAAC;AAC3B,QAAA,IAAI,OAAA,CAAQ,IAAI,SAAA,EAAW;AACzB,UAAA,MAAM,QAAA,GAAmC;AAAA,YACvC,UAAA,EAAY,CAAA;AAAA,YACZ,UAAA,EAAY,CAAA;AAAA,YACZ,UAAA,EAAY;AAAA,WACd;AACA,UAAA,OAAA,CAAQ,IAAA,CAAK,oBAAoB,QAAA,CAAS,OAAA,CAAQ,IAAI,SAAS,CAAA,IAAK,CAAC,CAAA,CAAE,CAAA;AAAA,QACzE;AACA,QAAA,IAAI,OAAA,CAAQ,GAAA,CAAI,OAAA,KAAY,KAAA,CAAA,EAAW;AACrC,UAAA,OAAA,CAAQ,IAAA,CAAK,CAAA,QAAA,EAAW,OAAA,CAAQ,GAAA,CAAI,OAAO,CAAA,CAAE,CAAA;AAAA,QAC/C;AACA,QAAA,IAAI,OAAA,CAAQ,SAAS,CAAA,EAAG;AACtB,UAAA,aAAA,GAAgB,OAAA,CAAQ,KAAK,GAAG,CAAA;AAAA,QAClC;AAAA,MACF;AAGA,MAAA,IAAI,CAAC,KAAA,EAAO,KAAA,EAAO,KAAK,CAAA,CAAE,QAAA,CAAS,OAAA,CAAQ,YAAY,CAAA,IAAK,OAAA,CAAQ,KAAA,EAAO,SAAA,KAAc,KAAA,CAAA,EAAW;AAElG,QAAA,MAAM,OAAA,GAAU,OAAA,CAAQ,KAAA,CAAM,SAAA,GAAY,CAAA;AAC1C,QAAA,IAAI,aAAA,EAAe;AACjB,UAAA,aAAA,IAAiB,CAAA,WAAA,EAAc,OAAO,CAAA,CAAA,EAAI,OAAO,CAAA,CAAA;AAAA,QACnD,CAAA,MAAO;AACL,UAAA,aAAA,GAAgB,CAAA,UAAA,EAAa,OAAO,CAAA,CAAA,EAAI,OAAO,CAAA,CAAA;AAAA,QACjD;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,YAAA,CAAa,YAAA,EAAc,EAAA,EAAI,oBAAoB,CAAA;AAGxD,MAAA,IAAA,CAAK,WAAA,CAAY,cAAA,CAAe,MAAA,EAAQ,UAAA,EAAY,WAAW,aAAa,CAAA;AAE5E,MAAA,IAAA,CAAK,YAAA,CAAa,YAAA,EAAc,EAAA,EAAI,mBAAmB,CAAA;AAGvD,MAAA,IAAI;AACF,QAAA,MAAM,UAAA,GAAa,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,SAAS,UAAU,CAAA;AAErD,QAAA,IAAI,UAAA,CAAW,WAAW,CAAA,EAAG;AAC3B,UAAA,MAAM,IAAI,eAAA;AAAA,YAAA,mBAAA;AAAA,YAER;AAAA,WACF;AAAA,QACF;AAEA,QAAA,OAAO,UAAA;AAAA,MACT,SAAS,OAAA,EAAS;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,mBAAA;AAAA,UAER,CAAA,+BAAA,EAAkC,MAAA,CAAO,OAAO,CAAC,CAAA;AAAA,SACnD;AAAA,MACF;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,IAAI,iBAAiB,eAAA,EAAiB;AACpC,QAAA,MAAM,KAAA;AAAA,MACR;AACA,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,mBAAA;AAAA,QAER,CAAA,mBAAA,EAAsB,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,OACrC;AAAA,IACF,CAAA,SAAE;AAEA,MAAA,IAAI,MAAA,KAAW,CAAA,IAAK,IAAA,CAAK,WAAA,EAAa;AACpC,QAAA,IAAI;AACF,UAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,QACzC,CAAA,CAAA,MAAQ;AAAA,QAER;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAA,CACJ,KAAA,EACA,OAAA,EACA,aAAA,GAA+B,EAAC,EACR;AACxB,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAA,CAAe,OAAA,CAAQ,WAAA,IAAe,MAAA,EAAQ,WAAA,EAAY;AAChE,IAAA,MAAM,KAAA,GAAQ,cAAc,KAAA,IAAS,GAAA;AACrC,IAAA,MAAM,MAAA,GAAS,cAAc,MAAA,IAAU,CAAA;AACvC,IAAA,MAAM,WAAA,GAAc,aAAA,CAAc,WAAA,IAAe,EAAC;AAElD,IAAA,MAAM,SAAA,GAAY,oBAAoB,WAAW,CAAA,CAAA;AACjD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,cAAc,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAE9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AACtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,WAAA,CAAY,gBAAA,CAAiB,MAAM,CAAA;AACzD,QAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,UAAA,OAAA,CAAQ,GAAA,CAAI,CAAA,uBAAA,EAA0B,QAAQ,CAAA,YAAA,CAAc,CAAA;AAAA,QAC9D;AAEA,QAAA,MAAM,aAAA,GACJ,YAAY,MAAA,GAAS,CAAA,GACjB,YAAY,MAAA,CAAO,CAAC,CAAA,KAAM,CAAA,IAAK,CAAA,IAAK,CAAA,GAAI,QAAQ,CAAA,GAChD,KAAA,CAAM,KAAK,EAAE,MAAA,EAAQ,UAAS,EAAG,CAAC,CAAA,EAAG,CAAA,KAAM,CAAC,CAAA;AAElD,QAAA,MAAM,UAAyB,EAAC;AAChC,QAAA,MAAM,QAAA,GAAW,cAAc,QAAA,IAAY,KAAA;AAE3C,QAAA,KAAA,MAAW,aAAa,aAAA,EAAe;AACrC,UAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,YAAA,OAAA,CAAQ,IAAI,CAAA,yBAAA,EAA4B,SAAA,GAAY,CAAC,CAAA,CAAA,EAAI,QAAQ,CAAA,CAAE,CAAA;AAAA,UACrE;AAEA,UAAA,MAAM,OAAA,GAAU,KAAK,WAAA,CAAY,UAAA,CAAW,QAAQ,SAAA,EAAW,KAAA,EAAO,QAAQ,QAAQ,CAAA;AACtF,UAAA,OAAA,CAAQ,IAAA,CAAK;AAAA,YACX,IAAA,EAAM,SAAA;AAAA,YACN,MAAM,OAAA,CAAQ,IAAA;AAAA,YACd,OAAO,OAAA,CAAQ,KAAA;AAAA,YACf,QAAQ,OAAA,CAAQ;AAAA,WACjB,CAAA;AAAA,QACH;AAEA,QAAA,OAAO,OAAA;AAAA,MACT,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,cAAc,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,qBAAA,CACJ,KAAA,EACA,SACA,SAAA,EACA,aAAA,GAA0C,EAAC,EACV;AACjC,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAA,CAAe,OAAA,CAAQ,WAAA,IAAe,MAAA,EAAQ,WAAA,EAAY;AAChE,IAAA,MAAM,GAAA,GAAM,cAAc,GAAA,IAAO,GAAA;AACjC,IAAA,MAAM,eAAe,aAAA,CAAc,YAAA;AAEnC,IAAA,MAAM,SAAA,GAAY,wBAAwB,WAAW,CAAA,CAAA;AACrD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,kBAAkB,CAAA;AAAA,MAC/B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAE9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AACtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,WAAA,CAAY,gBAAA,CAAiB,MAAM,CAAA;AACzD,QAAA,IAAI,SAAA,GAAY,CAAA,IAAK,SAAA,IAAa,QAAA,EAAU;AAC1C,UAAA,MAAM,IAAI,eAAA;AAAA,YAAA,mBAAA;AAAA,YAER,CAAA,WAAA,EAAc,SAAS,CAAA,iBAAA,EAAoB,QAAA,GAAW,CAAC,CAAA,CAAA;AAAA,WACzD;AAAA,QACF;AAEA,QAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,UAAA,OAAA,CAAQ,GAAA,CAAI,gCAAgC,SAAA,GAAY,CAAC,IAAI,QAAQ,CAAA,IAAA,EAAO,GAAG,CAAA,IAAA,CAAM,CAAA;AAAA,QACvF;AAEA,QAAA,MAAM,QAAA,GAAW,cAAc,QAAA,IAAY,KAAA;AAC3C,QAAA,MAAM,OAAA,GAAU,KAAK,WAAA,CAAY,qBAAA,CAAsB,QAAQ,SAAA,EAAW,GAAA,EAAK,cAAc,QAAQ,CAAA;AAErG,QAAA,OAAO;AAAA,UACL,IAAA,EAAM,SAAA;AAAA,UACN,MAAM,OAAA,CAAQ,IAAA;AAAA,UACd,OAAO,OAAA,CAAQ,KAAA;AAAA,UACf,QAAQ,OAAA,CAAQ,MAAA;AAAA,UAChB,KAAK,OAAA,CAAQ;AAAA,SACf;AAAA,MACF,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,kBAAkB,CAAA;AAAA,MAC/B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAA,CACJ,KAAA,EACA,OAAA,EACiB;AACjB,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAA,CAAe,OAAA,CAAQ,WAAA,IAAe,MAAA,EAAQ,WAAA,EAAY;AAEhE,IAAA,MAAM,SAAA,GAAY,sBAAsB,WAAW,CAAA,CAAA;AACnD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,gBAAgB,CAAA;AAAA,MAC7B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,OAAO,IAAA,CAAK,WAAA,CAAY,gBAAA,CAAiB,MAAM,CAAA;AAAA,MACjD,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,gBAAgB,CAAA;AAAA,MAC7B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAA,CACJ,KAAA,EACA,OAAA,EACuB;AACvB,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAA,CAAe,OAAA,CAAQ,WAAA,IAAe,MAAA,EAAQ,WAAA,EAAY;AAEhE,IAAA,MAAM,SAAA,GAAY,oBAAoB,WAAW,CAAA,CAAA;AACjD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,cAAc,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,OAAA,GAAU,IAAA,CAAK,WAAA,CAAY,uBAAA,CAAwB,MAAM,CAAA;AAC/D,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,WAAA,CAAY,gBAAA,CAAiB,MAAM,CAAA;AAC1D,QAAA,MAAM,kBAAA,GAAqB,2BAA2B,OAAO,CAAA;AAE7D,QAAA,MAAM,YAAA,GAAgD;AAAA,UACpD,gBAAwB,eAAA;AAAA,UACxB,uBAA+B,aAAA;AAAA,UAC/B,wBAAgC,cAAA;AAAA,UAChC,mBAA2B,SAAA;AAAA,UAC3B,iBAAyB;AAAA,SAC3B;AAEA,QAAA,OAAO;AAAA,UACL,YAAA,EAAc,OAAA;AAAA,UACd,gBAAA,EAAkB,YAAA,CAAa,OAAO,CAAA,IAAK,SAAA;AAAA,UAC3C,kBAAA;AAAA,UACA;AAAA,SACF;AAAA,MACF,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,cAAc,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,eAAA,CACJ,KAAA,EACA,OAAA,EACwB;AACxB,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,WAAA,EAAa,WAAA,EAAY;AAErD,IAAA,IAAI,CAAC,WAAA,EAAa;AAChB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,oBAAoB,WAAW,CAAA,CAAA;AACjD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,cAAc,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,OAAO,IAAA,CAAK,WAAA,CAAY,UAAA,CAAW,MAAM,CAAA;AAAA,MAC3C,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,cAAc,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAM,YAAA,CACJ,KAAA,EACA,OAAA,EACmB;AACnB,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,WAAA,EAAa,WAAA,EAAY;AAErD,IAAA,IAAI,CAAC,WAAA,EAAa;AAChB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,kBAAkB,WAAW,CAAA,CAAA;AAC/C,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,YAAY,CAAA;AAAA,MACzB,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,WAAA,CAAY,gBAAA,CAAiB,MAAM,CAAA;AACzD,QAAA,MAAM,QAAkB,EAAC;AAEzB,QAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,QAAA,EAAU,CAAA,EAAA,EAAK;AACjC,UAAA,MAAM,IAAA,GAAO,IAAA,CAAK,WAAA,CAAY,WAAA,CAAY,QAAQ,CAAC,CAAA;AACnD,UAAA,KAAA,CAAM,IAAA,CAAK,IAAA,IAAQ,CAAA,KAAA,EAAQ,CAAA,GAAI,CAAC,CAAA,CAAE,CAAA;AAAA,QACpC;AAEA,QAAA,OAAO,KAAA;AAAA,MACT,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,YAAY,CAAA;AAAA,MACzB,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAM,iBAAA,CACJ,KAAA,EACA,OAAA,EACyE;AACzE,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,WAAA,EAAa,WAAA,EAAY;AAErD,IAAA,IAAI,CAAC,WAAA,EAAa;AAChB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,kBAAkB,WAAW,CAAA,CAAA;AAC/C,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,YAAY,CAAA;AAAA,MACzB,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,WAAA,CAAY,qBAAA,CAAsB,MAAM,CAAA;AAC9D,QAAA,OAAO,IAAA,CAAK,WAAA,CAAY,mBAAA,CAAoB,QAAA,IAAY,EAAE,CAAA;AAAA,MAC5D,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,YAAY,CAAA;AAAA,MACzB,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAM,sBAAA,CACJ,KAAA,EACA,OAAA,EACA,aAAqB,CAAA,EACkB;AACvC,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,WAAA,EAAa,WAAA,EAAY;AAErD,IAAA,IAAI,CAAC,WAAA,EAAa;AAChB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,qBAAqB,WAAW,CAAA,CAAA;AAClD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,eAAe,CAAA;AAAA,MAC5B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,OAAO,IAAA,CAAK,WAAA,CAAY,WAAA,CAAY,MAAA,EAAQ,UAAU,CAAA;AAAA,MACxD,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,eAAe,CAAA;AAAA,MAC5B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA,EAEA,MAAM,iBAAA,CACJ,KAAA,EACA,OAAA,EACA,OAAA,EACA,OAAe,IAAA,EACA;AACf,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,WAAA,EAAa,WAAA,EAAY;AAErD,IAAA,IAAI,CAAC,WAAA,EAAa;AAChB,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,gBAAgB,WAAW,CAAA,CAAA;AAC7C,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,UAAU,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,WAAA,CAAY,cAAA,CAAe,MAAA,EAAQ,OAAA,EAAS,IAAI,CAAA;AAAA,MACvD,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,UAAU,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,UAAA,CACJ,KAAA,EACA,SACA,SAAA,EACA,KAAA,EACA,SAAS,CAAA,EACa;AACtB,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,MAAA,IAAU,CAAC,KAAK,WAAA,EAAa;AAC1D,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,MAAM,WAAA,GAAA,CAAe,OAAA,CAAQ,WAAA,IAAe,MAAA,EAAQ,WAAA,EAAY;AAEhE,IAAA,MAAM,SAAA,GAAY,uBAAuB,WAAW,CAAA,CAAA;AACpD,IAAA,MAAM,IAAA,GAAO,KAAK,MAAA,CAAO,EAAA;AAEzB,IAAA,IAAI;AACF,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,iBAAiB,CAAA;AAAA,MAC9B,CAAA,CAAA,MAAQ;AAAA,MAER;AAEA,MAAA,IAAA,CAAK,SAAA,CAAU,WAAW,IAAI,CAAA;AAC9B,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,WAAA,CAAY,YAAA,CAAa,SAAS,CAAA;AAEtD,MAAA,IAAI,WAAW,CAAA,EAAG;AAChB,QAAA,MAAM,IAAI,eAAA;AAAA,UAAA,aAAA;AAAA,UAER;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI;AACF,QAAA,MAAM,UAAU,IAAA,CAAK,WAAA,CAAY,WAAW,MAAA,EAAQ,SAAA,EAAW,OAAO,MAAM,CAAA;AAC5E,QAAA,OAAO;AAAA,UACL,IAAA,EAAM,SAAA;AAAA,UACN,MAAM,OAAA,CAAQ,IAAA;AAAA,UACd,OAAO,OAAA,CAAQ,KAAA;AAAA,UACf,QAAQ,OAAA,CAAQ;AAAA,SAClB;AAAA,MACF,CAAA,SAAE;AACA,QAAA,IAAA,CAAK,WAAA,CAAY,gBAAgB,MAAM,CAAA;AAAA,MACzC;AAAA,IACF,CAAA,SAAE;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,OAAO,SAAS,CAAA;AAAA,MACvB,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,MAAM,iBAAiB,CAAA;AAAA,MAC9B,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAAA,EAEA,YAAA,CACE,QACA,QAAA,EACwB;AACxB,IAAA,OAAO,OAAA,CAAQ,OAAO,IAAI,eAAA;AAAA,MAAA,mBAAA;AAAA,MAExB;AAAA,KACD,CAAA;AAAA,EACH;AAAA,EAEA,eAAA,CACE,UAAA,EACA,OAAA,EACA,KAAA,EACmC;AACnC,IAAA,OAAO,OAAA,CAAQ,OAAO,IAAI,eAAA;AAAA,MAAA,mBAAA;AAAA,MAExB;AAAA,KACD,CAAA;AAAA,EACH;AAAA,EAEA,cAAc,UAAA,EAAqD;AACjE,IAAA,OAAO,OAAA,CAAQ,OAAO,IAAI,eAAA;AAAA,MAAA,mBAAA;AAAA,MAExB;AAAA,KACD,CAAA;AAAA,EACH;AAAA,EAEA,cAAA,GAA0C;AACxC,IAAA,OAAO,IAAA,CAAK,WAAA;AAAA,EACd;AAAA,EAEA,OAAA,GAAyB;AACvB,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA,IAAI;AACF,QAAA,IAAA,CAAK,YAAY,OAAA,EAAQ;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AACA,MAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AAAA,IACrB;AAGA,IAAA,IAAI,KAAK,MAAA,EAAQ;AACf,MAAA,IAAI;AACF,QAAA,MAAM,MAAM,IAAA,CAAK,MAAA;AAEjB,QAAA,IAAI,GAAA,CAAI,SAAS,mBAAA,EAAqB;AACpC,UAAA,GAAA,CAAI,QAAQ,mBAAA,EAAoB;AAAA,QAClC;AAEA,QAAA,IAAI,GAAA,CAAI,SAAS,cAAA,EAAgB;AAC/B,UAAA,KAAA,MAAW,MAAA,IAAU,GAAA,CAAI,OAAA,CAAQ,cAAA,EAAgB;AAC/C,YAAA,IAAI,QAAQ,KAAA,EAAO;AACjB,cAAA,MAAA,CAAO,KAAA,EAAM;AAAA,YACf;AACA,YAAA,IAAI,QAAQ,SAAA,EAAW;AACrB,cAAA,MAAA,CAAO,SAAA,EAAU;AAAA,YACnB;AAAA,UACF;AACA,UAAA,GAAA,CAAI,OAAA,CAAQ,iBAAiB,EAAC;AAAA,QAChC;AAEA,QAAA,IAAI,GAAA,CAAI,SAAS,aAAA,EAAe;AAC9B,UAAA,KAAA,MAAW,MAAA,IAAU,GAAA,CAAI,OAAA,CAAQ,aAAA,EAAe;AAC9C,YAAA,IAAI,QAAQ,KAAA,EAAO;AACjB,cAAA,MAAA,CAAO,KAAA,EAAM;AAAA,YACf;AACA,YAAA,IAAI,QAAQ,SAAA,EAAW;AACrB,cAAA,MAAA,CAAO,SAAA,EAAU;AAAA,YACnB;AAAA,UACF;AACA,UAAA,GAAA,CAAI,OAAA,CAAQ,gBAAgB,EAAC;AAAA,QAC/B;AAAA,MACF,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAGA,IAAA,IAAI,OAAO,YAAY,WAAA,EAAa;AAClC,MAAA,IAAI;AACF,QAAA,MAAM,IAAA,GAAO,OAAA;AACb,QAAA,IAAI,KAAK,iBAAA,EAAmB;AAC1B,UAAA,MAAM,OAAA,GAAU,KAAK,iBAAA,EAAkB;AACvC,UAAA,KAAA,MAAW,UAAU,OAAA,EAAS;AAC5B,YAAA,IAAI,QAAQ,KAAA,EAAO;AACjB,cAAA,MAAM,IAAA,GAAO,MAAA,CAAO,WAAA,EAAa,IAAA,IAAQ,EAAA;AACzC,cAAA,IAAI,SAAS,aAAA,IAAkB,IAAA,KAAS,QAAA,IAAY,CAAC,OAAO,aAAA,EAAgB;AAC1E,gBAAA,MAAA,CAAO,KAAA,EAAM;AAAA,cACf;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF,CAAA,CAAA,MAAQ;AAAA,MAER;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,MAAA,GAAS,IAAA;AACd,IAAA,IAAA,CAAK,WAAA,GAAc,KAAA;AACnB,IAAA,OAAO,QAAQ,OAAA,EAAQ;AAAA,EACzB;AAAA,EAEA,OAAA,GAAmB;AACjB,IAAA,OAAO,IAAA,CAAK,WAAA;AAAA,EACd;AAAA,EAEA,SAAA,GAAqC;AACnC,IAAA,OAAO,IAAA,CAAK,MAAA;AAAA,EACd;AAAA,EAEA,OAAO,wBAAA,GAAqC;AAC1C,IAAA,OAAO,MAAA,CAAO,KAAK,mBAAmB,CAAA;AAAA,EACxC;AAAA,EAEA,OAAO,yBAAA,GAA4C;AACjD,IAAA,OAAO,MAAA,CAAO,KAAK,cAAc,CAAA;AAAA,EACnC;AAAA,EAEA,OAAO,sBAAsB,WAAA,EAAqC;AAChE,IAAA,OAAO,sBAAsB,WAA0B,CAAA;AAAA,EACzD;AAAA,EAEA,OAAO,qBAAA,CAAsB,WAAA,EAAqB,YAAA,EAA+B;AAC/E,IAAA,OAAO,iBAAA,CAAkB,aAAa,YAAY,CAAA;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA,EAMQ,eAAe,KAAA,EAAsD;AAC3E,IAAA,IAAI,iBAAiB,UAAA,EAAY;AAC/B,MAAA,OAAO,KAAA;AAAA,IACT;AACA,IAAA,IAAI,iBAAiB,WAAA,EAAa;AAChC,MAAA,OAAO,IAAI,WAAW,KAAK,CAAA;AAAA,IAC7B;AACA,IAAA,OAAO,IAAI,WAAW,KAAK,CAAA;AAAA,EAC7B;AAAA,EAEQ,yBAAyB,QAAA,EAAiC;AAChE,IAAA,MAAM,KAAA,GAAQ,QAAA,CAAS,KAAA,CAAM,GAAG,CAAA;AAChC,IAAA,IAAI,KAAA,CAAM,SAAS,CAAA,EAAG;AACpB,MAAA,OAAO,KAAA,CAAM,GAAA,EAAI,EAAG,WAAA,EAAY,IAAK,IAAA;AAAA,IACvC;AACA,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEQ,YAAY,QAAA,EAA0B;AAC5C,IAAA,MAAM,OAAA,GAAU,QAAA,CAAS,WAAA,CAAY,GAAG,CAAA;AACxC,IAAA,IAAI,UAAU,CAAA,EAAG;AACf,MAAA,OAAO,QAAA,CAAS,SAAA,CAAU,CAAA,EAAG,OAAO,CAAA;AAAA,IACtC;AACA,IAAA,OAAO,QAAA;AAAA,EACT;AAAA,EAEQ,YAAA,CACN,KAAA,EACA,OAAA,EACA,OAAA,EACM;AACN,IAAA,IAAA,CAAK,QAAQ,UAAA,GAAa,EAAE,KAAA,EAAO,OAAA,EAAS,SAAS,CAAA;AAAA,EACvD;AACF;AC14CO,IAAM,kBAAN,MAAuD;AAAA,EACpD,MAAA,GAAwB,IAAA;AAAA,EACxB,OAAA,uBAAc,GAAA,EAAwG;AAAA,EACtH,OAAA;AAAA,EACA,WAAA,GAAc,KAAA;AAAA,EACd,YAAA,GAAe,KAAA;AAAA,EAEvB,WAAA,CAAY,OAAA,GAAkC,EAAC,EAAG;AAChD,IAAA,IAAA,CAAK,OAAA,GAAU;AAAA,MACb,QAAA,EAAU,QAAA;AAAA,MACV,OAAA,EAAS,KAAA;AAAA,MACT,GAAG;AAAA,KACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAA,GAA4B;AAChC,IAAA,IAAI,KAAK,WAAA,EAAa;AACpB,MAAA;AAAA,IACF;AAEA,IAAA,IAAI,KAAK,YAAA,EAAc;AACrB,MAAA,OAAO,KAAK,YAAA,EAAc;AACxB,QAAA,MAAM,IAAI,OAAA,CAAQ,CAAAD,aAAW,UAAA,CAAWA,QAAAA,EAAS,GAAG,CAAC,CAAA;AAAA,MACvD;AACA,MAAA;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,YAAA,GAAe,IAAA;AAEpB,IAAA,IAAI;AAEF,MAAA,IAAI,UAAA;AAEJ,MAAA,IAAI,IAAA,CAAK,QAAQ,UAAA,EAAY;AAE3B,QAAA,UAAA,GAAaA,YAAA,CAAQ,IAAA,CAAK,OAAA,CAAQ,UAAU,CAAA;AAAA,MAC9C,CAAA,MAAO;AAEL,QAAA,IAAI;AACF,UAAA,MAAM,UAAA,GAAaE,YAAA,CAAQC,iBAAA,CAAc,2PAAe,CAAC,CAAA;AACzD,UAAA,UAAA,GAAaC,SAAA,CAAK,YAAY,iBAAiB,CAAA;AAAA,QACjD,CAAA,CAAA,MAAQ;AACN,UAAA,UAAA,GAAaA,SAAA,CAAK,WAAW,iBAAiB,CAAA;AAAA,QAChD;AAIA,QAAA,IAAI,CAACC,aAAA,CAAW,UAAU,CAAA,EAAG;AAC3B,UAAA,MAAM,iBAAiBL,YAAA,CAAQ,OAAA,CAAQ,GAAA,EAAI,EAAG,QAAQ,iBAAiB,CAAA;AACvE,UAAA,IAAIK,aAAA,CAAW,cAAc,CAAA,EAAG;AAC9B,YAAA,UAAA,GAAa,cAAA;AAAA,UACf;AAAA,QACF;AAAA,MACF;AAGA,MAAA,IAAA,CAAK,MAAA,GAAS,IAAIC,qBAAA,CAAO,UAAU,CAAA;AAGnC,MAAA,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,SAAA,EAAW,CAAC,QAAA,KAAgD;AACzE,QAAA,IAAI,MAAA,IAAU,QAAA,IAAY,QAAA,CAAS,IAAA,KAAS,OAAA,EAAS;AACnD,UAAA;AAAA,QACF;AAEA,QAAA,MAAM,GAAA,GAAM,QAAA;AACZ,QAAA,MAAM,OAAA,GAAU,IAAA,CAAK,OAAA,CAAQ,GAAA,CAAI,IAAI,EAAE,CAAA;AACvC,QAAA,IAAI,OAAA,EAAS;AAEX,UAAA,YAAA,CAAa,QAAQ,OAAO,CAAA;AAC5B,UAAA,IAAA,CAAK,OAAA,CAAQ,MAAA,CAAO,GAAA,CAAI,EAAE,CAAA;AAC1B,UAAA,IAAI,IAAI,OAAA,EAAS;AACf,YAAA,OAAA,CAAQ,OAAA,CAAQ,IAAI,IAAI,CAAA;AAAA,UAC1B,CAAA,MAAO;AACL,YAAA,OAAA,CAAQ,OAAO,IAAI,eAAA;AAAA,cAAA,mBAAA;AAAA,cAEjB,IAAI,KAAA,IAAS;AAAA,aACd,CAAA;AAAA,UACH;AAAA,QACF;AAAA,MACF,CAAC,CAAA;AAED,MAAA,IAAA,CAAK,MAAA,CAAO,EAAA,CAAG,OAAA,EAAS,CAAC,KAAA,KAAU;AAEjC,QAAA,KAAA,MAAW,GAAG,OAAO,CAAA,IAAK,KAAK,OAAA,EAAS;AACtC,UAAA,YAAA,CAAa,QAAQ,OAAO,CAAA;AAC5B,UAAA,OAAA,CAAQ,OAAO,KAAK,CAAA;AAAA,QACtB;AACA,QAAA,IAAA,CAAK,QAAQ,KAAA,EAAM;AAAA,MACrB,CAAC,CAAA;AAGD,MAAA,MAAM,IAAI,OAAA,CAAc,CAACN,QAAAA,KAAY;AACnC,QAAA,MAAM,OAAA,GAAU,CAAC,GAAA,KAAuB;AACtC,UAAA,IAAI,GAAA,CAAI,SAAS,OAAA,EAAS;AACxB,YAAA,IAAA,CAAK,MAAA,EAAQ,GAAA,CAAI,SAAA,EAAW,OAAO,CAAA;AACnC,YAAAA,QAAAA,EAAQ;AAAA,UACV;AAAA,QACF,CAAA;AACA,QAAA,IAAA,CAAK,MAAA,EAAQ,EAAA,CAAG,SAAA,EAAW,OAAO,CAAA;AAAA,MACpC,CAAC,CAAA;AAGD,MAAA,MAAM,IAAA,CAAK,YAAY,MAAA,EAAQ;AAAA,QAC7B,QAAA,EAAU,KAAK,OAAA,CAAQ,QAAA;AAAA,QACvB,OAAA,EAAS,KAAK,OAAA,CAAQ;AAAA,OACvB,CAAA;AAED,MAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AACnB,MAAA,IAAA,CAAK,QAAQ,OAAA,IAAU;AAAA,IACzB,SAAS,KAAA,EAAO;AACd,MAAA,MAAM,SAAA,GAAY,KAAA,YAAiB,eAAA,GAC/B,KAAA,GACA,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAEF,CAAA,6BAAA,EAAgC,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,OAC/C;AACJ,MAAA,IAAA,CAAK,OAAA,CAAQ,UAAU,SAAS,CAAA;AAChC,MAAA,MAAM,SAAA;AAAA,IACR,CAAA,SAAE;AACA,MAAA,IAAA,CAAK,YAAA,GAAe,KAAA;AAAA,IACtB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,WAAA,CAAY,MAAc,OAAA,EAAiC;AACjE,IAAA,OAAO,IAAI,OAAA,CAAQ,CAACA,QAAAA,EAAS,MAAA,KAAW;AACtC,MAAA,IAAI,CAAC,KAAK,MAAA,EAAQ;AAChB,QAAA,MAAA,CAAO,IAAI,eAAA;AAAA,UAAA,sBAAA;AAAA,UAET;AAAA,SACD,CAAA;AACD,QAAA;AAAA,MACF;AAEA,MAAA,MAAM,KAAKO,iBAAA,EAAW;AAGtB,MAAA,MAAM,OAAA,GAAU,WAAW,MAAM;AAC/B,QAAA,MAAM,OAAA,GAAU,IAAA,CAAK,OAAA,CAAQ,GAAA,CAAI,EAAE,CAAA;AACnC,QAAA,IAAI,OAAA,EAAS;AACX,UAAA,IAAA,CAAK,OAAA,CAAQ,OAAO,EAAE,CAAA;AACtB,UAAA,OAAA,CAAQ,OAAO,IAAI,eAAA;AAAA,YAAA,mBAAA;AAAA,YAEjB;AAAA,WACD,CAAA;AAAA,QACH;AAAA,MACF,GAAG,GAAM,CAAA;AAET,MAAA,IAAA,CAAK,OAAA,CAAQ,IAAI,EAAA,EAAI,EAAE,SAAAP,QAAAA,EAAS,MAAA,EAAQ,SAAS,CAAA;AACjD,MAAA,IAAA,CAAK,OAAO,WAAA,CAAY,EAAE,IAAA,EAAM,EAAA,EAAI,SAAS,CAAA;AAAA,IAC/C,CAAC,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAA,CACJ,KAAA,EACA,OAAA,EACA,WAAW,UAAA,EACgB;AAC3B,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,KAAK,GAAA,EAAI;AAC3B,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAE3C,IAAA,IAAI,SAAA,CAAU,WAAW,CAAA,EAAG;AAC1B,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,eAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,cAAc,OAAA,CAAQ,WAAA,IAAe,IAAA,CAAK,wBAAA,CAAyB,QAAQ,CAAA,IAAK,MAAA;AACtF,IAAA,MAAM,eAAe,OAAA,CAAQ,YAAA;AAE7B,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,WAAA,CAAY,SAAA,EAAW;AAAA,MAC/C,SAAA;AAAA,MACA,WAAA;AAAA,MACA,YAAA;AAAA,MACA;AAAA,KACD,CAAA;AAED,IAAA,MAAM,QAAA,GAAW,IAAA,CAAK,WAAA,CAAY,QAAQ,CAAA;AAC1C,IAAA,MAAM,cAAA,GAAiB,CAAA,EAAG,QAAQ,CAAA,CAAA,EAAI,YAAY,CAAA,CAAA;AAElD,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,IAAI,UAAA,CAAW,MAAM,CAAA;AAAA,MAC3B,QAAA,EAAU,kBAAkB,YAAY,CAAA;AAAA,MACxC,QAAA,EAAU,cAAA;AAAA,MACV,QAAA,EAAU,IAAA,CAAK,GAAA,EAAI,GAAI;AAAA,KACzB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAA,CACJ,KAAA,EACA,OAAA,EACiB;AACjB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,QAAQ,WAAA,IAAe,MAAA;AAC3C,IAAA,OAAO,KAAK,WAAA,CAAY,cAAA,EAAgB,EAAE,SAAA,EAAW,aAAa,CAAA;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAA,CACJ,KAAA,EACA,OAAA,EACuB;AACvB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,QAAQ,WAAA,IAAe,MAAA;AAC3C,IAAA,OAAO,KAAK,WAAA,CAAY,iBAAA,EAAmB,EAAE,SAAA,EAAW,aAAa,CAAA;AAAA,EACvE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAA,CACJ,KAAA,EACA,SACA,SAAA,EACA,KAAA,EACA,SAAS,CAAA,EACa;AACtB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,QAAQ,WAAA,IAAe,MAAA;AAC3C,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,WAAA,CAAY,YAAA,EAAc;AAAA,MAClD,SAAA;AAAA,MACA,WAAA;AAAA,MACA,SAAA;AAAA,MACA,KAAA;AAAA,MACA;AAAA,KACD,CAAA;AAED,IAAA,MAAM,OAAA,GAAU,MAAA;AAChB,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,SAAA;AAAA,MACN,IAAA,EAAM,IAAI,UAAA,CAAW,OAAA,CAAQ,IAAI,CAAA;AAAA,MACjC,OAAO,OAAA,CAAQ,KAAA;AAAA,MACf,QAAQ,OAAA,CAAQ;AAAA,KAClB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAA,CACJ,KAAA,EACA,OAAA,EACA,aAAA,GAA+B,EAAC,EACR;AACxB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,QAAQ,WAAA,IAAe,MAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,MAAM,IAAA,CAAK,WAAA,CAAY,oBAAA,EAAsB;AAAA,MAC/D,SAAA;AAAA,MACA,WAAA;AAAA,MACA,KAAA,EAAO,cAAc,KAAA,IAAS,GAAA;AAAA,MAC9B,MAAA,EAAQ,cAAc,MAAA,IAAU,CAAA;AAAA,MAChC,aAAa,aAAA,CAAc;AAAA,KAC5B,CAAA;AAED,IAAA,OAAO,WAAA,CAAY,GAAA,CAAI,CAAC,OAAA,MAAa;AAAA,MACnC,MAAM,OAAA,CAAQ,IAAA;AAAA,MACd,IAAA,EAAM,IAAI,UAAA,CAAW,OAAA,CAAQ,IAAI,CAAA;AAAA,MACjC,OAAO,OAAA,CAAQ,KAAA;AAAA,MACf,QAAQ,OAAA,CAAQ;AAAA,KAClB,CAAE,CAAA;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,qBAAA,CACJ,KAAA,EACA,SACA,SAAA,EACA,aAAA,GAA0C,EAAC,EACV;AACjC,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,QAAQ,WAAA,IAAe,MAAA;AAC3C,IAAA,MAAM,UAAA,GAAa,MAAM,IAAA,CAAK,WAAA,CAAY,uBAAA,EAAyB;AAAA,MACjE,SAAA;AAAA,MACA,WAAA;AAAA,MACA,SAAA;AAAA,MACA,GAAA,EAAK,cAAc,GAAA,IAAO,GAAA;AAAA,MAC1B,cAAc,aAAA,CAAc,YAAA;AAAA,MAC5B,QAAA,EAAU,cAAc,QAAA,IAAY;AAAA,KACrC,CAAA;AAED,IAAA,OAAO;AAAA,MACL,MAAM,UAAA,CAAW,IAAA;AAAA,MACjB,IAAA,EAAM,IAAI,UAAA,CAAW,UAAA,CAAW,IAAI,CAAA;AAAA,MACpC,OAAO,UAAA,CAAW,KAAA;AAAA,MAClB,QAAQ,UAAA,CAAW,MAAA;AAAA,MACnB,KAAK,UAAA,CAAW;AAAA,KAClB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAA,CACJ,KAAA,EACA,WAAA,EACwB;AACxB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,KAAK,WAAA,CAAY,iBAAA,EAAmB,EAAE,SAAA,EAAW,aAAa,CAAA;AAAA,EACvE;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAA,CACJ,KAAA,EACA,WAAA,EACmB;AACnB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,KAAK,WAAA,CAAY,cAAA,EAAgB,EAAE,SAAA,EAAW,aAAa,CAAA;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,YAAA,CACJ,KAAA,EACA,OAAA,EACwB;AACxB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,WAAA,GAAc,QAAQ,WAAA,IAAe,MAAA;AAC3C,IAAA,OAAO,KAAK,WAAA,CAAY,cAAA,EAAgB,EAAE,SAAA,EAAW,aAAa,CAAA;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,eAAA,CACJ,SAAA,EACA,MAAA,EACA,IAAA,EACmC;AACnC,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,OAAO,IAAA,CAAK,WAAA,CAAY,iBAAA,EAAmB,EAAE,SAAA,EAAW,QAAQ,IAAA,EAAM,IAAA,IAAQ,EAAC,EAAG,CAAA;AAAA,EACpF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,cAAc,SAAA,EAAoD;AACtE,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,MAAA,EAAQ;AACrC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAS,MAAM,IAAA,CAAK,YAAY,eAAA,EAAiB,EAAE,WAAW,CAAA;AACpE,IAAA,OAAO,MAAA,GAAS,IAAI,UAAA,CAAW,MAAM,CAAA,GAAI,MAAA;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAA,GAAyB;AAE7B,IAAA,KAAA,MAAW,GAAG,OAAO,CAAA,IAAK,KAAK,OAAA,EAAS;AACtC,MAAA,YAAA,CAAa,QAAQ,OAAO,CAAA;AAAA,IAC9B;AAEA,IAAA,IAAI,KAAK,MAAA,EAAQ;AACf,MAAA,IAAI;AACF,QAAA,MAAM,IAAA,CAAK,YAAY,SAAS,CAAA;AAAA,MAClC,CAAA,CAAA,MAAQ;AAAA,MAER;AAGA,MAAA,KAAA,MAAW,GAAG,OAAO,CAAA,IAAK,KAAK,OAAA,EAAS;AACtC,QAAA,YAAA,CAAa,QAAQ,OAAO,CAAA;AAAA,MAC9B;AAGA,MAAA,IAAA,CAAK,OAAO,kBAAA,EAAmB;AAG/B,MAAA,MAAM,IAAA,CAAK,OAAO,SAAA,EAAU;AAC5B,MAAA,IAAA,CAAK,MAAA,GAAS,IAAA;AAAA,IAChB;AACA,IAAA,IAAA,CAAK,WAAA,GAAc,KAAA;AACnB,IAAA,IAAA,CAAK,QAAQ,KAAA,EAAM;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA,EAKA,OAAA,GAAmB;AACjB,IAAA,OAAO,IAAA,CAAK,WAAA,IAAe,IAAA,CAAK,MAAA,KAAW,IAAA;AAAA,EAC7C;AAAA,EAEQ,eAAe,KAAA,EAAsD;AAC3E,IAAA,IAAI,iBAAiB,UAAA,EAAY;AAC/B,MAAA,OAAO,KAAA;AAAA,IACT;AACA,IAAA,IAAI,iBAAiB,WAAA,EAAa;AAChC,MAAA,OAAO,IAAI,WAAW,KAAK,CAAA;AAAA,IAC7B;AACA,IAAA,OAAO,IAAI,WAAW,KAAK,CAAA;AAAA,EAC7B;AAAA,EAEQ,yBAAyB,QAAA,EAAiC;AAChE,IAAA,MAAM,KAAA,GAAQ,QAAA,CAAS,KAAA,CAAM,GAAG,CAAA;AAChC,IAAA,IAAI,KAAA,CAAM,SAAS,CAAA,EAAG;AACpB,MAAA,OAAO,KAAA,CAAM,GAAA,EAAI,EAAG,WAAA,EAAY,IAAK,IAAA;AAAA,IACvC;AACA,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEQ,YAAY,QAAA,EAA0B;AAC5C,IAAA,MAAM,OAAA,GAAU,QAAA,CAAS,WAAA,CAAY,GAAG,CAAA;AACxC,IAAA,IAAI,UAAU,CAAA,EAAG;AACf,MAAA,OAAO,QAAA,CAAS,SAAA,CAAU,CAAA,EAAG,OAAO,CAAA;AAAA,IACtC;AACA,IAAA,OAAO,QAAA;AAAA,EACT;AACF;AAKA,eAAsB,qBAAA,CACpB,OAAA,GAAkC,EAAC,EACT;AAC1B,EAAA,MAAM,SAAA,GAAY,IAAI,eAAA,CAAgB,OAAO,CAAA;AAC7C,EAAA,MAAM,UAAU,UAAA,EAAW;AAC3B,EAAA,OAAO,SAAA;AACT;ACphBO,IAAM,sBAAN,MAA2D;AAAA,EACxD,KAAA,GAA6B,IAAA;AAAA,EAC7B,OAAA,uBAAc,GAAA,EAA2E;AAAA,EACzF,OAAA;AAAA,EACA,WAAA,GAAc,KAAA;AAAA,EACd,YAAA,GAAe,KAAA;AAAA,EACf,UAAA,GAAqB,EAAA;AAAA,EAE7B,WAAA,CAAY,OAAA,GAAsC,EAAC,EAAG;AACpD,IAAA,IAAA,CAAK,OAAA,GAAU;AAAA,MACb,QAAA,EAAU,QAAA;AAAA,MACV,OAAA,EAAS,KAAA;AAAA,MACT,cAAA,EAAgB,CAAA;AAAA,MAChB,oBAAA,EAAsB,CAAA;AAAA,MACtB,oBAAA,EAAsB,IAAA;AAAA,MACtB,GAAG;AAAA,KACL;AAAA,EACF;AAAA,EAEQ,cAAc,KAAA,EAAgC;AACpD,IAAA,MAAM,GAAA,GAAM,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,KAAA;AACrD,IAAA,OAAO,GAAA,CAAI,QAAA,CAAS,6BAA6B,CAAA,IAC1C,IAAI,QAAA,CAAS,aAAa,CAAA,IAC1B,GAAA,CAAI,QAAA,CAAS,8BAA8B,CAAA,IAC3C,GAAA,CAAI,SAAS,eAAe,CAAA;AAAA,EACrC;AAAA,EAEA,MAAc,WAAA,GAA6B;AAEzC,IAAA,IAAI,CAAC,KAAK,UAAA,EAAY;AACpB,MAAA,IAAI;AACF,QAAA,MAAM,UAAA,GAAaE,YAAAA,CAAQC,iBAAAA,CAAc,2PAAe,CAAC,CAAA;AAEzD,QAAA,IAAI,WAAW,QAAA,CAAS,MAAM,KAAK,UAAA,CAAW,QAAA,CAAS,OAAO,CAAA,EAAG;AAE/D,UAAA,IAAA,CAAK,UAAA,GAAaC,SAAAA,CAAK,UAAA,EAAY,IAAA,EAAM,QAAQ,uBAAuB,CAAA;AAAA,QAC1E,CAAA,MAAO;AAEL,UAAA,IAAA,CAAK,UAAA,GAAaA,SAAAA,CAAK,UAAA,EAAY,uBAAuB,CAAA;AAAA,QAC5D;AAAA,MACF,CAAA,CAAA,MAAQ;AACN,QAAA,IAAA,CAAK,UAAA,GAAaA,SAAAA,CAAK,SAAA,EAAW,uBAAuB,CAAA;AAAA,MAC3D;AAAA,IACF;AAEA,IAAA,MAAM,QAAA,GAAWJ,YAAAA,CAAQ,IAAA,CAAK,OAAA,CAAQ,YAAY,QAAQ,CAAA;AAE1D,IAAA,IAAA,CAAK,KAAA,GAAQQ,kBAAA,CAAK,IAAA,CAAK,UAAA,EAAY,EAAC,EAAG;AAAA,MACrC,GAAA,EAAK,EAAE,GAAG,OAAA,CAAQ,GAAA,EAAK,SAAA,EAAW,QAAA,EAAU,OAAA,EAAS,MAAA,CAAO,IAAA,CAAK,OAAA,CAAQ,OAAA,IAAW,KAAK,CAAA,EAAE;AAAA,MAC3F,KAAA,EAAO,CAAC,MAAA,EAAQ,MAAA,EAAQ,QAAQ,KAAK;AAAA,KACtC,CAAA;AAED,IAAA,IAAA,CAAK,KAAA,CAAM,MAAA,EAAQ,EAAA,CAAG,MAAA,EAAQ,CAAC,CAAA,KAAc;AAAE,MAAA,IAAI,KAAK,OAAA,CAAQ,OAAA,EAAS,OAAA,CAAQ,MAAA,CAAO,MAAM,CAAC,CAAA;AAAA,IAAG,CAAC,CAAA;AACnG,IAAA,IAAA,CAAK,KAAA,CAAM,MAAA,EAAQ,EAAA,CAAG,MAAA,EAAQ,CAAC,CAAA,KAAc;AAAE,MAAA,IAAI,KAAK,OAAA,CAAQ,OAAA,EAAS,OAAA,CAAQ,MAAA,CAAO,MAAM,CAAC,CAAA;AAAA,IAAG,CAAC,CAAA;AAEnG,IAAA,IAAA,CAAK,KAAA,CAAM,EAAA,CAAG,SAAA,EAAW,CAAC,GAAA,KAAuB;AAC/C,MAAA,IAAI,GAAA,CAAI,IAAA,KAAS,UAAA,IAAc,GAAA,CAAI,EAAA,EAAI;AACrC,QAAA,MAAM,CAAA,GAAI,IAAA,CAAK,OAAA,CAAQ,GAAA,CAAI,IAAI,EAAE,CAAA;AACjC,QAAA,IAAI,CAAA,EAAG;AACL,UAAA,IAAA,CAAK,OAAA,CAAQ,MAAA,CAAO,GAAA,CAAI,EAAE,CAAA;AAC1B,UAAA,GAAA,CAAI,OAAA,GAAU,CAAA,CAAE,OAAA,CAAQ,GAAA,CAAI,IAAI,CAAA,GAAI,CAAA,CAAE,MAAA,CAAO,IAAI,eAAA,CAAA,mBAAA,0BAAuD,GAAA,CAAI,KAAA,IAAS,OAAO,CAAC,CAAA;AAAA,QAC/H;AAAA,MACF;AAAA,IACF,CAAC,CAAA;AAED,IAAA,IAAA,CAAK,KAAA,CAAM,EAAA,CAAG,OAAA,EAAS,CAAC,CAAA,KAAM;AAC5B,MAAA,KAAA,MAAW,KAAK,IAAA,CAAK,OAAA,CAAQ,QAAO,EAAG,CAAA,CAAE,OAAO,CAAC,CAAA;AACjD,MAAA,IAAA,CAAK,QAAQ,KAAA,EAAM;AAAA,IACrB,CAAC,CAAA;AAED,IAAA,IAAA,CAAK,KAAA,CAAM,EAAA,CAAG,MAAA,EAAQ,CAAC,IAAA,KAAS;AAC9B,MAAA,IAAI,SAAS,CAAA,EAAG;AACd,QAAA,KAAA,MAAW,CAAA,IAAK,IAAA,CAAK,OAAA,CAAQ,MAAA,EAAO,EAAG,CAAA,CAAE,MAAA,CAAO,IAAI,KAAA,CAAM,CAAA,KAAA,EAAQ,IAAI,CAAA,CAAE,CAAC,CAAA;AACzE,QAAA,IAAA,CAAK,QAAQ,KAAA,EAAM;AAAA,MACrB;AACA,MAAA,IAAA,CAAK,KAAA,GAAQ,IAAA;AACb,MAAA,IAAA,CAAK,WAAA,GAAc,KAAA;AAAA,IACrB,CAAC,CAAA;AAGD,IAAA,MAAM,IAAI,OAAA,CAAc,CAACR,QAAAA,EAAS,MAAA,KAAW;AAC3C,MAAA,MAAM,CAAA,GAAI,WAAW,MAAM,MAAA,CAAO,IAAI,KAAA,CAAM,0BAA0B,CAAC,CAAA,EAAG,GAAK,CAAA;AAC/E,MAAA,MAAM,CAAA,GAAI,CAAC,GAAA,KAAuB;AAChC,QAAA,IAAI,GAAA,CAAI,SAAS,OAAA,EAAS;AAAE,UAAA,YAAA,CAAa,CAAC,CAAA;AAAG,UAAA,IAAA,CAAK,KAAA,EAAO,GAAA,CAAI,SAAA,EAAW,CAAC,CAAA;AAAG,UAAAA,QAAAA,EAAQ;AAAA,QAAG,CAAA,MAAA,IAC9E,GAAA,CAAI,IAAA,KAAS,OAAA,EAAS;AAAE,UAAA,YAAA,CAAa,CAAC,CAAA;AAAG,UAAA,IAAA,CAAK,KAAA,EAAO,GAAA,CAAI,SAAA,EAAW,CAAC,CAAA;AAAG,UAAA,MAAA,CAAO,IAAI,KAAA,CAAM,GAAA,CAAI,KAAK,CAAC,CAAA;AAAA,QAAG;AAAA,MACjH,CAAA;AACA,MAAA,IAAA,CAAK,KAAA,EAAO,EAAA,CAAG,SAAA,EAAW,CAAC,CAAA;AAAA,IAC7B,CAAC,CAAA;AAGD,IAAA,MAAM,IAAA,CAAK,IAAA,CAAK,MAAA,EAAQ,MAAA,EAAW,IAAM,CAAA;AAAA,EAC3C;AAAA,EAEQ,UAAA,GAAmB;AACzB,IAAA,IAAI,KAAK,KAAA,EAAO;AACd,MAAA,IAAI;AAAE,QAAA,IAAA,CAAK,KAAA,CAAM,KAAK,SAAS,CAAA;AAAA,MAAG,CAAA,CAAA,MAAQ;AAAA,MAAC;AAC3C,MAAA,IAAA,CAAK,KAAA,GAAQ,IAAA;AAAA,IACf;AACA,IAAA,IAAA,CAAK,WAAA,GAAc,KAAA;AACnB,IAAA,IAAA,CAAK,QAAQ,KAAA,EAAM;AAAA,EACrB;AAAA,EAEA,MAAM,UAAA,GAA4B;AAChC,IAAA,IAAI,KAAK,WAAA,EAAa;AACtB,IAAA,IAAI,KAAK,YAAA,EAAc;AACrB,MAAA,OAAO,IAAA,CAAK,cAAc,MAAM,IAAI,QAAQ,CAAA,CAAA,KAAK,UAAA,CAAW,CAAA,EAAG,GAAG,CAAC,CAAA;AACnE,MAAA;AAAA,IACF;AACA,IAAA,IAAA,CAAK,YAAA,GAAe,IAAA;AAEpB,IAAA,MAAM,UAAA,GAAa,IAAA,CAAK,OAAA,CAAQ,cAAA,IAAkB,CAAA;AAClD,IAAA,IAAI,SAAA,GAA0B,IAAA;AAE9B,IAAA,KAAA,IAAS,OAAA,GAAU,CAAA,EAAG,OAAA,IAAW,UAAA,EAAY,OAAA,EAAA,EAAW;AACtD,MAAA,IAAI;AACF,QAAA,MAAM,KAAK,UAAA,EAAW;AACtB,QAAA,MAAM,KAAK,WAAA,EAAY;AACvB,QAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AACnB,QAAA,IAAA,CAAK,YAAA,GAAe,KAAA;AACpB,QAAA,IAAA,CAAK,QAAQ,OAAA,IAAU;AACvB,QAAA;AAAA,MACF,SAAS,CAAA,EAAG;AACV,QAAA,SAAA,GAAY,aAAa,KAAA,GAAQ,CAAA,GAAI,IAAI,KAAA,CAAM,MAAA,CAAO,CAAC,CAAC,CAAA;AACxD,QAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,UAAA,OAAA,CAAQ,MAAM,CAAA,mCAAA,EAAsC,OAAO,IAAI,UAAU,CAAA,QAAA,CAAA,EAAY,UAAU,OAAO,CAAA;AAAA,QACxG;AACA,QAAA,MAAM,KAAK,UAAA,EAAW;AAGtB,QAAA,IAAI,UAAU,UAAA,EAAY;AACxB,UAAA,MAAM,IAAI,OAAA,CAAQ,CAAA,CAAA,KAAK,WAAW,CAAA,EAAG,GAAA,GAAM,OAAO,CAAC,CAAA;AAAA,QACrD;AAAA,MACF;AAAA,IACF;AAEA,IAAA,IAAA,CAAK,YAAA,GAAe,KAAA;AACpB,IAAA,MAAM,GAAA,GAAM,IAAI,eAAA,CAAA,sBAAA,6BAA0D,CAAA,kBAAA,EAAqB,UAAU,CAAA,WAAA,EAAc,SAAA,EAAW,OAAO,CAAA,CAAE,CAAA;AAC3I,IAAA,IAAA,CAAK,OAAA,CAAQ,UAAU,GAAG,CAAA;AAC1B,IAAA,MAAM,GAAA;AAAA,EACR;AAAA,EAEQ,IAAA,CAAK,IAAA,EAAc,OAAA,EAAmB,OAAA,GAAkB,GAAA,EAA0B;AACxF,IAAA,OAAO,IAAI,OAAA,CAAQ,CAACA,QAAAA,EAAS,MAAA,KAAW;AACtC,MAAA,IAAI,CAAC,KAAK,KAAA,EAAO;AAAE,QAAA,MAAA,CAAO,IAAI,eAAA,CAAA,sBAAA,6BAA0D,YAAY,CAAC,CAAA;AAAG,QAAA;AAAA,MAAQ;AAChH,MAAA,MAAM,KAAKO,iBAAAA,EAAW;AACtB,MAAA,IAAA,CAAK,QAAQ,GAAA,CAAI,EAAA,EAAI,EAAE,OAAA,EAAAP,QAAAA,EAAS,QAAQ,CAAA;AACxC,MAAA,IAAA,CAAK,MAAM,IAAA,CAAK,EAAE,IAAA,EAAM,EAAA,EAAI,SAAS,CAAA;AACrC,MAAA,UAAA,CAAW,MAAM;AACf,QAAA,IAAI,IAAA,CAAK,OAAA,CAAQ,GAAA,CAAI,EAAE,CAAA,EAAG;AACxB,UAAA,IAAA,CAAK,OAAA,CAAQ,OAAO,EAAE,CAAA;AACtB,UAAA,MAAA,CAAO,IAAI,eAAA,CAAA,mBAAA,0BAAuD,SAAS,CAAC,CAAA;AAAA,QAC9E;AAAA,MACF,GAAG,OAAO,CAAA;AAAA,IACZ,CAAC,CAAA;AAAA,EACH;AAAA,EAEQ,eAAe,KAAA,EAAsD;AAC3E,IAAA,IAAI,iBAAiB,UAAA,EAAY;AAC/B,MAAA,OAAO,KAAA;AAAA,IACT;AACA,IAAA,IAAI,iBAAiB,WAAA,EAAa;AAChC,MAAA,OAAO,IAAI,WAAW,KAAK,CAAA;AAAA,IAC7B;AACA,IAAA,OAAO,IAAI,WAAW,KAAK,CAAA;AAAA,EAC7B;AAAA,EAEA,MAAM,OAAA,CAAQ,KAAA,EAA0C,OAAA,EAA4B,WAAW,UAAA,EAAuC;AACpI,IAAA,IAAI,CAAC,KAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO,MAAM,IAAI,eAAA,CAAA,sBAAA,6BAA0D,iBAAiB,CAAA;AAE3H,IAAA,MAAM,KAAA,GAAQ,KAAK,GAAA,EAAI;AACvB,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AACtC,IAAA,IAAI,KAAK,MAAA,KAAW,CAAA,EAAG,MAAM,IAAI,qDAAmD,OAAO,CAAA;AAE3F,IAAA,MAAM,MAAM,OAAA,CAAQ,WAAA,KAAgB,QAAA,CAAS,QAAA,CAAS,GAAG,CAAA,GAAI,QAAA,CAAS,KAAA,CAAM,QAAA,CAAS,YAAY,GAAG,CAAA,GAAI,CAAC,CAAA,CAAE,aAAY,GAAI,MAAA,CAAA;AAC3H,IAAA,IAAI,MAAA,GAAS,qBAAA,CAAsB,OAAA,CAAQ,YAAY,CAAA,IAAK,EAAA;AAC5D,IAAA,IAAI,OAAA,CAAQ,YAAA,KAAiB,KAAA,IAAS,OAAA,CAAQ,GAAA,EAAK;AACjD,MAAA,MAAM,IAAc,EAAC;AACrB,MAAA,IAAI,QAAQ,GAAA,CAAI,SAAA,IAAa,IAAA,CAAK,CAAA,iBAAA,EAAoB,EAAE,UAAA,EAAY,CAAA,EAAG,YAAY,CAAA,EAAG,UAAA,EAAY,GAAE,CAAE,OAAA,CAAQ,IAAI,SAAS,CAAA,IAAK,CAAC,CAAA,CAAE,CAAA;AACnI,MAAA,IAAI,OAAA,CAAQ,GAAA,CAAI,OAAA,KAAY,MAAA,EAAW,CAAA,CAAE,KAAK,CAAA,QAAA,EAAW,OAAA,CAAQ,GAAA,CAAI,OAAO,CAAA,CAAE,CAAA;AAC9E,MAAA,IAAI,CAAA,CAAE,MAAA,EAAQ,MAAA,GAAS,CAAA,CAAE,KAAK,GAAG,CAAA;AAAA,IACnC;AAEA,IAAA,MAAM,UAAA,GAAa,IAAA,CAAK,OAAA,CAAQ,oBAAA,IAAwB,CAAA;AACxD,IAAA,IAAI,SAAA,GAA0B,IAAA;AAE9B,IAAA,KAAA,IAAS,OAAA,GAAU,CAAA,EAAG,OAAA,IAAW,UAAA,EAAY,OAAA,EAAA,EAAW;AACtD,MAAA,IAAI;AACF,QAAA,MAAM,CAAA,GAAI,MAAM,IAAA,CAAK,IAAA,CAAK,SAAA,EAAW;AAAA,UACnC,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,IAAI,CAAA;AAAA,UAC1B,QAAA,EAAU,GAAA;AAAA,UACV,YAAA,EAAc,oBAAA,CAAqB,OAAA,CAAQ,YAAY,CAAA;AAAA,UACvD,aAAA,EAAe;AAAA,SAChB,CAAA;AAED,QAAA,MAAM,IAAA,GAAO,QAAA,CAAS,QAAA,CAAS,GAAG,CAAA,GAAI,QAAA,CAAS,KAAA,CAAM,CAAA,EAAG,QAAA,CAAS,WAAA,CAAY,GAAG,CAAC,CAAA,GAAI,QAAA;AACrF,QAAA,OAAO;AAAA,UACL,IAAA,EAAM,IAAI,UAAA,CAAW,CAAC,CAAA;AAAA,UACtB,QAAA,EAAU,iBAAA,CAAkB,OAAA,CAAQ,YAAY,CAAA;AAAA,UAChD,QAAA,EAAU,CAAA,EAAG,IAAI,CAAA,CAAA,EAAI,QAAQ,YAAY,CAAA,CAAA;AAAA,UACzC,QAAA,EAAU,IAAA,CAAK,GAAA,EAAI,GAAI;AAAA,SACzB;AAAA,MACF,SAAS,CAAA,EAAG;AACV,QAAA,SAAA,GAAY,aAAa,KAAA,GAAQ,CAAA,GAAI,IAAI,KAAA,CAAM,MAAA,CAAO,CAAC,CAAC,CAAA;AAExD,QAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,UAAA,OAAA,CAAQ,MAAM,CAAA,yCAAA,EAA4C,OAAO,IAAI,UAAU,CAAA,QAAA,CAAA,EAAY,UAAU,OAAO,CAAA;AAAA,QAC9G;AAGA,QAAA,IAAI,IAAA,CAAK,cAAc,SAAS,CAAA,IAAK,KAAK,OAAA,CAAQ,oBAAA,IAAwB,UAAU,UAAA,EAAY;AAC9F,UAAA,IAAI,IAAA,CAAK,QAAQ,OAAA,EAAS;AACxB,YAAA,OAAA,CAAQ,MAAM,uEAAuE,CAAA;AAAA,UACvF;AACA,UAAA,MAAM,KAAK,UAAA,EAAW;AACtB,UAAA,MAAM,KAAK,WAAA,EAAY;AACvB,UAAA,IAAA,CAAK,WAAA,GAAc,IAAA;AAAA,QACrB,CAAA,MAAA,IAAW,UAAU,UAAA,EAAY;AAE/B,UAAA,MAAM,IAAI,OAAA,CAAQ,CAAA,CAAA,KAAK,UAAA,CAAW,CAAA,EAAG,GAAG,CAAC,CAAA;AAAA,QAC3C;AAAA,MACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,IAAa,IAAI,eAAA,CAAA,mBAAA,0BAAuD,mBAAmB,CAAA;AAAA,EACnG;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAA,CACJ,KAAA,EACA,OAAA,EACiB;AACjB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,IAAA,CAAK,KAAK,cAAA,EAAgB;AAAA,MAC/B,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B,aAAa,OAAA,CAAQ;AAAA,KACtB,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAA,CACJ,KAAA,EACA,OAAA,EACuB;AACvB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,IAAA,CAAK,KAAK,iBAAA,EAAmB;AAAA,MAClC,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B,aAAa,OAAA,CAAQ;AAAA,KACtB,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,UAAA,CACJ,KAAA,EACA,SACA,SAAA,EACA,KAAA,EACA,SAAS,CAAA,EACa;AACtB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,CAAK,YAAA,EAAc;AAAA,MAC3C,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B,aAAa,OAAA,CAAQ,WAAA;AAAA,MACrB,SAAA;AAAA,MACA,KAAA;AAAA,MACA;AAAA,KACD,CAAA;AAED,IAAA,OAAO;AAAA,MACL,IAAA,EAAM,SAAA;AAAA,MACN,IAAA,EAAM,IAAI,UAAA,CAAW,MAAA,CAAO,IAAI,CAAA;AAAA,MAChC,OAAO,MAAA,CAAO,KAAA;AAAA,MACd,QAAQ,MAAA,CAAO;AAAA,KACjB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAA,CACJ,KAAA,EACA,OAAA,EACA,aAAA,GAA+B,EAAC,EACR;AACxB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,CAAK,oBAAA,EAAsB;AAAA,MACnD,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B,aAAa,OAAA,CAAQ,WAAA;AAAA,MACrB,KAAA,EAAO,cAAc,KAAA,IAAS,GAAA;AAAA,MAC9B,MAAA,EAAQ,cAAc,MAAA,IAAU,CAAA;AAAA,MAChC,aAAa,aAAA,CAAc;AAAA,KAC5B,CAAA;AAED,IAAA,OAAO,MAAA,CAAO,GAAA,CAAI,CAAC,OAAA,MAAa;AAAA,MAC9B,MAAM,OAAA,CAAQ,IAAA;AAAA,MACd,IAAA,EAAM,IAAI,UAAA,CAAW,OAAA,CAAQ,IAAI,CAAA;AAAA,MACjC,OAAO,OAAA,CAAQ,KAAA;AAAA,MACf,QAAQ,OAAA,CAAQ;AAAA,KAClB,CAAE,CAAA;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,qBAAA,CACJ,KAAA,EACA,SACA,SAAA,EACA,aAAA,GAA0C,EAAC,EACV;AACjC,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,CAAK,uBAAA,EAAyB;AAAA,MACtD,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B,aAAa,OAAA,CAAQ,WAAA;AAAA,MACrB,SAAA;AAAA,MACA,GAAA,EAAK,cAAc,GAAA,IAAO,GAAA;AAAA,MAC1B,cAAc,aAAA,CAAc,YAAA;AAAA,MAC5B,QAAA,EAAU,cAAc,QAAA,IAAY;AAAA,KACrC,CAAA;AAED,IAAA,OAAO;AAAA,MACL,MAAM,MAAA,CAAO,IAAA;AAAA,MACb,IAAA,EAAM,IAAI,UAAA,CAAW,MAAA,CAAO,IAAI,CAAA;AAAA,MAChC,OAAO,MAAA,CAAO,KAAA;AAAA,MACd,QAAQ,MAAA,CAAO,MAAA;AAAA,MACf,KAAK,MAAA,CAAO;AAAA,KACd;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAA,CACJ,KAAA,EACA,WAAA,EACwB;AACxB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,IAAA,CAAK,KAAK,iBAAA,EAAmB;AAAA,MAClC,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B;AAAA,KACD,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAA,CACJ,KAAA,EACA,WAAA,EACmB;AACnB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,IAAA,CAAK,KAAK,cAAA,EAAgB;AAAA,MAC/B,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B;AAAA,KACD,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,YAAA,CACJ,KAAA,EACA,OAAA,EACwB;AACxB,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,cAAA,CAAe,KAAK,CAAA;AAC3C,IAAA,OAAO,IAAA,CAAK,KAAK,cAAA,EAAgB;AAAA,MAC/B,SAAA,EAAW,KAAA,CAAM,IAAA,CAAK,SAAS,CAAA;AAAA,MAC/B,aAAa,OAAA,CAAQ;AAAA,KACtB,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,eAAA,CACJ,SAAA,EACA,MAAA,EACA,IAAA,EACmC;AACnC,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,OAAO,IAAA,CAAK,IAAA,CAAK,iBAAA,EAAmB,EAAE,SAAA,EAAW,QAAQ,IAAA,EAAM,IAAA,IAAQ,EAAC,EAAG,CAAA;AAAA,EAC7E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,MAAM,cAAc,SAAA,EAAoD;AACtE,IAAA,IAAI,CAAC,IAAA,CAAK,WAAA,IAAe,CAAC,KAAK,KAAA,EAAO;AACpC,MAAA,MAAM,IAAI,eAAA;AAAA,QAAA,sBAAA;AAAA,QAER;AAAA,OACF;AAAA,IACF;AAEA,IAAA,MAAM,SAAS,MAAM,IAAA,CAAK,KAAK,eAAA,EAAiB,EAAE,WAAW,CAAA;AAC7D,IAAA,OAAO,MAAA,GAAS,IAAI,UAAA,CAAW,MAAM,CAAA,GAAI,MAAA;AAAA,EAC3C;AAAA,EAEA,MAAM,OAAA,GAAyB;AAC7B,IAAA,IAAI,KAAK,KAAA,EAAO;AAEd,MAAA,IAAI;AACF,QAAA,MAAM,IAAA,CAAK,KAAK,SAAS,CAAA;AAAA,MAC3B,CAAA,CAAA,MAAQ;AAAA,MAER;AAGA,MAAA,IAAI,KAAK,KAAA,EAAO;AACd,QAAA,IAAI;AACF,UAAA,IAAA,CAAK,KAAA,CAAM,KAAK,SAAS,CAAA;AAAA,QAC3B,CAAA,CAAA,MAAQ;AAAA,QAER;AACA,QAAA,IAAA,CAAK,KAAA,GAAQ,IAAA;AAAA,MACf;AAAA,IACF;AACA,IAAA,IAAA,CAAK,WAAA,GAAc,KAAA;AACnB,IAAA,IAAA,CAAK,QAAQ,KAAA,EAAM;AAAA,EACrB;AAAA,EAEA,OAAA,GAAmB;AAAE,IAAA,OAAO,IAAA,CAAK,WAAA,IAAe,IAAA,CAAK,KAAA,KAAU,IAAA;AAAA,EAAM;AACvE;AAEA,eAAsB,yBAAA,CAA0B,OAAA,GAAsC,EAAC,EAAiC;AACtH,EAAA,MAAM,CAAA,GAAI,IAAI,mBAAA,CAAoB,OAAO,CAAA;AACzC,EAAA,MAAM,EAAE,UAAA,EAAW;AACnB,EAAA,OAAO,CAAA;AACT;AC7hBA,IAAI,WAAA,GAAgD,MAAA;AAKpD,eAAsB,gBAAA,GAAqC;AACzD,EAAA,IAAI,gBAAgB,MAAA,EAAW;AAC7B,IAAA,IAAI;AAEF,MAAA,MAAM,GAAA,GAAM,MAAM,OAAO,OAAO,CAAA;AAChC,MAAA,WAAA,GAAc,GAAA,CAAI,OAAA;AAAA,IACpB,CAAA,CAAA,MAAQ;AACN,MAAA,WAAA,GAAc,IAAA;AAAA,IAChB;AAAA,EACF;AACA,EAAA,OAAO,WAAA,KAAgB,IAAA;AACzB;AAMA,eAAsB,QAAA,GAA0C;AAC9D,EAAA,IAAI,gBAAgB,MAAA,EAAW;AAC7B,IAAA,MAAM,gBAAA,EAAiB;AAAA,EACzB;AACA,EAAA,OAAO,WAAA,IAAe,IAAA;AACxB;AAiCA,eAAsB,WAAA,CACpB,UACA,KAAA,EACA,MAAA,EACA,UAA8B,EAAE,MAAA,EAAQ,OAAM,EAC7B;AACjB,EAAA,MAAM,KAAA,GAAQ,MAAM,QAAA,EAAS;AAE7B,EAAA,IAAI,KAAA,EAAO;AACT,IAAA,OAAO,eAAA,CAAgB,KAAA,EAAO,QAAA,EAAU,KAAA,EAAO,QAAQ,OAAO,CAAA;AAAA,EAChE;AAGA,EAAA,IAAI,OAAA,CAAQ,WAAW,KAAA,EAAO;AAC5B,IAAA,MAAM,IAAI,KAAA;AAAA,MACR,CAAA,QAAA,EAAW,QAAQ,MAAM,CAAA,oEAAA;AAAA,KAE3B;AAAA,EACF;AAEA,EAAA,OAAO,iBAAA,CAAkB,QAAA,EAAU,KAAA,EAAO,MAAM,CAAA;AAClD;AAKA,eAAe,eAAA,CACb,KAAA,EACA,QAAA,EACA,KAAA,EACA,QACA,OAAA,EACiB;AACjB,EAAA,IAAI,QAAA,GAA0B,KAAA,CAAM,MAAA,CAAO,IAAA,CAAK,QAAQ,CAAA,EAAG;AAAA,IACzD,GAAA,EAAK;AAAA,MACH,KAAA;AAAA,MACA,MAAA;AAAA,MACA,QAAA,EAAU;AAAA;AACZ,GACD,CAAA;AAED,EAAA,QAAQ,QAAQ,MAAA;AAAQ,IACtB,KAAK,KAAA;AACH,MAAA,QAAA,GAAW,SAAS,GAAA,CAAI;AAAA,QACtB,gBAAA,EAAkB,QAAQ,gBAAA,IAAoB;AAAA,OAC/C,CAAA;AACD,MAAA;AAAA,IACF,KAAK,MAAA;AACH,MAAA,QAAA,GAAW,SAAS,IAAA,CAAK;AAAA,QACvB,OAAA,EAAS,QAAQ,OAAA,IAAW;AAAA,OAC7B,CAAA;AACD,MAAA;AAAA,IACF,KAAK,MAAA;AACH,MAAA,QAAA,GAAW,SAAS,IAAA,CAAK;AAAA,QACvB,OAAA,EAAS,QAAQ,OAAA,IAAW;AAAA,OAC7B,CAAA;AACD,MAAA;AAAA;AAGJ,EAAA,OAAO,SAAS,QAAA,EAAS;AAC3B;AAMA,SAAS,iBAAA,CACP,QAAA,EACA,KAAA,EACA,MAAA,EACQ;AAER,EAAA,MAAM,SAAA,GAAY,MAAA,CAAO,IAAA,CAAK,CAAC,GAAA,EAAK,EAAA,EAAI,EAAA,EAAI,EAAA,EAAI,EAAA,EAAI,EAAA,EAAI,EAAA,EAAI,EAAE,CAAC,CAAA;AAG/D,EAAA,MAAM,QAAA,GAAqB,IAAI,KAAA,CAAM,GAAG,CAAA;AACxC,EAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,GAAA,EAAK,CAAA,EAAA,EAAK;AAC5B,IAAA,IAAI,CAAA,GAAI,CAAA;AACR,IAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,CAAA,EAAG,CAAA,EAAA,EAAK;AAC1B,MAAA,CAAA,GAAI,CAAA,GAAI,CAAA,GAAI,UAAA,GAAc,CAAA,KAAM,IAAK,CAAA,KAAM,CAAA;AAAA,IAC7C;AACA,IAAA,QAAA,CAAS,CAAC,CAAA,GAAI,CAAA;AAAA,EAChB;AAEA,EAAA,SAAS,MAAM,IAAA,EAAsB;AACnC,IAAA,IAAI,GAAA,GAAM,UAAA;AACV,IAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,IAAA,CAAK,QAAQ,CAAA,EAAA,EAAK;AACpC,MAAA,MAAM,UAAA,GAAA,CAAc,GAAA,GAAM,IAAA,CAAK,CAAC,CAAA,IAAM,GAAA;AACtC,MAAA,GAAA,GAAM,QAAA,CAAS,UAAU,CAAA,GAAM,GAAA,KAAQ,CAAA;AAAA,IACzC;AACA,IAAA,OAAA,CAAQ,MAAM,UAAA,MAAgB,CAAA;AAAA,EAChC;AAEA,EAAA,SAAS,WAAA,CAAY,MAAc,IAAA,EAAsB;AACvD,IAAA,MAAM,SAAA,GAAY,MAAA,CAAO,IAAA,CAAK,IAAI,CAAA;AAClC,IAAA,MAAM,MAAA,GAAS,MAAA,CAAO,KAAA,CAAM,CAAC,CAAA;AAC7B,IAAA,MAAA,CAAO,aAAA,CAAc,KAAK,MAAM,CAAA;AAChC,IAAA,MAAM,UAAU,MAAA,CAAO,MAAA,CAAO,CAAC,SAAA,EAAW,IAAI,CAAC,CAAA;AAC/C,IAAA,MAAM,QAAA,GAAW,MAAA,CAAO,KAAA,CAAM,CAAC,CAAA;AAC/B,IAAA,QAAA,CAAS,aAAA,CAAc,KAAA,CAAM,OAAO,CAAC,CAAA;AACrC,IAAA,OAAO,OAAO,MAAA,CAAO,CAAC,QAAQ,SAAA,EAAW,IAAA,EAAM,QAAQ,CAAC,CAAA;AAAA,EAC1D;AAGA,EAAA,MAAM,IAAA,GAAO,MAAA,CAAO,KAAA,CAAM,EAAE,CAAA;AAC5B,EAAA,IAAA,CAAK,aAAA,CAAc,OAAO,CAAC,CAAA;AAC3B,EAAA,IAAA,CAAK,aAAA,CAAc,QAAQ,CAAC,CAAA;AAC5B,EAAA,IAAA,CAAK,CAAC,CAAA,GAAI,CAAA;AACV,EAAA,IAAA,CAAK,CAAC,CAAA,GAAI,CAAA;AACV,EAAA,IAAA,CAAK,EAAE,CAAA,GAAI,CAAA;AACX,EAAA,IAAA,CAAK,EAAE,CAAA,GAAI,CAAA;AACX,EAAA,IAAA,CAAK,EAAE,CAAA,GAAI,CAAA;AACX,EAAA,MAAM,SAAA,GAAY,WAAA,CAAY,MAAA,EAAQ,IAAI,CAAA;AAI1C,EAAA,MAAM,OAAA,GAAU,IAAI,KAAA,GAAQ,CAAA;AAC5B,EAAA,MAAM,OAAA,GAAU,MAAA,CAAO,KAAA,CAAM,MAAA,GAAS,OAAO,CAAA;AAC7C,EAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,MAAA,EAAQ,CAAA,EAAA,EAAK;AAC/B,IAAA,MAAM,YAAY,CAAA,GAAI,OAAA;AACtB,IAAA,OAAA,CAAQ,SAAS,CAAA,GAAI,CAAA;AACrB,IAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,KAAA,EAAO,CAAA,EAAA,EAAK;AAC9B,MAAA,MAAM,SAAA,GAAA,CAAa,CAAA,GAAI,KAAA,GAAQ,CAAA,IAAK,CAAA;AACpC,MAAA,MAAM,SAAA,GAAY,SAAA,GAAY,CAAA,GAAI,CAAA,GAAI,CAAA;AACtC,MAAA,OAAA,CAAQ,SAAS,CAAA,GAAI,QAAA,CAAS,SAAS,CAAA,IAAK,CAAA;AAC5C,MAAA,OAAA,CAAQ,YAAY,CAAC,CAAA,GAAI,QAAA,CAAS,SAAA,GAAY,CAAC,CAAA,IAAK,CAAA;AACpD,MAAA,OAAA,CAAQ,YAAY,CAAC,CAAA,GAAI,QAAA,CAAS,SAAA,GAAY,CAAC,CAAA,IAAK,CAAA;AACpD,MAAA,OAAA,CAAQ,YAAY,CAAC,CAAA,GAAI,QAAA,CAAS,SAAA,GAAY,CAAC,CAAA,IAAK,CAAA;AAAA,IACtD;AAAA,EACF;AAGA,EAAA,MAAM,UAAA,GAAaS,iBAAY,OAAO,CAAA;AACtC,EAAA,MAAM,SAAA,GAAY,WAAA,CAAY,MAAA,EAAQ,UAAU,CAAA;AAGhD,EAAA,MAAM,YAAY,WAAA,CAAY,MAAA,EAAQ,MAAA,CAAO,KAAA,CAAM,CAAC,CAAC,CAAA;AAErD,EAAA,OAAO,OAAO,MAAA,CAAO,CAAC,WAAW,SAAA,EAAW,SAAA,EAAW,SAAS,CAAC,CAAA;AACnE;AASA,eAAsB,SAAA,CACpB,QAAA,EACA,KAAA,EACA,MAAA,EACiB;AACjB,EAAA,OAAO,YAAY,QAAA,EAAU,KAAA,EAAO,QAAQ,EAAE,MAAA,EAAQ,OAAO,CAAA;AAC/D;AAUA,eAAsB,UAAA,CACpB,QAAA,EACA,KAAA,EACA,MAAA,EACA,UAAU,EAAA,EACO;AACjB,EAAA,OAAO,WAAA,CAAY,UAAU,KAAA,EAAO,MAAA,EAAQ,EAAE,MAAA,EAAQ,MAAA,EAAQ,SAAS,CAAA;AACzE;AAUA,eAAsB,UAAA,CACpB,QAAA,EACA,KAAA,EACA,MAAA,EACA,UAAU,EAAA,EACO;AACjB,EAAA,OAAO,WAAA,CAAY,UAAU,KAAA,EAAO,MAAA,EAAQ,EAAE,MAAA,EAAQ,MAAA,EAAQ,SAAS,CAAA;AACzE;;;AC7PO,IAAe,eAAf,MAA4B;AAAA,EACvB,GAAA;AAAA,EACA,MAAA;AAAA,EACA,OAAA;AAAA,EACA,SAAA,GAAoB,EAAA;AAAA,EAE9B,WAAA,CAAY,GAAA,EAAkB,MAAA,EAAgB,OAAA,GAA+B,EAAC,EAAG;AAC/E,IAAA,IAAA,CAAK,GAAA,GAAM,GAAA;AACX,IAAA,IAAA,CAAK,MAAA,GAAS,MAAA;AACd,IAAA,IAAA,CAAK,OAAA,GAAU;AAAA,MACb,gBAAA,EAAkB,QAAQ,gBAAA,IAAoB,GAAA;AAAA,MAC9C,GAAG;AAAA,KACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAgBA,SAAA,GAAoB;AAClB,IAAA,OAAO,IAAA,CAAK,MAAA;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKA,cAAA,GAA8B;AAC5B,IAAA,OAAO,IAAA,CAAK,GAAA;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAMA,IAAA,GAA0C;AACxC,IAAA,IAAI;AAEF,MAAA,IAAI,CAAC,KAAK,SAAA,EAAW;AACnB,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,mBAAA,EAAqB,gCAAgC,CAAA;AAAA,MACrF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAA;AAChD,MAAA,OAAO,KAAK,YAAA,CAAa,EAAE,IAAA,EAAM,IAAA,CAAK,WAAW,CAAA;AAAA,IACnD,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,aAAA,EAAgB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC/D;AAAA,EACF;AAAA,EAEA,MAAA,CAAO,MAAc,MAAA,EAAyD;AAC5E,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,IAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,IAAA,EAAM,QAAQ,EAAE,CAAA;AACrD,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,IAAA,EAAM,CAAA;AAAA,IACnC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,eAAA,EAAkB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACjE;AAAA,EACF;AAAA,EAEA,KAAA,GAA+B;AAC7B,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAM,CAAA;AACpC,MAAA,IAAA,CAAK,MAAA,GAAS,CAAA;AACd,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,cAAA,EAAiB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAChE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,WAAA,GAAsB;AACpB,IAAA,OAAO,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,IAAA,CAAK,MAAM,CAAA;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,cAAA,GAAwD;AACtD,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,KAAK,MAAM,CAAA;AACnD,MAAA,IAAI,eAAe,CAAA,EAAG;AAEpB,QAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,QAAA,EAAU,GAAG,CAAA;AAAA,MAC1C;AAGA,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAA;AAEhD,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,KAAK,MAAM,CAAA;AAClD,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,IAAA;AAAA,QACT,UAAU,SAAA,KAAc,CAAA;AAAA,QACxB,IAAA,EAAM,EAAE,QAAA,EAAU,SAAA;AAAU,OAC9B;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,4BAAA,EAA+B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC9E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,IAAA,GAA8B;AAC5B,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAA;AAChD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,aAAA,EAAgB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC/D;AAAA,EACF;AAAA,EAEA,IAAA,GAA8B;AAC5B,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAA;AAChD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,aAAA,EAAgB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC/D;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,IAAA,CAAK,MAAc,OAAA,EAAoF;AACrG,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,SAAA,CAAU;AAAA,QAChC,yBAAA,EAA2B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA,EAAK;AAAA,QACzD,qBAAA,EAAuB,EAAE,IAAA,EAAM,SAAA,EAAW,OAAO,KAAA,EAAM;AAAA,QACvD,sBAAA,EAAwB,EAAE,IAAA,EAAM,SAAA,EAAW,OAAO,IAAA,EAAK;AAAA,QACvD,wBAAwB,EAAE,IAAA,EAAM,WAAW,KAAA,EAAO,OAAA,EAAS,iBAAiB,KAAA,EAAM;AAAA,QAClF,uBAAuB,EAAE,IAAA,EAAM,WAAW,KAAA,EAAO,OAAA,EAAS,aAAa,KAAA;AAAM,OAC9E,CAAA;AAED,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,sBAAsB,UAAU,CAAA;AAGrE,MAAA,MAAM,YAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,IAAA,CAAK,QAAQ,YAAY,CAAA;AACrE,MAAA,MAAM,QAAA,GAAW,SAAA,KAAc,IAAA,IAAQ,SAAA,CAAU,MAAA,GAAS,CAAA;AAE1D,MAAA,OAAO,KAAK,YAAA,CAAa;AAAA,QACvB,OAAA,EAAS,WAAW,CAAA,GAAI,CAAA;AAAA;AAAA,QACxB,YAAY,QAAA,GAAW,EAAE,GAAG,CAAA,EAAG,CAAA,EAAG,GAAE,GAAI,KAAA;AAAA,OACzC,CAAA;AAAA,IACH,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,aAAA,EAAgB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC/D;AAAA,EACF;AAAA,EAEA,iBAAA,CAAkB,IAAA,EAAc,OAAA,EAAiB,OAAA,EAAkE;AACjH,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,SAAA,CAAU;AAAA,QAChC,yBAAA,EAA2B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA,EAAK;AAAA,QACzD,0BAAA,EAA4B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,OAAA,EAAQ;AAAA,QAC7D,oBAAA,EAAsB,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,CAAA,EAAE;AAAA;AAAA,QAC/C,wBAAwB,EAAE,IAAA,EAAM,WAAW,KAAA,EAAO,OAAA,EAAS,iBAAiB,KAAA,EAAM;AAAA,QAClF,uBAAuB,EAAE,IAAA,EAAM,WAAW,KAAA,EAAO,OAAA,EAAS,aAAa,KAAA;AAAM,OAC9E,CAAA;AAED,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,sBAAsB,UAAU,CAAA;AAGrE,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,YAAA,EAAc,IAAI,CAAA;AAAA,IAC/C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,gBAAA,EAAmB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAClE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,eAAA,GAAwD;AACtD,IAAA,IAAI;AACF,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,GAAA,CAAI,gBAAA,EAAiB;AACzC,MAAA,OAAO,IAAA,CAAK,aAAa,MAAM,CAAA;AAAA,IACjC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,8BAAA,EAAiC,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAChF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,iBAAA,GAA0D;AACxD,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAM,CAAA;AACnC,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,GAAA,CAAI,gBAAA,EAAiB;AACzC,MAAA,OAAO,IAAA,CAAK,aAAa,MAAM,CAAA;AAAA,IACjC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,gCAAA,EAAmC,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAClF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,kBAAA,GAA2B;AACzB,IAAA,IAAA,CAAK,IAAI,kBAAA,EAAmB;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA,EAMA,OAAO,UAAA,EAAmE;AACxE,IAAA,IAAI;AAGF,MAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,IAAA,CAAK,QAAQ,YAAY,CAAA;AAChE,MAAA,OAAO,KAAK,YAAA,CAAa,EAAE,QAAA,EAAU,IAAA,IAAQ,IAAI,CAAA;AAAA,IACnD,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,eAAA,EAAkB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACjE;AAAA,EACF;AAAA,EAEA,YAAA,GAAyE;AACvE,IAAA,IAAI;AACF,MAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,IAAA,CAAK,QAAQ,YAAY,CAAA;AAChE,MAAA,OAAO,KAAK,YAAA,CAAa;AAAA,QACvB,MAAM,IAAA,IAAQ,EAAA;AAAA,QACd,KAAA,EAAO,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,EAAE,SAAA,EAAW,CAAA,EAAG,SAAA,EAAW,CAAA,EAAE;AAAE,OAC9D,CAAA;AAAA,IACH,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA,EAEA,cAAA,GAAwC;AACtC,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAM,CAAA;AACnC,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMU,aAAgB,IAAA,EAA6B;AACrD,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,QAAA,EAAU,IAAA;AAAA,MACV;AAAA,KACF;AAAA,EACF;AAAA,EAEU,iBAAA,CAAqB,OAAe,UAAA,EAAyC;AACrF,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,KAAA;AAAA,MACT,QAAA,EAAU,KAAA;AAAA,MACV,KAAA;AAAA,MACA;AAAA,KACF;AAAA,EACF;AAAA,EAEU,0BAAA,CAA8B,MAAS,UAAA,EAAiD;AAChG,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,IAAA;AAAA,MACT,QAAA,EAAU,IAAA;AAAA,MACV,IAAA;AAAA,MACA,SAAA,EAAW;AAAA,KACb;AAAA,EACF;AAAA,EAEU,eAAA,CAAgB,SAAiB,QAAA,EAKzC;AACA,IAAA,MAAM,KAAA,GAAQ,QAAA,IAAY,IAAA,CAAK,OAAA,CAAQ,gBAAA;AACvC,IAAA,MAAM,WAAW,OAAA,CAAQ,MAAA;AAEzB,IAAA,IAAI,YAAY,KAAA,EAAO;AACrB,MAAA,OAAO,EAAE,OAAA,EAAS,SAAA,EAAW,KAAA,EAAO,QAAA,EAAU,UAAU,QAAA,EAAS;AAAA,IACnE;AAGA,IAAA,IAAI,SAAA,GAAY,OAAA,CAAQ,KAAA,CAAM,CAAA,EAAG,KAAK,CAAA;AACtC,IAAA,MAAM,SAAA,GAAY,SAAA,CAAU,WAAA,CAAY,GAAG,CAAA;AAC3C,IAAA,IAAI,SAAA,GAAY,QAAQ,GAAA,EAAK;AAC3B,MAAA,SAAA,GAAY,SAAA,CAAU,KAAA,CAAM,CAAA,EAAG,SAAS,CAAA;AAAA,IAC1C;AAEA,IAAA,OAAO;AAAA,MACL,OAAA,EAAS,SAAA;AAAA,MACT,SAAA,EAAW,IAAA;AAAA,MACX,QAAA;AAAA,MACA,UAAU,SAAA,CAAU;AAAA,KACtB;AAAA,EACF;AAAA,EAEU,aAAA,CAAiB,KAAA,EAAY,QAAA,EAAkB,YAAA,EAKvD;AACA,IAAA,MAAM,WAAW,KAAA,CAAM,MAAA;AACvB,IAAA,IAAI,SAAA,GAAY,CAAA;AAChB,IAAA,IAAI,aAAA,GAAgB,CAAA;AAEpB,IAAA,KAAA,MAAW,QAAQ,KAAA,EAAO;AACxB,MAAA,MAAM,OAAA,GAAU,aAAa,IAAI,CAAA;AACjC,MAAA,IAAI,SAAA,GAAY,OAAA,CAAQ,MAAA,GAAS,QAAA,EAAU;AACzC,QAAA;AAAA,MACF;AACA,MAAA,SAAA,IAAa,OAAA,CAAQ,MAAA;AACrB,MAAA,aAAA,EAAA;AAAA,IACF;AAEA,IAAA,OAAO;AAAA,MACL,KAAA,EAAO,KAAA,CAAM,KAAA,CAAM,CAAA,EAAG,aAAa,CAAA;AAAA,MACnC,WAAW,aAAA,GAAgB,QAAA;AAAA,MAC3B,QAAA;AAAA,MACA,QAAA,EAAU;AAAA,KACZ;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMU,WAAW,EAAA,EAA0C;AAC7D,IAAA,MAAM,KAAA,GAAQ,EAAA,CAAG,KAAA,CAAM,kBAAkB,CAAA;AACzC,IAAA,IAAI,CAAC,KAAA,EAAO;AACV,MAAA,MAAM,IAAI,KAAA,CAAM,CAAA,qBAAA,EAAwB,EAAE,CAAA,CAAE,CAAA;AAAA,IAC9C;AAEA,IAAA,MAAM,MAAA,GAAS,KAAA,CAAM,CAAC,CAAA,CAAG,WAAA,EAAY;AACrC,IAAA,MAAM,MAAA,GAAS,MAAM,CAAC,CAAA;AAEtB,IAAA,IAAI,GAAA,GAAM,CAAA;AACV,IAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,MAAA,CAAO,QAAQ,CAAA,EAAA,EAAK;AACtC,MAAA,GAAA,GAAM,GAAA,GAAM,EAAA,IAAM,MAAA,CAAO,UAAA,CAAW,CAAC,CAAA,GAAI,EAAA,CAAA;AAAA,IAC3C;AACA,IAAA,GAAA,IAAO,CAAA;AAEP,IAAA,MAAM,GAAA,GAAM,QAAA,CAAS,MAAA,EAAQ,EAAE,CAAA,GAAI,CAAA;AAEnC,IAAA,OAAO,EAAE,KAAK,GAAA,EAAI;AAAA,EACpB;AAAA,EAEU,UAAA,CAAW,KAAa,GAAA,EAAqB;AACrD,IAAA,IAAI,MAAA,GAAS,EAAA;AACb,IAAA,IAAI,IAAI,GAAA,GAAM,CAAA;AAEd,IAAA,OAAO,IAAI,CAAA,EAAG;AACZ,MAAA,MAAM,SAAA,GAAA,CAAa,IAAI,CAAA,IAAK,EAAA;AAC5B,MAAA,MAAA,GAAS,MAAA,CAAO,YAAA,CAAa,EAAA,GAAK,SAAS,CAAA,GAAI,MAAA;AAC/C,MAAA,CAAA,GAAI,IAAA,CAAK,KAAA,CAAA,CAAO,CAAA,GAAI,CAAA,IAAK,EAAE,CAAA;AAAA,IAC7B;AAEA,IAAA,OAAO,CAAA,EAAG,MAAM,CAAA,EAAG,GAAA,GAAM,CAAC,CAAA,CAAA;AAAA,EAC5B;AAAA,EAEU,iBAAiB,GAAA,EAA4C;AACrE,IAAA,IAAI,OAAO,QAAQ,QAAA,EAAU;AAC3B,MAAA,OAAO,IAAA,CAAK,WAAW,GAAG,CAAA;AAAA,IAC5B;AACA,IAAA,OAAO,GAAA;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAMA,aAAa,IAAA,EAAoB;AAC/B,IAAA,IAAA,CAAK,SAAA,GAAY,IAAA;AAAA,EACnB;AAAA,EAEA,MAAA,GAAkB;AAChB,IAAA,OAAO,KAAK,MAAA,KAAW,CAAA;AAAA,EACzB;AACF;;;AC5ZO,IAAM,YAAA,GAAN,cAA2B,YAAA,CAAa;AAAA,EACrC,gBAAA,GAAoC,IAAA;AAAA,EAE5C,eAAA,GAA4B;AAC1B,IAAA,OAAO,QAAA;AAAA,EACT;AAAA,EAEA,aAAa,OAAA,EAA2E;AACtF,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,qBAAA,EAAsB;AAC9C,MAAA,MAAM,QAAA,GAAW,OAAA,EAAS,gBAAA,IAAoB,IAAA,CAAK,OAAA,CAAQ,gBAAA;AAE3D,MAAA,MAAM,cAAA,GAAiB,UAAA,CAAW,GAAA,CAAI,CAAC,MAAM,KAAA,MAAW;AAAA,QACtD,KAAA;AAAA,QACA,OAAA,EAAS,KAAK,KAAA,CAAM,CAAA,EAAG,GAAG,CAAA,IAAK,IAAA,CAAK,MAAA,GAAS,GAAA,GAAM,KAAA,GAAQ,EAAA,CAAA;AAAA,QAC3D,KAAA,EAAO,QAAA;AAAA;AAAA,QACP,WAAW,IAAA,CAAK;AAAA,OAClB,CAAE,CAAA;AAGF,MAAA,MAAM,cAAc,IAAA,CAAK,aAAA;AAAA,QACvB,cAAA;AAAA,QACA,QAAA;AAAA,QACA,CAAC,CAAA,KAAM,IAAA,CAAK,SAAA,CAAU,CAAC;AAAA,OACzB;AAEA,MAAA,MAAM,SAAA,GAA6B;AAAA,QACjC,IAAA,EAAM,QAAA;AAAA,QACN,YAAY,WAAA,CAAY,KAAA;AAAA,QACxB,SAAA,EAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAAA,QAChD,SAAA,EAAW,UAAA,CAAW,IAAA,CAAK,GAAG,CAAA,CAAE,KAAA,CAAM,KAAK,CAAA,CAAE,MAAA,CAAO,CAAA,CAAA,KAAK,CAAA,CAAE,MAAA,GAAS,CAAC,CAAA,CAAE;AAAA,OACzE;AAEA,MAAA,IAAI,YAAY,SAAA,EAAW;AACzB,QAAA,OAAO,IAAA,CAAK,2BAA2B,SAAA,EAAW;AAAA,UAChD,UAAU,WAAA,CAAY,QAAA;AAAA,UACtB,UAAU,WAAA,CAAY,QAAA;AAAA,UACtB,SAAS,CAAA,QAAA,EAAW,WAAA,CAAY,QAAQ,CAAA,IAAA,EAAO,YAAY,QAAQ,CAAA,yDAAA;AAAA,SACpE,CAAA;AAAA,MACH;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,SAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA,EAEA,aAAa,KAAA,EAA2C;AACtD,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,qBAAA,EAAsB;AAE9C,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,UAAA,CAAW,MAAA,EAAQ;AAC3C,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,CAAA,gBAAA,EAAmB,KAAK,CAAA,iBAAA,EAAoB,UAAA,CAAW,SAAS,CAAC,CAAA,CAAA,CAAA;AAAA,UACjE,CAAA,8CAAA;AAAA,SACF;AAAA,MACF;AAEA,MAAA,MAAM,IAAA,GAAO,WAAW,KAAK,CAAA;AAC7B,MAAA,OAAO,KAAK,YAAA,CAAa;AAAA,QACvB,KAAA;AAAA,QACA,IAAA;AAAA,QACA,KAAA,EAAO,QAAA;AAAA,QACP,WAAW,IAAA,CAAK;AAAA,OACjB,CAAA;AAAA,IACH,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA,EAEA,aAAA,CAAc,OAAe,KAAA,EAA6C;AACxE,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,qBAAA,EAAsB;AAE9C,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,UAAA,CAAW,MAAA,EAAQ;AAC3C,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,eAAe,KAAK,CAAA,aAAA,CAAA;AAAA,UACpB,CAAA,eAAA,EAAkB,UAAA,CAAW,MAAA,GAAS,CAAC,CAAA;AAAA,SACzC;AAAA,MACF;AAEA,MAAA,MAAM,MAAM,IAAA,CAAK,GAAA,CAAI,KAAA,GAAQ,KAAA,EAAO,WAAW,MAAM,CAAA;AACrD,MAAA,MAAM,MAAA,GAAS,WAAW,KAAA,CAAM,KAAA,EAAO,GAAG,CAAA,CAAE,GAAA,CAAI,CAAC,IAAA,EAAM,CAAA,MAAO;AAAA,QAC5D,OAAO,KAAA,GAAQ,CAAA;AAAA,QACf,IAAA;AAAA,QACA,KAAA,EAAO,QAAA;AAAA,QACP,WAAW,IAAA,CAAK;AAAA,OAClB,CAAE,CAAA;AAEF,MAAA,OAAO,IAAA,CAAK,aAAa,MAAM,CAAA;AAAA,IACjC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,0BAAA,EAA6B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5E;AAAA,EACF;AAAA,EAEA,eAAA,CAAgB,MAAc,OAAA,EAGS;AACrC,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,qBAAA,EAAsB;AAC9C,MAAA,MAAM,cAAc,OAAA,EAAS,UAAA,KAAe,SACxC,OAAA,CAAQ,UAAA,GAAa,IACrB,UAAA,CAAW,MAAA;AAGf,MAAA,IAAI,WAAA,GAAc,CAAA,IAAK,WAAA,IAAe,UAAA,CAAW,MAAA,EAAQ;AAEvD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,CAAA;AAAA,MAC1D;AAGA,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAGtD,MAAA,MAAM,QAAA,GAAW,KAAK,SAAA,CAAU;AAAA,QAC9B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA;AAAK,OACrC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,QAAQ,CAAA;AAGhE,MAAA,IAAI,OAAA,EAAS,KAAA,IAAS,OAAA,CAAQ,KAAA,KAAU,QAAA,EAAU;AAChD,QAAA,MAAM,QAAA,GAAmC;AAAA,UACvC,WAAA,EAAa,WAAA;AAAA,UACb,WAAA,EAAa,WAAA;AAAA,UACb,WAAA,EAAa,WAAA;AAAA,UACb,MAAA,EAAQ;AAAA,SACV;AACA,QAAA,MAAM,SAAA,GAAY,QAAA,CAAS,OAAA,CAAQ,KAAK,CAAA;AACxC,QAAA,IAAI,SAAA,EAAW;AACb,UAAA,MAAM,SAAA,GAAY,KAAK,SAAA,CAAU;AAAA,YAC/B,QAAA,EAAU,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,SAAA,EAAU;AAAA,YAC7C,MAAA,EAAQ,EAAE,IAAA,EAAM,OAAA,EAAS,OAAO,CAAA;AAAE;AAAA,WACnC,CAAA;AACD,UAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,SAAS,CAAA;AAAA,QACnE;AAAA,MACF;AAGA,MAAA,IAAA,CAAK,gBAAA,GAAmB,IAAA;AAGxB,MAAA,MAAM,aAAA,GAAgB,KAAK,qBAAA,EAAsB;AACjD,MAAA,MAAM,QAAA,GAAW,aAAA,CAAc,MAAA,GAAS,UAAA,CAAW,MAAA;AAEnD,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,IAAA;AAAA,QACT,QAAA;AAAA,QACA,IAAA,EAAM,EAAE,KAAA,EAAO,WAAA;AAAY,OAC7B;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,4BAAA,EAA+B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC9E;AAAA,EACF;AAAA,EAEA,gBAAA,CAAiB,OAAe,IAAA,EAAoD;AAClF,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,qBAAA,EAAsB;AAE9C,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,UAAA,CAAW,MAAA,EAAQ;AAC3C,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,mBAAmB,KAAK,CAAA,aAAA,CAAA;AAAA,UACxB,CAAA,eAAA,EAAkB,UAAA,CAAW,MAAA,GAAS,CAAC,CAAA;AAAA,SACzC;AAAA,MACF;AAEA,MAAA,MAAM,OAAA,GAAU,WAAW,KAAK,CAAA;AAIhC,MAAA,MAAM,eAAA,GAAkB,KAAK,SAAA,CAAU;AAAA,QACrC,yBAAA,EAA2B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,OAAA,EAAQ;AAAA,QAC5D,0BAAA,EAA4B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA,EAAK;AAAA,QAC1D,oBAAA,EAAsB,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,CAAA;AAAE;AAAA,OAChD,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,sBAAsB,eAAe,CAAA;AAG1E,MAAA,IAAA,CAAK,gBAAA,GAAmB,IAAA;AAExB,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,OAAA,EAAS,CAAA;AAAA,IACtC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,6BAAA,EAAgC,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC/E;AAAA,EACF;AAAA,EAEA,gBAAgB,KAAA,EAAyD;AACvE,IAAA,IAAI;AACF,MAAA,MAAM,UAAA,GAAa,KAAK,qBAAA,EAAsB;AAE9C,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,UAAA,CAAW,MAAA,EAAQ;AAC3C,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,mBAAmB,KAAK,CAAA,aAAA,CAAA;AAAA,UACxB,CAAA,eAAA,EAAkB,UAAA,CAAW,MAAA,GAAS,CAAC,CAAA;AAAA,SACzC;AAAA,MACF;AAEA,MAAA,MAAM,WAAA,GAAc,WAAW,KAAK,CAAA;AAGpC,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,gBAAA,CAAiB,KAAA,EAAO,EAAE,CAAA;AAC9C,MAAA,IAAI,CAAC,OAAO,OAAA,EAAS;AACnB,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,MAAA,CAAO,KAAA,IAAS,kBAAkB,CAAA;AAAA,MAClE;AAEA,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,WAAA,EAAa,CAAA;AAAA,IAC1C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,4BAAA,EAA+B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC9E;AAAA,EACF;AAAA,EAEA,UAAA,CAAW,MAAc,SAAA,EAAgD;AACvE,IAAA,IAAI;AAEF,MAAA,MAAM,QAAA,GAAW,KAAK,SAAA,CAAU;AAAA,QAC9B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA;AAAK,OACrC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,QAAQ,CAAA;AAEhE,MAAA,IAAA,CAAK,gBAAA,GAAmB,IAAA;AACxB,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA,EAEA,UAAA,CAAW,QAAsB,IAAA,EAA0D;AACzF,IAAA,IAAI;AAGF,MAAA,MAAM,YAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,IAAA,CAAK,QAAQ,YAAY,CAAA;AAGrE,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,aAAa,CAAA;AAElD,MAAA,IAAA,CAAK,gBAAA,GAAmB,IAAA;AACxB,MAAA,OAAO,KAAK,YAAA,CAAa,EAAE,OAAA,EAAS,SAAA,IAAa,IAAI,CAAA;AAAA,IACvD,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA,EAEA,WAAA,CAAY,IAAA,EAAc,OAAA,EAAiB,OAAA,EAGG;AAC5C,IAAA,IAAI;AACF,MAAA,MAAM,OAAA,GAAU,OAAA,EAAS,GAAA,GAAM,CAAA,GAAI,CAAA;AAEnC,MAAA,MAAM,UAAA,GAAa,KAAK,SAAA,CAAU;AAAA,QAChC,yBAAA,EAA2B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA,EAAK;AAAA,QACzD,0BAAA,EAA4B,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,OAAA,EAAQ;AAAA,QAC7D,oBAAA,EAAsB,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,OAAA;AAAQ,OACtD,CAAA;AAED,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,sBAAsB,UAAU,CAAA;AAErE,MAAA,IAAA,CAAK,gBAAA,GAAmB,IAAA;AAGxB,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,YAAA,EAAc,IAAI,CAAA;AAAA,IAC/C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA,EAEA,UAAA,CAAW,QAAmB,MAAA,EAA2C;AACvE,IAAA,IAAI;AAGF,MAAA,IAAI,MAAA,CAAO,SAAS,KAAA,CAAA,EAAW;AAC7B,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAA;AAAA,MAClD;AACA,MAAA,IAAI,MAAA,CAAO,WAAW,KAAA,CAAA,EAAW;AAC/B,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,aAAa,CAAA;AAAA,MACpD;AACA,MAAA,IAAI,MAAA,CAAO,cAAc,KAAA,CAAA,EAAW;AAClC,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,gBAAgB,CAAA;AAAA,MACvD;AACA,MAAA,IAAI,MAAA,CAAO,aAAa,KAAA,CAAA,EAAW;AACjC,QAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,UAC1B,YAAY,EAAE,IAAA,EAAM,OAAA,EAAS,KAAA,EAAO,OAAO,QAAA;AAAS,SACrD,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,IAAI,CAAA;AAAA,MAC9D;AACA,MAAA,IAAI,MAAA,CAAO,aAAa,KAAA,CAAA,EAAW;AACjC,QAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,UAC1B,cAAc,EAAE,IAAA,EAAM,QAAA,EAAU,KAAA,EAAO,OAAO,QAAA;AAAS,SACxD,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,qBAAqB,IAAI,CAAA;AAAA,MAChE;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,UAAU,SAAA,EAAuD;AAC/D,IAAA,IAAI;AAEF,MAAA,IAAA,CAAK,IAAI,kBAAA,EAAmB;AAI5B,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,CAAA;AACxD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAM,CAAA;AACnC,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,eAAe,CAAA;AACpD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAM,CAAA;AAGnC,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,GAAA,CAAI,gBAAA,EAAiB;AAGzC,MAAA,MAAM,SAAqB,EAAC;AAG5B,MAAA,MAAM,SAAA,GAAY,MAAA,CAAO,GAAA,CAAI,WAAW,CAAA;AACxC,MAAA,IAAI,cAAc,KAAA,CAAA,EAAW;AAC3B,QAAA,MAAA,CAAO,OAAO,SAAA,KAAc,MAAA;AAAA,MAC9B;AAGA,MAAA,MAAM,WAAA,GAAc,MAAA,CAAO,GAAA,CAAI,aAAa,CAAA;AAC5C,MAAA,IAAI,gBAAgB,KAAA,CAAA,EAAW;AAC7B,QAAA,MAAA,CAAO,SAAS,WAAA,KAAgB,MAAA;AAAA,MAClC;AAGA,MAAA,MAAM,cAAA,GAAiB,MAAA,CAAO,GAAA,CAAI,gBAAgB,CAAA;AAClD,MAAA,IAAI,mBAAmB,KAAA,CAAA,EAAW;AAChC,QAAA,MAAA,CAAO,YAAY,cAAA,KAAmB,MAAA;AAAA,MACxC;AAGA,MAAA,MAAM,aAAA,GAAgB,MAAA,CAAO,GAAA,CAAI,iBAAiB,CAAA;AAClD,MAAA,IAAI,kBAAkB,KAAA,CAAA,EAAW;AAC/B,QAAA,MAAM,IAAA,GAAO,WAAW,aAAa,CAAA;AACrC,QAAA,IAAI,CAAC,KAAA,CAAM,IAAI,CAAA,EAAG;AAChB,UAAA,MAAA,CAAO,QAAA,GAAW,IAAA;AAAA,QACpB;AAAA,MACF;AAGA,MAAA,MAAM,aAAA,GAAgB,MAAA,CAAO,GAAA,CAAI,mBAAmB,CAAA;AACpD,MAAA,IAAI,aAAA,KAAkB,KAAA,CAAA,IAAa,aAAA,CAAc,MAAA,GAAS,CAAA,EAAG;AAC3D,QAAA,MAAA,CAAO,QAAA,GAAW,aAAA;AAAA,MACpB;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,MAAM,CAAA;AAAA,IACjC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,sBAAA,EAAyB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACxE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,kBAAA,GAA2D;AACzD,IAAA,IAAI;AAEF,MAAA,MAAM,cAAA,GAAiB,IAAA,CAAK,GAAA,CAAI,gBAAA,EAAiB;AAEjD,MAAA,IAAI,cAAA,CAAe,SAAS,CAAA,EAAG;AAE7B,QAAA,IAAA,CAAK,IAAI,kBAAA,EAAmB;AAC5B,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AACtD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAM,CAAA;AACnC,QAAA,MAAM,MAAA,GAAS,IAAA,CAAK,GAAA,CAAI,gBAAA,EAAiB;AACzC,QAAA,OAAO,IAAA,CAAK,aAAa,MAAM,CAAA;AAAA,MACjC;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,cAAc,CAAA;AAAA,IACzC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,gCAAA,EAAmC,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAClF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,qBAAA,GAAkC;AACxC,IAAA,IAAI,KAAK,gBAAA,EAAkB;AACzB,MAAA,OAAO,IAAA,CAAK,gBAAA;AAAA,IACd;AAEA,IAAA,MAAM,OAAA,GAAU,IAAA,CAAK,GAAA,CAAI,UAAA,CAAW,KAAK,MAAM,CAAA;AAC/C,IAAA,IAAI,CAAC,OAAA,EAAS;AACZ,MAAA,OAAO,EAAC;AAAA,IACV;AAGA,IAAA,IAAA,CAAK,gBAAA,GAAmB,OAAA,CACrB,KAAA,CAAM,eAAe,EACrB,GAAA,CAAI,CAAA,CAAA,KAAK,CAAA,CAAE,IAAA,EAAM,CAAA,CACjB,MAAA,CAAO,CAAA,CAAA,KAAK,CAAA,CAAE,SAAS,CAAC,CAAA;AAE3B,IAAA,OAAO,IAAA,CAAK,gBAAA;AAAA,EACd;AACF;;;ACzZO,IAAM,UAAA,GAAN,cAAyB,YAAA,CAAa;AAAA,EAC3C,eAAA,GAA0B;AACxB,IAAA,OAAO,MAAA;AAAA,EACT;AAAA,EAEA,aAAa,QAAA,EAA0E;AACrF,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACvD,MAAA,MAAM,SAAsB,EAAC;AAE7B,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,SAAA,EAAW,CAAA,EAAA,EAAK;AAClC,QAAA,MAAM,IAAA,GAAO,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,IAAA,CAAK,QAAQ,CAAC,CAAA,IAAK,CAAA,KAAA,EAAQ,CAAA,GAAI,CAAC,CAAA,CAAA;AAClE,QAAA,MAAM,WAAW,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,IAAA,CAAK,QAAQ,CAAC,CAAA;AAEpD,QAAA,MAAA,CAAO,IAAA,CAAK;AAAA,UACV,KAAA,EAAO,CAAA;AAAA,UACP,IAAA;AAAA,UACA,WAAW,QAAA,CAAS,GAAA,GAAM,CAAA,IAAK,QAAA,CAAS,MAAM,CAAA,GAC1C,CAAA,GAAA,EAAM,IAAA,CAAK,UAAA,CAAW,SAAS,GAAA,GAAM,CAAA,EAAG,SAAS,GAAA,GAAM,CAAC,CAAC,CAAA,CAAA,GACzD,IAAA;AAAA,UACJ,UAAU,QAAA,CAAS,GAAA;AAAA,UACnB,UAAU,QAAA,CAAS;AAAA,SACpB,CAAA;AAAA,MACH;AAEA,MAAA,MAAM,SAAA,GAA2B;AAAA,QAC/B,IAAA,EAAM,MAAA;AAAA,QACN;AAAA,OACF;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,SAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA,EAEA,aAAA,GAA2C;AACzC,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACvD,MAAA,MAAM,QAAkB,EAAC;AAEzB,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,SAAA,EAAW,CAAA,EAAA,EAAK;AAClC,QAAA,MAAM,IAAA,GAAO,IAAA,CAAK,GAAA,CAAI,WAAA,CAAY,IAAA,CAAK,QAAQ,CAAC,CAAA,IAAK,CAAA,KAAA,EAAQ,CAAA,GAAI,CAAC,CAAA,CAAA;AAClE,QAAA,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,MACjB;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,KAAK,CAAA;AAAA,IAChC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,2BAAA,EAA8B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC7E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,OAAA,CAAQ,MAAe,KAAA,EAA6C;AAClE,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,EAAE,GAAA,EAAK,GAAA,EAAI,GAAI,IAAA,CAAK,iBAAiB,IAAI,CAAA;AAC/C,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,UAAA,CAAW,GAAA,EAAK,GAAG,CAAA;AAGxC,MAAA,IAAA,CAAK,SAAS,OAAO,CAAA;AAGrB,MAAA,MAAM,KAAA,GAAQ,KAAK,oBAAA,EAAqB;AACxC,MAAA,MAAM,OAAA,GAAU,KAAK,sBAAA,EAAuB;AAE5C,MAAA,OAAO,KAAK,YAAA,CAAa;AAAA,QACvB,OAAA;AAAA,QACA,KAAA;AAAA,QACA,SAAS,OAAA,IAAW,KAAA;AAAA,OACrB,CAAA;AAAA,IACH,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,oBAAA,EAAuB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACtE;AAAA,EACF;AAAA,EAEA,QAAA,CAAS,KAAA,EAAiB,KAAA,EAAkB,OAAA,EAEV;AAChC,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,EAAE,UAAU,QAAA,EAAU,MAAA,EAAQ,QAAO,GAAI,IAAA,CAAK,kBAAkB,KAAK,CAAA;AAC3E,MAAA,MAAM,QAAA,GAAW,OAAA,EAAS,gBAAA,IAAoB,IAAA,CAAK,OAAA,CAAQ,gBAAA;AAE3D,MAAA,MAAM,QAAsB,EAAC;AAC7B,MAAA,IAAI,SAAA,GAAY,CAAA;AAChB,MAAA,IAAI,SAAA,GAAY,KAAA;AAEhB,MAAA,KAAA,IAAS,IAAI,QAAA,EAAU,CAAA,IAAK,MAAA,IAAU,CAAC,WAAW,CAAA,EAAA,EAAK;AACrD,QAAA,MAAM,UAAsB,EAAC;AAE7B,QAAA,KAAA,IAAS,IAAI,QAAA,EAAU,CAAA,IAAK,MAAA,IAAU,CAAC,WAAW,CAAA,EAAA,EAAK;AACrD,UAAA,MAAM,OAAA,GAAU,IAAA,CAAK,UAAA,CAAW,CAAA,EAAG,CAAC,CAAA;AACpC,UAAA,IAAA,CAAK,SAAS,OAAO,CAAA;AAErB,UAAA,MAAM,KAAA,GAAQ,KAAK,oBAAA,EAAqB;AACxC,UAAA,MAAM,QAAA,GAAqB,EAAE,OAAA,EAAS,KAAA,EAAM;AAE5C,UAAA,MAAM,OAAA,GAAU,IAAA,CAAK,SAAA,CAAU,QAAQ,CAAA;AACvC,UAAA,IAAI,SAAA,GAAY,OAAA,CAAQ,MAAA,GAAS,QAAA,EAAU;AACzC,YAAA,SAAA,GAAY,IAAA;AACZ,YAAA;AAAA,UACF;AAEA,UAAA,SAAA,IAAa,OAAA,CAAQ,MAAA;AACrB,UAAA,OAAA,CAAQ,KAAK,QAAQ,CAAA;AAAA,QACvB;AAEA,QAAA,IAAI,OAAA,CAAQ,SAAS,CAAA,EAAG;AACtB,UAAA,KAAA,CAAM,KAAK,OAAO,CAAA;AAAA,QACpB;AAAA,MACF;AAEA,MAAA,IAAI,SAAA,EAAW;AACb,QAAA,OAAO,IAAA,CAAK,2BAA2B,KAAA,EAAO;AAAA,UAC5C,QAAA,EAAA,CAAW,MAAA,GAAS,QAAA,GAAW,CAAA,KAAM,SAAS,QAAA,GAAW,CAAA,CAAA;AAAA,UACzD,QAAA,EAAU,MAAM,MAAA,CAAO,CAAC,KAAK,GAAA,KAAQ,GAAA,GAAM,GAAA,CAAI,MAAA,EAAQ,CAAC,CAAA;AAAA,UACxD,OAAA,EAAS;AAAA,SACV,CAAA;AAAA,MACH;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,KAAK,CAAA;AAAA,IAChC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,YAAA,CAAa,IAAA,EAAe,KAAA,EAAwB,KAAA,EAGjD;AACD,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,EAAE,GAAA,EAAK,GAAA,EAAI,GAAI,IAAA,CAAK,iBAAiB,IAAI,CAAA;AAC/C,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,UAAA,CAAW,GAAA,EAAK,GAAG,CAAA;AAGxC,MAAA,IAAA,CAAK,SAAS,OAAO,CAAA;AACrB,MAAA,MAAM,QAAA,GAAW,KAAK,oBAAA,EAAqB;AAG3C,MAAA,MAAM,WAAW,OAAO,KAAA,KAAU,QAAA,GAAW,KAAA,CAAM,UAAS,GAAI,KAAA;AAChE,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,UAAA,EAAY,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,QAAA;AAAS,OAC/C,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,IAAI,CAAA;AAG7D,MAAA,MAAM,QAAA,GAAW,KAAK,oBAAA,EAAqB;AAC3C,MAAA,MAAM,cAAc,OAAO,KAAA,KAAU,QAAA,GAAW,KAAA,CAAM,UAAS,GAAI,KAAA;AACnE,MAAA,MAAM,QAAA,GAAW,QAAA,KAAa,WAAA,IAAe,QAAA,KAAa,KAAA;AAE1D,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,IAAA;AAAA,QACT,QAAA;AAAA,QACA,IAAA,EAAM,EAAE,QAAA,EAAU,QAAA;AAAS,OAC7B;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,0BAAA,EAA6B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5E;AAAA,EACF;AAAA,EAEA,cAAA,CAAe,IAAA,EAAe,OAAA,EAAiB,KAAA,EAE5C;AACD,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,EAAE,GAAA,EAAK,GAAA,EAAI,GAAI,IAAA,CAAK,iBAAiB,IAAI,CAAA;AAC/C,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,UAAA,CAAW,GAAA,EAAK,GAAG,CAAA;AAGxC,MAAA,IAAA,CAAK,SAAS,OAAO,CAAA;AAErB,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,UAAA,EAAY,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,OAAA;AAAQ,OAC9C,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,IAAI,CAAA;AAG7D,MAAA,MAAM,eAAA,GAAkB,KAAK,oBAAA,EAAqB;AAElD,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,eAAA,EAAiB,CAAA;AAAA,IAC9C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA,EAEA,QAAA,CAAS,KAAA,EAAiB,MAAA,EAAuB,KAAA,EAE9C;AACD,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,EAAE,QAAA,EAAU,QAAA,EAAS,GAAI,IAAA,CAAK,kBAAkB,KAAK,CAAA;AAC3D,MAAA,IAAI,YAAA,GAAe,CAAA;AAEnB,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,MAAA,CAAO,QAAQ,CAAA,EAAA,EAAK;AACtC,QAAA,MAAM,SAAA,GAAY,OAAO,CAAC,CAAA;AAC1B,QAAA,IAAI,CAAC,SAAA,EAAW;AAEhB,QAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,SAAA,CAAU,QAAQ,CAAA,EAAA,EAAK;AACzC,UAAA,MAAM,KAAA,GAAQ,UAAU,CAAC,CAAA;AACzB,UAAA,IAAI,KAAA,KAAU,IAAA,IAAQ,KAAA,KAAU,KAAA,CAAA,EAAW;AAE3C,UAAA,MAAM,UAAU,IAAA,CAAK,UAAA,CAAW,QAAA,GAAW,CAAA,EAAG,WAAW,CAAC,CAAA;AAC1D,UAAA,IAAA,CAAK,SAAS,OAAO,CAAA;AAErB,UAAA,MAAM,QAAA,GAAW,OAAO,KAAA,KAAU,QAAA,GAAW,MAAM,QAAA,EAAS,GAAI,OAAO,KAAK,CAAA;AAC5E,UAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,YAC1B,UAAA,EAAY,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,QAAA;AAAS,WAC/C,CAAA;AACD,UAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,IAAI,CAAA;AAC7D,UAAA,YAAA,EAAA;AAAA,QACF;AAAA,MACF;AAEA,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,YAAA,EAAc,CAAA;AAAA,IAC3C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,SAAA,CAAU,MAAe,KAAA,EAA4D;AACnF,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,EAAE,GAAA,EAAK,GAAA,EAAI,GAAI,IAAA,CAAK,iBAAiB,IAAI,CAAA;AAC/C,MAAA,MAAM,OAAA,GAAU,IAAA,CAAK,UAAA,CAAW,GAAA,EAAK,GAAG,CAAA;AAExC,MAAA,IAAA,CAAK,SAAS,OAAO,CAAA;AACrB,MAAA,MAAM,QAAA,GAAW,KAAK,oBAAA,EAAqB;AAE3C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,CAAA;AAEzD,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,QAAA,EAAU,CAAA;AAAA,IACvC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,sBAAA,EAAyB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACxE;AAAA,EACF;AAAA,EAEA,UAAA,CAAW,OAAiB,KAAA,EAA6D;AACvF,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,sBAAA,CAAuB,KAAK,CAAA;AAGlD,MAAA,IAAA,CAAK,SAAS,QAAQ,CAAA;AACtB,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,CAAA;AAGzD,MAAA,MAAM,EAAE,UAAU,QAAA,EAAU,MAAA,EAAQ,QAAO,GAAI,IAAA,CAAK,kBAAkB,KAAK,CAAA;AAC3E,MAAA,MAAM,YAAA,GAAA,CAAgB,MAAA,GAAS,QAAA,GAAW,CAAA,KAAM,SAAS,QAAA,GAAW,CAAA,CAAA;AAEpE,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,YAAA,EAAc,CAAA;AAAA,IAC3C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,SAAA,CAAU,UAAkB,KAAA,EAAyC;AACnE,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,IAAA,CAAK,SAAS,IAAA,CAAK,UAAA,CAAW,QAAA,GAAW,CAAA,EAAG,CAAC,CAAC,CAAA;AAC9C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AACtD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,sBAAA,EAAyB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACxE;AAAA,EACF;AAAA,EAEA,YAAA,CAAa,UAAkB,KAAA,EAAyC;AACtE,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,MAAA,GAAS,OAAO,QAAA,KAAa,QAAA,GAC/B,IAAA,CAAK,UAAA,CAAW,QAAA,GAAW,GAAG,CAAA,CAAE,GAAA,GAAM,CAAA,GACtC,QAAA,GAAW,CAAA;AAEf,MAAA,IAAA,CAAK,QAAA,CAAS,IAAA,CAAK,UAAA,CAAW,CAAA,EAAG,MAAM,CAAC,CAAA;AACxC,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,CAAA;AACzD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA,EAEA,SAAA,CAAU,KAAa,KAAA,EAAyC;AAC9D,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,IAAA,CAAK,QAAA,CAAS,IAAA,CAAK,UAAA,CAAW,GAAA,EAAK,CAAC,CAAC,CAAA;AACrC,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AACtD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,sBAAA,EAAyB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACxE;AAAA,EACF;AAAA,EAEA,YAAA,CAAa,KAAa,KAAA,EAAyC;AACjE,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,MAAA,GAAS,OAAO,GAAA,KAAQ,QAAA,GAC1B,KAAK,UAAA,CAAW,GAAA,GAAM,GAAG,CAAA,CAAE,GAAA,GAC3B,GAAA;AAEJ,MAAA,IAAA,CAAK,QAAA,CAAS,IAAA,CAAK,UAAA,CAAW,CAAA,EAAG,MAAM,CAAC,CAAA;AACxC,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,CAAA;AACzD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,WAAA,CAAY,KAAA,EAAiB,MAAA,EAAoB,KAAA,EAAyC;AACxF,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,sBAAA,CAAuB,KAAK,CAAA;AAClD,MAAA,IAAA,CAAK,SAAS,QAAQ,CAAA;AAEtB,MAAA,IAAI,MAAA,CAAO,SAAS,KAAA,CAAA,EAAW;AAC7B,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAA;AAAA,MAClD;AACA,MAAA,IAAI,MAAA,CAAO,iBAAiB,KAAA,CAAA,EAAW;AACrC,QAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,UAC1B,mBAAmB,EAAE,IAAA,EAAM,QAAA,EAAU,KAAA,EAAO,OAAO,YAAA;AAAa,SACjE,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,0BAA0B,IAAI,CAAA;AAAA,MACrE;AACA,MAAA,IAAI,MAAA,CAAO,oBAAoB,KAAA,CAAA,EAAW;AACxC,QAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,UAC1B,eAAA,EAAiB,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,IAAA,CAAK,WAAA,CAAY,MAAA,CAAO,eAAe,CAAA;AAAE,SAClF,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,wBAAwB,IAAI,CAAA;AAAA,MACnE;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,SAAS,IAAA,EAAkD;AACzD,IAAA,IAAI;AACF,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA;AAAK,OACrC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,eAAe,IAAI,CAAA;AAExD,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACvD,MAAA,OAAO,KAAK,YAAA,CAAa,EAAE,KAAA,EAAO,SAAA,GAAY,GAAG,CAAA;AAAA,IACnD,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA,EAEA,WAAA,CAAY,OAAiB,OAAA,EAAwC;AACnE,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,OAAA;AAAQ,OACxC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,IAAI,CAAA;AAC7D,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA,EAEA,YAAY,KAAA,EAAwC;AAClD,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,YAAY,KAAK,CAAA;AACtB,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,aAAa,CAAA;AAClD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,YAAY,KAAA,EAAwB;AAC1C,IAAA,IAAI,UAAU,MAAA,EAAW;AAEzB,IAAA,MAAM,QAAQ,OAAO,KAAA,KAAU,WAC3B,KAAA,GACA,IAAA,CAAK,oBAAoB,KAAK,CAAA;AAElC,IAAA,IAAI,SAAS,CAAA,EAAG;AACd,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAAA,IAC7C;AAAA,EACF;AAAA,EAEQ,oBAAoB,IAAA,EAAsB;AAChD,IAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACvD,IAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,SAAA,EAAW,CAAA,EAAA,EAAK;AAClC,MAAA,IAAI,KAAK,GAAA,CAAI,WAAA,CAAY,KAAK,MAAA,EAAQ,CAAC,MAAM,IAAA,EAAM;AACjD,QAAA,OAAO,CAAA;AAAA,MACT;AAAA,IACF;AACA,IAAA,OAAO,EAAA;AAAA,EACT;AAAA,EAEQ,SAAS,OAAA,EAAuB;AACtC,IAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,MAC1B,OAAA,EAAS,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,OAAA;AAAQ,KAC3C,CAAA;AACD,IAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,IAAI,CAAA;AAAA,EAC5D;AAAA,EAEQ,oBAAA,GAAkC;AACxC,IAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,IAAA,CAAK,QAAQ,YAAY,CAAA;AAChE,IAAA,IAAI,CAAC,MAAM,OAAO,IAAA;AAGlB,IAAA,MAAM,GAAA,GAAM,WAAW,IAAI,CAAA;AAC3B,IAAA,IAAI,CAAC,MAAM,GAAG,CAAA,IAAK,KAAK,IAAA,EAAK,KAAM,GAAA,CAAI,QAAA,EAAS,EAAG;AACjD,MAAA,OAAO,GAAA;AAAA,IACT;AAGA,IAAA,IAAI,IAAA,CAAK,WAAA,EAAY,KAAM,MAAA,EAAQ,OAAO,IAAA;AAC1C,IAAA,IAAI,IAAA,CAAK,WAAA,EAAY,KAAM,OAAA,EAAS,OAAO,KAAA;AAE3C,IAAA,OAAO,IAAA;AAAA,EACT;AAAA,EAEQ,sBAAA,GAAwC;AAC9C,IAAA,MAAM,SAAS,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,IAAA,CAAK,QAAQ,wBAAwB,CAAA;AAC9E,IAAA,IAAI,CAAC,QAAQ,OAAO,IAAA;AAEpB,IAAA,IAAI;AACF,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,KAAA,CAAM,MAAM,CAAA;AAChC,MAAA,OAAO,OAAO,KAAA,IAAS,IAAA;AAAA,IACzB,CAAA,CAAA,MAAQ;AACN,MAAA,OAAO,IAAA;AAAA,IACT;AAAA,EACF;AAAA,EAEQ,kBAAkB,KAAA,EAKxB;AACA,IAAA,IAAI,OAAO,UAAU,QAAA,EAAU;AAC7B,MAAA,MAAM,KAAA,GAAQ,KAAA,CAAM,KAAA,CAAM,GAAG,CAAA;AAC7B,MAAA,MAAMC,MAAAA,GAAQ,IAAA,CAAK,UAAA,CAAW,KAAA,CAAM,CAAC,CAAE,CAAA;AACvC,MAAA,MAAMC,IAAAA,GAAM,MAAM,CAAC,CAAA,GAAI,KAAK,UAAA,CAAW,KAAA,CAAM,CAAC,CAAC,CAAA,GAAID,MAAAA;AACnD,MAAA,OAAO;AAAA,QACL,UAAUA,MAAAA,CAAM,GAAA;AAAA,QAChB,UAAUA,MAAAA,CAAM,GAAA;AAAA,QAChB,QAAQC,IAAAA,CAAI,GAAA;AAAA,QACZ,QAAQA,IAAAA,CAAI;AAAA,OACd;AAAA,IACF;AAEA,IAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,gBAAA,CAAiB,KAAA,CAAM,KAAK,CAAA;AAC/C,IAAA,MAAM,GAAA,GAAM,IAAA,CAAK,gBAAA,CAAiB,KAAA,CAAM,GAAG,CAAA;AAC3C,IAAA,OAAO;AAAA,MACL,UAAU,KAAA,CAAM,GAAA;AAAA,MAChB,UAAU,KAAA,CAAM,GAAA;AAAA,MAChB,QAAQ,GAAA,CAAI,GAAA;AAAA,MACZ,QAAQ,GAAA,CAAI;AAAA,KACd;AAAA,EACF;AAAA,EAEQ,uBAAuB,KAAA,EAAyB;AACtD,IAAA,IAAI,OAAO,KAAA,KAAU,QAAA,EAAU,OAAO,KAAA;AAEtC,IAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,gBAAA,CAAiB,KAAA,CAAM,KAAK,CAAA;AAC/C,IAAA,MAAM,GAAA,GAAM,IAAA,CAAK,gBAAA,CAAiB,KAAA,CAAM,GAAG,CAAA;AAC3C,IAAA,OAAO,CAAA,EAAG,IAAA,CAAK,UAAA,CAAW,KAAA,CAAM,KAAK,KAAA,CAAM,GAAG,CAAC,CAAA,CAAA,EAAI,KAAK,UAAA,CAAW,GAAA,CAAI,GAAA,EAAK,GAAA,CAAI,GAAG,CAAC,CAAA,CAAA;AAAA,EACtF;AAAA,EAEQ,YAAY,GAAA,EAAqB;AACvC,IAAA,OAAO,SAAS,GAAA,CAAI,OAAA,CAAQ,GAAA,EAAK,EAAE,GAAG,EAAE,CAAA;AAAA,EAC1C;AACF;;;ACtfO,IAAM,aAAA,GAAN,cAA4B,YAAA,CAAa;AAAA,EAC9C,eAAA,GAA6B;AAC3B,IAAA,OAAO,SAAA;AAAA,EACT;AAAA,EAEA,aAAa,QAAA,EAA6E;AACxF,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACvD,MAAA,MAAM,SAAsB,EAAC;AAE7B,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,SAAA,EAAW,CAAA,EAAA,EAAK;AAClC,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,oBAAA,CAAqB,CAAC,CAAA;AAC7C,QAAA,MAAA,CAAO,KAAK,SAAS,CAAA;AAAA,MACvB;AAEA,MAAA,MAAM,SAAA,GAA8B;AAAA,QAClC,IAAA,EAAM,SAAA;AAAA,QACN,MAAA;AAAA,QACA,UAAA,EAAY;AAAA,OACd;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,SAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,SAAS,KAAA,EAA2C;AAClD,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,CAAA,qBAAA,EAAwB,KAAK,CAAA,iBAAA,EAAoB,SAAA,GAAY,CAAC,CAAA,CAAA;AAAA,UAC9D;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,UAAA,CAAW,IAAA,CAAK,MAAM,CAAA,IAAK,EAAA;AACjD,MAAA,MAAM,UAAA,GAAa,IAAA,CAAK,eAAA,CAAgB,IAAI,CAAA;AAE5C,MAAA,MAAM,SAAA,GAAuB;AAAA,QAC3B,KAAA;AAAA,QACA,OAAO,UAAA,CAAW,IAAA,CAAK,OAAK,CAAA,CAAE,IAAA,KAAS,OAAO,CAAA,EAAG,IAAA;AAAA,QACjD,UAAA;AAAA,QACA,QAAA,EAAU;AAAA;AAAA,OACZ;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,SAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA,EAEA,aAAA,GAAyC;AACvC,IAAA,IAAI;AACF,MAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACnD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAK,CAAA;AAAA,IAChC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,2BAAA,EAA8B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC7E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,SAAS,OAAA,EAA6F;AACpG,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAGvD,MAAA,IAAI,OAAA,EAAS,eAAe,KAAA,CAAA,EAAW;AACrC,QAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,QAAQ,UAAU,CAAA;AAAA,MAC1D,CAAA,MAAO;AAEL,QAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,YAAY,CAAC,CAAA;AAAA,MACrD;AAGA,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAGtD,MAAA,IAAI,SAAS,MAAA,EAAQ;AACnB,QAAA,IAAA,CAAK,gBAAA,CAAiB,QAAQ,MAAM,CAAA;AAAA,MACtC;AAEA,MAAA,MAAM,WAAW,OAAA,EAAS,UAAA,KAAe,KAAA,CAAA,GACrC,OAAA,CAAQ,aAAa,CAAA,GACrB,SAAA;AAGJ,MAAA,MAAM,YAAA,GAAe,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAC1D,MAAA,MAAM,WAAW,YAAA,GAAe,SAAA;AAEhC,MAAA,OAAO;AAAA,QACL,OAAA,EAAS,IAAA;AAAA,QACT,QAAA;AAAA,QACA,IAAA,EAAM,EAAE,KAAA,EAAO,QAAA;AAAS,OAC1B;AAAA,IACF,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA,EAEA,YAAY,KAAA,EAAsC;AAChD,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,aAAa,CAAA,EAAG;AAClB,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,8BAAA;AAAA,UACA;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,wBAAwB,KAAK,CAAA,CAAA;AAAA,UAC7B,CAAA,eAAA,EAAkB,YAAY,CAAC,CAAA;AAAA,SACjC;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAEtD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA,EAEA,eAAe,KAAA,EAAsD;AACnE,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,wBAAwB,KAAK,CAAA,CAAA;AAAA,UAC7B,CAAA,eAAA,EAAkB,YAAY,CAAC,CAAA;AAAA,SACjC;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,CAAA;AAEzD,MAAA,OAAO,KAAK,YAAA,CAAa,EAAE,QAAA,EAAU,KAAA,GAAQ,GAAG,CAAA;AAAA,IAClD,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,2BAAA,EAA8B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC7E;AAAA,EACF;AAAA,EAEA,SAAA,CAAU,WAAmB,OAAA,EAAwC;AACnE,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,YAAY,CAAA,IAAK,SAAA,IAAa,aAAa,OAAA,GAAU,CAAA,IAAK,WAAW,SAAA,EAAW;AAClF,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,CAAA,sCAAA,EAAyC,YAAY,CAAC,CAAA,CAAA;AAAA,UACtD;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI,cAAc,OAAA,EAAS;AACzB,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,qCAAA;AAAA,UACA;AAAA,SACF;AAAA,MACF;AAGA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAE/C,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,QAAA,EAAU,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,OAAA;AAAQ,OAC1C,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,sBAAsB,IAAI,CAAA;AAE/D,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,sBAAA,EAAyB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACxE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,aAAA,CAAc,OAAe,KAAA,EAAuD;AAClF,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,KAAK,CAAA,CAAE,CAAA;AAAA,MAC/D;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAG3C,MAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,UAAA,CAAW,IAAA,CAAK,MAAM,CAAA,IAAK,EAAA;AACjD,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,eAAA,CAAgB,IAAI,CAAA;AACxC,MAAA,MAAM,WAAW,MAAA,CAAO,IAAA,CAAK,OAAK,CAAA,CAAE,IAAA,KAAS,OAAO,CAAA,EAAG,IAAA;AAGvD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,gBAAgB,CAAA;AAGrD,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,KAAA;AAAM,OACtC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,IAAI,CAAA;AAE5D,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,QAAA,EAAU,CAAA;AAAA,IACvC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,2BAAA,EAA8B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC7E;AAAA,EACF;AAAA,EAEA,YAAA,CAAa,OAAe,IAAA,EAAqD;AAC/E,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,KAAK,CAAA,CAAE,CAAA;AAAA,MAC/D;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAG3C,MAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,UAAA,CAAW,IAAA,CAAK,MAAM,CAAA,IAAK,EAAA;AACjD,MAAA,MAAM,MAAA,GAAS,IAAA,CAAK,eAAA,CAAgB,IAAI,CAAA;AACxC,MAAA,MAAM,UAAU,MAAA,CAAO,IAAA,CAAK,OAAK,CAAA,CAAE,IAAA,KAAS,MAAM,CAAA,EAAG,IAAA;AAIrD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAEtD,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA;AAAK,OACrC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,IAAI,CAAA;AAE5D,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,OAAA,EAAS,CAAA;AAAA,IACtC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,0BAAA,EAA6B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5E;AAAA,EACF;AAAA,EAEA,aAAA,CAAc,OAAe,KAAA,EAAsC;AACjE,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,KAAK,CAAA,CAAE,CAAA;AAAA,MAC/D;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAG3C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,gBAAgB,CAAA;AAErD,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,KAAA;AAAM,OACtC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,IAAI,CAAA;AAG5D,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,qBAAqB,CAAA;AAE1D,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,2BAAA,EAA8B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC7E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,cAAA,CAAe,OAAe,MAAA,EAA4C;AACxE,IAAA,IAAI;AACF,MAAA,MAAM,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEvD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,SAAA,EAAW;AACnC,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,KAAK,CAAA,CAAE,CAAA;AAAA,MAC/D;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,IAAA,CAAK,iBAAiB,MAAM,CAAA;AAE5B,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,4BAAA,EAA+B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC9E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,qBAAqB,KAAA,EAA0B;AACrD,IAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAE3C,IAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,UAAA,CAAW,IAAA,CAAK,MAAM,CAAA,IAAK,EAAA;AACjD,IAAA,MAAM,MAAA,GAAS,IAAA,CAAK,eAAA,CAAgB,IAAI,CAAA;AACxC,IAAA,MAAM,aAAa,MAAA,CAAO,IAAA,CAAK,CAAA,CAAA,KAAK,CAAA,CAAE,SAAS,OAAO,CAAA;AAEtD,IAAA,OAAO;AAAA,MACL,KAAA;AAAA,MACA,OAAO,UAAA,EAAY,IAAA;AAAA,MACnB,MAAA,EAAQ,IAAA,CAAK,YAAA,CAAa,MAAM,CAAA;AAAA,MAChC,gBAAgB,MAAA,CAAO;AAAA,KACzB;AAAA,EACF;AAAA,EAEQ,gBAAgB,IAAA,EAA2B;AAGjD,IAAA,MAAM,UAAA,GAAa,KAAK,KAAA,CAAM,OAAO,EAAE,MAAA,CAAO,CAAA,CAAA,KAAK,CAAA,CAAE,IAAA,EAAM,CAAA;AAC3D,IAAA,MAAM,SAAsB,EAAC;AAE7B,IAAA,UAAA,CAAW,OAAA,CAAQ,CAAC,IAAA,EAAM,GAAA,KAAQ;AAChC,MAAA,MAAM,OAAO,GAAA,KAAQ,CAAA,GAAI,OAAA,GAAW,GAAA,KAAQ,IAAI,MAAA,GAAS,OAAA;AACzD,MAAA,MAAA,CAAO,IAAA,CAAK;AAAA,QACV,KAAA,EAAO,GAAA;AAAA,QACP,IAAA;AAAA,QACA,IAAA,EAAM,KAAK,IAAA,EAAK;AAAA,QAChB,MAAA,EAAQ,EAAE,CAAA,EAAG,CAAA,EAAG,GAAG,CAAA,EAAG,KAAA,EAAO,CAAA,EAAG,MAAA,EAAQ,CAAA;AAAE;AAAA,OAC3C,CAAA;AAAA,IACH,CAAC,CAAA;AAED,IAAA,OAAO,MAAA;AAAA,EACT;AAAA,EAEQ,aAAa,MAAA,EAAkC;AACrD,IAAA,IAAI,MAAA,CAAO,MAAA,KAAW,CAAA,EAAG,OAAO,OAAA;AAChC,IAAA,IAAI,MAAA,CAAO,WAAW,CAAA,IAAK,MAAA,CAAO,CAAC,CAAA,EAAG,IAAA,KAAS,SAAS,OAAO,OAAA;AAC/D,IAAA,IAAI,MAAA,CAAO,MAAA,IAAU,CAAA,EAAG,OAAO,cAAA;AAC/B,IAAA,OAAO,OAAA;AAAA,EACT;AAAA,EAEQ,iBAAiB,MAAA,EAA2B;AAElD,IAAA,MAAM,SAAA,GAAyC;AAAA,MAC7C,KAAA,EAAO,CAAA;AAAA,MACP,KAAA,EAAO,CAAA;AAAA,MACP,YAAA,EAAc,CAAA;AAAA,MACd,SAAA,EAAW;AAAA,KACb;AAEA,IAAA,MAAM,QAAA,GAAW,SAAA,CAAU,MAAM,CAAA,IAAK,CAAA;AACtC,IAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,MAC1B,UAAA,EAAY,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,QAAA;AAAS,KAC7C,CAAA;AACD,IAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,qBAAqB,IAAI,CAAA;AAAA,EAChE;AACF;;;ACrWO,IAAM,UAAA,GAAN,cAAyB,YAAA,CAAa;AAAA,EACnC,aAAA,GAAyB,KAAA;AAAA,EAEjC,eAAA,GAA0B;AACxB,IAAA,OAAO,MAAA;AAAA,EACT;AAAA,EAEA,eAAe,KAAA,EAAsB;AACnC,IAAA,IAAA,CAAK,aAAA,GAAgB,KAAA;AAAA,EACvB;AAAA,EAEA,aAAa,QAAA,EAA0E;AACrF,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACtD,MAAA,MAAM,QAAoB,EAAC;AAE3B,MAAA,KAAA,IAAS,CAAA,GAAI,CAAA,EAAG,CAAA,GAAI,QAAA,EAAU,CAAA,EAAA,EAAK;AACjC,QAAA,MAAM,QAAA,GAAW,IAAA,CAAK,mBAAA,CAAoB,CAAC,CAAA;AAC3C,QAAA,KAAA,CAAM,KAAK,QAAQ,CAAA;AAAA,MACrB;AAEA,MAAA,MAAM,SAAA,GAA2B;AAAA,QAC/B,IAAA,EAAM,MAAA;AAAA,QACN,KAAA;AAAA,QACA,SAAA,EAAW,QAAA;AAAA,QACX,eAAe,IAAA,CAAK;AAAA,OACtB;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,SAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,yBAAA,EAA4B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC3E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,QAAQ,KAAA,EAA0C;AAChD,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEtD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,QAAA,EAAU;AAClC,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,CAAA,oBAAA,EAAuB,KAAK,CAAA,iBAAA,EAAoB,QAAA,GAAW,CAAC,CAAA,CAAA;AAAA,UAC5D;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,MAAM,IAAA,GAAO,IAAA,CAAK,GAAA,CAAI,uBAAA,CAAwB,KAAK,MAAM,CAAA;AACzD,MAAA,MAAM,MAAA,GAAS,KAAK,eAAA,EAAgB;AAEpC,MAAA,MAAM,QAAA,GAAqB;AAAA,QACzB,KAAA;AAAA,QACA,MAAA;AAAA,QACA,MAAM,EAAE,KAAA,EAAO,KAAK,KAAA,EAAO,MAAA,EAAQ,KAAK,MAAA;AAAO,OACjD;AAEA,MAAA,OAAO,IAAA,CAAK,aAAa,QAAQ,CAAA;AAAA,IACnC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,oBAAA,EAAuB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACtE;AAAA,EACF;AAAA,EAEA,YAAA,GAAwC;AACtC,IAAA,IAAI;AACF,MAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AACnD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAK,CAAA;AAAA,IAChC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,0BAAA,EAA6B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,QAAQ,OAAA,EAAsE;AAC5E,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAGtD,MAAA,IAAI,OAAA,EAAS,cAAc,KAAA,CAAA,EAAW;AACpC,QAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,QAAQ,SAAS,CAAA;AAAA,MACzD,CAAA,MAAO;AACL,QAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,WAAW,CAAC,CAAA;AAAA,MACpD;AAGA,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAEtD,MAAA,MAAM,WAAW,OAAA,EAAS,SAAA,KAAc,KAAA,CAAA,GACpC,OAAA,CAAQ,YAAY,CAAA,GACpB,QAAA;AAEJ,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,KAAA,EAAO,UAAU,CAAA;AAAA,IAC9C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,oBAAA,EAAuB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACtE;AAAA,EACF;AAAA,EAEA,WAAW,KAAA,EAAsC;AAC/C,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEtD,MAAA,IAAI,YAAY,CAAA,EAAG;AACjB,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,6BAAA;AAAA,UACA;AAAA,SACF;AAAA,MACF;AAEA,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,QAAA,EAAU;AAClC,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,uBAAuB,KAAK,CAAA,CAAA;AAAA,UAC5B,CAAA,eAAA,EAAkB,WAAW,CAAC,CAAA;AAAA,SAChC;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAEtD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,uBAAA,EAA0B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACzE;AAAA,EACF;AAAA,EAEA,cAAc,KAAA,EAAsD;AAClE,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEtD,MAAA,IAAI,KAAA,GAAQ,CAAA,IAAK,KAAA,IAAS,QAAA,EAAU;AAClC,QAAA,OAAO,IAAA,CAAK,iBAAA;AAAA,UACV,uBAAuB,KAAK,CAAA,CAAA;AAAA,UAC5B,CAAA,eAAA,EAAkB,WAAW,CAAC,CAAA;AAAA,SAChC;AAAA,MACF;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,oBAAoB,CAAA;AAEzD,MAAA,OAAO,KAAK,YAAA,CAAa,EAAE,QAAA,EAAU,KAAA,GAAQ,GAAG,CAAA;AAAA,IAClD,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,0BAAA,EAA6B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMA,QAAA,CACE,SAAA,EACA,SAAA,EACA,MAAA,EACA,OAAA,EACyC;AACzC,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEtD,MAAA,IAAI,SAAA,GAAY,CAAA,IAAK,SAAA,IAAa,QAAA,EAAU;AAC1C,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,CAAA,oBAAA,EAAuB,SAAS,CAAA,CAAE,CAAA;AAAA,MAClE;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAG/C,MAAA,MAAM,YAAA,GAAe,IAAA,CAAK,eAAA,CAAgB,SAAS,CAAA;AAGnD,MAAA,MAAM,UAAA,GAAa,KAAK,SAAA,CAAU;AAAA,QAChC,GAAG,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,OAAO,CAAA,EAAE;AAAA,QACnC,GAAG,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,OAAO,CAAA,EAAE;AAAA,QACnC,OAAO,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,OAAO,KAAA,EAAM;AAAA,QAC3C,QAAQ,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,OAAO,MAAA;AAAO,OAC9C,CAAA;AAED,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,cAAc,UAAU,CAAA;AAG7D,MAAA,IAAI,SAAS,IAAA,EAAM;AACjB,QAAA,MAAM,QAAA,GAAW,KAAK,SAAA,CAAU;AAAA,UAC9B,MAAM,EAAE,IAAA,EAAM,QAAA,EAAU,KAAA,EAAO,QAAQ,IAAA;AAAK,SAC7C,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,QAAQ,CAAA;AAAA,MAClE;AAEA,MAAA,IAAI,SAAS,SAAA,EAAW;AACtB,QAAA,MAAM,SAAA,GAAY,KAAK,SAAA,CAAU;AAAA,UAC/B,SAAA,EAAW,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,IAAA,CAAK,WAAA,CAAY,OAAA,CAAQ,SAAS,CAAA;AAAE,SACvE,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,kBAAkB,SAAS,CAAA;AAAA,MAClE;AAEA,MAAA,IAAI,SAAS,SAAA,EAAW;AACtB,QAAA,MAAM,SAAA,GAAY,KAAK,SAAA,CAAU;AAAA,UAC/B,SAAA,EAAW,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,IAAA,CAAK,WAAA,CAAY,OAAA,CAAQ,SAAS,CAAA;AAAE,SACvE,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,SAAS,CAAA;AAAA,MACnE;AAGA,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,UAAA,EAAY,GAAG,CAAA;AAAA,IAC5C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,qBAAA,EAAwB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACvE;AAAA,EACF;AAAA,EAEA,OAAA,CACE,SAAA,EACA,KAAA,EACA,GAAA,EACA,OAAA,EACyC;AACzC,IAAA,IAAI;AACF,MAAA,MAAM,QAAA,GAAW,IAAA,CAAK,GAAA,CAAI,gBAAA,CAAiB,KAAK,MAAM,CAAA;AAEtD,MAAA,IAAI,SAAA,GAAY,CAAA,IAAK,SAAA,IAAa,QAAA,EAAU;AAC1C,QAAA,OAAO,IAAA,CAAK,iBAAA,CAAkB,CAAA,oBAAA,EAAuB,SAAS,CAAA,CAAE,CAAA;AAAA,MAClE;AAEA,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAE/C,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,QAAQ,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,MAAM,CAAA,EAAE;AAAA,QACvC,QAAQ,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,MAAM,CAAA,EAAE;AAAA,QACvC,MAAM,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,IAAI,CAAA,EAAE;AAAA,QACnC,MAAM,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,IAAI,CAAA;AAAE,OACpC,CAAA;AAED,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,aAAa,IAAI,CAAA;AAEtD,MAAA,IAAI,SAAS,SAAA,EAAW;AACtB,QAAA,MAAM,SAAA,GAAY,KAAK,SAAA,CAAU;AAAA,UAC/B,SAAA,EAAW,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,IAAA,CAAK,WAAA,CAAY,OAAA,CAAQ,SAAS,CAAA;AAAE,SACvE,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,SAAS,CAAA;AAAA,MACnE;AAEA,MAAA,IAAI,SAAS,SAAA,EAAW;AACtB,QAAA,MAAM,SAAA,GAAY,KAAK,SAAA,CAAU;AAAA,UAC/B,WAAW,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,QAAQ,SAAA;AAAU,SACrD,CAAA;AACD,QAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,kBAAkB,SAAS,CAAA;AAAA,MAClE;AAEA,MAAA,OAAO,IAAA,CAAK,YAAA,CAAa,EAAE,UAAA,EAAY,GAAG,CAAA;AAAA,IAC5C,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,oBAAA,EAAuB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACtE;AAAA,EACF;AAAA,EAEA,WAAA,CAAY,WAAmB,UAAA,EAA2C;AACxE,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAG/C,MAAA,IAAA,CAAK,YAAY,UAAU,CAAA;AAC3B,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,aAAa,CAAA;AAElD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA,EAEA,YAAA,CAAa,SAAA,EAAmB,UAAA,EAAoB,IAAA,EAAqC;AACvF,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAC/C,MAAA,IAAA,CAAK,YAAY,UAAU,CAAA;AAG3B,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAGtD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,gBAAgB,CAAA;AACrD,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,IAAA,EAAM,EAAE,IAAA,EAAM,QAAA,EAAU,OAAO,IAAA;AAAK,OACrC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,mBAAmB,IAAI,CAAA;AAG5D,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,iBAAiB,CAAA;AAEtD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,0BAAA,EAA6B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC5E;AAAA,EACF;AAAA,EAEA,SAAA,CAAU,SAAA,EAAmB,UAAA,EAAoB,WAAA,EAA8C;AAC7F,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAC/C,MAAA,IAAA,CAAK,YAAY,UAAU,CAAA;AAE3B,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,GAAG,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,YAAY,CAAA,EAAE;AAAA,QACxC,GAAG,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,YAAY,CAAA;AAAE,OACzC,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,0BAA0B,IAAI,CAAA;AAEnE,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,sBAAA,EAAyB,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IACxE;AAAA,EACF;AAAA,EAEA,WAAA,CAAY,SAAA,EAAmB,UAAA,EAAoB,OAAA,EAAsC;AACvF,IAAA,IAAI;AACF,MAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,SAAS,CAAA;AAC/C,MAAA,IAAA,CAAK,YAAY,UAAU,CAAA;AAE3B,MAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,QAC1B,OAAO,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,QAAQ,KAAA,EAAM;AAAA,QAC5C,QAAQ,EAAE,IAAA,EAAM,MAAA,EAAQ,KAAA,EAAO,QAAQ,MAAA;AAAO,OAC/C,CAAA;AACD,MAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,aAAa,IAAI,CAAA;AAEtD,MAAA,OAAO,IAAA,CAAK,aAAa,KAAA,CAAS,CAAA;AAAA,IACpC,SAAS,KAAA,EAAO;AACd,MAAA,OAAO,KAAK,iBAAA,CAAkB,CAAA,wBAAA,EAA2B,MAAA,CAAO,KAAK,CAAC,CAAA,CAAE,CAAA;AAAA,IAC1E;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAMQ,oBAAoB,KAAA,EAAyB;AACnD,IAAA,IAAA,CAAK,GAAA,CAAI,eAAA,CAAgB,IAAA,CAAK,MAAA,EAAQ,KAAK,CAAA;AAC3C,IAAA,MAAM,IAAA,GAAO,IAAA,CAAK,GAAA,CAAI,uBAAA,CAAwB,KAAK,MAAM,CAAA;AACzD,IAAA,MAAM,MAAA,GAAS,KAAK,eAAA,EAAgB;AAEpC,IAAA,OAAO;AAAA,MACL,KAAA;AAAA,MACA,YAAY,MAAA,CAAO,MAAA;AAAA,MACnB,MAAM,EAAE,KAAA,EAAO,KAAK,KAAA,EAAO,MAAA,EAAQ,KAAK,MAAA;AAAO,KACjD;AAAA,EACF;AAAA,EAEQ,eAAA,GAA+B;AAGrC,IAAA,MAAM,OAAO,IAAA,CAAK,GAAA,CAAI,UAAA,CAAW,IAAA,CAAK,MAAM,CAAA,IAAK,EAAA;AAEjD,IAAA,IAAI,CAAC,IAAA,CAAK,IAAA,EAAK,EAAG;AAChB,MAAA,OAAO,EAAC;AAAA,IACV;AAGA,IAAA,OAAO,CAAC;AAAA,MACN,KAAA,EAAO,CAAA;AAAA,MACP,IAAA,EAAM,MAAA;AAAA,MACN,IAAA;AAAA,MACA,MAAA,EAAQ,EAAE,CAAA,EAAG,CAAA,EAAG,GAAG,CAAA,EAAG,KAAA,EAAO,CAAA,EAAG,MAAA,EAAQ,CAAA;AAAE,KAC3C,CAAA;AAAA,EACH;AAAA,EAEQ,YAAY,UAAA,EAA0B;AAG5C,IAAA,MAAM,IAAA,GAAO,KAAK,SAAA,CAAU;AAAA,MAC1B,KAAA,EAAO,EAAE,IAAA,EAAM,MAAA,EAAQ,OAAO,UAAA;AAAW,KAC1C,CAAA;AACD,IAAA,IAAA,CAAK,GAAA,CAAI,cAAA,CAAe,IAAA,CAAK,MAAA,EAAQ,qBAAqB,IAAI,CAAA;AAAA,EAChE;AAAA,EAEQ,gBAAgB,SAAA,EAA8B;AACpD,IAAA,MAAM,QAAA,GAAsC;AAAA,MAC1C,SAAA,EAAW,WAAA;AAAA,MACX,OAAA,EAAS,cAAA;AAAA,MACT,IAAA,EAAM,WAAA;AAAA,MACN,IAAA,EAAM,WAAA;AAAA,MACN,KAAA,EAAO,oBAAA;AAAA,MACP,KAAA,EAAO,kBAAA;AAAA,MACP,KAAA,EAAO;AAAA;AAAA,KACT;AACA,IAAA,OAAO,SAAS,SAAS,CAAA;AAAA,EAC3B;AAAA,EAEQ,YAAY,GAAA,EAAqB;AACvC,IAAA,OAAO,SAAS,GAAA,CAAI,OAAA,CAAQ,GAAA,EAAK,EAAE,GAAG,EAAE,CAAA;AAAA,EAC1C;AACF;ACrYA,IAAM,kBAAA,GAAqBC,MAAE,MAAA,CAAO;AAAA,EAClC,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,4BAA4B,CAAA;AAAA,EACxE,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,kDAAkD;AAChG,CAAC,CAAA;AAED,IAAM,eAAA,GAAkBA,MAAE,MAAA,CAAO;AAAA,EAC/B,KAAA,EAAO,kBAAA,CAAmB,QAAA,CAAS,6BAA6B,CAAA;AAAA,EAChE,GAAA,EAAK,kBAAA,CAAmB,QAAA,CAAS,2BAA2B;AAC9D,CAAC,CAAA;AAED,IAAM,gBAAA,GAAmBA,MAAE,MAAA,CAAO;AAAA,EAChC,MAAMA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,uBAAuB,CAAA;AAAA,EAC7D,QAAQA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,yBAAyB,CAAA;AAAA,EACjE,WAAWA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,4BAA4B,CAAA;AAAA,EACvE,QAAA,EAAUA,MAAE,MAAA,EAAO,CAAE,UAAS,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,qBAAqB,CAAA;AAAA,EACzE,UAAUA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,qDAAqD,CAAA;AAAA,EAC9F,OAAOA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,4CAA4C;AACpF,CAAC,CAAA;AAED,IAAM,aAAA,GAAgBA,MAAE,KAAA,CAAM;AAAA,EAC5BA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,CAAS,qDAAqD,CAAA;AAAA,EACzEA,MAAE,MAAA,CAAO;AAAA,IACP,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,sBAAsB,CAAA;AAAA,IAC5D,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,yBAAyB;AAAA,GAChE;AACH,CAAC,CAAA;AAED,IAAM,cAAA,GAAiBA,MAAE,KAAA,CAAM;AAAA,EAC7BA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,CAAS,2CAA2C,CAAA;AAAA,EAC/DA,MAAE,MAAA,CAAO;AAAA,IACP,KAAA,EAAO,aAAA,CAAc,QAAA,CAAS,yBAAyB,CAAA;AAAA,IACvD,GAAA,EAAK,aAAA,CAAc,QAAA,CAAS,uBAAuB;AAAA,GACpD;AACH,CAAC,CAAA;AAED,IAAM,cAAA,GAAiBA,MAAE,KAAA,CAAM;AAAA,EAC7BA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,EAChCA,KAAA,CAAE,QAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,wBAAwB;AAC3D,CAAC,CAAA;AAED,IAAM,eAAA,GAAkBA,MAAE,KAAA,CAAM;AAAA,EAC9BA,MAAE,MAAA,EAAO;AAAA,EACTA,MAAE,MAAA,EAAO;AAAA,EACTA,MAAE,OAAA,EAAQ;AAAA,EACVA,MAAE,IAAA;AACJ,CAAC,CAAA,CAAE,SAAS,8CAA8C,CAAA;AAE1D,IAAM,gBAAA,GAAmBA,MAAE,MAAA,CAAO;AAAA,EAChC,MAAMA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,uBAAuB,CAAA;AAAA,EAC7D,cAAcA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,+CAA+C,CAAA;AAAA,EAC5F,iBAAiBA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,gCAAgC,CAAA;AAAA,EAChF,WAAWA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,0BAA0B;AACtE,CAAC,CAAA;AAED,IAAM,iBAAA,GAAoBA,KAAA,CAAE,IAAA,CAAK,CAAC,OAAA,EAAS,OAAA,EAAS,cAAA,EAAgB,WAAW,CAAC,CAAA,CAC7E,QAAA,CAAS,mBAAmB,CAAA;AAE/B,IAAM,eAAA,GAAkBA,KAAA,CAAE,IAAA,CAAK,CAAC,aAAa,SAAA,EAAW,MAAA,EAAQ,MAAA,EAAQ,OAAA,EAAS,OAAA,EAAS,OAAO,CAAC,CAAA,CAC/F,SAAS,yBAAyB,CAAA;AAErC,IAAM,eAAA,GAAkBA,MAAE,MAAA,CAAO;AAAA,EAC/B,CAAA,EAAGA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,qBAAqB,CAAA;AAAA,EAC5C,CAAA,EAAGA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,qBAAqB,CAAA;AAAA,EAC5C,OAAOA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,gBAAgB,CAAA;AAAA,EACtD,QAAQA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,iBAAiB;AAC1D,CAAC,CAAA;AAED,IAAM,cAAA,GAAiBA,MAAE,MAAA,CAAO;AAAA,EAC9B,CAAA,EAAGA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,qBAAqB,CAAA;AAAA,EAC5C,CAAA,EAAGA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,qBAAqB;AAC9C,CAAC,CAAA;AAED,IAAM,UAAA,GAAaA,MAAE,MAAA,CAAO;AAAA,EAC1B,OAAOA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,gBAAgB,CAAA;AAAA,EACtD,QAAQA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,iBAAiB;AAC1D,CAAC,CAAA;AAED,IAAM,kBAAA,GAAqBA,MAAE,IAAA,CAAK;AAAA,EAChC,KAAA;AAAA,EAAO,MAAA;AAAA,EAAQ,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,MAAA;AAAA,EAC3C,MAAA;AAAA,EAAQ,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO,KAAA;AAAA,EACtB,MAAA;AAAA,EAAQ,KAAA;AAAA,EAAO,KAAA;AAAA,EACf,KAAA;AAAA,EAAO,KAAA;AAAA,EAAO;AAChB,CAAC,CAAA,CAAE,SAAS,oBAAoB,CAAA;AAiBzB,IAAM,WAAA,GAAc;AAAA;AAAA,EAEzB,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,oJAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,gBAAA,EAAkBA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,QAAA,EAAS,CAAE,QAAA,EAAS,CACpD,QAAA,CAAS,wEAAwE;AAAA,KACrF,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA;AAAA,EAGA,IAAA,EAAM;AAAA,IACJ,IAAA,EAAM,MAAA;AAAA,IACN,WAAA,EAAa,oDAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,MAAA,EAAQ;AAAA,IACN,IAAA,EAAM,QAAA;AAAA,IACN,WAAA,EAAa,kEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,kBAAkB,CAAA;AAAA,MAC5C,MAAA,EAAQ;AAAA,KACT,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,KAAA,EAAO;AAAA,IACL,IAAA,EAAM,OAAA;AAAA,IACN,WAAA,EAAa,2CAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA;AAAA,EAGA,IAAA,EAAM;AAAA,IACJ,IAAA,EAAM,MAAA;AAAA,IACN,WAAA,EAAa,+BAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,IAAA,EAAM;AAAA,IACJ,IAAA,EAAM,MAAA;AAAA,IACN,WAAA,EAAa,uCAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA;AAAA,EAGA,IAAA,EAAM;AAAA,IACJ,IAAA,EAAM,MAAA;AAAA,IACN,WAAA,EAAa,6EAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,MAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,SAAS,oBAAoB,CAAA;AAAA,MACrD,eAAeA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,oBAAoB,CAAA;AAAA,MACnE,WAAWA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,wBAAwB;AAAA,KACpE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,iBAAA,EAAmB;AAAA,IACjB,IAAA,EAAM,mBAAA;AAAA,IACN,WAAA,EAAa,gDAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,MAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,SAAS,cAAc,CAAA;AAAA,MAC/C,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,kBAAkB,CAAA;AAAA,MAC/C,eAAeA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,oBAAoB,CAAA;AAAA,MACnE,WAAWA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,wBAAwB;AAAA,KACpE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA;AAAA,EAGA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,2CAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,cAAA,EAAgB;AAAA,IACd,IAAA,EAAM,gBAAA;AAAA,IACN,WAAA,EAAa,8BAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA;AAAA,EAGA,cAAA,EAAgB;AAAA,IACd,IAAA,EAAM,gBAAA;AAAA,IACN,WAAA,EAAa,oEAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,iDAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA;AAEzB;AAMO,IAAM,WAAA,GAAc;AAAA,EACzB,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,4FAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,4BAA4B;AAAA,KACrE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,2EAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,0BAA0B,CAAA;AAAA,MAClE,KAAA,EAAOA,MAAE,MAAA,EAAO,CAAE,KAAI,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,kCAAkC;AAAA,KAC/E,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,eAAA,EAAiB;AAAA,IACf,IAAA,EAAM,iBAAA;AAAA,IACN,WAAA,EAAa,+CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,wBAAwB,CAAA;AAAA,MAClD,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CAC1C,QAAA,CAAS,2DAA2D,CAAA;AAAA,MACvE,KAAA,EAAOA,KAAA,CAAE,IAAA,CAAK,CAAC,UAAU,WAAA,EAAa,WAAA,EAAa,WAAA,EAAa,MAAM,CAAC,CAAA,CAAE,QAAA,EAAS,CAC/E,SAAS,0BAA0B;AAAA,KACvC,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,gBAAA,EAAkB;AAAA,IAChB,IAAA,EAAM,kBAAA;AAAA,IACN,WAAA,EAAa,4CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,4BAA4B,CAAA;AAAA,MACpE,IAAA,EAAMA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,oBAAoB;AAAA,KAC/C,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,eAAA,EAAiB;AAAA,IACf,IAAA,EAAM,iBAAA;AAAA,IACN,WAAA,EAAa,8BAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,2BAA2B;AAAA,KACpE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,UAAA,EAAY;AAAA,IACV,IAAA,EAAM,YAAA;AAAA,IACN,WAAA,EAAa,yDAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,gBAAgB,CAAA;AAAA,MAC1C,QAAA,EAAU,kBAAA,CAAmB,QAAA,CAAS,uBAAuB;AAAA,KAC9D,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,UAAA,EAAY;AAAA,IACV,IAAA,EAAM,YAAA;AAAA,IACN,WAAA,EAAa,oCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,kBAAA,CAAmB,QAAA,CAAS,gBAAgB,CAAA;AAAA,MACnD,GAAA,EAAK,kBAAA,CAAmB,QAAA,CAAS,cAAc;AAAA,KAChD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,4CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,MAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,SAAS,cAAc,CAAA;AAAA,MAC/C,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,kBAAkB,CAAA;AAAA,MAC/C,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CACzC,QAAA,CAAS,6BAA6B,CAAA;AAAA,MACzC,KAAKA,KAAA,CAAE,OAAA,GAAU,QAAA,EAAS,CAAE,SAAS,0CAA0C;AAAA,KAChF,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,UAAA,EAAY;AAAA,IACV,IAAA,EAAM,YAAA;AAAA,IACN,WAAA,EAAa,mCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,eAAA,CAAgB,QAAA,CAAS,sBAAsB,CAAA;AAAA,MACtD,MAAA,EAAQ,gBAAA,CAAiB,QAAA,CAAS,qBAAqB;AAAA,KACxD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA,GAC1B;AAAA,EAEA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM,WAAA;AAAA,IACN,WAAA,EAAa,sEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,QAAA,EAAU,kBAAA,CAAmB,QAAA,EAAS,CAAE,SAAS,uDAAuD;AAAA,KACzG,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,QAAQ;AAAA;AAE5B;AAMO,IAAM,SAAA,GAAY;AAAA,EACvB,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,8CAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,OAAA,EAAS;AAAA,IACP,IAAA,EAAM,SAAA;AAAA,IACN,WAAA,EAAa,6CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAM,aAAA,CAAc,QAAA,CAAS,iDAAiD,CAAA;AAAA,MAC9E,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,oDAAoD;AAAA,KAC/F,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM,UAAA;AAAA,IACN,WAAA,EAAa,uDAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,6BAA6B,CAAA;AAAA,MAC5D,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB,CAAA;AAAA,MAC/D,gBAAA,EAAkBA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,QAAA,EAAS,CAAE,QAAA,EAAS,CACpD,QAAA,CAAS,2DAA2D;AAAA,KACxE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,iCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAM,aAAA,CAAc,QAAA,CAAS,gBAAgB,CAAA;AAAA,MAC7C,KAAA,EAAOA,KAAA,CAAE,KAAA,CAAM,CAACA,KAAA,CAAE,MAAA,EAAO,EAAGA,KAAA,CAAE,MAAA,EAAQ,CAAC,CAAA,CAAE,SAAS,cAAc,CAAA;AAAA,MAChE,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,cAAA,EAAgB;AAAA,IACd,IAAA,EAAM,gBAAA;AAAA,IACN,WAAA,EAAa,gFAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAM,aAAA,CAAc,QAAA,CAAS,gBAAgB,CAAA;AAAA,MAC7C,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,2BAA2B,CAAA;AAAA,MACxD,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM,UAAA;AAAA,IACN,WAAA,EAAa,mEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,wBAAwB,CAAA;AAAA,MACvD,MAAA,EAAQA,MAAE,KAAA,CAAMA,KAAA,CAAE,MAAM,eAAe,CAAC,CAAA,CACrC,QAAA,CAAS,8DAA8D,CAAA;AAAA,MAC1E,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM,WAAA;AAAA,IACN,WAAA,EAAa,+BAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAM,aAAA,CAAc,QAAA,CAAS,gBAAgB,CAAA;AAAA,MAC7C,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,UAAA,EAAY;AAAA,IACV,IAAA,EAAM,YAAA;AAAA,IACN,WAAA,EAAa,yCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,qBAAqB,CAAA;AAAA,MACpD,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM,WAAA;AAAA,IACN,WAAA,EAAa,2CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,QAAA,EAAUA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,uCAAuC,CAAA;AAAA,MAClF,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,iDAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,QAAA,EAAUA,MAAE,KAAA,CAAM;AAAA,QAChBA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,CAAS,sCAAsC,CAAA;AAAA,QAC1DA,KAAA,CAAE,QAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,wBAAwB;AAAA,OAC1D,CAAA,CAAE,QAAA,CAAS,0BAA0B,CAAA;AAAA,MACtC,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM,WAAA;AAAA,IACN,WAAA,EAAa,eAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,qBAAqB,CAAA;AAAA,MAC3D,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,kBAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,GAAA,EAAKA,MAAE,KAAA,CAAM;AAAA,QACXA,KAAA,CAAE,MAAA,EAAO,CAAE,QAAA,CAAS,eAAe,CAAA;AAAA,QACnCA,KAAA,CAAE,QAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,cAAc;AAAA,OAChD,CAAA,CAAE,QAAA,CAAS,kBAAkB,CAAA;AAAA,MAC9B,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,uCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,sBAAsB,CAAA;AAAA,MACrD,MAAA,EAAQ,gBAAA,CAAiB,QAAA,CAAS,qBAAqB,CAAA;AAAA,MACvD,KAAA,EAAO,cAAA,CAAe,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM,UAAA;AAAA,IACN,WAAA,EAAa,kCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,IAAA,EAAMA,MAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,SAAS,wBAAwB;AAAA,KAC1D,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,2BAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,iBAAiB,CAAA;AAAA,MAChD,OAAA,EAASA,MAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,SAAS,gBAAgB;AAAA,KACrD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,mCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,iBAAiB;AAAA,KACjD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA;AAE1B;AAMO,IAAM,YAAA,GAAe;AAAA,EAC1B,QAAA,EAAU;AAAA,IACR,IAAA,EAAM,UAAA;AAAA,IACN,WAAA,EAAa,2EAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,wBAAwB;AAAA,KACjE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,qDAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM,UAAA;AAAA,IACN,WAAA,EAAa,sCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CAC1C,QAAA,CAAS,uDAAuD,CAAA;AAAA,MACnE,MAAA,EAAQ,iBAAA,CAAkB,QAAA,EAAS,CAAE,SAAS,qBAAqB;AAAA,KACpE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,qEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,uBAAuB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,cAAA,EAAgB;AAAA,IACd,IAAA,EAAM,gBAAA;AAAA,IACN,WAAA,EAAa,oEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,0BAA0B;AAAA,KACnE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM,WAAA;AAAA,IACN,WAAA,EAAa,uCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,qBAAqB,CAAA;AAAA,MACjE,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,uBAAuB;AAAA,KAClE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,2CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MACrD,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,gBAAgB;AAAA,KAC5C,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,0CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MACrD,IAAA,EAAMA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,eAAe;AAAA,KAC1C,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,gCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MACrD,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,oBAAoB;AAAA,KAChD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA,GAC3B;AAAA,EAEA,cAAA,EAAgB;AAAA,IACd,IAAA,EAAM,gBAAA;AAAA,IACN,WAAA,EAAa,+BAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MACrD,MAAA,EAAQ,iBAAA,CAAkB,QAAA,CAAS,qBAAqB;AAAA,KACzD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,SAAS;AAAA;AAE7B;AAMO,IAAM,SAAA,GAAY;AAAA,EACvB,OAAA,EAAS;AAAA,IACP,IAAA,EAAM,SAAA;AAAA,IACN,WAAA,EAAa,2DAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,uBAAuB;AAAA,KAChE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,gDAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,OAAA,EAAS;AAAA,IACP,IAAA,EAAM,SAAA;AAAA,IACN,WAAA,EAAa,iCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CACzC,QAAA,CAAS,sDAAsD;AAAA,KACnE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,UAAA,EAAY;AAAA,IACV,IAAA,EAAM,YAAA;AAAA,IACN,WAAA,EAAa,+DAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,sBAAsB;AAAA,KAC/D,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,mEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,yBAAyB;AAAA,KAClE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,QAAA,EAAU;AAAA,IACR,IAAA,EAAM,UAAA;AAAA,IACN,WAAA,EAAa,wBAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,MACxD,SAAA,EAAW,eAAA,CAAgB,QAAA,CAAS,yBAAyB,CAAA;AAAA,MAC7D,MAAA,EAAQ,eAAA,CAAgB,QAAA,CAAS,gCAAgC,CAAA;AAAA,MACjE,MAAMA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,4BAA4B,CAAA;AAAA,MACjE,WAAWA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,qCAAqC,CAAA;AAAA,MAC/E,WAAWA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,0BAA0B;AAAA,KACrE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,OAAA,EAAS;AAAA,IACP,IAAA,EAAM,SAAA;AAAA,IACN,WAAA,EAAa,uBAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,MACxD,KAAA,EAAO,cAAA,CAAe,QAAA,CAAS,yBAAyB,CAAA;AAAA,MACxD,GAAA,EAAK,cAAA,CAAe,QAAA,CAAS,uBAAuB,CAAA;AAAA,MACpD,WAAWA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,mBAAmB,CAAA;AAAA,MAC7D,SAAA,EAAWA,MAAE,MAAA,EAAO,CAAE,UAAS,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,qBAAqB;AAAA,KAC3E,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,6BAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,MACxD,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,yBAAyB;AAAA,KACvE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,6CAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,MACxD,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MAC1D,IAAA,EAAMA,KAAA,CAAE,MAAA,EAAO,CAAE,SAAS,kBAAkB;AAAA,KAC7C,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,SAAA,EAAW;AAAA,IACT,IAAA,EAAM,WAAA;AAAA,IACN,WAAA,EAAa,iCAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,MACxD,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MAC1D,QAAA,EAAU,cAAA,CAAe,QAAA,CAAS,cAAc;AAAA,KACjD,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA,GACxB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,iBAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,YAAY,CAAA;AAAA,MACxD,UAAA,EAAYA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,aAAa,CAAA;AAAA,MAC1D,IAAA,EAAM,UAAA,CAAW,QAAA,CAAS,UAAU;AAAA,KACrC,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,MAAM;AAAA;AAE1B;AAUO,IAAM,aAAA,GAAgB;AAAA,EAC3B,eAAA,EAAiB;AAAA,IACf,IAAA,EAAM,iBAAA;AAAA,IACN,WAAA,EAAa,oLAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,YAAA,EAAc,kBAAA,CAAmB,QAAA,CAAS,8BAA8B,CAAA;AAAA,MACxE,OAAA,EAASA,MAAE,MAAA,CAAO;AAAA,QAChB,UAAA,EAAYA,KAAA,CAAE,IAAA,CAAK,CAAC,UAAA,EAAY,UAAA,EAAY,UAAU,CAAC,CAAA,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,uCAAuC,CAAA;AAAA,QACpH,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,GAAA,CAAI,GAAG,CAAA,CAAE,QAAA,EAAS,CAAE,SAAS,mCAAmC;AAAA,OAC5F,CAAA,CAAE,QAAA,EAAS,CAAE,SAAS,oCAAoC;AAAA,KAC5D,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,iBAAA,EAAmB;AAAA,IACjB,IAAA,EAAM,mBAAA;AAAA,IACN,WAAA,EAAa,wJAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,uCAAuC,CAAA;AAAA,MACnF,MAAA,EAAQA,KAAA,CAAE,IAAA,CAAK,CAAC,KAAA,EAAO,KAAA,EAAO,MAAM,CAAC,CAAA,CAAE,OAAA,CAAQ,KAAK,CAAA,CAAE,SAAS,qBAAqB,CAAA;AAAA,MACpF,OAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,GAAA,CAAI,IAAI,CAAA,CAAE,OAAA,CAAQ,IAAI,CAAA,CAAE,SAAS,8BAA8B,CAAA;AAAA,MAC9F,QAAQA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,GAAA,CAAI,IAAI,CAAA,CAAE,OAAA,CAAQ,CAAC,CAAA,CAAE,SAAS,gEAAgE,CAAA;AAAA,MAC9H,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,IAAI,CAAC,CAAA,CAAE,GAAA,CAAI,GAAG,CAAA,CAAE,OAAA,CAAQ,EAAE,CAAA,CAAE,SAAS,8BAA8B;AAAA,KACxF,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,wLAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,eAAA,EAAiB;AAAA,IACf,IAAA,EAAM,iBAAA;AAAA,IACN,WAAA,EAAa,kHAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,SAAA,EAAWA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,+BAA+B,CAAA;AAAA,MAC3E,OAAA,EAASA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,EAAI,CAAE,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,6EAA6E,CAAA;AAAA,MAClI,OAAA,EAASA,MAAE,MAAA,CAAO;AAAA,QAChB,UAAA,EAAYA,KAAA,CAAE,IAAA,CAAK,CAAC,UAAA,EAAY,UAAA,EAAY,UAAU,CAAC,CAAA,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,wBAAwB;AAAA,OACtG,EAAE,QAAA;AAAS,KACb,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,mBAAA,EAAqB;AAAA,IACnB,IAAA,EAAM,qBAAA;AAAA,IACN,WAAA,EAAa,iHAAA;AAAA,IACb,UAAA,EAAYA,KAAA,CAAE,MAAA,CAAO,EAAE,CAAA;AAAA,IACvB,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,mBAAA,EAAqB;AAAA,IACnB,IAAA,EAAM,qBAAA;AAAA,IACN,WAAA,EAAa,qEAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,OAAOA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,gBAAgB,CAAA;AAAA,MACtD,QAAQA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,iBAAiB,CAAA;AAAA,MACxD,SAASA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,kBAAkB,CAAA;AAAA,MAC1D,QAAA,EAAUA,KAAA,CAAE,KAAA,CAAMA,KAAA,CAAE,MAAA,EAAQ,CAAA,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,6CAA6C;AAAA,KAChG,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,YAAA,EAAc;AAAA,IACZ,IAAA,EAAM,cAAA;AAAA,IACN,WAAA,EAAa,gGAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,aAAA,EAAeA,MAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI,CAAA,CAAE,SAAS,qCAAqC,CAAA;AAAA,MACvF,YAAA,EAAcA,MAAE,OAAA,EAAQ,CAAE,QAAQ,IAAI,CAAA,CAAE,SAAS,kCAAkC;AAAA,KACpF,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,WAAA,EAAa;AAAA,IACX,IAAA,EAAM,aAAA;AAAA,IACN,WAAA,EAAa,6GAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,kBAAA,EAAoBA,MAAE,OAAA,EAAQ,CAAE,QAAQ,KAAK,CAAA,CAAE,SAAS,gEAAgE,CAAA;AAAA,MACxH,SAAA,EAAWA,MAAE,MAAA,CAAO;AAAA,QAClB,KAAA,EAAOA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,sBAAsB,CAAA;AAAA,QAC9D,GAAA,EAAKA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,QAAA,CAAS,+BAA+B;AAAA,OACtE,CAAA,CAAE,QAAA,EAAS,CAAE,SAAS,4CAA4C;AAAA,KACpE,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA,GACvB;AAAA,EAEA,aAAA,EAAe;AAAA,IACb,IAAA,EAAM,eAAA;AAAA,IACN,WAAA,EAAa,4FAAA;AAAA,IACb,UAAA,EAAYA,MAAE,MAAA,CAAO;AAAA,MACnB,QAAQA,KAAA,CAAE,MAAA,EAAO,CAAE,GAAA,GAAM,GAAA,CAAI,CAAC,CAAA,CAAE,GAAA,CAAI,GAAG,CAAA,CAAE,OAAA,CAAQ,CAAC,CAAA,CAAE,SAAS,kBAAkB,CAAA;AAAA,MAC/E,WAAWA,KAAA,CAAE,MAAA,GAAS,QAAA,EAAS,CAAE,SAAS,mDAAmD,CAAA;AAAA,MAC7F,WAAA,EAAaA,KAAA,CAAE,IAAA,CAAK,CAAC,UAAA,EAAY,WAAW,CAAC,CAAA,CAAE,QAAA,EAAS,CAAE,QAAA,CAAS,kBAAkB,CAAA;AAAA,MACrF,SAAA,EAAWA,KAAA,CAAE,IAAA,CAAK,CAAC,UAAU,IAAA,EAAM,OAAA,EAAS,IAAA,EAAM,IAAI,CAAC,CAAA,CAAE,QAAA,EAAS,CAAE,SAAS,YAAY;AAAA,KAC1F,CAAA;AAAA,IACD,aAAA,EAAe,CAAC,KAAK;AAAA;AAEzB;AASO,IAAM,QAAA,GAAW;AAAA,EACtB,MAAA,EAAQ,WAAA;AAAA,EACR,MAAA,EAAQ,WAAA;AAAA,EACR,IAAA,EAAM,SAAA;AAAA,EACN,OAAA,EAAS,YAAA;AAAA,EACT,IAAA,EAAM,SAAA;AAAA,EACN,QAAA,EAAU;AACZ;AAKO,IAAM,WAAA,GAAc;AAAA,EACzB,GAAG,WAAA;AAAA,EACH,GAAG,WAAA;AAAA,EACH,GAAG,SAAA;AAAA,EACH,GAAG,YAAA;AAAA,EACH,GAAG,SAAA;AAAA,EACH,GAAG;AACL;AAKO,SAAS,wBAAwB,OAAA,EAAmE;AACzG,EAAA,MAAM,QAA0B,EAAC;AAGjC,EAAA,KAAA,MAAW,IAAA,IAAQ,MAAA,CAAO,MAAA,CAAO,WAAW,CAAA,EAAG;AAC7C,IAAA,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,EACjB;AAGA,EAAA,KAAA,MAAW,IAAA,IAAQ,MAAA,CAAO,MAAA,CAAO,aAAa,CAAA,EAAG;AAC/C,IAAA,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,EACjB;AAGA,EAAA,MAAM,SAAA,GAAY;AAAA,IAChB,MAAA,EAAQ,WAAA;AAAA,IACR,IAAA,EAAM,SAAA;AAAA,IACN,OAAA,EAAS,YAAA;AAAA,IACT,IAAA,EAAM;AAAA,IACN,OAAO,CAAA;AAET,EAAA,KAAA,MAAW,IAAA,IAAQ,MAAA,CAAO,MAAA,CAAO,SAAS,CAAA,EAAG;AAC3C,IAAA,KAAA,CAAM,KAAK,IAAI,CAAA;AAAA,EACjB;AAEA,EAAA,OAAO,KAAA;AACT;AAKA,SAAS,gBAAgB,MAAA,EAA+C;AACtE,EAAA,MAAM,aAAaA,KAAA,CAAE,YAAA,CAAa,QAAQ,EAAE,MAAA,EAAQ,WAAW,CAAA;AAE/D,EAAA,MAAM,EAAE,OAAA,EAAS,OAAA,EAAS,GAAG,MAAK,GAAI,UAAA;AACtC,EAAA,OAAO,IAAA;AACT;AAKO,SAAS,iBAAiB,IAAA,EAI/B;AACA,EAAA,OAAO;AAAA,IACL,MAAM,IAAA,CAAK,IAAA;AAAA,IACX,aAAa,IAAA,CAAK,WAAA;AAAA,IAClB,UAAA,EAAY,eAAA,CAAgB,IAAA,CAAK,UAAU;AAAA,GAC7C;AACF;AAKO,SAAS,gBAAgB,IAAA,EAI9B;AACA,EAAA,OAAO;AAAA,IACL,MAAM,IAAA,CAAK,IAAA;AAAA,IACX,aAAa,IAAA,CAAK,WAAA;AAAA,IAClB,YAAA,EAAc,eAAA,CAAgB,IAAA,CAAK,UAAU;AAAA,GAC/C;AACF;AAKO,SAAS,mBAAmB,OAAA,EAAiD;AAClF,EAAA,OAAO,uBAAA,CAAwB,OAAO,CAAA,CAAE,GAAA,CAAI,gBAAgB,CAAA;AAC9D;AAKO,SAAS,kBAAkB,OAAA,EAAiD;AACjF,EAAA,OAAO,uBAAA,CAAwB,OAAO,CAAA,CAAE,GAAA,CAAI,eAAe,CAAA;AAC7D;;;ACv6BA,IAAMC,iBAAAA,GAAmB,CAAA;AACzB,IAAMC,wBAAAA,GAA0B,CAAA;AAChC,IAAMC,yBAAAA,GAA2B,CAAA;AACjC,IAAMC,oBAAAA,GAAsB,CAAA;AAsBrB,SAAS,YAAA,CACd,GAAA,EACA,MAAA,EACA,OAAA,EACc;AACd,EAAA,MAAM,OAAA,GAAU,GAAA,CAAI,uBAAA,CAAwB,MAAM,CAAA;AAElD,EAAA,QAAQ,OAAA;AAAS,IACf,KAAKH,iBAAAA;AACH,MAAA,OAAO,IAAI,YAAA,CAAa,GAAA,EAAK,MAAA,EAAQ,OAAO,CAAA;AAAA,IAE9C,KAAKC,wBAAAA;AACH,MAAA,OAAO,IAAI,UAAA,CAAW,GAAA,EAAK,MAAA,EAAQ,OAAO,CAAA;AAAA,IAE5C,KAAKC,yBAAAA;AACH,MAAA,OAAO,IAAI,aAAA,CAAc,GAAA,EAAK,MAAA,EAAQ,OAAO,CAAA;AAAA,IAE/C,KAAKC,oBAAAA;AACH,MAAA,OAAO,IAAI,UAAA,CAAW,GAAA,EAAK,MAAA,EAAQ,OAAO,CAAA;AAAA,IAE5C;AACE,MAAA,MAAM,IAAI,KAAA,CAAM,CAAA,2BAAA,EAA8B,OAAO,CAAA,CAAE,CAAA;AAAA;AAE7D;AASO,SAAS,eAAe,MAAA,EAA8C;AAC3E,EAAA,OAAO,MAAA,CAAO,iBAAgB,KAAM,QAAA;AACtC;AAKO,SAAS,aAAa,MAAA,EAA4C;AACvE,EAAA,OAAO,MAAA,CAAO,iBAAgB,KAAM,MAAA;AACtC;AAKO,SAAS,gBAAgB,MAAA,EAA+C;AAC7E,EAAA,OAAO,MAAA,CAAO,iBAAgB,KAAM,SAAA;AACtC;AAKO,SAAS,aAAa,MAAA,EAA4C;AACvE,EAAA,OAAO,MAAA,CAAO,iBAAgB,KAAM,MAAA;AACtC;;;ACDA,IAAM,MAAA,GAAS,OAAO,OAAA,KAAY,WAAA,IAChC,QAAQ,QAAA,IAAY,IAAA,IACpB,OAAA,CAAQ,QAAA,CAAS,IAAA,IAAQ,IAAA;AAmB3B,eAAsB,gBACpB,OAAA,EAC+B;AAC/B,EAAA,MAAM,SAAA,GAAY,IAAI,oBAAA,CAAqB,OAAO,CAAA;AAClD,EAAA,MAAM,UAAU,UAAA,EAAW;AAC3B,EAAA,OAAO,SAAA;AACT;AAkBA,eAAsB,eAAA,CACpB,KAAA,EACA,OAAA,EACA,gBAAA,EAC2B;AAG3B,EAAA,MAAM,iBAAA,GAAoB,CAAC,OAAA,CAAQ,KAAA;AAEnC,EAAA,IAAI,UAAU,iBAAA,EAAmB;AAC/B,IAAA,MAAMC,UAAAA,GAAY,MAAM,yBAAA,CAA0B,gBAAgB,CAAA;AAClE,IAAA,IAAI;AACF,MAAA,OAAO,MAAMA,UAAAA,CAAU,OAAA,CAAQ,KAAA,EAAO,OAAO,CAAA;AAAA,IAC/C,CAAA,SAAE;AACA,MAAA,MAAMA,WAAU,OAAA,EAAQ;AAAA,IAC1B;AAAA,EACF;AAGA,EAAA,MAAM,SAAA,GAAY,MAAM,eAAA,CAAgB,gBAAgB,CAAA;AACxD,EAAA,IAAI;AACF,IAAA,OAAO,MAAM,SAAA,CAAU,OAAA,CAAQ,KAAA,EAAO,OAAO,CAAA;AAAA,EAC/C,CAAA,SAAE;AACA,IAAA,MAAM,UAAU,OAAA,EAAQ;AAAA,EAC1B;AACF;AA+BA,eAAsB,cACpB,KAAA,EACA,KAAA,EACA,MAAA,GAAsB,KAAA,EACtB,cACA,gBAAA,EAC6B;AAC7B,EAAA,MAAM,YAAY,KAAA,CAAM,OAAA,CAAQ,KAAK,CAAA,GAAI,KAAA,GAAQ,CAAC,KAAK,CAAA;AACvD,EAAA,IAAI,SAAA,CAAU,WAAW,CAAA,EAAG;AAC1B,IAAA,MAAM,IAAI,MAAM,yCAAyC,CAAA;AAAA,EAC3D;AACA,EAAA,MAAM,SAAA,GAAY,MAAM,eAAA,CAAgB,gBAAgB,CAAA;AACxD,EAAA,IAAI;AACF,IAAA,MAAM,UAA8B,EAAC;AACrC,IAAA,KAAA,MAAW,aAAa,SAAA,EAAW;AACjC,MAAA,MAAM,MAAA,GAAS,MAAM,SAAA,CAAU,OAAA,CAAQ,KAAA,EAAO;AAAA,QAC5C,YAAA,EAAc,MAAA;AAAA,QACd,KAAA,EAAO,EAAE,GAAG,YAAA,EAAc,SAAA;AAAU,OACrC,CAAA;AACD,MAAA,OAAA,CAAQ,KAAK,MAAM,CAAA;AAAA,IACrB;AACA,IAAA,OAAO,OAAA;AAAA,EACT,CAAA,SAAE;AACA,IAAA,MAAM,UAAU,OAAA,EAAQ;AAAA,EAC1B;AACF;AAKO,SAAS,uBAAuB,MAAA,EAAyB;AAC9D,EAAA,OAAO,qBAAqB,wBAAA,EAAyB,CAAE,QAAA,CAAS,MAAA,CAAO,aAAa,CAAA;AACtF;AAKO,SAAS,wBAAwB,MAAA,EAAyB;AAC/D,EAAA,OAAO,qBAAqB,yBAAA,EAA0B,CAAE,QAAA,CAAS,MAAA,CAAO,aAA6B,CAAA;AACvG;AAiBO,SAAS,qBAAA,CAAsB,aAAqB,YAAA,EAA+B;AACxF,EAAA,OAAO,oBAAA,CAAqB,qBAAA,CAAsB,WAAA,EAAa,YAAY,CAAA;AAC7E;AAgBO,SAAS,yBAAyB,WAAA,EAAqC;AAC5E,EAAA,OAAO,oBAAA,CAAqB,sBAAsB,WAAW,CAAA;AAC/D","file":"index.cjs","sourcesContent":["/**\n * LibreOffice WASM Document Conversion Types\n * Headless document format conversion toolkit\n */\n\n/**\n * Supported input document formats\n */\nexport type InputFormat =\n  // Microsoft Office formats\n  | 'doc'\n  | 'docx'\n  | 'xls'\n  | 'xlsx'\n  | 'ppt'\n  | 'pptx'\n  // OpenDocument formats\n  | 'odt'\n  | 'ods'\n  | 'odp'\n  | 'odg'\n  | 'odf'\n  // Other formats\n  | 'rtf'\n  | 'txt'\n  | 'html'\n  | 'htm'\n  | 'csv'\n  | 'xml'\n  | 'epub'\n  | 'pdf';\n\n/**\n * Supported output document formats\n */\nexport type OutputFormat =\n  | 'pdf'\n  | 'docx'\n  | 'doc'\n  | 'odt'\n  | 'rtf'\n  | 'txt'\n  | 'html'\n  | 'xlsx'\n  | 'xls'\n  | 'ods'\n  | 'csv'\n  | 'pptx'\n  | 'ppt'\n  | 'odp'\n  | 'png'\n  | 'jpg'\n  | 'svg';\n\n/**\n * Document conversion options\n */\nexport interface ConversionOptions {\n  /**\n   * Output format for the conversion\n   */\n  outputFormat: OutputFormat;\n\n  /**\n   * Input format hint (auto-detected if not provided)\n   */\n  inputFormat?: InputFormat;\n\n  /**\n   * PDF-specific options\n   */\n  pdf?: PdfOptions;\n\n  /**\n   * Image output options (for png, jpg, svg)\n   */\n  image?: ImageOptions;\n\n  /**\n   * Password for encrypted documents\n   */\n  password?: string;\n}\n\n/**\n * PDF-specific conversion options\n */\nexport interface PdfOptions {\n  /**\n   * PDF/A conformance level\n   */\n  pdfaLevel?: 'PDF/A-1b' | 'PDF/A-2b' | 'PDF/A-3b';\n\n  /**\n   * PDF quality (0-100, affects image compression)\n   * @default 90\n   */\n  quality?: number;\n}\n\n/**\n * Image output options\n */\nexport interface ImageOptions {\n  /**\n   * Image width in pixels\n   */\n  width?: number;\n\n  /**\n   * Image height in pixels\n   */\n  height?: number;\n\n  /**\n   * DPI for rendering\n   * @default 150\n   */\n  dpi?: number;\n\n  /**\n   * Page index to export (0-based). Only exports this single page.\n   * If not specified, exports the first page (page 0).\n   * Cannot be used together with `pages`.\n   */\n  pageIndex?: number;\n\n  /**\n   * Array of page indices to export (0-based).\n   * If specified, returns an array of results (one per page).\n   * Cannot be used together with `pageIndex`.\n   */\n  pages?: number[];\n}\n\n/**\n * Result of a document conversion\n */\nexport interface ConversionResult {\n  /**\n   * The converted document data\n   */\n  data: Uint8Array;\n\n  /**\n   * MIME type of the output\n   */\n  mimeType: string;\n\n  /**\n   * Suggested filename with new extension\n   */\n  filename: string;\n\n  /**\n   * Conversion duration in milliseconds\n   */\n  duration: number;\n}\n\n/**\n * WASM loader module interface\n * This is the interface for the loader.cjs module that creates the Emscripten module\n */\nexport interface WasmLoaderModule {\n  createModule: (config: Record<string, unknown>) => Promise<EmscriptenModule>;\n}\n\n/**\n * LibreOffice WASM module initialization options (Node.js)\n */\nexport interface LibreOfficeWasmOptions {\n  /**\n   * Path to WASM files directory\n   * @default './wasm'\n   */\n  wasmPath?: string;\n\n  /**\n   * Path to the worker script (for WorkerConverter)\n   * When not specified, auto-detected based on module location\n   */\n  workerPath?: string;\n\n  /**\n   * Pre-loaded WASM loader module\n   * When provided, bypasses dynamic require of loader.cjs\n   * This is useful for bundlers like Turbopack that can't handle dynamic requires\n   *\n   * @example\n   * ```typescript\n   * // In your code, import the loader statically\n   * import * as wasmLoader from '@matbee/libreoffice-converter/wasm/loader.cjs';\n   *\n   * const converter = new LibreOfficeConverter({\n   *   wasmPath: './wasm',\n   *   wasmLoader,\n   * });\n   * ```\n   */\n  wasmLoader?: WasmLoaderModule;\n\n  /**\n   * Enable verbose logging\n   * @default false\n   */\n  verbose?: boolean;\n\n  /**\n   * Called when WASM module is ready\n   */\n  onReady?: () => void;\n\n  /**\n   * Called on initialization error\n   */\n  onError?: (error: Error) => void;\n\n  /**\n   * Called with progress updates during initialization\n   */\n  onProgress?: (progress: ProgressInfo) => void;\n}\n\n/**\n * Explicit paths to WASM files (Browser)\n * All paths are required when specified explicitly\n */\nexport interface BrowserWasmPaths {\n  /** URL to soffice.js - the main Emscripten loader script */\n  sofficeJs: string;\n  /** URL to soffice.wasm - the WebAssembly binary (~112MB) */\n  sofficeWasm: string;\n  /** URL to soffice.data - the virtual filesystem image (~80MB) */\n  sofficeData: string;\n  /** URL to soffice.worker.js - the Emscripten pthread worker */\n  sofficeWorkerJs: string;\n}\n\n/**\n * Browser converter initialization options\n * All WASM paths are optional and default to /wasm/ via createWasmPaths()\n */\nexport interface BrowserConverterOptions {\n  /** URL to soffice.js - defaults to /wasm/soffice.js */\n  sofficeJs?: string;\n  /** URL to soffice.wasm - defaults to /wasm/soffice.wasm */\n  sofficeWasm?: string;\n  /** URL to soffice.data - defaults to /wasm/soffice.data */\n  sofficeData?: string;\n  /** URL to soffice.worker.js - defaults to /wasm/soffice.worker.js */\n  sofficeWorkerJs?: string;\n\n  /**\n   * Enable verbose logging\n   * @default false\n   */\n  verbose?: boolean;\n\n  /**\n   * Called when WASM module is ready\n   */\n  onReady?: () => void;\n\n  /**\n   * Called on initialization error\n   */\n  onError?: (error: Error) => void;\n\n  /**\n   * Called with progress updates during initialization\n   */\n  onProgress?: (progress: WasmLoadProgress) => void;\n}\n\n/**\n * Worker browser converter initialization options\n * All WASM paths are optional and default to /wasm/ via createWasmPaths()\n */\nexport interface WorkerBrowserConverterOptions extends BrowserConverterOptions {\n  /** URL to browser.worker.js - defaults to /dist/browser.worker.global.js */\n  browserWorkerJs?: string;\n  /**\n   * Enable download progress tracking during WASM initialization\n   * When enabled, intercepts fetch/XHR to track download progress for soffice.wasm and soffice.data\n   * \n   * **WARNING**: This is disabled by default because the fetch interceptor can break\n   * WebAssembly streaming compilation in some environments. Only enable if you need\n   * detailed download progress and have tested it works in your target browsers.\n   * \n   * @default false\n   */\n  enableProgressTracking?: boolean;\n}\n\n/**\n * Internal type for BrowserConverterOptions after defaults are applied\n * All WASM paths are guaranteed to be defined\n */\nexport type ResolvedBrowserConverterOptions = BrowserConverterOptions & BrowserWasmPaths;\n\n/**\n * Internal type for WorkerBrowserConverterOptions after defaults are applied\n * All WASM paths and browserWorkerJs are guaranteed to be defined\n */\nexport type ResolvedWorkerBrowserConverterOptions = WorkerBrowserConverterOptions & BrowserWasmPaths & {\n  browserWorkerJs: string;\n};\n\n/**\n * Default URL for WASM files - relative path for same-origin hosting\n * Users typically serve WASM files from their own server at /wasm/\n */\nexport const DEFAULT_WASM_BASE_URL = '/wasm/';\n\n/**\n * Create WASM file paths from a base URL\n * Convenience helper for users who keep all WASM files in one directory\n *\n * @param baseUrl - Base URL ending with '/' (e.g., '/wasm/', 'https://cdn.example.com/wasm/')\n *                  Defaults to '/wasm/' for same-origin hosting\n * @returns Object with all WASM file paths\n *\n * @example\n * ```typescript\n * // Use default /wasm/ path (same-origin)\n * const converter = new WorkerBrowserConverter({\n *   ...createWasmPaths(),\n *   browserWorkerJs: '/dist/browser.worker.js',\n * });\n *\n * // Or use your own CDN\n * const converter = new WorkerBrowserConverter({\n *   ...createWasmPaths('https://cdn.example.com/wasm/'),\n *   browserWorkerJs: '/dist/browser.worker.js',\n * });\n * ```\n */\nexport function createWasmPaths(baseUrl: string = DEFAULT_WASM_BASE_URL): BrowserWasmPaths {\n  // Ensure baseUrl ends with /\n  const base = baseUrl.endsWith('/') ? baseUrl : `${baseUrl}/`;\n  return {\n    sofficeJs: `${base}soffice.js`,\n    sofficeWasm: `${base}soffice.wasm`,\n    sofficeData: `${base}soffice.data`,\n    sofficeWorkerJs: `${base}soffice.worker.js`,\n  };\n}\n\n/**\n * Loading phases for WASM initialization\n * Used to track detailed progress during the ~80 second browser startup\n */\nexport type WasmLoadPhase =\n  | 'download-wasm'    // Downloading soffice.wasm (~142MB)\n  | 'download-data'    // Downloading soffice.data (~96MB)\n  | 'compile'          // WebAssembly compilation\n  | 'filesystem'       // Emscripten filesystem setup\n  | 'lok-init'         // LibreOfficeKit initialization\n  | 'ready' | 'starting' | 'loading' | 'initializing' | 'converting' | 'complete';           // Complete\n\n/**\n * Extended progress information with download details\n * Backward compatible - existing code using percent/message continues to work\n */\nexport interface WasmLoadProgress {\n  /** Overall progress 0-100 */\n  percent: number;\n  /** Human-readable status message */\n  message: string;\n  /** Current loading phase */\n  phase: WasmLoadPhase;\n  /** Bytes downloaded (present during download phases) */\n  bytesLoaded?: number;\n  /** Total bytes to download (present during download phases) */\n  bytesTotal?: number;\n}\n\n/**\n * Progress information\n * @deprecated Use WasmLoadProgress for richer progress data\n */\nexport interface ProgressInfo {\n  phase: 'loading' | 'initializing' | 'converting' | 'complete';\n  percent: number;\n  message: string;\n}\n\n/**\n * Error codes for conversion failures\n */\nexport enum ConversionErrorCode {\n  UNKNOWN = 'UNKNOWN',\n  INVALID_INPUT = 'INVALID_INPUT',\n  UNSUPPORTED_FORMAT = 'UNSUPPORTED_FORMAT',\n  CORRUPTED_DOCUMENT = 'CORRUPTED_DOCUMENT',\n  PASSWORD_REQUIRED = 'PASSWORD_REQUIRED',\n  WASM_NOT_INITIALIZED = 'WASM_NOT_INITIALIZED',\n  CONVERSION_FAILED = 'CONVERSION_FAILED',\n  LOAD_FAILED = 'LOAD_FAILED',\n}\n\n/**\n * Custom error class for conversion errors\n */\nexport class ConversionError extends Error {\n  public readonly code: ConversionErrorCode;\n  public readonly details?: string;\n\n  constructor(code: ConversionErrorCode, message: string, details?: string) {\n    super(message);\n    this.name = 'ConversionError';\n    this.code = code;\n    this.details = details;\n  }\n}\n\n/**\n * Emscripten Module interface\n */\nexport interface EmscriptenModule {\n  // Core Emscripten functions\n  ccall: (\n    name: string,\n    returnType: string | null,\n    argTypes: string[],\n    args: unknown[]\n  ) => unknown;\n  cwrap: (\n    name: string,\n    returnType: string | null,\n    argTypes: string[]\n  ) => (...args: unknown[]) => unknown;\n\n  // Memory management\n  _malloc: (size: number) => number;\n  _free: (ptr: number) => void;\n  HEAPU8: Uint8Array;\n  HEAP32: Int32Array;\n  HEAPU32: Uint32Array;\n\n  // File system\n  FS: EmscriptenFS;\n\n  // Lifecycle\n  onRuntimeInitialized?: () => void;\n  calledRun?: boolean;\n\n  // LibreOfficeKit hooks (exported C functions)\n  _lok_preinit?: (path: number, args: number) => number;\n  _lok_preinit_2?: (path: number, args: number, callback: number) => number;\n  _libreofficekit_hook?: (path: number) => number;\n  _libreofficekit_hook_2?: (path: number, userProfile: number) => number;\n  _main?: (argc: number, argv: number) => number;\n\n  // WebAssembly function table for indirect calls\n  wasmTable?: WebAssembly.Table;\n\n  // Module locator\n  locateFile?: (path: string) => string;\n  print?: (text: string) => void;\n  printErr?: (text: string) => void;\n\n  // Runtime ready promise (some builds)\n  ready?: Promise<EmscriptenModule>;\n}\n\n/**\n * Emscripten virtual filesystem\n */\nexport interface EmscriptenFS {\n  mkdir: (path: string) => void;\n  writeFile: (path: string, data: Uint8Array | string, opts?: { encoding?: string }) => void;\n  readFile: (path: string, opts?: { encoding?: string }) => Uint8Array | string;\n  unlink: (path: string) => void;\n  readdir: (path: string) => string[];\n  stat: (path: string) => { size: number; isDirectory: () => boolean };\n  rmdir: (path: string) => void;\n  rename: (oldPath: string, newPath: string) => void;\n  open: (path: string, flags: unknown, mode?: unknown) => unknown;\n}\n\n/**\n * Filter name mapping for LibreOffice export\n * Note: For image exports, use getFilterForDocType() instead as filters are document-type specific\n */\nexport const FORMAT_FILTERS: Record<OutputFormat, string> = {\n  pdf: 'writer_pdf_Export',\n  docx: 'MS Word 2007 XML',\n  doc: 'MS Word 97',\n  odt: 'writer8',\n  rtf: 'Rich Text Format',\n  txt: 'Text',\n  html: 'HTML (StarWriter)',\n  xlsx: 'Calc MS Excel 2007 XML',\n  xls: 'MS Excel 97',\n  ods: 'calc8',\n  csv: 'Text - txt - csv (StarCalc)',\n  pptx: 'Impress MS PowerPoint 2007 XML',\n  ppt: 'MS PowerPoint 97',\n  odp: 'impress8',\n  png: 'writer_png_Export',\n  jpg: 'writer_jpg_Export',\n  svg: 'writer_svg_Export',\n};\n\n/**\n * LibreOfficeKit document types (from LibreOfficeKitEnums.h)\n */\nexport enum LOKDocumentType {\n  TEXT = 0,\n  SPREADSHEET = 1,\n  PRESENTATION = 2,\n  DRAWING = 3,\n  OTHER = 4,\n}\n\n/**\n * Document-type-specific filters for image and PDF exports\n * Each document type (Writer, Calc, Impress, Draw) has its own export filters\n */\nexport const DOC_TYPE_FILTERS: Record<LOKDocumentType, Partial<Record<OutputFormat, string>>> = {\n  [LOKDocumentType.TEXT]: {\n    pdf: 'writer_pdf_Export',\n    png: 'writer_png_Export',\n    jpg: 'writer_jpg_Export',\n    svg: 'writer_svg_Export',\n    html: 'HTML (StarWriter)',\n  },\n  [LOKDocumentType.SPREADSHEET]: {\n    pdf: 'calc_pdf_Export',\n    png: 'calc_png_Export',\n    jpg: 'calc_jpg_Export',\n    svg: 'calc_svg_Export',\n    html: 'HTML (StarCalc)',\n  },\n  [LOKDocumentType.PRESENTATION]: {\n    pdf: 'impress_pdf_Export',\n    png: 'impress_png_Export',\n    jpg: 'impress_jpg_Export',\n    svg: 'impress_svg_Export',\n    html: 'impress_html_Export',\n  },\n  [LOKDocumentType.DRAWING]: {\n    pdf: 'draw_pdf_Export',\n    png: 'draw_png_Export',\n    jpg: 'draw_jpg_Export',\n    svg: 'draw_svg_Export',\n    html: 'draw_html_Export',\n  },\n  [LOKDocumentType.OTHER]: {\n    pdf: 'writer_pdf_Export',\n    png: 'writer_png_Export',\n    jpg: 'writer_jpg_Export',\n    svg: 'writer_svg_Export',\n  },\n};\n\n/**\n * Get the correct export filter for a given output format and document type\n * @param outputFormat The desired output format\n * @param docType The LibreOfficeKit document type (use documentGetDocumentType())\n * @returns The filter name to use for saveAs\n */\nexport function getFilterForDocType(outputFormat: OutputFormat, docType: LOKDocumentType | number): string {\n  // Check if there's a document-type-specific filter\n  const docTypeFilters = DOC_TYPE_FILTERS[docType as LOKDocumentType];\n  if (docTypeFilters && docTypeFilters[outputFormat]) {\n    return docTypeFilters[outputFormat];\n  }\n\n  // Fall back to the default filter\n  return FORMAT_FILTERS[outputFormat];\n}\n\n/**\n * MIME types for output formats\n */\nexport const FORMAT_MIME_TYPES: Record<OutputFormat, string> = {\n  pdf: 'application/pdf',\n  docx: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  doc: 'application/msword',\n  odt: 'application/vnd.oasis.opendocument.text',\n  rtf: 'application/rtf',\n  txt: 'text/plain',\n  html: 'text/html',\n  xlsx: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  xls: 'application/vnd.ms-excel',\n  ods: 'application/vnd.oasis.opendocument.spreadsheet',\n  csv: 'text/csv',\n  pptx: 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  ppt: 'application/vnd.ms-powerpoint',\n  odp: 'application/vnd.oasis.opendocument.presentation',\n  png: 'image/png',\n  jpg: 'image/jpeg',\n  svg: 'image/svg+xml',\n};\n\n/**\n * File extension to format mapping\n */\nexport const EXTENSION_TO_FORMAT: Record<string, InputFormat> = {\n  doc: 'doc',\n  docx: 'docx',\n  xls: 'xls',\n  xlsx: 'xlsx',\n  ppt: 'ppt',\n  pptx: 'pptx',\n  odt: 'odt',\n  ods: 'ods',\n  odp: 'odp',\n  odg: 'odg',\n  odf: 'odf',\n  rtf: 'rtf',\n  txt: 'txt',\n  html: 'html',\n  htm: 'html',\n  csv: 'csv',\n  xml: 'xml',\n  epub: 'epub',\n  pdf: 'pdf',\n};\n\n/**\n * Map LOK document type to valid output formats\n * This is based on LibreOffice's actual extension maps in desktop/source/lib/init.cxx\n * \n * IMPORTANT: These are the formats that LibreOffice's saveAs() actually supports.\n * The extension maps in init.cxx determine what filters are available per document type.\n * \n * Writer (TEXT): doc, docx, odt, pdf, rtf, txt, html, png, epub\n * Calc (SPREADSHEET): csv, ods, pdf, xls, xlsx, html, png\n * Impress (PRESENTATION): odp, pdf, ppt, pptx, svg, html, png\n * Draw (DRAWING): odg, pdf, svg, html, png\n * \n * NOTE: jpg is NOT in any extension map! Only png is supported for image export.\n * NOTE: svg is only supported for Impress and Draw, not Writer or Calc.\n */\nexport const LOK_DOCTYPE_OUTPUT_FORMATS: Record<LOKDocumentType, OutputFormat[]> = {\n  [LOKDocumentType.TEXT]: ['pdf', 'docx', 'doc', 'odt', 'rtf', 'txt', 'html', 'png'],\n  [LOKDocumentType.SPREADSHEET]: ['pdf', 'xlsx', 'xls', 'ods', 'csv', 'html', 'png'],\n  [LOKDocumentType.PRESENTATION]: ['pdf', 'pptx', 'ppt', 'odp', 'png', 'svg', 'html'],\n  [LOKDocumentType.DRAWING]: ['pdf', 'png', 'svg', 'html'],\n  [LOKDocumentType.OTHER]: ['pdf'],\n};\n\n/**\n * Get valid output formats for a LOK document type\n * Use this after loading a document to get accurate conversion options\n * @param docType The LOK document type (from documentGetDocumentType)\n * @returns Array of valid output formats\n */\nexport function getOutputFormatsForDocType(docType: LOKDocumentType | number): OutputFormat[] {\n  return LOK_DOCTYPE_OUTPUT_FORMATS[docType as LOKDocumentType] || ['pdf'];\n}\n\n/**\n * Map output format to LOK format string\n * These are the format names used by LibreOfficeKit's saveAs\n */\nexport const OUTPUT_FORMAT_TO_LOK: Record<OutputFormat, string> = {\n  pdf: 'pdf',\n  docx: 'docx',\n  doc: 'doc',\n  odt: 'odt',\n  rtf: 'rtf',\n  txt: 'txt',\n  html: 'html',\n  xlsx: 'xlsx',\n  xls: 'xls',\n  ods: 'ods',\n  csv: 'csv',\n  pptx: 'pptx',\n  ppt: 'ppt',\n  odp: 'odp',\n  png: 'png',\n  jpg: 'jpg',\n  svg: 'svg',\n};\n\n/**\n * Filter options for specific format conversions\n * These are passed to LibreOfficeKit's saveAs as the filterOptions parameter\n */\nexport const FORMAT_FILTER_OPTIONS: Partial<Record<OutputFormat, string>> = {\n  // PDF options can include things like:\n  // - SelectPdfVersion (0=PDF 1.4, 1=PDF/A-1, 2=PDF/A-2, 3=PDF/A-3)\n  // - UseLosslessCompression\n  // - Quality\n  pdf: '',\n  // CSV can specify separator, encoding, etc.\n  csv: '44,34,76,1,,0,false,true,false,false,false,-1',\n  // Text encoding\n  txt: 'UTF8',\n};\n\n/**\n * CSV Import filter options for loading CSV files as spreadsheets.\n * \n * The FilterOptions token format (15 tokens, comma-separated):\n * Token 0: Field separator ASCII code (44 = comma, 9 = tab, 59 = semicolon)\n * Token 1: Text delimiter ASCII code (34 = double quote)\n * Token 2: Character set (76 = UTF-8)\n * Token 3: Start row (1 = first row)\n * Token 4: Column format info (empty = auto-detect)\n * Token 5: Language ID (1033 = English US, 0 = system)\n * Token 6: Quoted field as text (true/false)\n * Token 7: Detect special numbers (true/false)\n * Token 8: Save as shown - export only (false)\n * Token 9: Save formulas - export only (false)\n * Token 10: Trim spaces (false)\n * Token 11: Sheet to export - export only (0)\n * Token 12: Evaluate formulas (true)\n * Token 13: Include BOM - export only (false)\n * Token 14: Detect scientific numbers (true)\n * \n * This ensures LibreOffice loads CSV files as Calc spreadsheet documents\n * in headless mode without triggering dialogs.\n */\nexport const CSV_IMPORT_FILTER_OPTIONS = 'FilterName=Text - txt - csv (StarCalc),FilterOptions=44,34,76,1,,1033,false,true,false,false,false,0,true,false,true';\n\n/**\n * Build load options for a document based on format and other options\n * @param inputFormat The input document format\n * @param password Optional password for encrypted documents\n * @returns Load options string for documentLoadWithOptions, or empty string for documentLoad\n */\nexport function buildLoadOptions(inputFormat?: string, password?: string): string {\n  const options: string[] = [];\n  \n  // CSV files need explicit import filter to be recognized as spreadsheets\n  if (inputFormat?.toLowerCase() === 'csv') {\n    options.push(CSV_IMPORT_FILTER_OPTIONS);\n  }\n  \n  // Password-protected documents\n  if (password) {\n    options.push(`Password=${password}`);\n  }\n  \n  return options.join(',');\n}\n\n/**\n * Document type categories for determining valid conversions\n */\nexport type DocumentCategory = 'text' | 'spreadsheet' | 'presentation' | 'drawing' | 'other';\n\n/**\n * Map input formats to their document category\n * This determines which output formats are valid\n */\nexport const INPUT_FORMAT_CATEGORY: Record<InputFormat, DocumentCategory> = {\n  // Text/Writer documents\n  doc: 'text',\n  docx: 'text',\n  odt: 'text',\n  rtf: 'text',\n  txt: 'text',\n  html: 'text',\n  htm: 'text',\n  epub: 'text',\n  xml: 'text',\n  // Spreadsheet/Calc documents\n  xls: 'spreadsheet',\n  xlsx: 'spreadsheet',\n  ods: 'spreadsheet',\n  csv: 'spreadsheet',\n  // Presentation/Impress documents\n  ppt: 'presentation',\n  pptx: 'presentation',\n  odp: 'presentation',\n  // Drawing/Draw documents (PDF imports as Draw)\n  odg: 'drawing',\n  odf: 'drawing',\n  pdf: 'drawing', // PDFs are imported as Draw documents\n};\n\n/**\n * Valid output formats for each document category\n * Based on LibreOffice's actual filter capabilities\n */\nexport const CATEGORY_OUTPUT_FORMATS: Record<DocumentCategory, OutputFormat[]> = {\n  // Writer documents can export to (based on aWriterExtensionMap in init.cxx):\n  // NOTE: jpg and svg are NOT supported for Writer - only png for images\n  text: ['pdf', 'docx', 'doc', 'odt', 'rtf', 'txt', 'html', 'png'],\n  // Calc documents can export to (based on aCalcExtensionMap in init.cxx):\n  // NOTE: jpg and svg are NOT supported for Calc - only png for images\n  spreadsheet: ['pdf', 'xlsx', 'xls', 'ods', 'csv', 'html', 'png'],\n  // Impress documents can export to (based on aImpressExtensionMap in init.cxx):\n  // NOTE: jpg is NOT supported - only png and svg for images\n  presentation: ['pdf', 'pptx', 'ppt', 'odp', 'png', 'svg', 'html'],\n  // Draw documents (including imported PDFs) can export to (based on aDrawExtensionMap in init.cxx):\n  // NOTE: jpg is NOT supported - only png and svg for images\n  drawing: ['pdf', 'png', 'svg', 'html'],\n  // Other/unknown - try PDF only\n  other: ['pdf'],\n};\n\n/**\n * Get valid output formats for a given input format\n * @param inputFormat The input document format\n * @returns Array of valid output formats\n */\nexport function getValidOutputFormats(inputFormat: InputFormat | string): OutputFormat[] {\n  const format = inputFormat.toLowerCase() as InputFormat;\n  const category = INPUT_FORMAT_CATEGORY[format];\n\n  if (!category) {\n    // Unknown format - allow PDF as a safe default\n    return ['pdf'];\n  }\n\n  return CATEGORY_OUTPUT_FORMATS[category];\n}\n\n/**\n * Check if a conversion from input format to output format is valid\n * @param inputFormat The input document format\n * @param outputFormat The desired output format\n * @returns true if the conversion is supported\n */\nexport function isConversionValid(\n  inputFormat: InputFormat | string,\n  outputFormat: OutputFormat | string\n): boolean {\n  const validOutputs = getValidOutputFormats(inputFormat);\n  return validOutputs.includes(outputFormat.toLowerCase() as OutputFormat);\n}\n\n/**\n * Get a human-readable error message for invalid conversions\n * @param inputFormat The input document format\n * @param outputFormat The desired output format\n * @returns Error message explaining why the conversion is not supported\n */\nexport function getConversionErrorMessage(\n  inputFormat: InputFormat | string,\n  outputFormat: OutputFormat | string\n): string {\n  const input = inputFormat.toLowerCase();\n  const output = outputFormat.toLowerCase();\n  const validOutputs = getValidOutputFormats(input as InputFormat);\n\n  const category = INPUT_FORMAT_CATEGORY[input as InputFormat] || 'unknown';\n\n  let reason = '';\n  if (category === 'drawing' && ['docx', 'doc', 'xlsx', 'xls', 'pptx', 'ppt'].includes(output)) {\n    reason = `PDF files are imported as Draw documents and cannot be exported to Office formats. `;\n  } else if (category === 'spreadsheet' && ['docx', 'doc', 'pptx', 'ppt'].includes(output)) {\n    reason = `Spreadsheet documents cannot be converted to word processing or presentation formats. `;\n  } else if (category === 'presentation' && ['docx', 'doc', 'xlsx', 'xls'].includes(output)) {\n    reason = `Presentation documents cannot be converted to word processing or spreadsheet formats. `;\n  } else if (category === 'text' && ['xlsx', 'xls', 'pptx', 'ppt'].includes(output)) {\n    reason = `Text documents cannot be converted to spreadsheet or presentation formats. `;\n  }\n\n  return `Cannot convert ${input.toUpperCase()} to ${output.toUpperCase()}. ${reason}Valid output formats for ${input.toUpperCase()}: ${validOutputs.join(', ')}`;\n}\n\n// ============================================\n// Shared Converter Interface\n// ============================================\n\n/**\n * Page preview data returned by renderPage/renderPagePreviews\n */\nexport interface PagePreview {\n  page: number;\n  data: Uint8Array;\n  width: number;\n  height: number;\n}\n\n/**\n * Document information returned by getDocumentInfo\n */\nexport interface DocumentInfo {\n  documentType: LOKDocumentType | number;\n  documentTypeName: string;\n  validOutputFormats: OutputFormat[];\n  pageCount: number;\n}\n\n/**\n * Options for rendering page previews\n */\nexport interface RenderOptions {\n  /** Width of rendered image in pixels */\n  width?: number;\n  /** Height of rendered image in pixels (0 = auto based on aspect ratio) */\n  height?: number;\n  /** Specific page indices to render (0-based). If empty, renders all pages */\n  pageIndices?: number[];\n  /**\n   * Render in edit mode (shows text input boxes, cursors, etc.)\n   * Default is false - presentations render in view/read mode for clean output\n   */\n  editMode?: boolean;\n}\n\n/**\n * Options for full quality page rendering\n */\nexport interface FullQualityRenderOptions {\n  /** DPI for rendering (default 150, use 300 for print quality) */\n  dpi?: number;\n  /** Maximum dimension (width or height) to prevent memory issues */\n  maxDimension?: number;\n  /**\n   * Render in edit mode (shows text input boxes, cursors, etc.)\n   * Default is false - presentations render in view/read mode for clean output\n   */\n  editMode?: boolean;\n}\n\n/**\n * Full quality page preview with DPI information\n */\nexport interface FullQualityPagePreview extends PagePreview {\n  /** Effective DPI (may differ from requested if capped) */\n  dpi: number;\n}\n\n/**\n * Editor session returned from openDocument\n */\nexport interface EditorSession {\n  sessionId: string;\n  documentType: string;\n  pageCount: number;\n}\n\n/**\n * Result from editor operations\n */\nexport interface EditorOperationResult<T = unknown> {\n  success: boolean;\n  verified?: boolean;\n  data?: T;\n  error?: string;\n  suggestion?: string;\n}\n\n/**\n * Options containing input format for document operations.\n */\nexport type InputFormatOptions = Pick<ConversionOptions, 'inputFormat'>;\n\n/**\n * Common interface for all LibreOffice converter implementations.\n * Ensures consistent API across different threading models (main thread, workers, child processes).\n *\n * All methods returning Promise are async in the interface to allow implementations\n * flexibility in whether they need actual async operations.\n */\nexport interface ILibreOfficeConverter {\n  // ============================================\n  // Lifecycle\n  // ============================================\n\n  /** Initialize the converter. Must be called before any other operations. */\n  initialize(): Promise<void>;\n\n  /** Destroy the converter and release all resources. */\n  destroy(): Promise<void>;\n\n  /** Check if the converter is ready for operations. */\n  isReady(): boolean;\n\n  // ============================================\n  // Core Conversion\n  // ============================================\n\n  /** Convert a document to a different format. */\n  convert(\n    input: Uint8Array | ArrayBuffer,\n    options: ConversionOptions,\n    filename?: string\n  ): Promise<ConversionResult>;\n\n  // ============================================\n  // Document Inspection\n  // ============================================\n\n  /** Get the number of pages in a document. */\n  getPageCount(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions\n  ): Promise<number>;\n\n  /** Get document information including type and valid output formats. */\n  getDocumentInfo(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions\n  ): Promise<DocumentInfo>;\n\n  // ============================================\n  // Page Rendering\n  // ============================================\n\n  /** Render a single page as an image. */\n  renderPage(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    width: number,\n    height?: number\n  ): Promise<PagePreview>;\n\n  /** Render multiple pages as images. */\n  renderPagePreviews(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions,\n    renderOptions?: RenderOptions\n  ): Promise<PagePreview[]>;\n\n  /**\n   * Render a page at full quality (native resolution based on DPI).\n   * Unlike renderPage which scales to a fixed width, this renders at the\n   * document's native resolution converted to pixels at the specified DPI.\n   */\n  renderPageFullQuality(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    renderOptions?: FullQualityRenderOptions\n  ): Promise<FullQualityPagePreview>;\n\n  // ============================================\n  // Editor Operations\n  // ============================================\n\n  /** Open a document for editing and return a session. */\n  openDocument(\n    input: Uint8Array | ArrayBuffer,\n    options: InputFormatOptions\n  ): Promise<EditorSession>;\n\n  /** Execute an editor operation on an open document. */\n  editorOperation<T = unknown>(\n    sessionId: string,\n    method: string,\n    args?: unknown[]\n  ): Promise<EditorOperationResult<T>>;\n\n  /** Close an editor session and optionally get the modified document. */\n  closeDocument(sessionId: string): Promise<Uint8Array | undefined>;\n}\n","/**\n * LibreOfficeKit Low-Level Bindings\n *\n * This module provides direct access to the LibreOfficeKit C API\n * through the WASM module using the stable lok_* shim exports.\n *\n * Shim functions (C side) should be defined as:\n *   - lok_documentLoad(pKit, pPath)\n *   - lok_documentLoadWithOptions(pKit, pPath, pOptions)\n *   - lok_documentSaveAs(pDoc, pUrl, pFormat, pFilterOptions)\n *   - lok_documentDestroy(pDoc)\n *   - lok_getError(pKit)\n *   - lok_destroy(pKit)          <-- RECOMMENDED to add\n */\n\nimport type { EmscriptenModule } from './types.js';\n\n// Extended module type with our LOK shim exports\ninterface LOKModule extends EmscriptenModule {\n  _lok_documentLoad?: (lok: number, path: number) => number;\n  _lok_documentLoadWithOptions?: (lok: number, path: number, options: number) => number;\n  _lok_documentSaveAs?: (doc: number, url: number, format: number, opts: number) => number;\n  _lok_documentDestroy?: (doc: number) => void;\n  _lok_getError?: (lok: number) => number;\n  _lok_destroy?: (lok: number) => void;\n  // Page rendering shims\n  _lok_documentGetParts?: (doc: number) => number;\n  _lok_documentGetPart?: (doc: number) => number;\n  _lok_documentSetPart?: (doc: number, part: number) => void;\n  _lok_documentGetDocumentType?: (doc: number) => number;\n  _lok_documentGetDocumentSize?: (doc: number, widthPtr: number, heightPtr: number) => void;\n  _lok_documentInitializeForRendering?: (doc: number, args: number) => void;\n  _lok_documentPaintTile?: (\n    doc: number,\n    buffer: number,\n    canvasWidth: number,\n    canvasHeight: number,\n    tilePosX: number,\n    tilePosY: number,\n    tileWidth: number,\n    tileHeight: number\n  ) => void;\n  _lok_documentGetTileMode?: (doc: number) => number;\n  // Text selection and content shims\n  _lok_documentGetTextSelection?: (doc: number, mimeType: number, usedMimeType: number) => number;\n  _lok_documentSetTextSelection?: (doc: number, type: number, x: number, y: number) => void;\n  _lok_documentGetSelectionType?: (doc: number) => number;\n  _lok_documentResetSelection?: (doc: number) => void;\n  // Mouse and keyboard event shims\n  _lok_documentPostMouseEvent?: (doc: number, type: number, x: number, y: number, count: number, buttons: number, modifier: number) => void;\n  _lok_documentPostKeyEvent?: (doc: number, type: number, charCode: number, keyCode: number) => void;\n  // UNO command shims\n  _lok_documentPostUnoCommand?: (doc: number, command: number, args: number, notifyWhenFinished: number) => void;\n  _lok_documentGetCommandValues?: (doc: number, command: number) => number;\n  // Page/Part information shims\n  _lok_documentGetPartPageRectangles?: (doc: number) => number;\n  _lok_documentGetPartInfo?: (doc: number, part: number) => number;\n  _lok_documentGetPartName?: (doc: number, part: number) => number;\n  // Clipboard shims\n  _lok_documentPaste?: (doc: number, mimeType: number, data: number, size: number) => number;\n  // View and zoom shims\n  _lok_documentSetClientZoom?: (doc: number, tilePixelWidth: number, tilePixelHeight: number, tileTwipWidth: number, tileTwipHeight: number) => void;\n  _lok_documentSetClientVisibleArea?: (doc: number, x: number, y: number, width: number, height: number) => void;\n  // Accessibility shims\n  _lok_documentGetA11yFocusedParagraph?: (doc: number) => number;\n  _lok_documentGetA11yCaretPosition?: (doc: number) => number;\n  _lok_documentSetAccessibilityState?: (doc: number, viewId: number, enabled: number) => void;\n  // Spreadsheet-specific shims\n  _lok_documentGetDataArea?: (doc: number, part: number, colPtr: number, rowPtr: number) => void;\n  // Edit mode shim\n  _lok_documentGetEditMode?: (doc: number) => number;\n  _lok_documentSetEditMode?: (doc: number, mode: number) => void;\n  // View management shims\n  _lok_documentCreateView?: (doc: number) => number;\n  _lok_documentCreateViewWithOptions?: (doc: number, options: number) => number;\n  _lok_documentDestroyView?: (doc: number, viewId: number) => void;\n  _lok_documentSetView?: (doc: number, viewId: number) => void;\n  _lok_documentGetView?: (doc: number) => number;\n  _lok_documentGetViewsCount?: (doc: number) => number;\n  // Event loop and callback shims\n  _lok_enableSyncEvents?: () => void;\n  _lok_disableSyncEvents?: () => void;\n  _lok_runLoop?: (lok: number, pollCallback: number, wakeCallback: number, data: number) => void;\n  // Callback queue shims\n  _lok_documentRegisterCallback?: (doc: number) => void;\n  _lok_documentUnregisterCallback?: (doc: number) => void;\n  _lok_hasCallbackEvents?: () => number;\n  _lok_getCallbackEventCount?: () => number;\n  _lok_pollCallback?: (payloadBuffer: number, bufferSize: number, payloadLengthPtr: number) => number;\n  _lok_clearCallbackQueue?: () => void;\n  _lok_flushCallbacks?: (doc: number) => void;\n}\n\n// LOK Mouse Event Types\nexport const LOK_MOUSEEVENT_BUTTONDOWN = 0;\nexport const LOK_MOUSEEVENT_BUTTONUP = 1;\nexport const LOK_MOUSEEVENT_MOVE = 2;\n\n// LOK Key Event Types\nexport const LOK_KEYEVENT_KEYINPUT = 0;\nexport const LOK_KEYEVENT_KEYUP = 1;\n\n// LOK Selection Types\nexport const LOK_SELTYPE_NONE = 0;\nexport const LOK_SELTYPE_TEXT = 1;\nexport const LOK_SELTYPE_CELL = 2;\n\n// LOK Text Selection Types\nexport const LOK_SETTEXTSELECTION_START = 0;\nexport const LOK_SETTEXTSELECTION_END = 1;\nexport const LOK_SETTEXTSELECTION_RESET = 2;\n\n// LOK Document Types\nexport const LOK_DOCTYPE_TEXT = 0;\nexport const LOK_DOCTYPE_SPREADSHEET = 1;\nexport const LOK_DOCTYPE_PRESENTATION = 2;\nexport const LOK_DOCTYPE_DRAWING = 3;\nexport const LOK_DOCTYPE_OTHER = 4;\n\n// LOK Callback Types (from LibreOfficeKitEnums.h)\nexport const LOK_CALLBACK_INVALIDATE_TILES = 0;\nexport const LOK_CALLBACK_INVALIDATE_VISIBLE_CURSOR = 1;\nexport const LOK_CALLBACK_TEXT_SELECTION = 2;\nexport const LOK_CALLBACK_TEXT_SELECTION_START = 3;\nexport const LOK_CALLBACK_TEXT_SELECTION_END = 4;\nexport const LOK_CALLBACK_CURSOR_VISIBLE = 5;\nexport const LOK_CALLBACK_GRAPHIC_SELECTION = 6;\nexport const LOK_CALLBACK_HYPERLINK_CLICKED = 7;\nexport const LOK_CALLBACK_STATE_CHANGED = 8;\nexport const LOK_CALLBACK_STATUS_INDICATOR_START = 9;\nexport const LOK_CALLBACK_STATUS_INDICATOR_SET_VALUE = 10;\nexport const LOK_CALLBACK_STATUS_INDICATOR_FINISH = 11;\nexport const LOK_CALLBACK_SEARCH_NOT_FOUND = 12;\nexport const LOK_CALLBACK_DOCUMENT_SIZE_CHANGED = 13;\nexport const LOK_CALLBACK_SET_PART = 14;\nexport const LOK_CALLBACK_SEARCH_RESULT_SELECTION = 15;\nexport const LOK_CALLBACK_UNO_COMMAND_RESULT = 16;\nexport const LOK_CALLBACK_CELL_CURSOR = 17;\nexport const LOK_CALLBACK_MOUSE_POINTER = 18;\nexport const LOK_CALLBACK_CELL_FORMULA = 19;\nexport const LOK_CALLBACK_DOCUMENT_PASSWORD = 20;\nexport const LOK_CALLBACK_DOCUMENT_PASSWORD_TO_MODIFY = 21;\nexport const LOK_CALLBACK_CONTEXT_MENU = 22;\nexport const LOK_CALLBACK_INVALIDATE_VIEW_CURSOR = 23;\nexport const LOK_CALLBACK_TEXT_VIEW_SELECTION = 24;\nexport const LOK_CALLBACK_CELL_VIEW_CURSOR = 25;\nexport const LOK_CALLBACK_GRAPHIC_VIEW_SELECTION = 26;\nexport const LOK_CALLBACK_VIEW_CURSOR_VISIBLE = 27;\nexport const LOK_CALLBACK_VIEW_LOCK = 28;\nexport const LOK_CALLBACK_REDLINE_TABLE_SIZE_CHANGED = 29;\nexport const LOK_CALLBACK_REDLINE_TABLE_ENTRY_MODIFIED = 30;\nexport const LOK_CALLBACK_COMMENT = 31;\nexport const LOK_CALLBACK_INVALIDATE_HEADER = 32;\nexport const LOK_CALLBACK_CELL_ADDRESS = 33;\n\n// Callback event interface\nexport interface LOKCallbackEvent {\n  type: number;\n  typeName: string;\n  payload: string;\n}\n\n// Map callback type to name\nexport function getCallbackTypeName(type: number): string {\n  const names: Record<number, string> = {\n    [LOK_CALLBACK_INVALIDATE_TILES]: 'INVALIDATE_TILES',\n    [LOK_CALLBACK_INVALIDATE_VISIBLE_CURSOR]: 'INVALIDATE_VISIBLE_CURSOR',\n    [LOK_CALLBACK_TEXT_SELECTION]: 'TEXT_SELECTION',\n    [LOK_CALLBACK_TEXT_SELECTION_START]: 'TEXT_SELECTION_START',\n    [LOK_CALLBACK_TEXT_SELECTION_END]: 'TEXT_SELECTION_END',\n    [LOK_CALLBACK_CURSOR_VISIBLE]: 'CURSOR_VISIBLE',\n    [LOK_CALLBACK_GRAPHIC_SELECTION]: 'GRAPHIC_SELECTION',\n    [LOK_CALLBACK_HYPERLINK_CLICKED]: 'HYPERLINK_CLICKED',\n    [LOK_CALLBACK_STATE_CHANGED]: 'STATE_CHANGED',\n    [LOK_CALLBACK_STATUS_INDICATOR_START]: 'STATUS_INDICATOR_START',\n    [LOK_CALLBACK_STATUS_INDICATOR_SET_VALUE]: 'STATUS_INDICATOR_SET_VALUE',\n    [LOK_CALLBACK_STATUS_INDICATOR_FINISH]: 'STATUS_INDICATOR_FINISH',\n    [LOK_CALLBACK_SEARCH_NOT_FOUND]: 'SEARCH_NOT_FOUND',\n    [LOK_CALLBACK_DOCUMENT_SIZE_CHANGED]: 'DOCUMENT_SIZE_CHANGED',\n    [LOK_CALLBACK_SET_PART]: 'SET_PART',\n    [LOK_CALLBACK_SEARCH_RESULT_SELECTION]: 'SEARCH_RESULT_SELECTION',\n    [LOK_CALLBACK_UNO_COMMAND_RESULT]: 'UNO_COMMAND_RESULT',\n    [LOK_CALLBACK_CELL_CURSOR]: 'CELL_CURSOR',\n    [LOK_CALLBACK_MOUSE_POINTER]: 'MOUSE_POINTER',\n    [LOK_CALLBACK_CELL_FORMULA]: 'CELL_FORMULA',\n    [LOK_CALLBACK_DOCUMENT_PASSWORD]: 'DOCUMENT_PASSWORD',\n    [LOK_CALLBACK_DOCUMENT_PASSWORD_TO_MODIFY]: 'DOCUMENT_PASSWORD_TO_MODIFY',\n    [LOK_CALLBACK_CONTEXT_MENU]: 'CONTEXT_MENU',\n    [LOK_CALLBACK_INVALIDATE_VIEW_CURSOR]: 'INVALIDATE_VIEW_CURSOR',\n    [LOK_CALLBACK_TEXT_VIEW_SELECTION]: 'TEXT_VIEW_SELECTION',\n    [LOK_CALLBACK_CELL_VIEW_CURSOR]: 'CELL_VIEW_CURSOR',\n    [LOK_CALLBACK_GRAPHIC_VIEW_SELECTION]: 'GRAPHIC_VIEW_SELECTION',\n    [LOK_CALLBACK_VIEW_CURSOR_VISIBLE]: 'VIEW_CURSOR_VISIBLE',\n    [LOK_CALLBACK_VIEW_LOCK]: 'VIEW_LOCK',\n    [LOK_CALLBACK_REDLINE_TABLE_SIZE_CHANGED]: 'REDLINE_TABLE_SIZE_CHANGED',\n    [LOK_CALLBACK_REDLINE_TABLE_ENTRY_MODIFIED]: 'REDLINE_TABLE_ENTRY_MODIFIED',\n    [LOK_CALLBACK_COMMENT]: 'COMMENT',\n    [LOK_CALLBACK_INVALIDATE_HEADER]: 'INVALIDATE_HEADER',\n    [LOK_CALLBACK_CELL_ADDRESS]: 'CELL_ADDRESS',\n  };\n  return names[type] || `UNKNOWN(${type})`;\n}\n\n// Fallback offsets for WASM32 (4-byte pointers) if shims not available\nconst LOK_CLASS = {\n  nSize: 0,\n  destroy: 4,\n  documentLoad: 8,\n  getError: 12,\n  documentLoadWithOptions: 16,\n  freeError: 20,\n};\n\nconst DOC_CLASS = {\n  nSize: 0,\n  destroy: 4,\n  saveAs: 8,\n};\n\n// Reuse encoder/decoder\nconst textEncoder = new TextEncoder();\nconst textDecoder = new TextDecoder();\n\nexport class LOKBindings {\n  private module: LOKModule;\n  private lokPtr = 0;\n  private verbose: boolean;\n  private useShims: boolean;\n\n  constructor(module: EmscriptenModule, verbose = false) {\n    this.module = module as LOKModule;\n    this.verbose = verbose;\n\n    this.useShims = typeof this.module._lok_documentLoad === 'function';\n    if (this.useShims) {\n      this.log('Using direct LOK shim exports');\n    } else {\n      this.log('Using vtable traversal (shims not available)');\n    }\n  }\n\n  private log(...args: unknown[]): void {\n    if (this.verbose) {\n      console.log('[LOK]', ...args);\n    }\n  }\n\n  /**\n   * Get fresh heap views (important after memory growth!)\n   */\n  private get HEAPU8(): Uint8Array {\n    return this.module.HEAPU8;\n  }\n\n  private get HEAPU32(): Uint32Array {\n    return this.module.HEAPU32;\n  }\n\n  private get HEAP32(): Int32Array {\n    return this.module.HEAP32;\n  }\n\n  /**\n   * Allocate a null-terminated string in WASM memory\n   */\n  allocString(str: string): number {\n    const bytes = textEncoder.encode(str + '\\0');\n    const ptr = this.module._malloc(bytes.length);\n    // Always get fresh heap view after malloc (might have grown memory)\n    this.HEAPU8.set(bytes, ptr);\n    return ptr;\n  }\n\n  /**\n   * Read a null-terminated string from WASM memory\n   */\n  readString(ptr: number): string | null {\n    if (ptr === 0) return null;\n    // Always get fresh heap view\n    const heap = this.HEAPU8;\n    let end = ptr;\n    while (heap[end] !== 0) end++;\n    // Copy the data to avoid SharedArrayBuffer issues in browsers\n    // TextDecoder.decode() doesn't accept SharedArrayBuffer views in some browsers\n    const slice = heap.slice(ptr, end);\n    return textDecoder.decode(slice);\n  }\n\n  /**\n   * Read a 32-bit pointer from memory (unsigned)\n   */\n  readPtr(addr: number): number {\n    // Always get fresh heap view\n    return this.HEAPU32[addr >> 2] || 0;\n  }\n\n  /**\n   * Get a function from the WASM table (fallback for vtable traversal)\n   */\n  private getFunc<T>(ptr: number): T {\n    const wasmTable = this.module.wasmTable as WebAssembly.Table;\n    return wasmTable.get(ptr) as T;\n  }\n\n  /**\n   * Initialize LibreOfficeKit\n   */\n  initialize(installPath: string = '/instdir/program'): void {\n    this.log('Initializing with path:', installPath);\n    const pathPtr = this.allocString(installPath);\n\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n      const hook = (this.module as any)._libreofficekit_hook as\n        | ((pathPtr: number) => number)\n        | undefined;\n\n      if (typeof hook !== 'function') {\n        throw new Error('libreofficekit_hook export not found on module');\n      }\n\n      this.lokPtr = hook(pathPtr);\n\n      if (this.lokPtr === 0) {\n        throw new Error('Failed to initialize LibreOfficeKit');\n      }\n\n      this.log('LOK initialized, ptr:', this.lokPtr);\n    } finally {\n      this.module._free(pathPtr);\n    }\n  }\n\n  /**\n   * Get the last error message\n   */\n  getError(): string | null {\n    if (this.lokPtr === 0) return null;\n\n    // Prefer shim\n    if (this.useShims && this.module._lok_getError) {\n      const errPtr = this.module._lok_getError(this.lokPtr);\n      return this.readString(errPtr);\n    }\n\n    // Fallback: vtable traversal\n    const lokClassPtr = this.readPtr(this.lokPtr);\n    const getErrorPtr = this.readPtr(lokClassPtr + LOK_CLASS.getError);\n    if (getErrorPtr === 0) return null;\n\n    const getError = this.getFunc<(lok: number) => number>(getErrorPtr);\n    const errPtr = getError(this.lokPtr);\n    return this.readString(errPtr);\n  }\n\n  /**\n   * Get version info\n   */\n  getVersionInfo(): string | null {\n    return 'LibreOffice WASM';\n  }\n\n  /**\n   * Convert a filesystem path to a file:// URL\n   * Required by LibreOffice's getAbsoluteURL() which uses rtl::Uri::convertRelToAbs()\n   */\n  private toFileUrl(path: string): string {\n    if (path.startsWith('file://')) return path;\n    const absolutePath = path.startsWith('/') ? path : '/' + path;\n    return 'file://' + absolutePath;\n  }\n\n  /**\n   * Load a document from the virtual filesystem\n   */\n  documentLoad(path: string): number {\n    if (this.lokPtr === 0) {\n      throw new Error('LOK not initialized');\n    }\n\n    const fileUrl = this.toFileUrl(path);\n    this.log('Loading document:', path, '->', fileUrl);\n    const pathPtr = this.allocString(fileUrl);\n\n    try {\n      const startTime = Date.now();\n      let docPtr: number;\n\n      if (this.useShims && this.module._lok_documentLoad) {\n        // Use direct shim export\n        docPtr = this.module._lok_documentLoad(this.lokPtr, pathPtr);\n      } else {\n        // Fallback: vtable traversal\n        const lokClassPtr = this.readPtr(this.lokPtr);\n        const documentLoadPtr = this.readPtr(lokClassPtr + LOK_CLASS.documentLoad);\n        const documentLoad = this.getFunc<(lok: number, path: number) => number>(documentLoadPtr);\n        docPtr = documentLoad(this.lokPtr, pathPtr);\n      }\n\n      this.log('Document loaded in', Date.now() - startTime, 'ms, ptr:', docPtr);\n\n      if (docPtr === 0) {\n        const error = this.getError();\n        throw new Error(`Failed to load document: ${error || 'unknown error'}`);\n      }\n\n      return docPtr;\n    } finally {\n      this.module._free(pathPtr);\n    }\n  }\n\n  /**\n   * Load a document with options\n   */\n  documentLoadWithOptions(path: string, options: string): number {\n    if (this.lokPtr === 0) {\n      throw new Error('LOK not initialized');\n    }\n\n    const fileUrl = this.toFileUrl(path);\n    this.log('Loading document with options:', path, '->', fileUrl, options);\n    const pathPtr = this.allocString(fileUrl);\n    const optsPtr = this.allocString(options);\n\n    try {\n      let docPtr: number;\n\n      if (this.useShims && this.module._lok_documentLoadWithOptions) {\n        // Use direct shim export\n        docPtr = this.module._lok_documentLoadWithOptions(this.lokPtr, pathPtr, optsPtr);\n      } else {\n        // Fallback: vtable traversal\n        const lokClassPtr = this.readPtr(this.lokPtr);\n        const loadWithOptsPtr = this.readPtr(lokClassPtr + LOK_CLASS.documentLoadWithOptions);\n\n        if (loadWithOptsPtr === 0) {\n          // No special method - fall back to plain load\n          return this.documentLoad(path);\n        }\n\n        const loadWithOpts = this.getFunc<\n          (lok: number, path: number, opts: number) => number\n        >(loadWithOptsPtr);\n        docPtr = loadWithOpts(this.lokPtr, pathPtr, optsPtr);\n      }\n\n      if (docPtr === 0) {\n        const error = this.getError();\n        throw new Error(`Failed to load document: ${error || 'unknown error'}`);\n      }\n\n      this.log('Document loaded, ptr:', docPtr);\n      return docPtr;\n    } finally {\n      this.module._free(pathPtr);\n      this.module._free(optsPtr);\n    }\n  }\n\n  /**\n   * Save a document to a different format\n   */\n  documentSaveAs(\n    docPtr: number,\n    outputPath: string,\n    format: string,\n    filterOptions: string = ''\n  ): void {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    const fileUrl = this.toFileUrl(outputPath);\n    this.log('Saving document to:', outputPath, '->', fileUrl, 'format:', format);\n\n    const urlPtr = this.allocString(fileUrl);\n    const formatPtr = this.allocString(format);\n    const optsPtr = this.allocString(filterOptions);\n\n    try {\n      let result: number;\n\n      if (this.useShims && this.module._lok_documentSaveAs) {\n        // Use direct shim export\n        result = this.module._lok_documentSaveAs(docPtr, urlPtr, formatPtr, optsPtr);\n      } else {\n        // Fallback: vtable traversal\n        const docClassPtr = this.readPtr(docPtr);\n        const saveAsPtr = this.readPtr(docClassPtr + DOC_CLASS.saveAs);\n        const saveAs = this.getFunc<\n          (doc: number, url: number, format: number, opts: number) => number\n        >(saveAsPtr);\n        result = saveAs(docPtr, urlPtr, formatPtr, optsPtr);\n      }\n\n      this.log('Save result:', result);\n\n      if (result === 0) {\n        throw new Error('Failed to save document');\n      }\n    } finally {\n      this.module._free(urlPtr);\n      this.module._free(formatPtr);\n      this.module._free(optsPtr);\n    }\n  }\n\n  /**\n   * Destroy a document\n   */\n  documentDestroy(docPtr: number): void {\n    if (docPtr === 0) return;\n\n    if (this.useShims && this.module._lok_documentDestroy) {\n      // Use direct shim export\n      this.module._lok_documentDestroy(docPtr);\n      this.log('Document destroyed (via shim)');\n      return;\n    }\n\n    // Fallback: vtable traversal\n    const docClassPtr = this.readPtr(docPtr);\n    const destroyPtr = this.readPtr(docClassPtr + DOC_CLASS.destroy);\n\n    if (destroyPtr !== 0) {\n      const destroy = this.getFunc<(doc: number) => void>(destroyPtr);\n      destroy(docPtr);\n      this.log('Document destroyed (via vtable)');\n    }\n  }\n\n  /**\n   * Destroy the LOK instance\n   */\n  destroy(): void {\n    if (this.lokPtr === 0) return;\n\n    try {\n      // Prefer C shim if available\n      if (this.useShims && this.module._lok_destroy) {\n        this.module._lok_destroy(this.lokPtr);\n        this.log('LOK destroyed (via shim)');\n      } else {\n        // Fallback: vtable traversal\n        const lokClassPtr = this.readPtr(this.lokPtr);\n        const destroyPtr = this.readPtr(lokClassPtr + LOK_CLASS.destroy);\n\n        if (destroyPtr !== 0) {\n          const destroy = this.getFunc<(lok: number) => void>(destroyPtr);\n          destroy(this.lokPtr);\n          this.log('LOK destroyed (via vtable)');\n        }\n      }\n    } catch (error) {\n      this.log('LOK destroy error (ignored):', error);\n    }\n\n    this.lokPtr = 0;\n  }\n\n  /**\n   * Check if LOK is initialized\n   */\n  isInitialized(): boolean {\n    return this.lokPtr !== 0;\n  }\n\n  /**\n   * Check if using direct shim exports\n   */\n  isUsingShims(): boolean {\n    return this.useShims;\n  }\n\n  // ==========================================\n  // Page Rendering Methods\n  // ==========================================\n\n  /**\n   * Get the number of parts (pages/slides) in a document\n   */\n  documentGetParts(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetParts) {\n      return this.module._lok_documentGetParts(docPtr);\n    }\n\n    // Fallback not implemented - would need vtable offsets\n    this.log('documentGetParts: shim not available');\n    return 0;\n  }\n\n  /**\n   * Get the current part (page/slide) index\n   */\n  documentGetPart(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetPart) {\n      return this.module._lok_documentGetPart(docPtr);\n    }\n\n    this.log('documentGetPart: shim not available');\n    return 0;\n  }\n\n  /**\n   * Set the current part (page/slide) index\n   */\n  documentSetPart(docPtr: number, part: number): void {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentSetPart) {\n      this.module._lok_documentSetPart(docPtr, part);\n      return;\n    }\n\n    this.log('documentSetPart: shim not available');\n  }\n\n  /**\n   * Get document type (0=text, 1=spreadsheet, 2=presentation, 3=drawing)\n   */\n  documentGetDocumentType(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetDocumentType) {\n      return this.module._lok_documentGetDocumentType(docPtr);\n    }\n\n    this.log('documentGetDocumentType: shim not available');\n    return 0;\n  }\n\n  /**\n   * Get document size in twips (1/1440 inch)\n   */\n  documentGetDocumentSize(docPtr: number): { width: number; height: number } {\n    this.log(`documentGetDocumentSize called with docPtr: ${docPtr}`);\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetDocumentSize) {\n      // Allocate space for two longs (32-bit on WASM)\n      const sizePtr = this.module._malloc(8);\n      try {\n        this.module._lok_documentGetDocumentSize(docPtr, sizePtr, sizePtr + 4);\n        const width = this.HEAP32[sizePtr >> 2] ?? 0;\n        const height = this.HEAP32[(sizePtr + 4) >> 2] ?? 0;\n        this.log(`documentGetDocumentSize: ${width}x${height} twips`);\n        return { width, height };\n      } finally {\n        this.module._free(sizePtr);\n      }\n    }\n\n    this.log('documentGetDocumentSize: shim not available');\n    return { width: 0, height: 0 };\n  }\n\n  /**\n   * Initialize document for rendering\n   */\n  documentInitializeForRendering(docPtr: number, options: string = ''): void {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentInitializeForRendering) {\n      const optsPtr = this.allocString(options);\n      try {\n        this.module._lok_documentInitializeForRendering(docPtr, optsPtr);\n      } finally {\n        this.module._free(optsPtr);\n      }\n      return;\n    }\n\n    this.log('documentInitializeForRendering: shim not available');\n  }\n\n  /**\n   * Paint a tile of the document to a buffer\n   * @param docPtr Document pointer\n   * @param canvasWidth Output width in pixels\n   * @param canvasHeight Output height in pixels\n   * @param tilePosX X position in twips\n   * @param tilePosY Y position in twips\n   * @param tileWidth Width in twips\n   * @param tileHeight Height in twips\n   * @returns RGBA pixel data\n   */\n  documentPaintTile(\n    docPtr: number,\n    canvasWidth: number,\n    canvasHeight: number,\n    tilePosX: number,\n    tilePosY: number,\n    tileWidth: number,\n    tileHeight: number\n  ): Uint8Array {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentPaintTile) {\n      // Allocate RGBA buffer (4 bytes per pixel)\n      const bufferSize = canvasWidth * canvasHeight * 4;\n      const bufferPtr = this.module._malloc(bufferSize);\n\n      if (bufferPtr === 0) {\n        throw new Error(`Failed to allocate ${bufferSize} bytes for tile buffer`);\n      }\n\n      try {\n        this.module._lok_documentPaintTile(\n          docPtr,\n          bufferPtr,\n          canvasWidth,\n          canvasHeight,\n          tilePosX,\n          tilePosY,\n          tileWidth,\n          tileHeight\n        );\n\n        // Copy data out of WASM memory\n        const result = new Uint8Array(bufferSize);\n        result.set(this.HEAPU8.subarray(bufferPtr, bufferPtr + bufferSize));\n        return result;\n      } finally {\n        this.module._free(bufferPtr);\n      }\n    }\n\n    this.log('documentPaintTile: shim not available');\n    return new Uint8Array(0);\n  }\n\n  /**\n   * Get tile mode (0=RGBA, 1=BGRA)\n   */\n  documentGetTileMode(docPtr: number): number {\n    if (docPtr === 0) {\n      throw new Error('Invalid document pointer');\n    }\n\n    if (this.useShims && this.module._lok_documentGetTileMode) {\n      return this.module._lok_documentGetTileMode(docPtr);\n    }\n\n    this.log('documentGetTileMode: shim not available');\n    return 0; // Default to RGBA\n  }\n\n  /**\n   * Render a page/slide to an image\n   * @param docPtr Document pointer\n   * @param pageIndex Page/slide index (0-based)\n   * @param width Output width in pixels\n   * @param height Output height in pixels (0 = auto based on aspect ratio)\n   * @returns RGBA pixel data and dimensions\n   */\n  renderPage(\n    docPtr: number,\n    pageIndex: number,\n    width: number,\n    height: number = 0,\n    editMode: boolean = false\n  ): { data: Uint8Array; width: number; height: number } {\n    // Initialize for rendering if not already done\n    this.documentInitializeForRendering(docPtr);\n\n    // Get document type to determine rendering strategy\n    const docType = this.documentGetDocumentType(docPtr);\n\n    // For presentations and drawings, use setPart to select the slide/page\n    // For text documents, we need to use page rectangles\n    if (docType === 2 || docType === 3) { // PRESENTATION or DRAWING\n      console.log(`[LOK] Setting part to ${pageIndex} for presentation/drawing`);\n      this.documentSetPart(docPtr, pageIndex);\n      const currentPart = this.documentGetPart(docPtr);\n      console.log(`[LOK] Current part after setPart: ${currentPart}`);\n\n      // Set view mode (0) for presentations to avoid showing edit UI elements\n      // unless explicitly requested\n      if (!editMode) {\n        this.setEditMode(docPtr, 0);\n        console.log(`[LOK] Set edit mode to 0 (view mode) for presentation rendering`);\n      }\n    }\n\n    // Get document/page size in twips\n    const docSize = this.documentGetDocumentSize(docPtr);\n    this.log('Document size (twips):', docSize);\n\n    if (docSize.width === 0 || docSize.height === 0) {\n      throw new Error('Failed to get document size');\n    }\n\n    // For text documents, get page rectangles to find the specific page\n    let tilePosX = 0;\n    let tilePosY = 0;\n    let tileWidth = docSize.width;\n    let tileHeight = docSize.height;\n\n    if (docType === 0 || docType === 1) { // TEXT or SPREADSHEET\n      // Get page rectangles to find the Y offset for this page\n      const pageRectsStr = this.getPartPageRectangles(docPtr);\n      if (pageRectsStr) {\n        const pageRects = this.parsePageRectangles(pageRectsStr);\n        const pageRect = pageRects[pageIndex];\n        if (pageRect) {\n          tilePosX = pageRect.x;\n          tilePosY = pageRect.y;\n          tileWidth = pageRect.width;\n          tileHeight = pageRect.height;\n          this.log(`Page ${pageIndex} rectangle:`, pageRect);\n        }\n      }\n    }\n\n    // Calculate output dimensions maintaining aspect ratio\n    const aspectRatio = tileHeight / tileWidth;\n    const outputWidth = width;\n    const outputHeight = height > 0 ? height : Math.round(width * aspectRatio);\n\n    console.log(`[LOK] Calling paintTile: ${outputWidth}x${outputHeight} from tile pos (${tilePosX}, ${tilePosY}) size (${tileWidth}x${tileHeight})`);\n\n    // Paint the tile for this specific page\n    const data = this.documentPaintTile(\n      docPtr,\n      outputWidth,\n      outputHeight,\n      tilePosX,\n      tilePosY,\n      tileWidth,\n      tileHeight\n    );\n\n    console.log(`[LOK] paintTile returned ${data.length} bytes`);\n    return { data, width: outputWidth, height: outputHeight };\n  }\n\n  /**\n   * Render a page/slide at full quality (native resolution based on DPI)\n   *\n   * Unlike renderPage which scales to a fixed width, this method renders\n   * at the document's native resolution converted to pixels at the specified DPI.\n   *\n   * @param docPtr Document pointer\n   * @param pageIndex Page/slide index (0-based)\n   * @param dpi Dots per inch for rendering (default 150, use 300 for print quality)\n   * @param maxDimension Optional maximum dimension (width or height) to prevent memory issues\n   * @returns RGBA pixel data and dimensions\n   *\n   * @example\n   * // Render at 150 DPI (good for screen)\n   * const preview = lokBindings.renderPageFullQuality(docPtr, 0, 150);\n   *\n   * // Render at 300 DPI (print quality)\n   * const highRes = lokBindings.renderPageFullQuality(docPtr, 0, 300);\n   *\n   * // Render with max dimension cap to prevent memory issues\n   * const capped = lokBindings.renderPageFullQuality(docPtr, 0, 300, 4096);\n   */\n  renderPageFullQuality(\n    docPtr: number,\n    pageIndex: number,\n    dpi: number = 150,\n    maxDimension?: number,\n    editMode: boolean = false\n  ): { data: Uint8Array; width: number; height: number; dpi: number } {\n    // Initialize for rendering if not already done\n    this.documentInitializeForRendering(docPtr);\n\n    // Get document type to determine rendering strategy\n    const docType = this.documentGetDocumentType(docPtr);\n\n    // For presentations and drawings, use setPart to select the slide/page\n    if (docType === 2 || docType === 3) { // PRESENTATION or DRAWING\n      this.log(`Setting part to ${pageIndex} for presentation/drawing`);\n      this.documentSetPart(docPtr, pageIndex);\n\n      // Set view mode (0) for presentations to avoid showing edit UI elements\n      // unless explicitly requested\n      if (!editMode) {\n        this.setEditMode(docPtr, 0);\n        this.log(`Set edit mode to 0 (view mode) for presentation rendering`);\n      }\n    }\n\n    // Get document/page size in twips\n    const docSize = this.documentGetDocumentSize(docPtr);\n    this.log('Document size (twips):', docSize);\n\n    if (docSize.width === 0 || docSize.height === 0) {\n      throw new Error('Failed to get document size');\n    }\n\n    // For text documents, get page rectangles to find the specific page\n    let tilePosX = 0;\n    let tilePosY = 0;\n    let tileWidth = docSize.width;\n    let tileHeight = docSize.height;\n\n    if (docType === 0 || docType === 1) { // TEXT or SPREADSHEET\n      const pageRectsStr = this.getPartPageRectangles(docPtr);\n      if (pageRectsStr) {\n        const pageRects = this.parsePageRectangles(pageRectsStr);\n        const pageRect = pageRects[pageIndex];\n        if (pageRect) {\n          tilePosX = pageRect.x;\n          tilePosY = pageRect.y;\n          tileWidth = pageRect.width;\n          tileHeight = pageRect.height;\n          this.log(`Page ${pageIndex} rectangle:`, pageRect);\n        }\n      }\n    }\n\n    // Convert twips to pixels at the specified DPI\n    // 1 inch = 1440 twips, so pixels = twips * dpi / 1440\n    const TWIPS_PER_INCH = 1440;\n    let outputWidth = Math.round(tileWidth * dpi / TWIPS_PER_INCH);\n    let outputHeight = Math.round(tileHeight * dpi / TWIPS_PER_INCH);\n    let effectiveDpi = dpi;\n\n    // Apply max dimension cap if specified\n    if (maxDimension && (outputWidth > maxDimension || outputHeight > maxDimension)) {\n      const scale = maxDimension / Math.max(outputWidth, outputHeight);\n      outputWidth = Math.round(outputWidth * scale);\n      outputHeight = Math.round(outputHeight * scale);\n      effectiveDpi = Math.round(dpi * scale);\n      this.log(`Capped dimensions to ${outputWidth}x${outputHeight} (effective DPI: ${effectiveDpi})`);\n    }\n\n    console.log(`[LOK] renderPageFullQuality: ${outputWidth}x${outputHeight} at ${effectiveDpi} DPI from tile (${tilePosX}, ${tilePosY}) size (${tileWidth}x${tileHeight}) twips`);\n\n    // Paint the tile\n    const data = this.documentPaintTile(\n      docPtr,\n      outputWidth,\n      outputHeight,\n      tilePosX,\n      tilePosY,\n      tileWidth,\n      tileHeight\n    );\n\n    console.log(`[LOK] renderPageFullQuality returned ${data.length} bytes`);\n    return { data, width: outputWidth, height: outputHeight, dpi: effectiveDpi };\n  }\n\n  // ==========================================\n  // Text Selection and Content Methods\n  // ==========================================\n\n  /**\n   * Get currently selected text\n   * @param docPtr Document pointer\n   * @param mimeType Desired MIME type. Must include charset, e.g., 'text/plain;charset=utf-8'\n   *                 Note: 'text/plain' without charset is NOT supported by LOK\n   * @returns Selected text or null\n   */\n  getTextSelection(docPtr: number, mimeType: string = 'text/plain;charset=utf-8'): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetTextSelection) {\n      const mimePtr = this.allocString(mimeType);\n      const usedMimePtr = this.module._malloc(4); // pointer to char*\n      try {\n        const resultPtr = this.module._lok_documentGetTextSelection(docPtr, mimePtr, usedMimePtr);\n        if (resultPtr === 0) return null;\n        const result = this.readString(resultPtr);\n        this.module._free(resultPtr);\n        return result;\n      } finally {\n        this.module._free(mimePtr);\n        this.module._free(usedMimePtr);\n      }\n    }\n\n    this.log('getTextSelection: shim not available');\n    return null;\n  }\n\n  /**\n   * Set text selection at coordinates\n   * @param docPtr Document pointer\n   * @param type Selection type (LOK_SETTEXTSELECTION_START, END, or RESET)\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   */\n  setTextSelection(docPtr: number, type: number, x: number, y: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetTextSelection) {\n      this.module._lok_documentSetTextSelection(docPtr, type, x, y);\n      return;\n    }\n\n    this.log('setTextSelection: shim not available');\n  }\n\n  /**\n   * Get current selection type\n   * @param docPtr Document pointer\n   * @returns Selection type (LOK_SELTYPE_NONE, TEXT, or CELL)\n   */\n  getSelectionType(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetSelectionType) {\n      return this.module._lok_documentGetSelectionType(docPtr);\n    }\n\n    this.log('getSelectionType: shim not available');\n    return 0;\n  }\n\n  /**\n   * Reset/clear current selection\n   * @param docPtr Document pointer\n   */\n  resetSelection(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentResetSelection) {\n      this.module._lok_documentResetSelection(docPtr);\n      return;\n    }\n\n    this.log('resetSelection: shim not available');\n  }\n\n  // ==========================================\n  // Mouse and Keyboard Event Methods\n  // ==========================================\n\n  /**\n   * Post a mouse event to the document\n   * @param docPtr Document pointer\n   * @param type Event type (LOK_MOUSEEVENT_BUTTONDOWN, BUTTONUP, MOVE)\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   * @param count Click count (1 for single, 2 for double click)\n   * @param buttons Button mask (1=left, 2=middle, 4=right)\n   * @param modifier Modifier keys mask\n   */\n  postMouseEvent(\n    docPtr: number,\n    type: number,\n    x: number,\n    y: number,\n    count: number = 1,\n    buttons: number = 1,\n    modifier: number = 0\n  ): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPostMouseEvent) {\n      this.module._lok_documentPostMouseEvent(docPtr, type, x, y, count, buttons, modifier);\n      return;\n    }\n\n    this.log('postMouseEvent: shim not available');\n  }\n\n  /**\n   * Post a keyboard event to the document\n   * @param docPtr Document pointer\n   * @param type Event type (LOK_KEYEVENT_KEYINPUT, KEYUP)\n   * @param charCode Character code\n   * @param keyCode Key code\n   */\n  postKeyEvent(docPtr: number, type: number, charCode: number, keyCode: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPostKeyEvent) {\n      this.module._lok_documentPostKeyEvent(docPtr, type, charCode, keyCode);\n      return;\n    }\n\n    this.log('postKeyEvent: shim not available');\n  }\n\n  // ==========================================\n  // UNO Command Methods\n  // ==========================================\n\n  /**\n   * Execute a UNO command\n   * @param docPtr Document pointer\n   * @param command UNO command (e.g., '.uno:SelectAll', '.uno:Copy')\n   * @param args JSON arguments string\n   * @param notifyWhenFinished Whether to notify when command completes\n   */\n  postUnoCommand(\n    docPtr: number,\n    command: string,\n    args: string = '{}',\n    notifyWhenFinished: boolean = false\n  ): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPostUnoCommand) {\n      const cmdPtr = this.allocString(command);\n      const argsPtr = this.allocString(args);\n      try {\n        this.module._lok_documentPostUnoCommand(docPtr, cmdPtr, argsPtr, notifyWhenFinished ? 1 : 0);\n      } finally {\n        this.module._free(cmdPtr);\n        this.module._free(argsPtr);\n      }\n      return;\n    }\n\n    this.log('postUnoCommand: shim not available');\n  }\n\n  /**\n   * Get command values (query document state)\n   * @param docPtr Document pointer\n   * @param command Command to query (e.g., '.uno:CharFontName')\n   * @returns JSON string with command values\n   */\n  getCommandValues(docPtr: number, command: string): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetCommandValues) {\n      const cmdPtr = this.allocString(command);\n      try {\n        const resultPtr = this.module._lok_documentGetCommandValues(docPtr, cmdPtr);\n        if (resultPtr === 0) return null;\n        const result = this.readString(resultPtr);\n        this.module._free(resultPtr);\n        return result;\n      } finally {\n        this.module._free(cmdPtr);\n      }\n    }\n\n    this.log('getCommandValues: shim not available');\n    return null;\n  }\n\n  // ==========================================\n  // Page/Part Information Methods\n  // ==========================================\n\n  /**\n   * Get bounding rectangles for all pages\n   * @param docPtr Document pointer\n   * @returns String with rectangles \"x,y,width,height;x,y,width,height;...\"\n   */\n  getPartPageRectangles(docPtr: number): string | null {\n    this.log(`getPartPageRectangles called with docPtr: ${docPtr}`);\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetPartPageRectangles) {\n      this.log('getPartPageRectangles: using shim');\n      const resultPtr = this.module._lok_documentGetPartPageRectangles(docPtr);\n      this.log(`getPartPageRectangles: resultPtr=${resultPtr}`);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.log(`getPartPageRectangles: result=\"${result?.slice(0, 100)}...\"`);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getPartPageRectangles: shim not available');\n    return null;\n  }\n\n  /**\n   * Get information about a page/slide\n   * @param docPtr Document pointer\n   * @param part Part index\n   * @returns JSON string with part info\n   */\n  getPartInfo(docPtr: number, part: number): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetPartInfo) {\n      const resultPtr = this.module._lok_documentGetPartInfo(docPtr, part);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getPartInfo: shim not available');\n    return null;\n  }\n\n  /**\n   * Get name of a page/slide\n   * @param docPtr Document pointer\n   * @param part Part index\n   * @returns Part name\n   */\n  getPartName(docPtr: number, part: number): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetPartName) {\n      const resultPtr = this.module._lok_documentGetPartName(docPtr, part);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getPartName: shim not available');\n    return null;\n  }\n\n  // ==========================================\n  // Clipboard Methods\n  // ==========================================\n\n  /**\n   * Paste content at current cursor position\n   * @param docPtr Document pointer\n   * @param mimeType MIME type of data\n   * @param data Data to paste\n   * @returns true if successful\n   */\n  paste(docPtr: number, mimeType: string, data: string | Uint8Array): boolean {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentPaste) {\n      const mimePtr = this.allocString(mimeType);\n      let dataPtr: number;\n      let dataSize: number;\n\n      if (typeof data === 'string') {\n        const bytes = new TextEncoder().encode(data);\n        dataSize = bytes.length;\n        dataPtr = this.module._malloc(dataSize);\n        this.HEAPU8.set(bytes, dataPtr);\n      } else {\n        dataSize = data.length;\n        dataPtr = this.module._malloc(dataSize);\n        this.HEAPU8.set(data, dataPtr);\n      }\n\n      try {\n        return this.module._lok_documentPaste(docPtr, mimePtr, dataPtr, dataSize) !== 0;\n      } finally {\n        this.module._free(mimePtr);\n        this.module._free(dataPtr);\n      }\n    }\n\n    this.log('paste: shim not available');\n    return false;\n  }\n\n  // ==========================================\n  // View and Zoom Methods\n  // ==========================================\n\n  /**\n   * Set client zoom level\n   * @param docPtr Document pointer\n   * @param tilePixelWidth Tile width in pixels\n   * @param tilePixelHeight Tile height in pixels\n   * @param tileTwipWidth Tile width in twips\n   * @param tileTwipHeight Tile height in twips\n   */\n  setClientZoom(\n    docPtr: number,\n    tilePixelWidth: number,\n    tilePixelHeight: number,\n    tileTwipWidth: number,\n    tileTwipHeight: number\n  ): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetClientZoom) {\n      this.module._lok_documentSetClientZoom(docPtr, tilePixelWidth, tilePixelHeight, tileTwipWidth, tileTwipHeight);\n      return;\n    }\n\n    this.log('setClientZoom: shim not available');\n  }\n\n  /**\n   * Set visible area for the client\n   * @param docPtr Document pointer\n   * @param x X position in twips\n   * @param y Y position in twips\n   * @param width Width in twips\n   * @param height Height in twips\n   */\n  setClientVisibleArea(docPtr: number, x: number, y: number, width: number, height: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetClientVisibleArea) {\n      this.module._lok_documentSetClientVisibleArea(docPtr, x, y, width, height);\n      return;\n    }\n\n    this.log('setClientVisibleArea: shim not available');\n  }\n\n  // ==========================================\n  // Accessibility Methods\n  // ==========================================\n\n  /**\n   * Get the currently focused paragraph text\n   * @param docPtr Document pointer\n   * @returns Focused paragraph text\n   */\n  getA11yFocusedParagraph(docPtr: number): string | null {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetA11yFocusedParagraph) {\n      const resultPtr = this.module._lok_documentGetA11yFocusedParagraph(docPtr);\n      if (resultPtr === 0) return null;\n      const result = this.readString(resultPtr);\n      this.module._free(resultPtr);\n      return result;\n    }\n\n    this.log('getA11yFocusedParagraph: shim not available');\n    return null;\n  }\n\n  /**\n   * Get caret position in focused paragraph\n   * @param docPtr Document pointer\n   * @returns Caret position or -1\n   */\n  getA11yCaretPosition(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetA11yCaretPosition) {\n      return this.module._lok_documentGetA11yCaretPosition(docPtr);\n    }\n\n    this.log('getA11yCaretPosition: shim not available');\n    return -1;\n  }\n\n  /**\n   * Enable/disable accessibility features\n   * @param docPtr Document pointer\n   * @param viewId View ID\n   * @param enabled Whether to enable accessibility\n   */\n  setAccessibilityState(docPtr: number, viewId: number, enabled: boolean): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetAccessibilityState) {\n      this.module._lok_documentSetAccessibilityState(docPtr, viewId, enabled ? 1 : 0);\n      return;\n    }\n\n    this.log('setAccessibilityState: shim not available');\n  }\n\n  // ==========================================\n  // Spreadsheet-Specific Methods\n  // ==========================================\n\n  /**\n   * Get data area for a spreadsheet (last used row/column)\n   * @param docPtr Document pointer\n   * @param part Sheet index\n   * @returns Object with col and row counts\n   */\n  getDataArea(docPtr: number, part: number): { col: number; row: number } {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetDataArea) {\n      const colPtr = this.module._malloc(8);\n      const rowPtr = this.module._malloc(8);\n      try {\n        this.module._lok_documentGetDataArea(docPtr, part, colPtr, rowPtr);\n        const col = this.HEAP32[colPtr >> 2] ?? 0;\n        const row = this.HEAP32[rowPtr >> 2] ?? 0;\n        return { col, row };\n      } finally {\n        this.module._free(colPtr);\n        this.module._free(rowPtr);\n      }\n    }\n\n    this.log('getDataArea: shim not available');\n    return { col: 0, row: 0 };\n  }\n\n  // ==========================================\n  // Edit Mode Methods\n  // ==========================================\n\n  /**\n   * Get current edit mode\n   * @param docPtr Document pointer\n   * @returns Edit mode value\n   */\n  getEditMode(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetEditMode) {\n      return this.module._lok_documentGetEditMode(docPtr);\n    }\n\n    this.log('getEditMode: shim not available');\n    return 0;\n  }\n\n  /**\n   * Set edit mode for the document\n   * @param docPtr Document pointer\n   * @param mode 0 for view mode, 1 for edit mode\n   */\n  setEditMode(docPtr: number, mode: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetEditMode) {\n      this.log(`setEditMode: setting mode to ${mode}`);\n      this.module._lok_documentSetEditMode(docPtr, mode);\n      return;\n    }\n\n    this.log('setEditMode: shim not available');\n  }\n\n  // ==========================================\n  // View Management Methods\n  // ==========================================\n\n  /**\n   * Create a new view for the document\n   * @param docPtr Document pointer\n   * @returns View ID\n   */\n  createView(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentCreateView) {\n      const viewId = this.module._lok_documentCreateView(docPtr);\n      this.log(`createView: created view ${viewId}`);\n      return viewId;\n    }\n\n    this.log('createView: shim not available');\n    return -1;\n  }\n\n  /**\n   * Create a new view with options\n   * @param docPtr Document pointer\n   * @param options Options string (JSON)\n   * @returns View ID\n   */\n  createViewWithOptions(docPtr: number, options: string): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentCreateViewWithOptions) {\n      const optionsPtr = this.allocString(options);\n      try {\n        const viewId = this.module._lok_documentCreateViewWithOptions(docPtr, optionsPtr);\n        this.log(`createViewWithOptions: created view ${viewId}`);\n        return viewId;\n      } finally {\n        this.module._free(optionsPtr);\n      }\n    }\n\n    this.log('createViewWithOptions: shim not available');\n    return -1;\n  }\n\n  /**\n   * Destroy a view\n   * @param docPtr Document pointer\n   * @param viewId View ID to destroy\n   */\n  destroyView(docPtr: number, viewId: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentDestroyView) {\n      this.log(`destroyView: destroying view ${viewId}`);\n      this.module._lok_documentDestroyView(docPtr, viewId);\n      return;\n    }\n\n    this.log('destroyView: shim not available');\n  }\n\n  /**\n   * Set the current active view\n   * @param docPtr Document pointer\n   * @param viewId View ID to make active\n   */\n  setView(docPtr: number, viewId: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentSetView) {\n      this.log(`setView: setting active view to ${viewId}`);\n      this.module._lok_documentSetView(docPtr, viewId);\n      return;\n    }\n\n    this.log('setView: shim not available');\n  }\n\n  /**\n   * Get the current active view ID\n   * @param docPtr Document pointer\n   * @returns Current view ID\n   */\n  getView(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetView) {\n      return this.module._lok_documentGetView(docPtr);\n    }\n\n    this.log('getView: shim not available');\n    return -1;\n  }\n\n  /**\n   * Get the number of views\n   * @param docPtr Document pointer\n   * @returns Number of views\n   */\n  getViewsCount(docPtr: number): number {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentGetViewsCount) {\n      return this.module._lok_documentGetViewsCount(docPtr);\n    }\n\n    this.log('getViewsCount: shim not available');\n    return 0;\n  }\n\n  // ==========================================\n  // Event Loop and Callback Methods\n  // ==========================================\n\n  /**\n   * Enable synchronous event dispatch (Unipoll mode).\n   * This must be called before using postKeyEvent, postMouseEvent, etc.\n   * to ensure events are processed immediately instead of being queued.\n   *\n   * Without this, events posted via postKeyEvent/postMouseEvent are queued\n   * via Application::PostUserEvent() and never processed in headless mode.\n   */\n  enableSyncEvents(): void {\n    if (this.useShims && this.module._lok_enableSyncEvents) {\n      this.module._lok_enableSyncEvents();\n      this.log('enableSyncEvents: Unipoll mode enabled');\n    } else {\n      this.log('enableSyncEvents: shim not available');\n    }\n  }\n\n  /**\n   * Disable synchronous event dispatch.\n   * Call this when done with event-based operations.\n   */\n  disableSyncEvents(): void {\n    if (this.useShims && this.module._lok_disableSyncEvents) {\n      this.module._lok_disableSyncEvents();\n      this.log('disableSyncEvents: Unipoll mode disabled');\n    } else {\n      this.log('disableSyncEvents: shim not available');\n    }\n  }\n\n  // ==========================================\n  // Callback Queue Methods\n  // ==========================================\n\n  /**\n   * Register a callback handler for the document.\n   * Events are queued and can be retrieved via pollCallback().\n   * @param docPtr Document pointer\n   */\n  registerCallback(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentRegisterCallback) {\n      this.module._lok_documentRegisterCallback(docPtr);\n      this.log('registerCallback: callback registered');\n    } else {\n      this.log('registerCallback: shim not available');\n    }\n  }\n\n  /**\n   * Unregister the callback handler for the document.\n   * @param docPtr Document pointer\n   */\n  unregisterCallback(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    if (this.useShims && this.module._lok_documentUnregisterCallback) {\n      this.module._lok_documentUnregisterCallback(docPtr);\n      this.log('unregisterCallback: callback unregistered');\n    } else {\n      this.log('unregisterCallback: shim not available');\n    }\n  }\n\n  /**\n   * Check if there are any pending callback events.\n   * @returns true if events are pending\n   */\n  hasCallbackEvents(): boolean {\n    if (this.useShims && this.module._lok_hasCallbackEvents) {\n      return this.module._lok_hasCallbackEvents() !== 0;\n    }\n    return false;\n  }\n\n  /**\n   * Get the number of pending callback events.\n   * @returns Number of events in the queue\n   */\n  getCallbackEventCount(): number {\n    if (this.useShims && this.module._lok_getCallbackEventCount) {\n      return this.module._lok_getCallbackEventCount();\n    }\n    return 0;\n  }\n\n  /**\n   * Poll and retrieve the next callback event from the queue.\n   * @returns The next event, or null if queue is empty\n   */\n  pollCallback(): LOKCallbackEvent | null {\n    if (!this.useShims || !this.module._lok_pollCallback) {\n      return null;\n    }\n\n    const bufferSize = 4096;\n    const payloadBuffer = this.module._malloc(bufferSize);\n    const payloadLengthPtr = this.module._malloc(4);\n\n    try {\n      const eventType = this.module._lok_pollCallback(payloadBuffer, bufferSize, payloadLengthPtr);\n\n      if (eventType === -1) {\n        return null; // Queue is empty\n      }\n\n      // Read the payload length\n      const payloadLength = this.module.HEAP32[payloadLengthPtr >> 2] ?? 0;\n\n      // Read the payload string\n      let payload = '';\n      if (payloadLength > 0) {\n        // Copy bytes from HEAPU8 to avoid SharedArrayBuffer issues in browsers\n        // TextDecoder.decode() doesn't accept SharedArrayBuffer views in some browsers\n        const len = Math.min(payloadLength, bufferSize - 1);\n        const bytes = this.module.HEAPU8.slice(payloadBuffer, payloadBuffer + len);\n        payload = textDecoder.decode(bytes);\n      }\n\n      return {\n        type: eventType,\n        typeName: getCallbackTypeName(eventType),\n        payload,\n      };\n    } finally {\n      this.module._free(payloadBuffer);\n      this.module._free(payloadLengthPtr);\n    }\n  }\n\n  /**\n   * Poll all pending callback events.\n   * @returns Array of all pending events\n   */\n  pollAllCallbacks(): LOKCallbackEvent[] {\n    const events: LOKCallbackEvent[] = [];\n    let event = this.pollCallback();\n    while (event !== null) {\n      events.push(event);\n      event = this.pollCallback();\n    }\n    return events;\n  }\n\n  /**\n   * Clear all pending callback events.\n   */\n  clearCallbackQueue(): void {\n    if (this.useShims && this.module._lok_clearCallbackQueue) {\n      this.module._lok_clearCallbackQueue();\n      this.log('clearCallbackQueue: queue cleared');\n    }\n  }\n\n  /**\n   * Force flush pending LOK callbacks for a document.\n   * This is needed in WASM because callbacks are queued via PostUserEvent\n   * but the event loop doesn't run automatically.\n   * Call this after operations that trigger callbacks (e.g., postUnoCommand)\n   * to ensure the callback queue is populated.\n   * @param docPtr Document pointer\n   */\n  flushCallbacks(docPtr: number): void {\n    if (docPtr === 0) throw new Error('Invalid document pointer');\n\n    const hasShim = !!this.module._lok_flushCallbacks;\n    this.log(`flushCallbacks: useShims=${this.useShims}, _lok_flushCallbacks exists=${hasShim}`);\n\n    if (this.useShims && this.module._lok_flushCallbacks) {\n      this.module._lok_flushCallbacks(docPtr);\n      this.log('flushCallbacks: callbacks flushed');\n    } else {\n      this.log('flushCallbacks: shim not available');\n    }\n  }\n\n  /**\n   * Poll for STATE_CHANGED callbacks and parse them into a map.\n   * STATE_CHANGED payloads are in format: \".uno:CommandName=value\"\n   * @returns Map of command names to values\n   */\n  pollStateChanges(): Map<string, string> {\n    const states = new Map<string, string>();\n    const events = this.pollAllCallbacks();\n\n    for (const event of events) {\n      if (event.type === LOK_CALLBACK_STATE_CHANGED) {\n        // Parse \".uno:Bold=true\" format\n        const eqIndex = event.payload.indexOf('=');\n        if (eqIndex !== -1) {\n          const key = event.payload.substring(0, eqIndex);\n          const value = event.payload.substring(eqIndex + 1);\n          states.set(key, value);\n        } else {\n          // Some state changes are just the command name (enabled/disabled toggle)\n          states.set(event.payload, '');\n        }\n      }\n    }\n\n    return states;\n  }\n\n  // ==========================================\n  // High-Level Convenience Methods\n  // ==========================================\n\n  /**\n   * Click at a position and get text at that location\n   * @param docPtr Document pointer\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   * @returns Text at the clicked position\n   */\n  clickAndGetText(docPtr: number, x: number, y: number): string | null {\n    // Click down and up to select\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONDOWN, x, y, 1, 1, 0);\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONUP, x, y, 1, 1, 0);\n\n    // Get selected text\n    return this.getTextSelection(docPtr, 'text/plain;charset=utf-8');\n  }\n\n  /**\n   * Double-click to select a word and get it\n   * @param docPtr Document pointer\n   * @param x X coordinate in twips\n   * @param y Y coordinate in twips\n   * @returns Selected word\n   */\n  doubleClickAndGetWord(docPtr: number, x: number, y: number): string | null {\n    // Double click to select word\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONDOWN, x, y, 2, 1, 0);\n    this.postMouseEvent(docPtr, LOK_MOUSEEVENT_BUTTONUP, x, y, 2, 1, 0);\n\n    // Get selected text\n    return this.getTextSelection(docPtr, 'text/plain;charset=utf-8');\n  }\n\n  /**\n   * Select all content in the document\n   * @param docPtr Document pointer\n   */\n  selectAll(docPtr: number): void {\n    this.postUnoCommand(docPtr, '.uno:SelectAll');\n  }\n\n  /**\n   * Get all text content from the document\n   * @param docPtr Document pointer\n   * @returns All text content\n   */\n  getAllText(docPtr: number): string | null {\n    this.log(`getAllText called with docPtr: ${docPtr}`);\n    this.selectAll(docPtr);\n    const text = this.getTextSelection(docPtr, 'text/plain;charset=utf-8');\n    this.log(`getAllText: text=\"${text?.slice(0, 100)}...\"`);\n    this.resetSelection(docPtr);\n    return text;\n  }\n\n  /**\n   * Parse page rectangles string into array of objects\n   * @param rectanglesStr String from getPartPageRectangles\n   * @returns Array of rectangle objects\n   */\n  parsePageRectangles(rectanglesStr: string): Array<{ x: number; y: number; width: number; height: number }> {\n    if (!rectanglesStr) return [];\n    \n    return rectanglesStr.split(';').filter(s => s.trim()).map(rect => {\n      const parts = rect.split(',').map(Number);\n      return { \n        x: parts[0] ?? 0, \n        y: parts[1] ?? 0, \n        width: parts[2] ?? 0, \n        height: parts[3] ?? 0 \n      };\n    });\n  }\n}\n","/**\n * LibreOffice WASM Document Converter - Node.js Version\n *\n * This is the Node.js-specific version that requires wasmLoader to be provided.\n * For browser usage, use converter.ts instead.\n */\n\nimport {\n  ConversionError,\n  ConversionErrorCode,\n  ConversionOptions,\n  ConversionResult,\n  DocumentInfo,\n  EditorOperationResult,\n  EditorSession,\n  EmscriptenModule,\n  EXTENSION_TO_FORMAT,\n  FORMAT_FILTERS,\n  FORMAT_MIME_TYPES,\n  FORMAT_FILTER_OPTIONS,\n  FullQualityPagePreview,\n  FullQualityRenderOptions,\n  ILibreOfficeConverter,\n  InputFormatOptions,\n  LibreOfficeWasmOptions,\n  LOKDocumentType,\n  OUTPUT_FORMAT_TO_LOK,\n  OutputFormat,\n  PagePreview,\n  ProgressInfo,\n  RenderOptions,\n  isConversionValid,\n  getConversionErrorMessage,\n  getValidOutputFormats,\n  InputFormat,\n  getOutputFormatsForDocType,\n  buildLoadOptions,\n} from './types.js';\nimport { LOKBindings } from './lok-bindings.js';\n\n/** Emscripten worker with Node.js-specific methods */\ninterface EmscriptenWorker {\n  unref?: () => void;\n  terminate?: () => void;\n}\n\n/** Emscripten PThread interface for pthread cleanup */\ninterface EmscriptenPThread {\n  terminateAllThreads?: () => void;\n  runningWorkers?: EmscriptenWorker[];\n  unusedWorkers?: EmscriptenWorker[];\n}\n\n/** Emscripten module with PThread support */\ninterface EmscriptenModuleWithPThread extends EmscriptenModule {\n  PThread?: EmscriptenPThread;\n}\n\n/** Node.js process handle */\ninterface ProcessHandle {\n  unref?: () => void;\n  constructor?: { name?: string };\n  remoteAddress?: string;\n}\n\n/** Node.js process with internal methods */\ninterface ProcessWithHandles {\n  _getActiveHandles?: () => ProcessHandle[];\n}\n\n/**\n * LibreOffice WASM Document Converter - Node.js Version\n *\n * A headless document conversion toolkit that uses LibreOffice\n * compiled to WebAssembly. This version is optimized for Node.js\n * with static imports that work with ESM bundlers.\n */\nexport class LibreOfficeConverter implements ILibreOfficeConverter {\n  private module: EmscriptenModule | null = null;\n  private lokBindings: LOKBindings | null = null;\n  private initialized = false;\n  private initializing = false;\n  private options: LibreOfficeWasmOptions;\n  private corrupted = false;\n  private fsTracked = false;\n\n  constructor(options: LibreOfficeWasmOptions = {}) {\n    this.options = {\n      wasmPath: './wasm',\n      verbose: false,\n      ...options,\n    };\n  }\n\n  /**\n   * Check if an error indicates LOK corruption requiring reinitialization\n   */\n  private isCorruptionError(error: Error | string): boolean {\n    const msg = error instanceof Error ? error.message : error;\n    return msg.includes('memory access out of bounds') ||\n      msg.includes('ComponentContext is not avail') ||\n      msg.includes('unreachable') ||\n      msg.includes('table index is out of bounds') ||\n      msg.includes('null function');\n  }\n\n  /**\n   * Force reinitialization of the converter (for recovery from errors)\n   */\n  async reinitialize(): Promise<void> {\n    if (this.options.verbose) {\n      console.log('[LibreOfficeConverter] Reinitializing due to corruption...');\n    }\n\n    // Clean up existing state\n    if (this.lokBindings) {\n      try {\n        this.lokBindings.destroy();\n      } catch {\n        // Ignore errors during cleanup\n      }\n      this.lokBindings = null;\n    }\n    this.module = null;\n    this.initialized = false;\n    this.corrupted = false;\n\n    // Reinitialize\n    await this.initialize();\n  }\n\n  /**\n   * Initialize with a pre-loaded Emscripten module\n   * This is useful for environments like Web Workers that have their own\n   * WASM loading mechanism (e.g., importScripts with progress tracking)\n   */\n  async initializeWithModule(module: EmscriptenModule): Promise<void> {\n    if (this.initialized) {\n      return;\n    }\n\n    if (this.initializing) {\n      while (this.initializing) {\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      }\n      return;\n    }\n\n    this.initializing = true;\n\n    try {\n      this.module = module;\n\n      // Set up filesystem\n      this.setupFileSystem();\n\n      // Initialize LibreOfficeKit\n      this.initializeLibreOfficeKit();\n\n      this.initialized = true;\n      this.options.onReady?.();\n    } catch (error) {\n      console.error('[LibreOfficeConverter] Initialization error:', error);\n      const convError =\n        error instanceof ConversionError\n          ? error\n          : new ConversionError(\n            ConversionErrorCode.WASM_NOT_INITIALIZED,\n            `Failed to initialize with module: ${String(error)}`\n          );\n      this.options.onError?.(convError);\n      throw convError;\n    } finally {\n      this.initializing = false;\n    }\n  }\n\n  /**\n   * Initialize the LibreOffice WASM module\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) {\n      return;\n    }\n\n    if (this.initializing) {\n      while (this.initializing) {\n        await new Promise((resolve) => setTimeout(resolve, 100));\n      }\n      return;\n    }\n\n    this.initializing = true;\n    this.emitProgress('loading', 0, 'Loading LibreOffice WASM module...');\n\n    try {\n      // Load WASM module (progress 0-45% handled by loader)\n      this.module = await this.loadModule();\n\n      this.emitProgress('initializing', 50, 'Setting up virtual filesystem...');\n\n      // Create directories in virtual filesystem\n      this.setupFileSystem();\n\n      this.emitProgress('initializing', 60, 'Initializing LibreOfficeKit...');\n\n      // Initialize LibreOfficeKit\n      this.initializeLibreOfficeKit();\n\n      this.emitProgress('initializing', 90, 'LibreOfficeKit ready');\n\n      this.initialized = true;\n      this.emitProgress('complete', 100, 'LibreOffice ready');\n      this.options.onReady?.();\n    } catch (error) {\n      console.error('[LibreOfficeConverter] Initialization error:', error);\n      const convError =\n        error instanceof ConversionError\n          ? error\n          : new ConversionError(\n            ConversionErrorCode.WASM_NOT_INITIALIZED,\n            `Failed to initialize WASM module: ${String(error)}`\n          );\n      this.options.onError?.(convError);\n      throw convError;\n    } finally {\n      this.initializing = false;\n    }\n  }\n\n  /**\n   * Load the Emscripten WASM module (Node.js only)\n   * Requires wasmLoader option to be provided for bundler compatibility\n   */\n  private async loadModule(): Promise<EmscriptenModule> {\n    console.log('[LibreOfficeConverter] Loading WASM module...', this.options.wasmPath, this.options.workerPath, this.options.wasmLoader);\n\n    // wasmLoader must be provided - no dynamic require\n    if (!this.options.wasmLoader) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'wasmLoader option is required. Import the loader and pass it:\\n' +\n        '  import wasmLoader from \"@matbee/libreoffice-converter/wasm/loader.cjs\";\\n' +\n        '  new LibreOfficeConverter({ wasmLoader })'\n      );\n    }\n\n    // Build loader config\n    const config = {\n      verbose: this.options.verbose,\n      print: this.options.verbose ? console.log : () => { },\n      printErr: this.options.verbose ? console.error : () => { },\n      onProgress: (_phase: string, percent: number, message: string) => {\n        // Map loader progress to our progress phases\n        this.emitProgress('loading', percent, message);\n      },\n    };\n\n    return await this.options.wasmLoader.createModule(config);\n  }\n\n  /**\n   * Set up the virtual filesystem\n   */\n  private setupFileSystem(): void {\n    if (!this.module?.FS) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Filesystem not available'\n      );\n    }\n\n    const emFs = this.module.FS;\n\n    const tryMkdir = (dirPath: string) => {\n      try {\n        emFs.mkdir(dirPath);\n      } catch {\n        // Directory may already exist\n      }\n    };\n\n    tryMkdir('/tmp');\n    tryMkdir('/tmp/input');\n    tryMkdir('/tmp/output');\n  }\n\n  /**\n   * Initialize LibreOfficeKit\n   */\n  private initializeLibreOfficeKit(): void {\n    if (!this.module) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Module not loaded'\n      );\n    }\n\n    // Debug filesystem contents before LOK init\n    if (this.options.verbose && this.module.FS) {\n      const emFs = this.module.FS as typeof this.module.FS & {\n        trackingDelegate?: Record<string, unknown>;\n        open: (...args: unknown[]) => unknown;\n      };\n\n      if (!this.fsTracked) {\n        this.fsTracked = true;\n\n        if (!emFs.trackingDelegate) {\n          emFs.trackingDelegate = {\n            onOpen: (filePath: string) => {\n              console.log('[FS OPEN]', filePath);\n            },\n            onOpenFile: (filePath: string) => {\n              console.log('[FS OPEN FILE]', filePath);\n            },\n          };\n        }\n\n        if (typeof emFs.open === 'function') {\n          const originalOpen = emFs.open.bind(emFs);\n          emFs.open = ((filePath: string, flags?: unknown, mode?: unknown) => {\n            console.log('[FS OPEN CALL]', filePath);\n            try {\n              return originalOpen(filePath, flags as never, mode as never);\n            } catch (err) {\n              const error = err as { code?: string; message?: string };\n              if (error?.code === 'ENOENT') {\n                console.log('[FS ENOENT]', filePath);\n              }\n              throw err;\n            }\n          }) as typeof emFs.open;\n        }\n      }\n\n      const logDir = (label: string, dirPath: string) => {\n        try {\n          console.log(`[FS] ${label}:`, emFs.readdir(dirPath));\n        } catch (e) {\n          console.log(`[FS] ${label}: ERROR -`, (e as Error).message);\n        }\n      };\n\n      logDir('ROOT', '/');\n      logDir('PROGRAM DIR', '/instdir/program');\n      logDir('SHARE DIR', '/instdir/share');\n      logDir('REGISTRY DIR', '/instdir/share/registry');\n      logDir('FILTER DIR', '/instdir/share/filter');\n      logDir('CONFIG DIR', '/instdir/share/config/soffice.cfg');\n      logDir('CONFIG FILTER', '/instdir/share/config/soffice.cfg/filter');\n      logDir('IMPRESS MODULES', '/instdir/share/config/soffice.cfg/modules/simpress');\n    }\n\n    // Create required directories for LibreOffice user profile\n    // These are needed for temp files, locks, and user settings during LOK initialization\n    const emFs = this.module.FS;\n    const createDir = (dirPath: string) => {\n      try {\n        emFs.mkdir(dirPath);\n        if (this.options.verbose) {\n          console.log('[FS] Created directory:', dirPath);\n        }\n      } catch (e) {\n        // Directory might already exist - ignore EEXIST errors\n        const err = e as { code?: string };\n        if (err.code !== 'EEXIST') {\n          if (this.options.verbose) {\n            console.log('[FS] mkdir failed:', dirPath, (e as Error).message);\n          }\n        }\n      }\n    };\n\n    // Create user profile directories that LibreOffice needs\n    createDir('/instdir/user');\n    createDir('/instdir/user/temp');\n    createDir('/instdir/user/temp/embeddedfonts');\n    createDir('/instdir/user/temp/embeddedfonts/fromdocs');\n    createDir('/instdir/user/temp/embeddedfonts/fromsystem');\n    createDir('/instdir/user/registry');\n    createDir('/instdir/user/registry/data');\n\n    // Create LOK bindings wrapper\n    this.lokBindings = new LOKBindings(this.module, this.options.verbose);\n\n    try {\n      // Initialize LibreOfficeKit through the bindings\n      this.lokBindings.initialize('/instdir/program');\n\n      if (this.options.verbose) {\n        const versionInfo = this.lokBindings.getVersionInfo();\n        if (versionInfo) {\n          console.log('[LOK] Version:', versionInfo);\n        }\n      }\n    } catch (error) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        `Failed to initialize LibreOfficeKit: ${String(error)}`\n      );\n    }\n  }\n\n  /**\n   * Convert a document to a different format\n   */\n  async convert(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    filename = 'document'\n  ): Promise<ConversionResult> {\n    // Check if we need to reinitialize due to previous corruption\n    if (this.corrupted) {\n      await this.reinitialize();\n    }\n\n    if (!this.initialized || !this.module) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'LibreOffice WASM not initialized. Call initialize() first.'\n      );\n    }\n\n    const startTime = Date.now();\n    const inputData = this.normalizeInput(input);\n\n    if (inputData.length === 0) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Empty document provided'\n      );\n    }\n\n    const inputExt = options.inputFormat || this.getExtensionFromFilename(filename) || 'docx';\n    const outputExt = options.outputFormat;\n\n    if (!FORMAT_FILTERS[outputExt]) {\n      throw new ConversionError(\n        ConversionErrorCode.UNSUPPORTED_FORMAT,\n        `Unsupported output format: ${outputExt}`\n      );\n    }\n\n    // Validate that this conversion path is supported\n    if (!isConversionValid(inputExt, outputExt)) {\n      throw new ConversionError(\n        ConversionErrorCode.UNSUPPORTED_FORMAT,\n        getConversionErrorMessage(inputExt, outputExt)\n      );\n    }\n\n    const inputPath = `/tmp/input/doc.${inputExt}`;\n    const outputPath = `/tmp/output/doc.${outputExt}`;\n\n    try {\n      this.emitProgress('converting', 10, 'Writing input document...');\n\n      // Write input file to virtual filesystem\n      this.module.FS.writeFile(inputPath, inputData);\n\n      this.emitProgress('converting', 30, 'Converting document...');\n\n      // Perform conversion\n      const result = await this.performConversion(inputPath, outputPath, options);\n\n      this.emitProgress('complete', 100, 'Conversion complete');\n\n      const baseName = this.getBasename(filename);\n      const outputFilename = `${baseName}.${outputExt}`;\n\n      return {\n        data: result,\n        mimeType: FORMAT_MIME_TYPES[outputExt],\n        filename: outputFilename,\n        duration: Date.now() - startTime,\n      };\n    } catch (error) {\n      // Check if this error indicates corruption\n      if (error instanceof Error && this.isCorruptionError(error)) {\n        this.corrupted = true;\n        if (this.options.verbose) {\n          console.log('[LibreOfficeConverter] Corruption detected, will reinitialize on next convert');\n        }\n      }\n      throw error;\n    } finally {\n      // Cleanup temporary files\n      try {\n        this.module?.FS.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        this.module?.FS.unlink(outputPath);\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Perform the actual conversion using LibreOfficeKit\n   */\n  private async performConversion(\n    inputPath: string,\n    outputPath: string,\n    options: ConversionOptions\n  ): Promise<Uint8Array> {\n    if (!this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Module not loaded'\n      );\n    }\n\n    this.emitProgress('converting', 40, 'Loading document...');\n\n    let docPtr = 0;\n\n    try {\n      // Build load options (e.g., for CSV import filter or password-protected documents)\n      const loadOptions = buildLoadOptions(options.inputFormat, options.password);\n\n      // Debug: verify file exists before LOK load\n      if (this.options.verbose) {\n        try {\n          const stat = this.module.FS.stat(inputPath);\n          console.log('[Convert] File exists before LOK load:', inputPath, 'size:', stat.size);\n        } catch (e) {\n          console.log('[Convert] File NOT found before LOK load:', inputPath, (e as Error).message);\n        }\n        if (loadOptions) {\n          console.log('[Convert] Using load options:', loadOptions);\n        }\n      }\n\n      // Load the document using LibreOfficeKit\n      if (loadOptions) {\n        docPtr = this.lokBindings.documentLoadWithOptions(inputPath, loadOptions);\n      } else {\n        docPtr = this.lokBindings.documentLoad(inputPath);\n      }\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      this.emitProgress('converting', 60, 'Converting format...');\n\n      // Determine the output format string for LOK\n      const lokFormat = OUTPUT_FORMAT_TO_LOK[options.outputFormat];\n\n      // Get filter options for the format\n      let filterOptions = FORMAT_FILTER_OPTIONS[options.outputFormat] || '';\n\n      // Add PDF-specific options if applicable\n      if (options.outputFormat === 'pdf' && options.pdf) {\n        const pdfOpts: string[] = [];\n        if (options.pdf.pdfaLevel) {\n          const levelMap: Record<string, number> = {\n            'PDF/A-1b': 1,\n            'PDF/A-2b': 2,\n            'PDF/A-3b': 3,\n          };\n          pdfOpts.push(`SelectPdfVersion=${levelMap[options.pdf.pdfaLevel] || 0}`);\n        }\n        if (options.pdf.quality !== undefined) {\n          pdfOpts.push(`Quality=${options.pdf.quality}`);\n        }\n        if (pdfOpts.length > 0) {\n          filterOptions = pdfOpts.join(',');\n        }\n      }\n\n      // Add page selection for image exports (png, jpg, svg)\n      if (['png', 'jpg', 'svg'].includes(options.outputFormat) && options.image?.pageIndex !== undefined) {\n        // PageRange is 1-indexed\n        const pageNum = options.image.pageIndex + 1;\n        if (filterOptions) {\n          filterOptions += `;PageRange=${pageNum}-${pageNum}`;\n        } else {\n          filterOptions = `PageRange=${pageNum}-${pageNum}`;\n        }\n      }\n\n      this.emitProgress('converting', 70, 'Saving document...');\n\n      // Save the document in the new format\n      this.lokBindings.documentSaveAs(docPtr, outputPath, lokFormat, filterOptions);\n\n      this.emitProgress('converting', 90, 'Reading output...');\n\n      // Read the converted output file\n      try {\n        const outputData = this.module.FS.readFile(outputPath) as Uint8Array;\n\n        if (outputData.length === 0) {\n          throw new ConversionError(\n            ConversionErrorCode.CONVERSION_FAILED,\n            'Conversion produced empty output'\n          );\n        }\n\n        return outputData;\n      } catch (fsError) {\n        throw new ConversionError(\n          ConversionErrorCode.CONVERSION_FAILED,\n          `Failed to read converted file: ${String(fsError)}`\n        );\n      }\n    } catch (error) {\n      if (error instanceof ConversionError) {\n        throw error;\n      }\n      throw new ConversionError(\n        ConversionErrorCode.CONVERSION_FAILED,\n        `Conversion failed: ${String(error)}`\n      );\n    } finally {\n      // Always clean up the document\n      if (docPtr !== 0 && this.lokBindings) {\n        try {\n          this.lokBindings.documentDestroy(docPtr);\n        } catch {\n          // Ignore cleanup errors\n        }\n      }\n    }\n  }\n\n  /**\n   * Render page previews (thumbnails) for a document\n   */\n  async renderPagePreviews(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    renderOptions: RenderOptions = {}\n  ): Promise<PagePreview[]> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n    const width = renderOptions.width ?? 256;\n    const height = renderOptions.height ?? 0;\n    const pageIndices = renderOptions.pageIndices ?? [];\n\n    const inputPath = `/tmp/preview/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/preview');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document for preview'\n        );\n      }\n\n      try {\n        const numParts = this.lokBindings.documentGetParts(docPtr);\n        if (this.options.verbose) {\n          console.log(`[Preview] Document has ${numParts} pages/parts`);\n        }\n\n        const pagesToRender =\n          pageIndices.length > 0\n            ? pageIndices.filter((i) => i >= 0 && i < numParts)\n            : Array.from({ length: numParts }, (_, i) => i);\n\n        const results: PagePreview[] = [];\n        const editMode = renderOptions.editMode ?? false;\n\n        for (const pageIndex of pagesToRender) {\n          if (this.options.verbose) {\n            console.log(`[Preview] Rendering page ${pageIndex + 1}/${numParts}`);\n          }\n\n          const preview = this.lokBindings.renderPage(docPtr, pageIndex, width, height, editMode);\n          results.push({\n            page: pageIndex,\n            data: preview.data,\n            width: preview.width,\n            height: preview.height,\n          });\n        }\n\n        return results;\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/preview');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Render a page at full quality (native resolution based on DPI)\n   */\n  async renderPageFullQuality(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    renderOptions: FullQualityRenderOptions = {}\n  ): Promise<FullQualityPagePreview> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n    const dpi = renderOptions.dpi ?? 150;\n    const maxDimension = renderOptions.maxDimension;\n\n    const inputPath = `/tmp/fullquality/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/fullquality');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document for full quality render'\n        );\n      }\n\n      try {\n        const numParts = this.lokBindings.documentGetParts(docPtr);\n        if (pageIndex < 0 || pageIndex >= numParts) {\n          throw new ConversionError(\n            ConversionErrorCode.CONVERSION_FAILED,\n            `Page index ${pageIndex} out of range (0-${numParts - 1})`\n          );\n        }\n\n        if (this.options.verbose) {\n          console.log(`[FullQuality] Rendering page ${pageIndex + 1}/${numParts} at ${dpi} DPI`);\n        }\n\n        const editMode = renderOptions.editMode ?? false;\n        const preview = this.lokBindings.renderPageFullQuality(docPtr, pageIndex, dpi, maxDimension, editMode);\n\n        return {\n          page: pageIndex,\n          data: preview.data,\n          width: preview.width,\n          height: preview.height,\n          dpi: preview.dpi,\n        };\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/fullquality');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Get the number of pages/parts in a document\n   */\n  async getPageCount(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<number> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n\n    const inputPath = `/tmp/pagecount/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/pagecount');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        return this.lokBindings.documentGetParts(docPtr);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/pagecount');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  /**\n   * Get valid output formats for a document by loading it and checking its type\n   */\n  async getDocumentInfo(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<DocumentInfo> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n\n    const inputPath = `/tmp/docinfo/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/docinfo');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const docType = this.lokBindings.documentGetDocumentType(docPtr) as LOKDocumentType;\n        const pageCount = this.lokBindings.documentGetParts(docPtr);\n        const validOutputFormats = getOutputFormatsForDocType(docType);\n\n        const docTypeNames: Record<LOKDocumentType, string> = {\n          [LOKDocumentType.TEXT]: 'Text Document',\n          [LOKDocumentType.SPREADSHEET]: 'Spreadsheet',\n          [LOKDocumentType.PRESENTATION]: 'Presentation',\n          [LOKDocumentType.DRAWING]: 'Drawing',\n          [LOKDocumentType.OTHER]: 'Other',\n        };\n\n        return {\n          documentType: docType,\n          documentTypeName: docTypeNames[docType] || 'Unknown',\n          validOutputFormats,\n          pageCount,\n        };\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/docinfo');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  // ============================================\n  // Document Inspection Methods\n  // ============================================\n\n  async getDocumentText(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions\n  ): Promise<string | null> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/inspect/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/inspect');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        return this.lokBindings.getAllText(docPtr);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/inspect');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async getPageNames(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions\n  ): Promise<string[]> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/names/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/names');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const numParts = this.lokBindings.documentGetParts(docPtr);\n        const names: string[] = [];\n\n        for (let i = 0; i < numParts; i++) {\n          const name = this.lokBindings.getPartName(docPtr, i);\n          names.push(name || `Page ${i + 1}`);\n        }\n\n        return names;\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/names');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async getPageRectangles(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions\n  ): Promise<Array<{ x: number; y: number; width: number; height: number }>> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/rects/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/rects');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const rectsStr = this.lokBindings.getPartPageRectangles(docPtr);\n        return this.lokBindings.parsePageRectangles(rectsStr || '');\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/rects');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async getSpreadsheetDataArea(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    sheetIndex: number = 0\n  ): Promise<{ col: number; row: number }> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/dataarea/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/dataarea');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        return this.lokBindings.getDataArea(docPtr, sheetIndex);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/dataarea');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  async executeUnoCommand(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    command: string,\n    args: string = '{}'\n  ): Promise<void> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = options.inputFormat?.toLowerCase();\n\n    if (!inputFormat) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Input format is required'\n      );\n    }\n\n    const inputPath = `/tmp/uno/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/uno');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        this.lokBindings.postUnoCommand(docPtr, command, args);\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/uno');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  // ============================================\n  // ILibreOfficeConverter Interface Methods\n  // ============================================\n\n  async renderPage(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    width: number,\n    height = 0\n  ): Promise<PagePreview> {\n    if (!this.initialized || !this.module || !this.lokBindings) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized'\n      );\n    }\n\n    const data = this.normalizeInput(input);\n    const inputFormat = (options.inputFormat || 'docx').toLowerCase();\n\n    const inputPath = `/tmp/renderpage/doc.${inputFormat}`;\n    const emFs = this.module.FS;\n\n    try {\n      try {\n        emFs.mkdir('/tmp/renderpage');\n      } catch {\n        // Directory might exist\n      }\n\n      emFs.writeFile(inputPath, data);\n      const docPtr = this.lokBindings.documentLoad(inputPath);\n\n      if (docPtr === 0) {\n        throw new ConversionError(\n          ConversionErrorCode.LOAD_FAILED,\n          'Failed to load document'\n        );\n      }\n\n      try {\n        const preview = this.lokBindings.renderPage(docPtr, pageIndex, width, height);\n        return {\n          page: pageIndex,\n          data: preview.data,\n          width: preview.width,\n          height: preview.height,\n        };\n      } finally {\n        this.lokBindings.documentDestroy(docPtr);\n      }\n    } finally {\n      try {\n        emFs.unlink(inputPath);\n      } catch {\n        // Ignore\n      }\n      try {\n        emFs.rmdir('/tmp/renderpage');\n      } catch {\n        // Ignore\n      }\n    }\n  }\n\n  openDocument(\n    _input: Uint8Array | ArrayBuffer,\n    _options: InputFormatOptions\n  ): Promise<EditorSession> {\n    return Promise.reject(new ConversionError(\n      ConversionErrorCode.CONVERSION_FAILED,\n      'Editor sessions not supported by LibreOfficeConverter. Use WorkerConverter or WorkerBrowserConverter.'\n    ));\n  }\n\n  editorOperation<T = unknown>(\n    _sessionId: string,\n    _method: string,\n    _args?: unknown[]\n  ): Promise<EditorOperationResult<T>> {\n    return Promise.reject(new ConversionError(\n      ConversionErrorCode.CONVERSION_FAILED,\n      'Editor operations not supported by LibreOfficeConverter. Use WorkerConverter or WorkerBrowserConverter.'\n    ));\n  }\n\n  closeDocument(_sessionId: string): Promise<Uint8Array | undefined> {\n    return Promise.reject(new ConversionError(\n      ConversionErrorCode.CONVERSION_FAILED,\n      'Editor sessions not supported by LibreOfficeConverter. Use WorkerConverter or WorkerBrowserConverter.'\n    ));\n  }\n\n  getLokBindings(): typeof this.lokBindings {\n    return this.lokBindings;\n  }\n\n  destroy(): Promise<void> {\n    if (this.lokBindings) {\n      try {\n        this.lokBindings.destroy();\n      } catch {\n        // Ignore cleanup errors\n      }\n      this.lokBindings = null;\n    }\n\n    // Terminate Emscripten pthread workers to allow process to exit\n    if (this.module) {\n      try {\n        const mod = this.module as EmscriptenModuleWithPThread;\n\n        if (mod.PThread?.terminateAllThreads) {\n          mod.PThread.terminateAllThreads();\n        }\n\n        if (mod.PThread?.runningWorkers) {\n          for (const worker of mod.PThread.runningWorkers) {\n            if (worker?.unref) {\n              worker.unref();\n            }\n            if (worker?.terminate) {\n              worker.terminate();\n            }\n          }\n          mod.PThread.runningWorkers = [];\n        }\n\n        if (mod.PThread?.unusedWorkers) {\n          for (const worker of mod.PThread.unusedWorkers) {\n            if (worker?.unref) {\n              worker.unref();\n            }\n            if (worker?.terminate) {\n              worker.terminate();\n            }\n          }\n          mod.PThread.unusedWorkers = [];\n        }\n      } catch {\n        // Ignore pthread cleanup errors\n      }\n    }\n\n    // In Node.js, unref any remaining handles to allow process exit\n    if (typeof process !== 'undefined') {\n      try {\n        const proc = process as unknown as ProcessWithHandles;\n        if (proc._getActiveHandles) {\n          const handles = proc._getActiveHandles();\n          for (const handle of handles) {\n            if (handle?.unref) {\n              const name = handle.constructor?.name ?? '';\n              if (name === 'MessagePort' || (name === 'Socket' && !handle.remoteAddress)) {\n                handle.unref();\n              }\n            }\n          }\n        }\n      } catch {\n        // Ignore\n      }\n    }\n\n    this.module = null;\n    this.initialized = false;\n    return Promise.resolve();\n  }\n\n  isReady(): boolean {\n    return this.initialized;\n  }\n\n  getModule(): EmscriptenModule | null {\n    return this.module;\n  }\n\n  static getSupportedInputFormats(): string[] {\n    return Object.keys(EXTENSION_TO_FORMAT);\n  }\n\n  static getSupportedOutputFormats(): OutputFormat[] {\n    return Object.keys(FORMAT_FILTERS) as OutputFormat[];\n  }\n\n  static getValidOutputFormats(inputFormat: string): OutputFormat[] {\n    return getValidOutputFormats(inputFormat as InputFormat);\n  }\n\n  static isConversionSupported(inputFormat: string, outputFormat: string): boolean {\n    return isConversionValid(inputFormat, outputFormat);\n  }\n\n  // ============================================\n  // Private helper methods\n  // ============================================\n\n  private normalizeInput(input: Uint8Array | ArrayBuffer | Buffer): Uint8Array {\n    if (input instanceof Uint8Array) {\n      return input;\n    }\n    if (input instanceof ArrayBuffer) {\n      return new Uint8Array(input);\n    }\n    return new Uint8Array(input);\n  }\n\n  private getExtensionFromFilename(filename: string): string | null {\n    const parts = filename.split('.');\n    if (parts.length > 1) {\n      return parts.pop()?.toLowerCase() || null;\n    }\n    return null;\n  }\n\n  private getBasename(filename: string): string {\n    const lastDot = filename.lastIndexOf('.');\n    if (lastDot > 0) {\n      return filename.substring(0, lastDot);\n    }\n    return filename;\n  }\n\n  private emitProgress(\n    phase: ProgressInfo['phase'],\n    percent: number,\n    message: string\n  ): void {\n    this.options.onProgress?.({ phase, percent, message });\n  }\n}\n","/**\n * Worker-based LibreOffice Converter\n * \n * This converter runs the WASM module in a Worker thread to avoid\n * blocking the main Node.js event loop.\n */\n\nimport { Worker } from 'worker_threads';\nimport { fileURLToPath } from 'url';\nimport { dirname, join, resolve } from 'path';\nimport { randomUUID } from 'crypto';\nimport { existsSync } from 'fs';\nimport {\n  ConversionError,\n  ConversionErrorCode,\n  ConversionOptions,\n  ConversionResult,\n  DocumentInfo,\n  EditorOperationResult,\n  EditorSession,\n  FORMAT_MIME_TYPES,\n  FullQualityPagePreview,\n  FullQualityRenderOptions,\n  ILibreOfficeConverter,\n  InputFormatOptions,\n  LibreOfficeWasmOptions,\n  LOKDocumentType,\n  OutputFormat,\n  PagePreview,\n  RenderOptions,\n} from './types.js';\n\n// Re-export types used by consumers\nexport type { LOKDocumentType, OutputFormat, PagePreview, DocumentInfo, EditorSession, RenderOptions };\n\ninterface WorkerResponse {\n  id: string;\n  success: boolean;\n  error?: string;\n  data?: unknown;\n}\n\n/** Worker message for ready/error notifications */\ninterface WorkerMessage {\n  type: 'ready' | 'error';\n  error?: string;\n}\n\n/** Raw preview data from worker */\ninterface RawPreviewData {\n  page: number;\n  data: ArrayBuffer | Uint8Array;\n  width: number;\n  height: number;\n}\n\n/**\n * Worker-based LibreOffice Converter\n * Uses a separate thread to avoid blocking the main event loop\n */\nexport class WorkerConverter implements ILibreOfficeConverter {\n  private worker: Worker | null = null;\n  private pending = new Map<string, { resolve: (value: any) => void; reject: (error: Error) => void; timeout: NodeJS.Timeout }>();\n  private options: LibreOfficeWasmOptions;\n  private initialized = false;\n  private initializing = false;\n\n  constructor(options: LibreOfficeWasmOptions = {}) {\n    this.options = {\n      wasmPath: './wasm',\n      verbose: false,\n      ...options,\n    };\n  }\n\n  /**\n   * Initialize the converter\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) {\n      return;\n    }\n\n    if (this.initializing) {\n      while (this.initializing) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n      return;\n    }\n\n    this.initializing = true;\n\n    try {\n      // Find the worker script path\n      let workerPath: string;\n\n      if (this.options.workerPath) {\n        // Use explicit worker path if provided\n        workerPath = resolve(this.options.workerPath);\n      } else {\n        // Auto-detect worker path\n        try {\n          const currentDir = dirname(fileURLToPath(import.meta.url));\n          workerPath = join(currentDir, 'node.worker.cjs');\n        } catch {\n          workerPath = join(__dirname, 'node.worker.cjs');\n        }\n\n        // If worker doesn't exist at computed path, try dist/ relative to cwd\n        // (handles vitest running source files directly)\n        if (!existsSync(workerPath)) {\n          const distWorkerPath = resolve(process.cwd(), 'dist', 'node.worker.cjs');\n          if (existsSync(distWorkerPath)) {\n            workerPath = distWorkerPath;\n          }\n        }\n      }\n\n      // Create the worker\n      this.worker = new Worker(workerPath);\n\n      // Set up message handling\n      this.worker.on('message', (response: WorkerResponse | { type: string }) => {\n        if ('type' in response && response.type === 'ready') {\n          return; // Worker ready signal\n        }\n\n        const res = response as WorkerResponse;\n        const pending = this.pending.get(res.id);\n        if (pending) {\n          // Clear the timeout to prevent it from keeping the process alive\n          clearTimeout(pending.timeout);\n          this.pending.delete(res.id);\n          if (res.success) {\n            pending.resolve(res.data);\n          } else {\n            pending.reject(new ConversionError(\n              ConversionErrorCode.CONVERSION_FAILED,\n              res.error || 'Unknown worker error'\n            ));\n          }\n        }\n      });\n\n      this.worker.on('error', (error) => {\n        // Reject all pending operations and clear their timeouts\n        for (const [, pending] of this.pending) {\n          clearTimeout(pending.timeout);\n          pending.reject(error);\n        }\n        this.pending.clear();\n      });\n\n      // Wait for ready signal\n      await new Promise<void>((resolve) => {\n        const handler = (msg: WorkerMessage) => {\n          if (msg.type === 'ready') {\n            this.worker?.off('message', handler);\n            resolve();\n          }\n        };\n        this.worker?.on('message', handler);\n      });\n\n      // Initialize the WASM module in the worker\n      await this.sendMessage('init', {\n        wasmPath: this.options.wasmPath,\n        verbose: this.options.verbose,\n      });\n\n      this.initialized = true;\n      this.options.onReady?.();\n    } catch (error) {\n      const convError = error instanceof ConversionError\n        ? error\n        : new ConversionError(\n            ConversionErrorCode.WASM_NOT_INITIALIZED,\n            `Failed to initialize worker: ${String(error)}`\n          );\n      this.options.onError?.(convError);\n      throw convError;\n    } finally {\n      this.initializing = false;\n    }\n  }\n\n  /**\n   * Send a message to the worker and wait for response\n   */\n  private sendMessage(type: string, payload?: unknown): Promise<any> {\n    return new Promise((resolve, reject) => {\n      if (!this.worker) {\n        reject(new ConversionError(\n          ConversionErrorCode.WASM_NOT_INITIALIZED,\n          'Worker not initialized'\n        ));\n        return;\n      }\n\n      const id = randomUUID();\n\n      // Timeout after 5 minutes\n      const timeout = setTimeout(() => {\n        const pending = this.pending.get(id);\n        if (pending) {\n          this.pending.delete(id);\n          pending.reject(new ConversionError(\n            ConversionErrorCode.CONVERSION_FAILED,\n            'Worker operation timeout'\n          ));\n        }\n      }, 300000);\n\n      this.pending.set(id, { resolve, reject, timeout });\n      this.worker.postMessage({ type, id, payload });\n    });\n  }\n\n  /**\n   * Convert a document\n   */\n  async convert(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: ConversionOptions,\n    filename = 'document'\n  ): Promise<ConversionResult> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const startTime = Date.now();\n    const inputData = this.normalizeInput(input);\n\n    if (inputData.length === 0) {\n      throw new ConversionError(\n        ConversionErrorCode.INVALID_INPUT,\n        'Empty document provided'\n      );\n    }\n\n    const inputFormat = options.inputFormat || this.getExtensionFromFilename(filename) || 'docx';\n    const outputFormat = options.outputFormat;\n\n    const result = await this.sendMessage('convert', {\n      inputData,\n      inputFormat,\n      outputFormat,\n      filename,\n    });\n\n    const baseName = this.getBasename(filename);\n    const outputFilename = `${baseName}.${outputFormat}`;\n\n    return {\n      data: new Uint8Array(result),\n      mimeType: FORMAT_MIME_TYPES[outputFormat],\n      filename: outputFilename,\n      duration: Date.now() - startTime,\n    };\n  }\n\n  /**\n   * Get the number of pages in a document\n   */\n  async getPageCount(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<number> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const inputFormat = options.inputFormat || 'docx';\n    return this.sendMessage('getPageCount', { inputData, inputFormat });\n  }\n\n  /**\n   * Get document information including type and valid output formats\n   */\n  async getDocumentInfo(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<DocumentInfo> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const inputFormat = options.inputFormat || 'docx';\n    return this.sendMessage('getDocumentInfo', { inputData, inputFormat });\n  }\n\n  /**\n   * Render a single page as an image\n   */\n  async renderPage(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    width: number,\n    height = 0\n  ): Promise<PagePreview> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const inputFormat = options.inputFormat || 'docx';\n    const result = await this.sendMessage('renderPage', {\n      inputData,\n      inputFormat,\n      pageIndex,\n      width,\n      height,\n    });\n\n    const preview = result as RawPreviewData;\n    return {\n      page: pageIndex,\n      data: new Uint8Array(preview.data),\n      width: preview.width,\n      height: preview.height,\n    };\n  }\n\n  /**\n   * Render multiple page previews\n   */\n  async renderPagePreviews(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    renderOptions: RenderOptions = {}\n  ): Promise<PagePreview[]> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const inputFormat = options.inputFormat || 'docx';\n    const rawPreviews = await this.sendMessage('renderPagePreviews', {\n      inputData,\n      inputFormat,\n      width: renderOptions.width || 800,\n      height: renderOptions.height || 0,\n      pageIndices: renderOptions.pageIndices,\n    }) as RawPreviewData[];\n\n    return rawPreviews.map((preview) => ({\n      page: preview.page,\n      data: new Uint8Array(preview.data),\n      width: preview.width,\n      height: preview.height,\n    }));\n  }\n\n  /**\n   * Render a page at full quality (native resolution based on DPI)\n   * @param input Document data\n   * @param options Must include inputFormat\n   * @param pageIndex Zero-based page index to render\n   * @param renderOptions DPI and max dimension settings\n   * @returns Full quality page preview with RGBA data and DPI info\n   */\n  async renderPageFullQuality(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    renderOptions: FullQualityRenderOptions = {}\n  ): Promise<FullQualityPagePreview> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const inputFormat = options.inputFormat || 'docx';\n    const rawPreview = await this.sendMessage('renderPageFullQuality', {\n      inputData,\n      inputFormat,\n      pageIndex,\n      dpi: renderOptions.dpi ?? 150,\n      maxDimension: renderOptions.maxDimension,\n      editMode: renderOptions.editMode ?? false,\n    }) as RawPreviewData & { dpi: number };\n\n    return {\n      page: rawPreview.page,\n      data: new Uint8Array(rawPreview.data),\n      width: rawPreview.width,\n      height: rawPreview.height,\n      dpi: rawPreview.dpi,\n    };\n  }\n\n  /**\n   * Extract text content from a document\n   */\n  async getDocumentText(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    inputFormat: string\n  ): Promise<string | null> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.sendMessage('getDocumentText', { inputData, inputFormat });\n  }\n\n  /**\n   * Get page/slide names from a document\n   */\n  async getPageNames(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    inputFormat: string\n  ): Promise<string[]> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.sendMessage('getPageNames', { inputData, inputFormat });\n  }\n\n  // ============================================\n  // Editor Operations\n  // ============================================\n\n  /**\n   * Open a document for editing\n   * Returns a session ID that can be used for subsequent editor operations\n   */\n  async openDocument(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<EditorSession> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const inputFormat = options.inputFormat || 'docx';\n    return this.sendMessage('openDocument', { inputData, inputFormat });\n  }\n\n  /**\n   * Execute an editor operation on an open document session\n   * @param sessionId - The session ID from openDocument\n   * @param method - The editor method to call (e.g., 'insertParagraph', 'getStructure')\n   * @param args - Arguments to pass to the method\n   */\n  async editorOperation<T = unknown>(\n    sessionId: string,\n    method: string,\n    args?: unknown[]\n  ): Promise<EditorOperationResult<T>> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    return this.sendMessage('editorOperation', { sessionId, method, args: args ?? [] });\n  }\n\n  /**\n   * Close an editor session and get the modified document\n   * @param sessionId - The session ID from openDocument\n   * @returns The modified document data, or undefined if save failed\n   */\n  async closeDocument(sessionId: string): Promise<Uint8Array | undefined> {\n    if (!this.initialized || !this.worker) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const result = await this.sendMessage('closeDocument', { sessionId });\n    return result ? new Uint8Array(result) : undefined;\n  }\n\n  /**\n   * Destroy the converter and terminate the worker\n   */\n  async destroy(): Promise<void> {\n    // Clear all pending timeouts first to allow process to exit\n    for (const [, pending] of this.pending) {\n      clearTimeout(pending.timeout);\n    }\n\n    if (this.worker) {\n      try {\n        await this.sendMessage('destroy');\n      } catch {\n        // Ignore errors during cleanup\n      }\n\n      // Clear any new timeouts from the destroy message\n      for (const [, pending] of this.pending) {\n        clearTimeout(pending.timeout);\n      }\n\n      // Remove all event listeners to prevent memory leaks\n      this.worker.removeAllListeners();\n\n      // Terminate the worker thread\n      await this.worker.terminate();\n      this.worker = null;\n    }\n    this.initialized = false;\n    this.pending.clear();\n  }\n\n  /**\n   * Check if the converter is ready\n   */\n  isReady(): boolean {\n    return this.initialized && this.worker !== null;\n  }\n\n  private normalizeInput(input: Uint8Array | ArrayBuffer | Buffer): Uint8Array {\n    if (input instanceof Uint8Array) {\n      return input;\n    }\n    if (input instanceof ArrayBuffer) {\n      return new Uint8Array(input);\n    }\n    return new Uint8Array(input);\n  }\n\n  private getExtensionFromFilename(filename: string): string | null {\n    const parts = filename.split('.');\n    if (parts.length > 1) {\n      return parts.pop()?.toLowerCase() || null;\n    }\n    return null;\n  }\n\n  private getBasename(filename: string): string {\n    const lastDot = filename.lastIndexOf('.');\n    if (lastDot > 0) {\n      return filename.substring(0, lastDot);\n    }\n    return filename;\n  }\n}\n\n/**\n * Create and initialize a worker-based converter\n */\nexport async function createWorkerConverter(\n  options: LibreOfficeWasmOptions = {}\n): Promise<WorkerConverter> {\n  const converter = new WorkerConverter(options);\n  await converter.initialize();\n  return converter;\n}\n\n","/**\n * Forked Process LibreOffice Converter\n *\n * Runs the WASM module in a completely separate Node.js process.\n * Includes retry logic for handling transient WASM memory errors.\n */\n\nimport { fork, ChildProcess } from 'child_process';\nimport { fileURLToPath } from 'url';\nimport { dirname, join, resolve } from 'path';\nimport { randomUUID } from 'crypto';\nimport {\n  ConversionError,\n  ConversionErrorCode,\n  ConversionOptions,\n  ConversionResult,\n  DocumentInfo,\n  EditorOperationResult,\n  EditorSession,\n  FORMAT_MIME_TYPES,\n  FullQualityPagePreview,\n  FullQualityRenderOptions,\n  OUTPUT_FORMAT_TO_LOK,\n  FORMAT_FILTER_OPTIONS,\n  ILibreOfficeConverter,\n  InputFormatOptions,\n  LibreOfficeWasmOptions,\n  LOKDocumentType,\n  OutputFormat,\n  PagePreview,\n  RenderOptions,\n} from './types.js';\n\n// Re-export types used by consumers\nexport type { LOKDocumentType, OutputFormat, PagePreview, DocumentInfo, EditorSession, RenderOptions };\n\ninterface WorkerMessage {\n  type: 'ready' | 'error' | 'response';\n  id?: string;\n  success?: boolean;\n  error?: string;\n  data?: unknown;\n}\n\ninterface SubprocessConverterOptions extends LibreOfficeWasmOptions {\n  /** Max retries for initialization (default: 3) */\n  maxInitRetries?: number;\n  /** Max retries for conversion (default: 2) */\n  maxConversionRetries?: number;\n  /** Whether to restart subprocess on memory errors (default: true) */\n  restartOnMemoryError?: boolean;\n}\n\nexport class SubprocessConverter implements ILibreOfficeConverter {\n  private child: ChildProcess | null = null;\n  private pending = new Map<string, { resolve: (v: unknown) => void; reject: (e: Error) => void }>();\n  private options: SubprocessConverterOptions;\n  private initialized = false;\n  private initializing = false;\n  private workerPath: string = '';\n\n  constructor(options: SubprocessConverterOptions = {}) {\n    this.options = {\n      wasmPath: './wasm',\n      verbose: false,\n      maxInitRetries: 3,\n      maxConversionRetries: 2,\n      restartOnMemoryError: true,\n      ...options\n    };\n  }\n\n  private isMemoryError(error: string | Error): boolean {\n    const msg = error instanceof Error ? error.message : error;\n    return msg.includes('memory access out of bounds') ||\n           msg.includes('unreachable') ||\n           msg.includes('table index is out of bounds') ||\n           msg.includes('null function');\n  }\n\n  private async spawnWorker(): Promise<void> {\n    // Determine worker path\n    if (!this.workerPath) {\n      try {\n        const currentDir = dirname(fileURLToPath(import.meta.url));\n        // Check if running from src (development/test) or dist (production)\n        if (currentDir.endsWith('/src') || currentDir.endsWith('\\\\src')) {\n          // Running from source - worker is in dist/\n          this.workerPath = join(currentDir, '..', 'dist', 'subprocess.worker.cjs');\n        } else {\n          // Running from dist\n          this.workerPath = join(currentDir, 'subprocess.worker.cjs');\n        }\n      } catch {\n        this.workerPath = join(__dirname, 'subprocess.worker.cjs');\n      }\n    }\n\n    const wasmPath = resolve(this.options.wasmPath || './wasm');\n\n    this.child = fork(this.workerPath, [], {\n      env: { ...process.env, WASM_PATH: wasmPath, VERBOSE: String(this.options.verbose || false) },\n      stdio: ['pipe', 'pipe', 'pipe', 'ipc'],\n    });\n\n    this.child.stdout?.on('data', (d: Buffer) => { if (this.options.verbose) process.stdout.write(d); });\n    this.child.stderr?.on('data', (d: Buffer) => { if (this.options.verbose) process.stderr.write(d); });\n\n    this.child.on('message', (msg: WorkerMessage) => {\n      if (msg.type === 'response' && msg.id) {\n        const p = this.pending.get(msg.id);\n        if (p) {\n          this.pending.delete(msg.id);\n          msg.success ? p.resolve(msg.data) : p.reject(new ConversionError(ConversionErrorCode.CONVERSION_FAILED, msg.error || 'Error'));\n        }\n      }\n    });\n\n    this.child.on('error', (e) => {\n      for (const p of this.pending.values()) p.reject(e);\n      this.pending.clear();\n    });\n\n    this.child.on('exit', (code) => {\n      if (code !== 0) {\n        for (const p of this.pending.values()) p.reject(new Error(`Exit ${code}`));\n        this.pending.clear();\n      }\n      this.child = null;\n      this.initialized = false;\n    });\n\n    // Wait for ready signal (subprocess started)\n    await new Promise<void>((resolve, reject) => {\n      const t = setTimeout(() => reject(new Error('Subprocess start timeout')), 30000);\n      const h = (msg: WorkerMessage) => {\n        if (msg.type === 'ready') { clearTimeout(t); this.child?.off('message', h); resolve(); }\n        else if (msg.type === 'error') { clearTimeout(t); this.child?.off('message', h); reject(new Error(msg.error)); }\n      };\n      this.child?.on('message', h);\n    });\n\n    // Now send init message to start WASM loading\n    await this.send('init', undefined, 180000); // 3 minute timeout for WASM init\n  }\n\n  private killWorker(): void {\n    if (this.child) {\n      try { this.child.kill('SIGKILL'); } catch {}\n      this.child = null;\n    }\n    this.initialized = false;\n    this.pending.clear();\n  }\n\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n    if (this.initializing) {\n      while (this.initializing) await new Promise(r => setTimeout(r, 100));\n      return;\n    }\n    this.initializing = true;\n\n    const maxRetries = this.options.maxInitRetries || 3;\n    let lastError: Error | null = null;\n\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        await this.killWorker();\n        await this.spawnWorker();\n        this.initialized = true;\n        this.initializing = false;\n        this.options.onReady?.();\n        return;\n      } catch (e) {\n        lastError = e instanceof Error ? e : new Error(String(e));\n        if (this.options.verbose) {\n          console.error(`[SubprocessConverter] Init attempt ${attempt}/${maxRetries} failed:`, lastError.message);\n        }\n        await this.killWorker();\n\n        // Wait before retry\n        if (attempt < maxRetries) {\n          await new Promise(r => setTimeout(r, 500 * attempt));\n        }\n      }\n    }\n\n    this.initializing = false;\n    const err = new ConversionError(ConversionErrorCode.WASM_NOT_INITIALIZED, `Init failed after ${maxRetries} attempts: ${lastError?.message}`);\n    this.options.onError?.(err);\n    throw err;\n  }\n\n  private send(type: string, payload?: unknown, timeout: number = 300000): Promise<unknown> {\n    return new Promise((resolve, reject) => {\n      if (!this.child) { reject(new ConversionError(ConversionErrorCode.WASM_NOT_INITIALIZED, 'No process')); return; }\n      const id = randomUUID();\n      this.pending.set(id, { resolve, reject });\n      this.child.send({ type, id, payload });\n      setTimeout(() => {\n        if (this.pending.has(id)) {\n          this.pending.delete(id);\n          reject(new ConversionError(ConversionErrorCode.CONVERSION_FAILED, 'Timeout'));\n        }\n      }, timeout);\n    });\n  }\n\n  private normalizeInput(input: Uint8Array | ArrayBuffer | Buffer): Uint8Array {\n    if (input instanceof Uint8Array) {\n      return input;\n    }\n    if (input instanceof ArrayBuffer) {\n      return new Uint8Array(input);\n    }\n    return new Uint8Array(input);\n  }\n\n  async convert(input: Uint8Array | ArrayBuffer | Buffer, options: ConversionOptions, filename = 'document'): Promise<ConversionResult> {\n    if (!this.initialized || !this.child) throw new ConversionError(ConversionErrorCode.WASM_NOT_INITIALIZED, 'Not initialized');\n\n    const start = Date.now();\n    const data = this.normalizeInput(input);\n    if (data.length === 0) throw new ConversionError(ConversionErrorCode.INVALID_INPUT, 'Empty');\n\n    const ext = options.inputFormat || (filename.includes('.') ? filename.slice(filename.lastIndexOf('.') + 1).toLowerCase() : 'docx');\n    let filter = FORMAT_FILTER_OPTIONS[options.outputFormat] || '';\n    if (options.outputFormat === 'pdf' && options.pdf) {\n      const o: string[] = [];\n      if (options.pdf.pdfaLevel) o.push(`SelectPdfVersion=${{ 'PDF/A-1b': 1, 'PDF/A-2b': 2, 'PDF/A-3b': 3 }[options.pdf.pdfaLevel] || 0}`);\n      if (options.pdf.quality !== undefined) o.push(`Quality=${options.pdf.quality}`);\n      if (o.length) filter = o.join(',');\n    }\n\n    const maxRetries = this.options.maxConversionRetries || 2;\n    let lastError: Error | null = null;\n\n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        const r = await this.send('convert', {\n          inputData: Array.from(data),\n          inputExt: ext,\n          outputFormat: OUTPUT_FORMAT_TO_LOK[options.outputFormat],\n          filterOptions: filter\n        }) as number[];\n\n        const base = filename.includes('.') ? filename.slice(0, filename.lastIndexOf('.')) : filename;\n        return {\n          data: new Uint8Array(r),\n          mimeType: FORMAT_MIME_TYPES[options.outputFormat],\n          filename: `${base}.${options.outputFormat}`,\n          duration: Date.now() - start\n        };\n      } catch (e) {\n        lastError = e instanceof Error ? e : new Error(String(e));\n\n        if (this.options.verbose) {\n          console.error(`[SubprocessConverter] Conversion attempt ${attempt}/${maxRetries} failed:`, lastError.message);\n        }\n\n        // If it's a memory error and we should restart, do so\n        if (this.isMemoryError(lastError) && this.options.restartOnMemoryError && attempt < maxRetries) {\n          if (this.options.verbose) {\n            console.error('[SubprocessConverter] Memory error detected, restarting subprocess...');\n          }\n          await this.killWorker();\n          await this.spawnWorker();\n          this.initialized = true;\n        } else if (attempt < maxRetries) {\n          // Small delay before retry\n          await new Promise(r => setTimeout(r, 100));\n        }\n      }\n    }\n\n    throw lastError || new ConversionError(ConversionErrorCode.CONVERSION_FAILED, 'Conversion failed');\n  }\n\n  /**\n   * Get the number of pages in a document\n   */\n  async getPageCount(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<number> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.send('getPageCount', {\n      inputData: Array.from(inputData),\n      inputFormat: options.inputFormat\n    }) as Promise<number>;\n  }\n\n  /**\n   * Get document information including type and valid output formats\n   */\n  async getDocumentInfo(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<DocumentInfo> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.send('getDocumentInfo', {\n      inputData: Array.from(inputData),\n      inputFormat: options.inputFormat\n    }) as Promise<DocumentInfo>;\n  }\n\n  /**\n   * Render a single page as an image\n   */\n  async renderPage(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    width: number,\n    height = 0\n  ): Promise<PagePreview> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const result = await this.send('renderPage', {\n      inputData: Array.from(inputData),\n      inputFormat: options.inputFormat,\n      pageIndex,\n      width,\n      height,\n    }) as { data: number[]; width: number; height: number };\n\n    return {\n      page: pageIndex,\n      data: new Uint8Array(result.data),\n      width: result.width,\n      height: result.height,\n    };\n  }\n\n  /**\n   * Render multiple page previews\n   */\n  async renderPagePreviews(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    renderOptions: RenderOptions = {}\n  ): Promise<PagePreview[]> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const result = await this.send('renderPagePreviews', {\n      inputData: Array.from(inputData),\n      inputFormat: options.inputFormat,\n      width: renderOptions.width || 800,\n      height: renderOptions.height || 0,\n      pageIndices: renderOptions.pageIndices,\n    }) as Array<{ page: number; data: number[]; width: number; height: number }>;\n\n    return result.map((preview) => ({\n      page: preview.page,\n      data: new Uint8Array(preview.data),\n      width: preview.width,\n      height: preview.height,\n    }));\n  }\n\n  /**\n   * Render a page at full quality (native resolution based on DPI)\n   * @param input Document data\n   * @param options Must include inputFormat\n   * @param pageIndex Zero-based page index to render\n   * @param renderOptions DPI and max dimension settings\n   * @returns Full quality page preview with RGBA data and DPI info\n   */\n  async renderPageFullQuality(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions,\n    pageIndex: number,\n    renderOptions: FullQualityRenderOptions = {}\n  ): Promise<FullQualityPagePreview> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    const result = await this.send('renderPageFullQuality', {\n      inputData: Array.from(inputData),\n      inputFormat: options.inputFormat,\n      pageIndex,\n      dpi: renderOptions.dpi ?? 150,\n      maxDimension: renderOptions.maxDimension,\n      editMode: renderOptions.editMode ?? false,\n    }) as { page: number; data: number[]; width: number; height: number; dpi: number };\n\n    return {\n      page: result.page,\n      data: new Uint8Array(result.data),\n      width: result.width,\n      height: result.height,\n      dpi: result.dpi,\n    };\n  }\n\n  /**\n   * Extract text content from a document\n   */\n  async getDocumentText(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    inputFormat: string\n  ): Promise<string | null> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.send('getDocumentText', {\n      inputData: Array.from(inputData),\n      inputFormat\n    }) as Promise<string | null>;\n  }\n\n  /**\n   * Get page/slide names from a document\n   */\n  async getPageNames(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    inputFormat: string\n  ): Promise<string[]> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.send('getPageNames', {\n      inputData: Array.from(inputData),\n      inputFormat\n    }) as Promise<string[]>;\n  }\n\n  // ============================================\n  // Editor Operations\n  // ============================================\n\n  /**\n   * Open a document for editing\n   * Returns a session ID that can be used for subsequent editor operations\n   */\n  async openDocument(\n    input: Uint8Array | ArrayBuffer | Buffer,\n    options: InputFormatOptions\n  ): Promise<EditorSession> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const inputData = this.normalizeInput(input);\n    return this.send('openDocument', {\n      inputData: Array.from(inputData),\n      inputFormat: options.inputFormat\n    }) as Promise<EditorSession>;\n  }\n\n  /**\n   * Execute an editor operation on an open document session\n   * @param sessionId - The session ID from openDocument\n   * @param method - The editor method to call (e.g., 'insertParagraph', 'getStructure')\n   * @param args - Arguments to pass to the method\n   */\n  async editorOperation<T = unknown>(\n    sessionId: string,\n    method: string,\n    args?: unknown[]\n  ): Promise<EditorOperationResult<T>> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    return this.send('editorOperation', { sessionId, method, args: args ?? [] }) as Promise<EditorOperationResult<T>>;\n  }\n\n  /**\n   * Close an editor session and get the modified document\n   * @param sessionId - The session ID from openDocument\n   * @returns The modified document data, or undefined if save failed\n   */\n  async closeDocument(sessionId: string): Promise<Uint8Array | undefined> {\n    if (!this.initialized || !this.child) {\n      throw new ConversionError(\n        ConversionErrorCode.WASM_NOT_INITIALIZED,\n        'Converter not initialized. Call initialize() first.'\n      );\n    }\n\n    const result = await this.send('closeDocument', { sessionId }) as number[] | undefined;\n    return result ? new Uint8Array(result) : undefined;\n  }\n\n  async destroy(): Promise<void> {\n    if (this.child) {\n      // Send destroy message (child will exit after cleanup)\n      try { \n        await this.send('destroy'); \n      } catch {\n        // Child may have already exited, that's fine\n      }\n      \n      // Force kill if still running (child should have exited via process.exit)\n      if (this.child) {\n        try { \n          this.child.kill('SIGKILL'); \n        } catch {\n          // Already dead, that's fine\n        }\n        this.child = null;\n      }\n    }\n    this.initialized = false;\n    this.pending.clear();\n  }\n\n  isReady(): boolean { return this.initialized && this.child !== null; }\n}\n\nexport async function createSubprocessConverter(options: SubprocessConverterOptions = {}): Promise<SubprocessConverter> {\n  const c = new SubprocessConverter(options);\n  await c.initialize();\n  return c;\n}\n","/**\n * Image encoding utilities for converting raw RGBA pixel data to image formats.\n * Uses sharp when available for high performance, falls back to pure JS implementation.\n */\n\nimport { deflateSync } from 'zlib';\n\n/** Sharp function type for creating sharp instances */\ntype SharpFunction = (\n  input: Buffer | Uint8Array,\n  options?: { raw?: { width: number; height: number; channels: number } }\n) => SharpInstance;\n\n/** Sharp instance with chained methods */\ninterface SharpInstance {\n  png(options?: { compressionLevel?: number }): SharpInstance;\n  jpeg(options?: { quality?: number }): SharpInstance;\n  webp(options?: { quality?: number }): SharpInstance;\n  toBuffer(): Promise<Buffer>;\n}\n\n/** Cached sharp module (or null if not available) */\nlet sharpModule: SharpFunction | null | undefined = undefined;\n\n/**\n * Check if sharp is available\n */\nexport async function isSharpAvailable(): Promise<boolean> {\n  if (sharpModule === undefined) {\n    try {\n      // Dynamic import with type assertion\n      const mod = await import('sharp');\n      sharpModule = mod.default as unknown as SharpFunction;\n    } catch {\n      sharpModule = null;\n    }\n  }\n  return sharpModule !== null;\n}\n\n/**\n * Get the sharp module if available\n * @returns sharp function or null if not installed\n */\nexport async function getSharp(): Promise<SharpFunction | null> {\n  if (sharpModule === undefined) {\n    await isSharpAvailable();\n  }\n  return sharpModule ?? null;\n}\n\n/**\n * Image format options for encoding\n */\nexport interface ImageEncodeOptions {\n  /** Output format */\n  format: 'png' | 'jpeg' | 'webp';\n  /** Quality for lossy formats (1-100), default 90 */\n  quality?: number;\n  /** Compression level for PNG (0-9), default 6 */\n  compressionLevel?: number;\n}\n\n/**\n * Convert raw RGBA pixel data to an encoded image format.\n * Uses sharp when available for high performance, falls back to pure JS PNG encoder.\n *\n * @param rgbaData - Raw RGBA pixel data (4 bytes per pixel)\n * @param width - Image width in pixels\n * @param height - Image height in pixels\n * @param options - Encoding options (format, quality)\n * @returns Encoded image data as Buffer\n *\n * @example\n * ```typescript\n * import { encodeImage } from '@matbee/libreoffice-converter';\n *\n * const preview = await converter.renderPage(docBuffer, 'docx', 0, 800);\n * const pngBuffer = await encodeImage(preview.data, preview.width, preview.height, { format: 'png' });\n * fs.writeFileSync('page.png', pngBuffer);\n * ```\n */\nexport async function encodeImage(\n  rgbaData: Uint8Array,\n  width: number,\n  height: number,\n  options: ImageEncodeOptions = { format: 'png' }\n): Promise<Buffer> {\n  const sharp = await getSharp();\n\n  if (sharp) {\n    return encodeWithSharp(sharp, rgbaData, width, height, options);\n  }\n\n  // Fallback to pure JS implementation (PNG only)\n  if (options.format !== 'png') {\n    throw new Error(\n      `Format '${options.format}' requires sharp to be installed. ` +\n      `Install it with: npm install sharp`\n    );\n  }\n\n  return encodePngFallback(rgbaData, width, height);\n}\n\n/**\n * Encode image using sharp (high performance)\n */\nasync function encodeWithSharp(\n  sharp: SharpFunction,\n  rgbaData: Uint8Array,\n  width: number,\n  height: number,\n  options: ImageEncodeOptions\n): Promise<Buffer> {\n  let pipeline: SharpInstance = sharp(Buffer.from(rgbaData), {\n    raw: {\n      width,\n      height,\n      channels: 4,\n    },\n  });\n\n  switch (options.format) {\n    case 'png':\n      pipeline = pipeline.png({\n        compressionLevel: options.compressionLevel ?? 6,\n      });\n      break;\n    case 'jpeg':\n      pipeline = pipeline.jpeg({\n        quality: options.quality ?? 90,\n      });\n      break;\n    case 'webp':\n      pipeline = pipeline.webp({\n        quality: options.quality ?? 90,\n      });\n      break;\n  }\n\n  return pipeline.toBuffer();\n}\n\n/**\n * Pure JS PNG encoder (fallback when sharp is not available)\n * Creates a valid PNG file from raw RGBA data using zlib compression.\n */\nfunction encodePngFallback(\n  rgbaData: Uint8Array,\n  width: number,\n  height: number\n): Buffer {\n  // PNG signature\n  const signature = Buffer.from([137, 80, 78, 71, 13, 10, 26, 10]);\n\n  // CRC32 table (pre-computed)\n  const crcTable: number[] = new Array(256);\n  for (let n = 0; n < 256; n++) {\n    let c = n;\n    for (let k = 0; k < 8; k++) {\n      c = c & 1 ? 0xedb88320 ^ (c >>> 1) : c >>> 1;\n    }\n    crcTable[n] = c;\n  }\n\n  function crc32(data: Buffer): number {\n    let crc = 0xffffffff;\n    for (let i = 0; i < data.length; i++) {\n      const tableIndex = (crc ^ data[i]!) & 0xff;\n      crc = crcTable[tableIndex]! ^ (crc >>> 8);\n    }\n    return (crc ^ 0xffffffff) >>> 0;\n  }\n\n  function createChunk(type: string, data: Buffer): Buffer {\n    const typeBytes = Buffer.from(type);\n    const length = Buffer.alloc(4);\n    length.writeUInt32BE(data.length);\n    const crcData = Buffer.concat([typeBytes, data]);\n    const crcValue = Buffer.alloc(4);\n    crcValue.writeUInt32BE(crc32(crcData));\n    return Buffer.concat([length, typeBytes, data, crcValue]);\n  }\n\n  // IHDR chunk\n  const ihdr = Buffer.alloc(13);\n  ihdr.writeUInt32BE(width, 0);\n  ihdr.writeUInt32BE(height, 4);\n  ihdr[8] = 8; // bit depth\n  ihdr[9] = 6; // color type (RGBA)\n  ihdr[10] = 0; // compression\n  ihdr[11] = 0; // filter\n  ihdr[12] = 0; // interlace\n  const ihdrChunk = createChunk('IHDR', ihdr);\n\n  // IDAT chunk - raw image data with filter bytes\n  // Add filter byte (0 = none) at start of each row\n  const rowSize = 1 + width * 4;\n  const rawData = Buffer.alloc(height * rowSize);\n  for (let y = 0; y < height; y++) {\n    const rowOffset = y * rowSize;\n    rawData[rowOffset] = 0; // filter type: none\n    for (let x = 0; x < width; x++) {\n      const srcOffset = (y * width + x) * 4;\n      const dstOffset = rowOffset + 1 + x * 4;\n      rawData[dstOffset] = rgbaData[srcOffset] ?? 0; // R\n      rawData[dstOffset + 1] = rgbaData[srcOffset + 1] ?? 0; // G\n      rawData[dstOffset + 2] = rgbaData[srcOffset + 2] ?? 0; // B\n      rawData[dstOffset + 3] = rgbaData[srcOffset + 3] ?? 0; // A\n    }\n  }\n\n  // Compress with zlib\n  const compressed = deflateSync(rawData);\n  const idatChunk = createChunk('IDAT', compressed);\n\n  // IEND chunk\n  const iendChunk = createChunk('IEND', Buffer.alloc(0));\n\n  return Buffer.concat([signature, ihdrChunk, idatChunk, iendChunk]);\n}\n\n/**\n * Convenience function to encode RGBA data to PNG\n * @param rgbaData - Raw RGBA pixel data\n * @param width - Image width\n * @param height - Image height\n * @returns PNG encoded Buffer\n */\nexport async function rgbaToPng(\n  rgbaData: Uint8Array,\n  width: number,\n  height: number\n): Promise<Buffer> {\n  return encodeImage(rgbaData, width, height, { format: 'png' });\n}\n\n/**\n * Convenience function to encode RGBA data to JPEG (requires sharp)\n * @param rgbaData - Raw RGBA pixel data\n * @param width - Image width\n * @param height - Image height\n * @param quality - JPEG quality (1-100), default 90\n * @returns JPEG encoded Buffer\n */\nexport async function rgbaToJpeg(\n  rgbaData: Uint8Array,\n  width: number,\n  height: number,\n  quality = 90\n): Promise<Buffer> {\n  return encodeImage(rgbaData, width, height, { format: 'jpeg', quality });\n}\n\n/**\n * Convenience function to encode RGBA data to WebP (requires sharp)\n * @param rgbaData - Raw RGBA pixel data\n * @param width - Image width\n * @param height - Image height\n * @param quality - WebP quality (1-100), default 90\n * @returns WebP encoded Buffer\n */\nexport async function rgbaToWebp(\n  rgbaData: Uint8Array,\n  width: number,\n  height: number,\n  quality = 90\n): Promise<Buffer> {\n  return encodeImage(rgbaData, width, height, { format: 'webp', quality });\n}\n","// src/editor/base.ts\nimport type { LOKBindings } from '../lok-bindings.js';\nimport type { OutputFormat } from '../types.js';\nimport type {\n  OperationResult,\n  DocumentStructure,\n  OpenDocumentOptions,\n  SelectionRange,\n  FindOptions,\n  Position,\n  TruncationInfo,\n  CellRef,\n} from './types.js';\n\n/**\n * Abstract base class for all document editors\n */\nexport abstract class OfficeEditor {\n  protected lok: LOKBindings;\n  protected docPtr: number;\n  protected options: Required<Pick<OpenDocumentOptions, 'maxResponseChars'>> & OpenDocumentOptions;\n  protected inputPath: string = '';\n\n  constructor(lok: LOKBindings, docPtr: number, options: OpenDocumentOptions = {}) {\n    this.lok = lok;\n    this.docPtr = docPtr;\n    this.options = {\n      maxResponseChars: options.maxResponseChars ?? 8000,\n      ...options,\n    };\n  }\n\n  // ============================================\n  // Abstract methods (implemented by subclasses)\n  // ============================================\n\n  abstract getStructure(options?: { maxResponseChars?: number }): OperationResult<DocumentStructure>;\n  abstract getDocumentType(): 'writer' | 'calc' | 'impress' | 'draw';\n\n  // ============================================\n  // Accessor methods\n  // ============================================\n\n  /**\n   * Get the document pointer for low-level LOK operations\n   */\n  getDocPtr(): number {\n    return this.docPtr;\n  }\n\n  /**\n   * Get the LOK bindings for low-level operations\n   */\n  getLokBindings(): LOKBindings {\n    return this.lok;\n  }\n\n  // ============================================\n  // Lifecycle methods\n  // ============================================\n\n  save(): OperationResult<{ path: string }> {\n    try {\n      // Save to the original path\n      if (!this.inputPath) {\n        return this.createErrorResult('No input path set', 'Use saveAs() to specify a path');\n      }\n      // LibreOffice auto-saves on document operations, but we can force it\n      this.lok.postUnoCommand(this.docPtr, '.uno:Save');\n      return this.createResult({ path: this.inputPath });\n    } catch (error) {\n      return this.createErrorResult(`Save failed: ${String(error)}`);\n    }\n  }\n\n  saveAs(path: string, format: OutputFormat): OperationResult<{ path: string }> {\n    try {\n      this.lok.documentSaveAs(this.docPtr, path, format, '');\n      return this.createResult({ path });\n    } catch (error) {\n      return this.createErrorResult(`SaveAs failed: ${String(error)}`);\n    }\n  }\n\n  close(): OperationResult<void> {\n    try {\n      this.lok.documentDestroy(this.docPtr);\n      this.docPtr = 0;\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Close failed: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Get the current edit mode of the document\n   * @returns 0 = view mode, 1 = edit mode\n   */\n  getEditMode(): number {\n    return this.lok.getEditMode(this.docPtr);\n  }\n\n  /**\n   * Attempt to enable edit mode for the document\n   * @returns OperationResult with success and verified fields\n   */\n  enableEditMode(): OperationResult<{ editMode: number }> {\n    try {\n      const beforeMode = this.lok.getEditMode(this.docPtr);\n      if (beforeMode === 1) {\n        // Already in edit mode\n        return this.createResult({ editMode: 1 });\n      }\n\n      // Try .uno:Edit command to switch to edit mode\n      this.lok.postUnoCommand(this.docPtr, '.uno:Edit');\n\n      const afterMode = this.lok.getEditMode(this.docPtr);\n      return {\n        success: true,\n        verified: afterMode === 1,\n        data: { editMode: afterMode },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to enable edit mode: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // History methods\n  // ============================================\n\n  undo(): OperationResult<void> {\n    try {\n      this.lok.postUnoCommand(this.docPtr, '.uno:Undo');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Undo failed: ${String(error)}`);\n    }\n  }\n\n  redo(): OperationResult<void> {\n    try {\n      this.lok.postUnoCommand(this.docPtr, '.uno:Redo');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Redo failed: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Search methods\n  // ============================================\n\n  find(text: string, options?: FindOptions): OperationResult<{ matches: number; firstMatch?: Position }> {\n    try {\n      const searchArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: text },\n        'SearchItem.Backward': { type: 'boolean', value: false },\n        'SearchItem.SearchAll': { type: 'boolean', value: true },\n        'SearchItem.MatchCase': { type: 'boolean', value: options?.caseSensitive ?? false },\n        'SearchItem.WordOnly': { type: 'boolean', value: options?.wholeWord ?? false },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', searchArgs);\n\n      // Get search results - this is approximate as LOK doesn't return match count directly\n      const selection = this.lok.getTextSelection(this.docPtr, 'text/plain');\n      const hasMatch = selection !== null && selection.length > 0;\n\n      return this.createResult({\n        matches: hasMatch ? 1 : 0, // LOK doesn't provide count, we report if found\n        firstMatch: hasMatch ? { x: 0, y: 0 } : undefined,\n      });\n    } catch (error) {\n      return this.createErrorResult(`Find failed: ${String(error)}`);\n    }\n  }\n\n  findAndReplaceAll(find: string, replace: string, options?: FindOptions): OperationResult<{ replacements: number }> {\n    try {\n      const searchArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: find },\n        'SearchItem.ReplaceString': { type: 'string', value: replace },\n        'SearchItem.Command': { type: 'long', value: 3 }, // Replace All\n        'SearchItem.MatchCase': { type: 'boolean', value: options?.caseSensitive ?? false },\n        'SearchItem.WordOnly': { type: 'boolean', value: options?.wholeWord ?? false },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', searchArgs);\n\n      // LOK doesn't return replacement count, we assume success\n      return this.createResult({ replacements: -1 }); // -1 indicates unknown count\n    } catch (error) {\n      return this.createErrorResult(`Replace failed: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Callback-based state retrieval\n  // ============================================\n\n  /**\n   * Poll all STATE_CHANGED callback events and return as a map.\n   *\n   * LOK sends STATE_CHANGED events when formatting state changes (e.g., when\n   * the cursor moves over bold text, `.uno:Bold=true` is emitted).\n   *\n   * Pattern for getting current format state:\n   * 1. clearCallbackQueue() - clear any stale events\n   * 2. Perform action that triggers state change (e.g., SelectWord)\n   * 3. flushCallbacks(docPtr) - force LOK to process callbacks\n   * 4. pollStateChanges() - retrieve the events\n   *\n   * @returns Map of UNO command names to their state values\n   *          e.g., Map { '.uno:Bold' => 'true', '.uno:Italic' => 'false' }\n   */\n  getStateChanges(): OperationResult<Map<string, string>> {\n    try {\n      const states = this.lok.pollStateChanges();\n      return this.createResult(states);\n    } catch (error) {\n      return this.createErrorResult(`Failed to poll state changes: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Flush pending LOK callbacks and then poll for state changes.\n   * Convenience method that combines flushCallbacks + pollStateChanges.\n   *\n   * @returns Map of UNO command names to their state values\n   */\n  flushAndPollState(): OperationResult<Map<string, string>> {\n    try {\n      this.lok.flushCallbacks(this.docPtr);\n      const states = this.lok.pollStateChanges();\n      return this.createResult(states);\n    } catch (error) {\n      return this.createErrorResult(`Failed to flush and poll state: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Clear the callback queue, useful before performing operations\n   * where you want to capture only new state changes.\n   */\n  clearCallbackQueue(): void {\n    this.lok.clearCallbackQueue();\n  }\n\n  // ============================================\n  // Selection methods\n  // ============================================\n\n  select(_selection: SelectionRange): OperationResult<{ selected: string }> {\n    try {\n      // Implementation depends on selection type - subclasses may override\n      // Base implementation just returns current selection\n      const text = this.lok.getTextSelection(this.docPtr, 'text/plain');\n      return this.createResult({ selected: text || '' });\n    } catch (error) {\n      return this.createErrorResult(`Select failed: ${String(error)}`);\n    }\n  }\n\n  getSelection(): OperationResult<{ text: string; range: SelectionRange }> {\n    try {\n      const text = this.lok.getTextSelection(this.docPtr, 'text/plain');\n      return this.createResult({\n        text: text || '',\n        range: { type: 'text', start: { paragraph: 0, character: 0 } },\n      });\n    } catch (error) {\n      return this.createErrorResult(`GetSelection failed: ${String(error)}`);\n    }\n  }\n\n  clearSelection(): OperationResult<void> {\n    try {\n      this.lok.resetSelection(this.docPtr);\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`ClearSelection failed: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Protected helper methods\n  // ============================================\n\n  protected createResult<T>(data: T): OperationResult<T> {\n    return {\n      success: true,\n      verified: true,\n      data,\n    };\n  }\n\n  protected createErrorResult<T>(error: string, suggestion?: string): OperationResult<T> {\n    return {\n      success: false,\n      verified: false,\n      error,\n      suggestion,\n    };\n  }\n\n  protected createResultWithTruncation<T>(data: T, truncation?: TruncationInfo): OperationResult<T> {\n    return {\n      success: true,\n      verified: true,\n      data,\n      truncated: truncation,\n    };\n  }\n\n  protected truncateContent(content: string, maxChars?: number): {\n    content: string;\n    truncated: boolean;\n    original: number;\n    returned: number;\n  } {\n    const limit = maxChars ?? this.options.maxResponseChars;\n    const original = content.length;\n\n    if (original <= limit) {\n      return { content, truncated: false, original, returned: original };\n    }\n\n    // Truncate at a word boundary if possible\n    let truncated = content.slice(0, limit);\n    const lastSpace = truncated.lastIndexOf(' ');\n    if (lastSpace > limit * 0.8) {\n      truncated = truncated.slice(0, lastSpace);\n    }\n\n    return {\n      content: truncated,\n      truncated: true,\n      original,\n      returned: truncated.length,\n    };\n  }\n\n  protected truncateArray<T>(items: T[], maxChars: number, itemToString: (item: T) => string): {\n    items: T[];\n    truncated: boolean;\n    original: number;\n    returned: number;\n  } {\n    const original = items.length;\n    let charCount = 0;\n    let includedCount = 0;\n\n    for (const item of items) {\n      const itemStr = itemToString(item);\n      if (charCount + itemStr.length > maxChars) {\n        break;\n      }\n      charCount += itemStr.length;\n      includedCount++;\n    }\n\n    return {\n      items: items.slice(0, includedCount),\n      truncated: includedCount < original,\n      original,\n      returned: includedCount,\n    };\n  }\n\n  // ============================================\n  // Cell address helpers\n  // ============================================\n\n  protected a1ToRowCol(a1: string): { row: number; col: number } {\n    const match = a1.match(/^([A-Z]+)(\\d+)$/i);\n    if (!match) {\n      throw new Error(`Invalid A1 notation: ${a1}`);\n    }\n\n    const colStr = match[1]!.toUpperCase();\n    const rowStr = match[2]!;\n\n    let col = 0;\n    for (let i = 0; i < colStr.length; i++) {\n      col = col * 26 + (colStr.charCodeAt(i) - 64);\n    }\n    col -= 1; // 0-indexed\n\n    const row = parseInt(rowStr, 10) - 1; // 0-indexed\n\n    return { row, col };\n  }\n\n  protected rowColToA1(row: number, col: number): string {\n    let colStr = '';\n    let c = col + 1; // 1-indexed for conversion\n\n    while (c > 0) {\n      const remainder = (c - 1) % 26;\n      colStr = String.fromCharCode(65 + remainder) + colStr;\n      c = Math.floor((c - 1) / 26);\n    }\n\n    return `${colStr}${row + 1}`;\n  }\n\n  protected normalizeCellRef(ref: CellRef): { row: number; col: number } {\n    if (typeof ref === 'string') {\n      return this.a1ToRowCol(ref);\n    }\n    return ref;\n  }\n\n  // ============================================\n  // Internal state\n  // ============================================\n\n  setInputPath(path: string): void {\n    this.inputPath = path;\n  }\n\n  isOpen(): boolean {\n    return this.docPtr !== 0;\n  }\n}\n","// src/editor/writer.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  WriterStructure,\n  Paragraph,\n  TextPosition,\n  TextRange,\n  TextFormat,\n} from './types.js';\n\n/**\n * Editor for Writer (text) documents\n */\nexport class WriterEditor extends OfficeEditor {\n  private cachedParagraphs: string[] | null = null;\n\n  getDocumentType(): 'writer' {\n    return 'writer';\n  }\n\n  getStructure(options?: { maxResponseChars?: number }): OperationResult<WriterStructure> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n      const maxChars = options?.maxResponseChars ?? this.options.maxResponseChars;\n\n      const paragraphInfos = paragraphs.map((text, index) => ({\n        index,\n        preview: text.slice(0, 100) + (text.length > 100 ? '...' : ''),\n        style: 'Normal', // Would need UNO query to get actual style\n        charCount: text.length,\n      }));\n\n      // Truncate if needed\n      const truncResult = this.truncateArray(\n        paragraphInfos,\n        maxChars,\n        (p) => JSON.stringify(p)\n      );\n\n      const structure: WriterStructure = {\n        type: 'writer',\n        paragraphs: truncResult.items,\n        pageCount: this.lok.documentGetParts(this.docPtr),\n        wordCount: paragraphs.join(' ').split(/\\s+/).filter(w => w.length > 0).length,\n      };\n\n      if (truncResult.truncated) {\n        return this.createResultWithTruncation(structure, {\n          original: truncResult.original,\n          returned: truncResult.returned,\n          message: `Showing ${truncResult.returned} of ${truncResult.original} paragraphs. Use getParagraphs(start, count) to paginate.`,\n        });\n      }\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  getParagraph(index: number): OperationResult<Paragraph> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (index < 0 || index >= paragraphs.length) {\n        return this.createErrorResult(\n          `Paragraph index ${index} out of range (0-${paragraphs.length - 1})`,\n          `Use getStructure() to see available paragraphs`\n        );\n      }\n\n      const text = paragraphs[index]!;\n      return this.createResult({\n        index,\n        text,\n        style: 'Normal',\n        charCount: text.length,\n      });\n    } catch (error) {\n      return this.createErrorResult(`Failed to get paragraph: ${String(error)}`);\n    }\n  }\n\n  getParagraphs(start: number, count: number): OperationResult<Paragraph[]> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (start < 0 || start >= paragraphs.length) {\n        return this.createErrorResult(\n          `Start index ${start} out of range`,\n          `Valid range: 0-${paragraphs.length - 1}`\n        );\n      }\n\n      const end = Math.min(start + count, paragraphs.length);\n      const result = paragraphs.slice(start, end).map((text, i) => ({\n        index: start + i,\n        text,\n        style: 'Normal',\n        charCount: text.length,\n      }));\n\n      return this.createResult(result);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get paragraphs: ${String(error)}`);\n    }\n  }\n\n  insertParagraph(text: string, options?: {\n    afterIndex?: number;\n    style?: 'Normal' | 'Heading 1' | 'Heading 2' | 'Heading 3' | 'List';\n  }): OperationResult<{ index: number }> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n      const insertIndex = options?.afterIndex !== undefined\n        ? options.afterIndex + 1\n        : paragraphs.length;\n\n      // Move to end of target paragraph or document end\n      if (insertIndex > 0 && insertIndex <= paragraphs.length) {\n        // Navigate to position\n        this.lok.postUnoCommand(this.docPtr, '.uno:GoToEndOfDoc');\n      }\n\n      // Insert paragraph break and text\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertPara');\n\n      // Insert the text\n      const textArgs = JSON.stringify({\n        Text: { type: 'string', value: text },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', textArgs);\n\n      // Apply style if specified\n      if (options?.style && options.style !== 'Normal') {\n        const styleMap: Record<string, string> = {\n          'Heading 1': 'Heading 1',\n          'Heading 2': 'Heading 2',\n          'Heading 3': 'Heading 3',\n          'List': 'List',\n        };\n        const styleName = styleMap[options.style];\n        if (styleName) {\n          const styleArgs = JSON.stringify({\n            Template: { type: 'string', value: styleName },\n            Family: { type: 'short', value: 2 }, // Paragraph styles\n          });\n          this.lok.postUnoCommand(this.docPtr, '.uno:StyleApply', styleArgs);\n        }\n      }\n\n      // Invalidate cache\n      this.cachedParagraphs = null;\n\n      // Verify by re-reading\n      const newParagraphs = this.getParagraphsInternal();\n      const verified = newParagraphs.length > paragraphs.length;\n\n      return {\n        success: true,\n        verified,\n        data: { index: insertIndex },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert paragraph: ${String(error)}`);\n    }\n  }\n\n  replaceParagraph(index: number, text: string): OperationResult<{ oldText: string }> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (index < 0 || index >= paragraphs.length) {\n        return this.createErrorResult(\n          `Paragraph index ${index} out of range`,\n          `Valid range: 0-${paragraphs.length - 1}`\n        );\n      }\n\n      const oldText = paragraphs[index]!;\n\n      // Select the paragraph and replace\n      // This is a simplified implementation - full implementation would use cursor positioning\n      const findReplaceArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: oldText },\n        'SearchItem.ReplaceString': { type: 'string', value: text },\n        'SearchItem.Command': { type: 'long', value: 2 }, // Replace\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', findReplaceArgs);\n\n      // Invalidate cache\n      this.cachedParagraphs = null;\n\n      return this.createResult({ oldText });\n    } catch (error) {\n      return this.createErrorResult(`Failed to replace paragraph: ${String(error)}`);\n    }\n  }\n\n  deleteParagraph(index: number): OperationResult<{ deletedText: string }> {\n    try {\n      const paragraphs = this.getParagraphsInternal();\n\n      if (index < 0 || index >= paragraphs.length) {\n        return this.createErrorResult(\n          `Paragraph index ${index} out of range`,\n          `Valid range: 0-${paragraphs.length - 1}`\n        );\n      }\n\n      const deletedText = paragraphs[index]!;\n\n      // Replace with empty string\n      const result = this.replaceParagraph(index, '');\n      if (!result.success) {\n        return this.createErrorResult(result.error || 'Failed to delete');\n      }\n\n      return this.createResult({ deletedText });\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete paragraph: ${String(error)}`);\n    }\n  }\n\n  insertText(text: string, _position: TextPosition): OperationResult<void> {\n    try {\n      // TODO: Navigate to position using cursor before inserting\n      const textArgs = JSON.stringify({\n        Text: { type: 'string', value: text },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', textArgs);\n\n      this.cachedParagraphs = null;\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert text: ${String(error)}`);\n    }\n  }\n\n  deleteText(_start: TextPosition, _end: TextPosition): OperationResult<{ deleted: string }> {\n    try {\n      // TODO: Use start/end to select text range before deleting\n      // Get current selection\n      const selection = this.lok.getTextSelection(this.docPtr, 'text/plain');\n\n      // Delete selection\n      this.lok.postUnoCommand(this.docPtr, '.uno:Delete');\n\n      this.cachedParagraphs = null;\n      return this.createResult({ deleted: selection || '' });\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete text: ${String(error)}`);\n    }\n  }\n\n  replaceText(find: string, replace: string, options?: {\n    paragraph?: number;\n    all?: boolean;\n  }): OperationResult<{ replacements: number }> {\n    try {\n      const command = options?.all ? 3 : 2; // 3 = Replace All, 2 = Replace\n\n      const searchArgs = JSON.stringify({\n        'SearchItem.SearchString': { type: 'string', value: find },\n        'SearchItem.ReplaceString': { type: 'string', value: replace },\n        'SearchItem.Command': { type: 'long', value: command },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ExecuteSearch', searchArgs);\n\n      this.cachedParagraphs = null;\n\n      // LOK doesn't return count, we indicate success\n      return this.createResult({ replacements: -1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to replace text: ${String(error)}`);\n    }\n  }\n\n  formatText(_range: TextRange, format: TextFormat): OperationResult<void> {\n    try {\n      // TODO: Use range to select text before applying format\n      // Apply formatting commands\n      if (format.bold !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Bold');\n      }\n      if (format.italic !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Italic');\n      }\n      if (format.underline !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Underline');\n      }\n      if (format.fontSize !== undefined) {\n        const args = JSON.stringify({\n          FontHeight: { type: 'float', value: format.fontSize },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:FontHeight', args);\n      }\n      if (format.fontName !== undefined) {\n        const args = JSON.stringify({\n          CharFontName: { type: 'string', value: format.fontName },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:CharFontName', args);\n      }\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to format text: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Get the text formatting at the current selection or cursor position.\n   *\n   * Uses LOK callback mechanism to retrieve STATE_CHANGED events which contain\n   * formatting state like `.uno:Bold=true`, `.uno:Italic=false`, etc.\n   *\n   * @param _position - Text position (currently unused, uses current selection)\n   * @returns TextFormat with bold, italic, underline, fontSize, fontName properties\n   */\n  getFormat(_position?: TextPosition): OperationResult<TextFormat> {\n    try {\n      // Clear any existing callback events\n      this.lok.clearCallbackQueue();\n\n      // Trigger a selection change to get current formatting state\n      // Moving cursor slightly and back triggers STATE_CHANGED callbacks\n      this.lok.postUnoCommand(this.docPtr, '.uno:CharRightSel');\n      this.lok.flushCallbacks(this.docPtr);\n      this.lok.postUnoCommand(this.docPtr, '.uno:CharLeft');\n      this.lok.flushCallbacks(this.docPtr);\n\n      // Poll STATE_CHANGED events to get formatting state\n      const states = this.lok.pollStateChanges();\n\n      // Parse the state values into TextFormat\n      const format: TextFormat = {};\n\n      // Bold: .uno:Bold=true or .uno:Bold=false\n      const boldState = states.get('.uno:Bold');\n      if (boldState !== undefined) {\n        format.bold = boldState === 'true';\n      }\n\n      // Italic: .uno:Italic=true or .uno:Italic=false\n      const italicState = states.get('.uno:Italic');\n      if (italicState !== undefined) {\n        format.italic = italicState === 'true';\n      }\n\n      // Underline: .uno:Underline=true or .uno:Underline=false\n      const underlineState = states.get('.uno:Underline');\n      if (underlineState !== undefined) {\n        format.underline = underlineState === 'true';\n      }\n\n      // Font size: .uno:FontHeight=12\n      const fontSizeState = states.get('.uno:FontHeight');\n      if (fontSizeState !== undefined) {\n        const size = parseFloat(fontSizeState);\n        if (!isNaN(size)) {\n          format.fontSize = size;\n        }\n      }\n\n      // Font name: .uno:CharFontName=Arial\n      const fontNameState = states.get('.uno:CharFontName');\n      if (fontNameState !== undefined && fontNameState.length > 0) {\n        format.fontName = fontNameState;\n      }\n\n      return this.createResult(format);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get format: ${String(error)}`);\n    }\n  }\n\n  /**\n   * Get formatting state for the current selection using the callback mechanism.\n   * This is the preferred way to get character formatting as it uses LOK's\n   * STATE_CHANGED callback events.\n   *\n   * @returns Map of UNO command names to their state values\n   */\n  getSelectionFormat(): OperationResult<Map<string, string>> {\n    try {\n      // Poll any existing STATE_CHANGED events (from previous operations)\n      const existingStates = this.lok.pollStateChanges();\n\n      if (existingStates.size === 0) {\n        // No existing states, trigger a selection to get current format\n        this.lok.clearCallbackQueue();\n        this.lok.postUnoCommand(this.docPtr, '.uno:SelectWord');\n        this.lok.flushCallbacks(this.docPtr);\n        const states = this.lok.pollStateChanges();\n        return this.createResult(states);\n      }\n\n      return this.createResult(existingStates);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get selection format: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private getParagraphsInternal(): string[] {\n    if (this.cachedParagraphs) {\n      return this.cachedParagraphs;\n    }\n\n    const allText = this.lok.getAllText(this.docPtr);\n    if (!allText) {\n      return [];\n    }\n\n    // Split by double newlines (paragraph breaks) or single newlines\n    this.cachedParagraphs = allText\n      .split(/\\n\\n|\\r\\n\\r\\n/)\n      .map(p => p.trim())\n      .filter(p => p.length > 0);\n\n    return this.cachedParagraphs;\n  }\n}\n","// src/editor/calc.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  CalcStructure,\n  CellRef,\n  RangeRef,\n  SheetRef,\n  ColRef,\n  CellData,\n  CellValue,\n  CellFormat,\n  SheetInfo,\n} from './types.js';\n\n/**\n * Editor for Calc (spreadsheet) documents\n */\nexport class CalcEditor extends OfficeEditor {\n  getDocumentType(): 'calc' {\n    return 'calc';\n  }\n\n  getStructure(_options?: { maxResponseChars?: number }): OperationResult<CalcStructure> {\n    try {\n      const numSheets = this.lok.documentGetParts(this.docPtr);\n      const sheets: SheetInfo[] = [];\n\n      for (let i = 0; i < numSheets; i++) {\n        const name = this.lok.getPartName(this.docPtr, i) || `Sheet${i + 1}`;\n        const dataArea = this.lok.getDataArea(this.docPtr, i);\n\n        sheets.push({\n          index: i,\n          name,\n          usedRange: dataArea.col > 0 && dataArea.row > 0\n            ? `A1:${this.rowColToA1(dataArea.row - 1, dataArea.col - 1)}`\n            : 'A1',\n          rowCount: dataArea.row,\n          colCount: dataArea.col,\n        });\n      }\n\n      const structure: CalcStructure = {\n        type: 'calc',\n        sheets,\n      };\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  getSheetNames(): OperationResult<string[]> {\n    try {\n      const numSheets = this.lok.documentGetParts(this.docPtr);\n      const names: string[] = [];\n\n      for (let i = 0; i < numSheets; i++) {\n        const name = this.lok.getPartName(this.docPtr, i) || `Sheet${i + 1}`;\n        names.push(name);\n      }\n\n      return this.createResult(names);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get sheet names: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Cell reading\n  // ============================================\n\n  getCell(cell: CellRef, sheet?: SheetRef): OperationResult<CellData> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      // Navigate to cell\n      this.goToCell(address);\n\n      // Get value\n      const value = this.getCellValueInternal();\n      const formula = this.getCellFormulaInternal();\n\n      return this.createResult({\n        address,\n        value,\n        formula: formula || undefined,\n      });\n    } catch (error) {\n      return this.createErrorResult(`Failed to get cell: ${String(error)}`);\n    }\n  }\n\n  getCells(range: RangeRef, sheet?: SheetRef, options?: {\n    maxResponseChars?: number;\n  }): OperationResult<CellData[][]> {\n    try {\n      this.selectSheet(sheet);\n      const { startRow, startCol, endRow, endCol } = this.normalizeRangeRef(range);\n      const maxChars = options?.maxResponseChars ?? this.options.maxResponseChars;\n\n      const cells: CellData[][] = [];\n      let charCount = 0;\n      let truncated = false;\n\n      for (let r = startRow; r <= endRow && !truncated; r++) {\n        const rowData: CellData[] = [];\n\n        for (let c = startCol; c <= endCol && !truncated; c++) {\n          const address = this.rowColToA1(r, c);\n          this.goToCell(address);\n\n          const value = this.getCellValueInternal();\n          const cellData: CellData = { address, value };\n\n          const cellStr = JSON.stringify(cellData);\n          if (charCount + cellStr.length > maxChars) {\n            truncated = true;\n            break;\n          }\n\n          charCount += cellStr.length;\n          rowData.push(cellData);\n        }\n\n        if (rowData.length > 0) {\n          cells.push(rowData);\n        }\n      }\n\n      if (truncated) {\n        return this.createResultWithTruncation(cells, {\n          original: (endRow - startRow + 1) * (endCol - startCol + 1),\n          returned: cells.reduce((sum, row) => sum + row.length, 0),\n          message: 'Range truncated due to size. Use smaller ranges to paginate.',\n        });\n      }\n\n      return this.createResult(cells);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get cells: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Cell writing\n  // ============================================\n\n  setCellValue(cell: CellRef, value: string | number, sheet?: SheetRef): OperationResult<{\n    oldValue: CellValue;\n    newValue: CellValue;\n  }> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      // Get old value first\n      this.goToCell(address);\n      const oldValue = this.getCellValueInternal();\n\n      // Enter the new value\n      const valueStr = typeof value === 'number' ? value.toString() : value;\n      const args = JSON.stringify({\n        StringName: { type: 'string', value: valueStr },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:EnterString', args);\n\n      // Verify by re-reading the cell\n      const newValue = this.getCellValueInternal();\n      const expectedStr = typeof value === 'number' ? value.toString() : value;\n      const verified = newValue === expectedStr || newValue === value;\n\n      return {\n        success: true,\n        verified,\n        data: { oldValue, newValue },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to set cell value: ${String(error)}`);\n    }\n  }\n\n  setCellFormula(cell: CellRef, formula: string, sheet?: SheetRef): OperationResult<{\n    calculatedValue: CellValue;\n  }> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      // Navigate and enter formula\n      this.goToCell(address);\n\n      const args = JSON.stringify({\n        StringName: { type: 'string', value: formula },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:EnterString', args);\n\n      // Get calculated value\n      const calculatedValue = this.getCellValueInternal();\n\n      return this.createResult({ calculatedValue });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set formula: ${String(error)}`);\n    }\n  }\n\n  setCells(range: RangeRef, values: CellValue[][], sheet?: SheetRef): OperationResult<{\n    cellsUpdated: number;\n  }> {\n    try {\n      this.selectSheet(sheet);\n      const { startRow, startCol } = this.normalizeRangeRef(range);\n      let cellsUpdated = 0;\n\n      for (let r = 0; r < values.length; r++) {\n        const rowValues = values[r];\n        if (!rowValues) continue;\n\n        for (let c = 0; c < rowValues.length; c++) {\n          const value = rowValues[c];\n          if (value === null || value === undefined) continue;\n\n          const address = this.rowColToA1(startRow + r, startCol + c);\n          this.goToCell(address);\n\n          const valueStr = typeof value === 'number' ? value.toString() : String(value);\n          const args = JSON.stringify({\n            StringName: { type: 'string', value: valueStr },\n          });\n          this.lok.postUnoCommand(this.docPtr, '.uno:EnterString', args);\n          cellsUpdated++;\n        }\n      }\n\n      return this.createResult({ cellsUpdated });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set cells: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Clear operations\n  // ============================================\n\n  clearCell(cell: CellRef, sheet?: SheetRef): OperationResult<{ oldValue: CellValue }> {\n    try {\n      this.selectSheet(sheet);\n      const { row, col } = this.normalizeCellRef(cell);\n      const address = this.rowColToA1(row, col);\n\n      this.goToCell(address);\n      const oldValue = this.getCellValueInternal();\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:ClearContents');\n\n      return this.createResult({ oldValue });\n    } catch (error) {\n      return this.createErrorResult(`Failed to clear cell: ${String(error)}`);\n    }\n  }\n\n  clearRange(range: RangeRef, sheet?: SheetRef): OperationResult<{ cellsCleared: number }> {\n    try {\n      this.selectSheet(sheet);\n      const rangeStr = this.normalizeRangeToString(range);\n\n      // Select range and clear\n      this.goToCell(rangeStr);\n      this.lok.postUnoCommand(this.docPtr, '.uno:ClearContents');\n\n      // Count is approximate\n      const { startRow, startCol, endRow, endCol } = this.normalizeRangeRef(range);\n      const cellsCleared = (endRow - startRow + 1) * (endCol - startCol + 1);\n\n      return this.createResult({ cellsCleared });\n    } catch (error) {\n      return this.createErrorResult(`Failed to clear range: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Row/Column operations\n  // ============================================\n\n  insertRow(afterRow: number, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      this.goToCell(this.rowColToA1(afterRow + 1, 0));\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertRows');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert row: ${String(error)}`);\n    }\n  }\n\n  insertColumn(afterCol: ColRef, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const colNum = typeof afterCol === 'string'\n        ? this.a1ToRowCol(afterCol + '1').col + 1\n        : afterCol + 1;\n\n      this.goToCell(this.rowColToA1(0, colNum));\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertColumns');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to insert column: ${String(error)}`);\n    }\n  }\n\n  deleteRow(row: number, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      this.goToCell(this.rowColToA1(row, 0));\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeleteRows');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete row: ${String(error)}`);\n    }\n  }\n\n  deleteColumn(col: ColRef, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const colNum = typeof col === 'string'\n        ? this.a1ToRowCol(col + '1').col\n        : col;\n\n      this.goToCell(this.rowColToA1(0, colNum));\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeleteColumns');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete column: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Formatting\n  // ============================================\n\n  formatCells(range: RangeRef, format: CellFormat, sheet?: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const rangeStr = this.normalizeRangeToString(range);\n      this.goToCell(rangeStr);\n\n      if (format.bold !== undefined) {\n        this.lok.postUnoCommand(this.docPtr, '.uno:Bold');\n      }\n      if (format.numberFormat !== undefined) {\n        const args = JSON.stringify({\n          NumberFormatValue: { type: 'string', value: format.numberFormat },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:NumberFormatValue', args);\n      }\n      if (format.backgroundColor !== undefined) {\n        const args = JSON.stringify({\n          BackgroundColor: { type: 'long', value: this.hexToNumber(format.backgroundColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:BackgroundColor', args);\n      }\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to format cells: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Sheet management\n  // ============================================\n\n  addSheet(name: string): OperationResult<{ index: number }> {\n    try {\n      const args = JSON.stringify({\n        Name: { type: 'string', value: name },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:Insert', args);\n\n      const numSheets = this.lok.documentGetParts(this.docPtr);\n      return this.createResult({ index: numSheets - 1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add sheet: ${String(error)}`);\n    }\n  }\n\n  renameSheet(sheet: SheetRef, newName: string): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      const args = JSON.stringify({\n        Name: { type: 'string', value: newName },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:RenameTable', args);\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to rename sheet: ${String(error)}`);\n    }\n  }\n\n  deleteSheet(sheet: SheetRef): OperationResult<void> {\n    try {\n      this.selectSheet(sheet);\n      this.lok.postUnoCommand(this.docPtr, '.uno:Remove');\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete sheet: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private selectSheet(sheet?: SheetRef): void {\n    if (sheet === undefined) return;\n\n    const index = typeof sheet === 'number'\n      ? sheet\n      : this.getSheetIndexByName(sheet);\n\n    if (index >= 0) {\n      this.lok.documentSetPart(this.docPtr, index);\n    }\n  }\n\n  private getSheetIndexByName(name: string): number {\n    const numSheets = this.lok.documentGetParts(this.docPtr);\n    for (let i = 0; i < numSheets; i++) {\n      if (this.lok.getPartName(this.docPtr, i) === name) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  private goToCell(address: string): void {\n    const args = JSON.stringify({\n      ToPoint: { type: 'string', value: address },\n    });\n    this.lok.postUnoCommand(this.docPtr, '.uno:GoToCell', args);\n  }\n\n  private getCellValueInternal(): CellValue {\n    const text = this.lok.getTextSelection(this.docPtr, 'text/plain');\n    if (!text) return null;\n\n    // Try to parse as number\n    const num = parseFloat(text);\n    if (!isNaN(num) && text.trim() === num.toString()) {\n      return num;\n    }\n\n    // Check for boolean\n    if (text.toLowerCase() === 'true') return true;\n    if (text.toLowerCase() === 'false') return false;\n\n    return text;\n  }\n\n  private getCellFormulaInternal(): string | null {\n    const result = this.lok.getCommandValues(this.docPtr, '.uno:GetFormulaBarText');\n    if (!result) return null;\n\n    try {\n      const parsed = JSON.parse(result) as { value?: string };\n      return parsed.value ?? null;\n    } catch {\n      return null;\n    }\n  }\n\n  private normalizeRangeRef(range: RangeRef): {\n    startRow: number;\n    startCol: number;\n    endRow: number;\n    endCol: number;\n  } {\n    if (typeof range === 'string') {\n      const parts = range.split(':');\n      const start = this.a1ToRowCol(parts[0]!);\n      const end = parts[1] ? this.a1ToRowCol(parts[1]) : start;\n      return {\n        startRow: start.row,\n        startCol: start.col,\n        endRow: end.row,\n        endCol: end.col,\n      };\n    }\n\n    const start = this.normalizeCellRef(range.start);\n    const end = this.normalizeCellRef(range.end);\n    return {\n      startRow: start.row,\n      startCol: start.col,\n      endRow: end.row,\n      endCol: end.col,\n    };\n  }\n\n  private normalizeRangeToString(range: RangeRef): string {\n    if (typeof range === 'string') return range;\n\n    const start = this.normalizeCellRef(range.start);\n    const end = this.normalizeCellRef(range.end);\n    return `${this.rowColToA1(start.row, start.col)}:${this.rowColToA1(end.row, end.col)}`;\n  }\n\n  private hexToNumber(hex: string): number {\n    return parseInt(hex.replace('#', ''), 16);\n  }\n}\n","// src/editor/impress.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  ImpressStructure,\n  SlideData,\n  SlideInfo,\n  SlideLayout,\n  TextFrame,\n} from './types.js';\n\n/**\n * Editor for Impress (presentation) documents\n */\nexport class ImpressEditor extends OfficeEditor {\n  getDocumentType(): 'impress' {\n    return 'impress';\n  }\n\n  getStructure(_options?: { maxResponseChars?: number }): OperationResult<ImpressStructure> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n      const slides: SlideInfo[] = [];\n\n      for (let i = 0; i < numSlides; i++) {\n        const slideData = this.getSlideInfoInternal(i);\n        slides.push(slideData);\n      }\n\n      const structure: ImpressStructure = {\n        type: 'impress',\n        slides,\n        slideCount: numSlides,\n      };\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide reading\n  // ============================================\n\n  getSlide(index: number): OperationResult<SlideData> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide index: ${index}. Valid range: 0-${numSlides - 1}`,\n          'Use getStructure() to see available slides'\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      const text = this.lok.getAllText(this.docPtr) || '';\n      const textFrames = this.parseTextFrames(text);\n\n      const slideData: SlideData = {\n        index,\n        title: textFrames.find(f => f.type === 'title')?.text,\n        textFrames,\n        hasNotes: false, // Could detect from LOK if available\n      };\n\n      return this.createResult(slideData);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get slide: ${String(error)}`);\n    }\n  }\n\n  getSlideCount(): OperationResult<number> {\n    try {\n      const count = this.lok.documentGetParts(this.docPtr);\n      return this.createResult(count);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get slide count: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide management\n  // ============================================\n\n  addSlide(options?: { afterSlide?: number; layout?: SlideLayout }): OperationResult<{ index: number }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      // Navigate to position if specified\n      if (options?.afterSlide !== undefined) {\n        this.lok.documentSetPart(this.docPtr, options.afterSlide);\n      } else {\n        // Go to last slide\n        this.lok.documentSetPart(this.docPtr, numSlides - 1);\n      }\n\n      // Insert new slide\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertPage');\n\n      // Apply layout if specified\n      if (options?.layout) {\n        this.applySlideLayout(options.layout);\n      }\n\n      const newIndex = options?.afterSlide !== undefined\n        ? options.afterSlide + 1\n        : numSlides;\n\n      // Verify by checking slide count increased\n      const newNumSlides = this.lok.documentGetParts(this.docPtr);\n      const verified = newNumSlides > numSlides;\n\n      return {\n        success: true,\n        verified,\n        data: { index: newIndex },\n      };\n    } catch (error) {\n      return this.createErrorResult(`Failed to add slide: ${String(error)}`);\n    }\n  }\n\n  deleteSlide(index: number): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (numSlides <= 1) {\n        return this.createErrorResult(\n          'Cannot delete the last slide',\n          'A presentation must have at least one slide'\n        );\n      }\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide index: ${index}`,\n          `Valid range: 0-${numSlides - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeletePage');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete slide: ${String(error)}`);\n    }\n  }\n\n  duplicateSlide(index: number): OperationResult<{ newIndex: number }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide index: ${index}`,\n          `Valid range: 0-${numSlides - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DuplicatePage');\n\n      return this.createResult({ newIndex: index + 1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to duplicate slide: ${String(error)}`);\n    }\n  }\n\n  moveSlide(fromIndex: number, toIndex: number): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (fromIndex < 0 || fromIndex >= numSlides || toIndex < 0 || toIndex >= numSlides) {\n        return this.createErrorResult(\n          `Invalid slide indices. Valid range: 0-${numSlides - 1}`,\n          'Check slide indices are within bounds'\n        );\n      }\n\n      if (fromIndex === toIndex) {\n        return this.createErrorResult(\n          'Source and destination are the same',\n          'Provide different indices to move'\n        );\n      }\n\n      // LOK doesn't have direct slide move - we simulate via cut/paste\n      this.lok.documentSetPart(this.docPtr, fromIndex);\n\n      const args = JSON.stringify({\n        Position: { type: 'long', value: toIndex },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:MovePageFirst', args);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to move slide: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide content editing\n  // ============================================\n\n  setSlideTitle(index: number, title: string): OperationResult<{ oldTitle?: string }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n\n      // Get current title\n      const text = this.lok.getAllText(this.docPtr) || '';\n      const frames = this.parseTextFrames(text);\n      const oldTitle = frames.find(f => f.type === 'title')?.text;\n\n      // Select title placeholder and replace\n      this.lok.postUnoCommand(this.docPtr, '.uno:SelectAll');\n\n      // Enter title text (this replaces first text frame typically)\n      const args = JSON.stringify({\n        Text: { type: 'string', value: title },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      return this.createResult({ oldTitle });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide title: ${String(error)}`);\n    }\n  }\n\n  setSlideBody(index: number, body: string): OperationResult<{ oldBody?: string }> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n\n      // Get current body\n      const text = this.lok.getAllText(this.docPtr) || '';\n      const frames = this.parseTextFrames(text);\n      const oldBody = frames.find(f => f.type === 'body')?.text;\n\n      // Navigate to body and replace\n      // Using Tab to move from title to body placeholder\n      this.lok.postUnoCommand(this.docPtr, '.uno:NextObject');\n\n      const args = JSON.stringify({\n        Text: { type: 'string', value: body },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      return this.createResult({ oldBody });\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide body: ${String(error)}`);\n    }\n  }\n\n  setSlideNotes(index: number, notes: string): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n\n      // Switch to notes view and insert text\n      this.lok.postUnoCommand(this.docPtr, '.uno:NotesMode');\n\n      const args = JSON.stringify({\n        Text: { type: 'string', value: notes },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      // Switch back to normal view\n      this.lok.postUnoCommand(this.docPtr, '.uno:NormalViewMode');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide notes: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Slide layout\n  // ============================================\n\n  setSlideLayout(index: number, layout: SlideLayout): OperationResult<void> {\n    try {\n      const numSlides = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numSlides) {\n        return this.createErrorResult(`Invalid slide index: ${index}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.applySlideLayout(layout);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to set slide layout: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private getSlideInfoInternal(index: number): SlideInfo {\n    this.lok.documentSetPart(this.docPtr, index);\n\n    const text = this.lok.getAllText(this.docPtr) || '';\n    const frames = this.parseTextFrames(text);\n    const titleFrame = frames.find(f => f.type === 'title');\n\n    return {\n      index,\n      title: titleFrame?.text,\n      layout: this.detectLayout(frames),\n      textFrameCount: frames.length,\n    };\n  }\n\n  private parseTextFrames(text: string): TextFrame[] {\n    // Parse text content into frames\n    // In Impress, text is typically separated by paragraph breaks\n    const paragraphs = text.split(/\\n\\n+/).filter(p => p.trim());\n    const frames: TextFrame[] = [];\n\n    paragraphs.forEach((para, idx) => {\n      const type = idx === 0 ? 'title' : (idx === 1 ? 'body' : 'other');\n      frames.push({\n        index: idx,\n        type: type as TextFrame['type'],\n        text: para.trim(),\n        bounds: { x: 0, y: 0, width: 0, height: 0 }, // Would need LOK API for actual bounds\n      });\n    });\n\n    return frames;\n  }\n\n  private detectLayout(frames: TextFrame[]): SlideLayout {\n    if (frames.length === 0) return 'blank';\n    if (frames.length === 1 && frames[0]?.type === 'title') return 'title';\n    if (frames.length >= 2) return 'titleContent';\n    return 'blank';\n  }\n\n  private applySlideLayout(layout: SlideLayout): void {\n    // Map layout names to LOK layout IDs\n    const layoutMap: Record<SlideLayout, number> = {\n      blank: 0,\n      title: 1,\n      titleContent: 2,\n      twoColumn: 3,\n    };\n\n    const layoutId = layoutMap[layout] ?? 0;\n    const args = JSON.stringify({\n      WhatLayout: { type: 'long', value: layoutId },\n    });\n    this.lok.postUnoCommand(this.docPtr, '.uno:AssignLayout', args);\n  }\n}\n","// src/editor/draw.ts\nimport { OfficeEditor } from './base.js';\nimport type {\n  OperationResult,\n  DrawStructure,\n  PageData,\n  PageInfo,\n  ShapeData,\n  ShapeType,\n  Rectangle,\n  Size,\n  Position,\n} from './types.js';\n\n/**\n * Editor for Draw (vector graphics) documents\n * Also handles imported PDFs opened for editing\n */\nexport class DrawEditor extends OfficeEditor {\n  private isImportedPdf: boolean = false;\n\n  getDocumentType(): 'draw' {\n    return 'draw';\n  }\n\n  setImportedPdf(value: boolean): void {\n    this.isImportedPdf = value;\n  }\n\n  getStructure(_options?: { maxResponseChars?: number }): OperationResult<DrawStructure> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n      const pages: PageInfo[] = [];\n\n      for (let i = 0; i < numPages; i++) {\n        const pageInfo = this.getPageInfoInternal(i);\n        pages.push(pageInfo);\n      }\n\n      const structure: DrawStructure = {\n        type: 'draw',\n        pages,\n        pageCount: numPages,\n        isImportedPdf: this.isImportedPdf,\n      };\n\n      return this.createResult(structure);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get structure: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Page reading\n  // ============================================\n\n  getPage(index: number): OperationResult<PageData> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numPages) {\n        return this.createErrorResult(\n          `Invalid page index: ${index}. Valid range: 0-${numPages - 1}`,\n          'Use getStructure() to see available pages'\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      const size = this.lok.documentGetDocumentSize(this.docPtr);\n      const shapes = this.getShapesOnPage();\n\n      const pageData: PageData = {\n        index,\n        shapes,\n        size: { width: size.width, height: size.height },\n      };\n\n      return this.createResult(pageData);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get page: ${String(error)}`);\n    }\n  }\n\n  getPageCount(): OperationResult<number> {\n    try {\n      const count = this.lok.documentGetParts(this.docPtr);\n      return this.createResult(count);\n    } catch (error) {\n      return this.createErrorResult(`Failed to get page count: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Page management\n  // ============================================\n\n  addPage(options?: { afterPage?: number }): OperationResult<{ index: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      // Navigate to position\n      if (options?.afterPage !== undefined) {\n        this.lok.documentSetPart(this.docPtr, options.afterPage);\n      } else {\n        this.lok.documentSetPart(this.docPtr, numPages - 1);\n      }\n\n      // Insert new page\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertPage');\n\n      const newIndex = options?.afterPage !== undefined\n        ? options.afterPage + 1\n        : numPages;\n\n      return this.createResult({ index: newIndex });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add page: ${String(error)}`);\n    }\n  }\n\n  deletePage(index: number): OperationResult<void> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (numPages <= 1) {\n        return this.createErrorResult(\n          'Cannot delete the last page',\n          'A drawing document must have at least one page'\n        );\n      }\n\n      if (index < 0 || index >= numPages) {\n        return this.createErrorResult(\n          `Invalid page index: ${index}`,\n          `Valid range: 0-${numPages - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DeletePage');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete page: ${String(error)}`);\n    }\n  }\n\n  duplicatePage(index: number): OperationResult<{ newIndex: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (index < 0 || index >= numPages) {\n        return this.createErrorResult(\n          `Invalid page index: ${index}`,\n          `Valid range: 0-${numPages - 1}`\n        );\n      }\n\n      this.lok.documentSetPart(this.docPtr, index);\n      this.lok.postUnoCommand(this.docPtr, '.uno:DuplicatePage');\n\n      return this.createResult({ newIndex: index + 1 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to duplicate page: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Shape operations\n  // ============================================\n\n  addShape(\n    pageIndex: number,\n    shapeType: ShapeType,\n    bounds: Rectangle,\n    options?: { text?: string; fillColor?: string; lineColor?: string }\n  ): OperationResult<{ shapeIndex: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (pageIndex < 0 || pageIndex >= numPages) {\n        return this.createErrorResult(`Invalid page index: ${pageIndex}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n\n      // Map shape type to UNO command\n      const shapeCommand = this.getShapeCommand(shapeType);\n\n      // Set shape bounds\n      const boundsArgs = JSON.stringify({\n        X: { type: 'long', value: bounds.x },\n        Y: { type: 'long', value: bounds.y },\n        Width: { type: 'long', value: bounds.width },\n        Height: { type: 'long', value: bounds.height },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, shapeCommand, boundsArgs);\n\n      // Set optional properties\n      if (options?.text) {\n        const textArgs = JSON.stringify({\n          Text: { type: 'string', value: options.text },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', textArgs);\n      }\n\n      if (options?.fillColor) {\n        const colorArgs = JSON.stringify({\n          FillColor: { type: 'long', value: this.hexToNumber(options.fillColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:FillColor', colorArgs);\n      }\n\n      if (options?.lineColor) {\n        const colorArgs = JSON.stringify({\n          LineColor: { type: 'long', value: this.hexToNumber(options.lineColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:XLineColor', colorArgs);\n      }\n\n      // Return approximate index (would need LOK API to get actual)\n      return this.createResult({ shapeIndex: 0 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add shape: ${String(error)}`);\n    }\n  }\n\n  addLine(\n    pageIndex: number,\n    start: Position,\n    end: Position,\n    options?: { lineColor?: string; lineWidth?: number }\n  ): OperationResult<{ shapeIndex: number }> {\n    try {\n      const numPages = this.lok.documentGetParts(this.docPtr);\n\n      if (pageIndex < 0 || pageIndex >= numPages) {\n        return this.createErrorResult(`Invalid page index: ${pageIndex}`);\n      }\n\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n\n      const args = JSON.stringify({\n        StartX: { type: 'long', value: start.x },\n        StartY: { type: 'long', value: start.y },\n        EndX: { type: 'long', value: end.x },\n        EndY: { type: 'long', value: end.y },\n      });\n\n      this.lok.postUnoCommand(this.docPtr, '.uno:Line', args);\n\n      if (options?.lineColor) {\n        const colorArgs = JSON.stringify({\n          LineColor: { type: 'long', value: this.hexToNumber(options.lineColor) },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:XLineColor', colorArgs);\n      }\n\n      if (options?.lineWidth) {\n        const widthArgs = JSON.stringify({\n          LineWidth: { type: 'long', value: options.lineWidth },\n        });\n        this.lok.postUnoCommand(this.docPtr, '.uno:LineWidth', widthArgs);\n      }\n\n      return this.createResult({ shapeIndex: 0 });\n    } catch (error) {\n      return this.createErrorResult(`Failed to add line: ${String(error)}`);\n    }\n  }\n\n  deleteShape(pageIndex: number, shapeIndex: number): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n\n      // Select shape by index (simplified - real impl would use object selection)\n      this.selectShape(shapeIndex);\n      this.lok.postUnoCommand(this.docPtr, '.uno:Delete');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to delete shape: ${String(error)}`);\n    }\n  }\n\n  setShapeText(pageIndex: number, shapeIndex: number, text: string): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n      this.selectShape(shapeIndex);\n\n      // Enter edit mode for the shape\n      this.lok.postUnoCommand(this.docPtr, '.uno:EnterGroup');\n\n      // Replace text\n      this.lok.postUnoCommand(this.docPtr, '.uno:SelectAll');\n      const args = JSON.stringify({\n        Text: { type: 'string', value: text },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:InsertText', args);\n\n      // Exit edit mode\n      this.lok.postUnoCommand(this.docPtr, '.uno:LeaveGroup');\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to set shape text: ${String(error)}`);\n    }\n  }\n\n  moveShape(pageIndex: number, shapeIndex: number, newPosition: Position): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n      this.selectShape(shapeIndex);\n\n      const args = JSON.stringify({\n        X: { type: 'long', value: newPosition.x },\n        Y: { type: 'long', value: newPosition.y },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:SetObjectPosition', args);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to move shape: ${String(error)}`);\n    }\n  }\n\n  resizeShape(pageIndex: number, shapeIndex: number, newSize: Size): OperationResult<void> {\n    try {\n      this.lok.documentSetPart(this.docPtr, pageIndex);\n      this.selectShape(shapeIndex);\n\n      const args = JSON.stringify({\n        Width: { type: 'long', value: newSize.width },\n        Height: { type: 'long', value: newSize.height },\n      });\n      this.lok.postUnoCommand(this.docPtr, '.uno:Size', args);\n\n      return this.createResult(undefined);\n    } catch (error) {\n      return this.createErrorResult(`Failed to resize shape: ${String(error)}`);\n    }\n  }\n\n  // ============================================\n  // Private helpers\n  // ============================================\n\n  private getPageInfoInternal(index: number): PageInfo {\n    this.lok.documentSetPart(this.docPtr, index);\n    const size = this.lok.documentGetDocumentSize(this.docPtr);\n    const shapes = this.getShapesOnPage();\n\n    return {\n      index,\n      shapeCount: shapes.length,\n      size: { width: size.width, height: size.height },\n    };\n  }\n\n  private getShapesOnPage(): ShapeData[] {\n    // In a real implementation, we'd enumerate shapes via LOK\n    // For now, we parse text content as a simple proxy\n    const text = this.lok.getAllText(this.docPtr) || '';\n\n    if (!text.trim()) {\n      return [];\n    }\n\n    // Return a single text shape if there's content\n    return [{\n      index: 0,\n      type: 'text',\n      text,\n      bounds: { x: 0, y: 0, width: 0, height: 0 },\n    }];\n  }\n\n  private selectShape(shapeIndex: number): void {\n    // Navigate to shape - simplified implementation\n    // Real implementation would use object enumeration\n    const args = JSON.stringify({\n      Index: { type: 'long', value: shapeIndex },\n    });\n    this.lok.postUnoCommand(this.docPtr, '.uno:SelectObject', args);\n  }\n\n  private getShapeCommand(shapeType: ShapeType): string {\n    const commands: Record<ShapeType, string> = {\n      rectangle: '.uno:Rect',\n      ellipse: '.uno:Ellipse',\n      line: '.uno:Line',\n      text: '.uno:Text',\n      image: '.uno:InsertGraphic',\n      group: '.uno:FormatGroup',\n      other: '.uno:Rect', // Default to rectangle\n    };\n    return commands[shapeType];\n  }\n\n  private hexToNumber(hex: string): number {\n    return parseInt(hex.replace('#', ''), 16);\n  }\n}\n","// src/editor/tools.ts\n/**\n * LLM-friendly tool definitions for document editing\n *\n * This module provides a hashmap of tools with names, descriptions, and Zod schemas\n * for use with LLM function calling / tool use APIs.\n */\n\nimport { z } from 'zod';\n\n// ============================================\n// Shared Schemas\n// ============================================\n\nconst TextPositionSchema = z.object({\n  paragraph: z.number().int().min(0).describe('Zero-based paragraph index'),\n  character: z.number().int().min(0).describe('Zero-based character offset within the paragraph'),\n});\n\nconst TextRangeSchema = z.object({\n  start: TextPositionSchema.describe('Start position of the range'),\n  end: TextPositionSchema.describe('End position of the range'),\n});\n\nconst TextFormatSchema = z.object({\n  bold: z.boolean().optional().describe('Apply bold formatting'),\n  italic: z.boolean().optional().describe('Apply italic formatting'),\n  underline: z.boolean().optional().describe('Apply underline formatting'),\n  fontSize: z.number().positive().optional().describe('Font size in points'),\n  fontName: z.string().optional().describe('Font family name (e.g., \"Arial\", \"Times New Roman\")'),\n  color: z.string().optional().describe('Text color as hex string (e.g., \"#FF0000\")'),\n});\n\nconst CellRefSchema = z.union([\n  z.string().describe('A1-style cell reference (e.g., \"A1\", \"B5\", \"AA100\")'),\n  z.object({\n    row: z.number().int().min(0).describe('Zero-based row index'),\n    col: z.number().int().min(0).describe('Zero-based column index'),\n  }),\n]);\n\nconst RangeRefSchema = z.union([\n  z.string().describe('A1-style range (e.g., \"A1:B10\", \"C5:D20\")'),\n  z.object({\n    start: CellRefSchema.describe('Start cell of the range'),\n    end: CellRefSchema.describe('End cell of the range'),\n  }),\n]);\n\nconst SheetRefSchema = z.union([\n  z.string().describe('Sheet name'),\n  z.number().int().min(0).describe('Zero-based sheet index'),\n]);\n\nconst CellValueSchema = z.union([\n  z.string(),\n  z.number(),\n  z.boolean(),\n  z.null(),\n]).describe('Cell value: string, number, boolean, or null');\n\nconst CellFormatSchema = z.object({\n  bold: z.boolean().optional().describe('Apply bold formatting'),\n  numberFormat: z.string().optional().describe('Number format string (e.g., \"#,##0.00\", \"0%\")'),\n  backgroundColor: z.string().optional().describe('Background color as hex string'),\n  textColor: z.string().optional().describe('Text color as hex string'),\n});\n\nconst SlideLayoutSchema = z.enum(['blank', 'title', 'titleContent', 'twoColumn'])\n  .describe('Slide layout type');\n\nconst ShapeTypeSchema = z.enum(['rectangle', 'ellipse', 'line', 'text', 'image', 'group', 'other'])\n  .describe('Type of shape to create');\n\nconst RectangleSchema = z.object({\n  x: z.number().describe('X position in twips'),\n  y: z.number().describe('Y position in twips'),\n  width: z.number().positive().describe('Width in twips'),\n  height: z.number().positive().describe('Height in twips'),\n});\n\nconst PositionSchema = z.object({\n  x: z.number().describe('X position in twips'),\n  y: z.number().describe('Y position in twips'),\n});\n\nconst SizeSchema = z.object({\n  width: z.number().positive().describe('Width in twips'),\n  height: z.number().positive().describe('Height in twips'),\n});\n\nconst OutputFormatSchema = z.enum([\n  'pdf', 'docx', 'doc', 'odt', 'rtf', 'txt', 'html',\n  'xlsx', 'xls', 'ods', 'csv',\n  'pptx', 'ppt', 'odp',\n  'png', 'jpg', 'svg',\n]).describe('Output file format');\n\n// ============================================\n// Tool Definition Type\n// ============================================\n\nexport interface ToolDefinition<T extends z.ZodTypeAny = z.ZodTypeAny> {\n  name: string;\n  description: string;\n  parameters: T;\n  documentTypes: ('writer' | 'calc' | 'impress' | 'draw' | 'all')[];\n}\n\n// ============================================\n// Common Tools (all document types)\n// ============================================\n\nexport const commonTools = {\n  // Document Structure\n  getStructure: {\n    name: 'getStructure',\n    description: 'Get the document structure including paragraphs, sheets, slides, or pages depending on document type. Returns an overview of the document content.',\n    parameters: z.object({\n      maxResponseChars: z.number().int().positive().optional()\n        .describe('Maximum characters to return (default: 8000). Use for large documents.'),\n    }),\n    documentTypes: ['all'],\n  },\n\n  // Lifecycle\n  save: {\n    name: 'save',\n    description: 'Save changes to the document at its original path.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  saveAs: {\n    name: 'saveAs',\n    description: 'Save the document to a new path with optional format conversion.',\n    parameters: z.object({\n      path: z.string().describe('Output file path'),\n      format: OutputFormatSchema,\n    }),\n    documentTypes: ['all'],\n  },\n\n  close: {\n    name: 'close',\n    description: 'Close the document and release resources.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  // History\n  undo: {\n    name: 'undo',\n    description: 'Undo the last edit operation.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  redo: {\n    name: 'redo',\n    description: 'Redo the previously undone operation.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  // Search\n  find: {\n    name: 'find',\n    description: 'Find text in the document. Returns match count and position of first match.',\n    parameters: z.object({\n      text: z.string().min(1).describe('Text to search for'),\n      caseSensitive: z.boolean().optional().describe('Match case exactly'),\n      wholeWord: z.boolean().optional().describe('Match whole words only'),\n    }),\n    documentTypes: ['all'],\n  },\n\n  findAndReplaceAll: {\n    name: 'findAndReplaceAll',\n    description: 'Find all occurrences of text and replace them.',\n    parameters: z.object({\n      find: z.string().min(1).describe('Text to find'),\n      replace: z.string().describe('Replacement text'),\n      caseSensitive: z.boolean().optional().describe('Match case exactly'),\n      wholeWord: z.boolean().optional().describe('Match whole words only'),\n    }),\n    documentTypes: ['all'],\n  },\n\n  // Selection\n  getSelection: {\n    name: 'getSelection',\n    description: 'Get the currently selected text or range.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  clearSelection: {\n    name: 'clearSelection',\n    description: 'Clear the current selection.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  // Edit mode\n  enableEditMode: {\n    name: 'enableEditMode',\n    description: 'Enable edit mode for the document. Required before making changes.',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n\n  getEditMode: {\n    name: 'getEditMode',\n    description: 'Get the current edit mode (0 = view, 1 = edit).',\n    parameters: z.object({}),\n    documentTypes: ['all'],\n  },\n} as const satisfies Record<string, ToolDefinition>;\n\n// ============================================\n// Writer Tools (text documents)\n// ============================================\n\nexport const writerTools = {\n  getParagraph: {\n    name: 'getParagraph',\n    description: 'Get a single paragraph by its index. Use getStructure() first to see available paragraphs.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Zero-based paragraph index'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  getParagraphs: {\n    name: 'getParagraphs',\n    description: 'Get a range of paragraphs. Useful for paginating through large documents.',\n    parameters: z.object({\n      start: z.number().int().min(0).describe('Starting paragraph index'),\n      count: z.number().int().positive().describe('Number of paragraphs to retrieve'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  insertParagraph: {\n    name: 'insertParagraph',\n    description: 'Insert a new paragraph with optional styling.',\n    parameters: z.object({\n      text: z.string().describe('Paragraph text content'),\n      afterIndex: z.number().int().min(0).optional()\n        .describe('Insert after this paragraph index. Omit to append at end.'),\n      style: z.enum(['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'List']).optional()\n        .describe('Paragraph style to apply'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  replaceParagraph: {\n    name: 'replaceParagraph',\n    description: 'Replace the entire content of a paragraph.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Paragraph index to replace'),\n      text: z.string().describe('New paragraph text'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  deleteParagraph: {\n    name: 'deleteParagraph',\n    description: 'Delete a paragraph by index.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Paragraph index to delete'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  insertText: {\n    name: 'insertText',\n    description: 'Insert text at a specific position within the document.',\n    parameters: z.object({\n      text: z.string().describe('Text to insert'),\n      position: TextPositionSchema.describe('Position to insert at'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  deleteText: {\n    name: 'deleteText',\n    description: 'Delete text between two positions.',\n    parameters: z.object({\n      start: TextPositionSchema.describe('Start position'),\n      end: TextPositionSchema.describe('End position'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  replaceText: {\n    name: 'replaceText',\n    description: 'Find and replace text within the document.',\n    parameters: z.object({\n      find: z.string().min(1).describe('Text to find'),\n      replace: z.string().describe('Replacement text'),\n      paragraph: z.number().int().min(0).optional()\n        .describe('Limit to specific paragraph'),\n      all: z.boolean().optional().describe('Replace all occurrences (default: false)'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  formatText: {\n    name: 'formatText',\n    description: 'Apply formatting to a text range.',\n    parameters: z.object({\n      range: TextRangeSchema.describe('Text range to format'),\n      format: TextFormatSchema.describe('Formatting to apply'),\n    }),\n    documentTypes: ['writer'],\n  },\n\n  getFormat: {\n    name: 'getFormat',\n    description: 'Get the text formatting at the current cursor position or selection.',\n    parameters: z.object({\n      position: TextPositionSchema.optional().describe('Position to check (uses current selection if omitted)'),\n    }),\n    documentTypes: ['writer'],\n  },\n} as const satisfies Record<string, ToolDefinition>;\n\n// ============================================\n// Calc Tools (spreadsheets)\n// ============================================\n\nexport const calcTools = {\n  getSheetNames: {\n    name: 'getSheetNames',\n    description: 'Get the names of all sheets in the workbook.',\n    parameters: z.object({}),\n    documentTypes: ['calc'],\n  },\n\n  getCell: {\n    name: 'getCell',\n    description: 'Get the value and formula of a single cell.',\n    parameters: z.object({\n      cell: CellRefSchema.describe('Cell reference (e.g., \"A1\" or {row: 0, col: 0})'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index (uses active sheet if omitted)'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  getCells: {\n    name: 'getCells',\n    description: 'Get values from a range of cells. Returns a 2D array.',\n    parameters: z.object({\n      range: RangeRefSchema.describe('Cell range (e.g., \"A1:C10\")'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n      maxResponseChars: z.number().int().positive().optional()\n        .describe('Maximum response size. Use smaller ranges for large data.'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  setCellValue: {\n    name: 'setCellValue',\n    description: 'Set the value of a single cell.',\n    parameters: z.object({\n      cell: CellRefSchema.describe('Cell reference'),\n      value: z.union([z.string(), z.number()]).describe('Value to set'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  setCellFormula: {\n    name: 'setCellFormula',\n    description: 'Set a formula in a cell. Formula should start with \"=\" (e.g., \"=SUM(A1:A10)\").',\n    parameters: z.object({\n      cell: CellRefSchema.describe('Cell reference'),\n      formula: z.string().describe('Formula starting with \"=\"'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  setCells: {\n    name: 'setCells',\n    description: 'Set values for multiple cells at once. Pass a 2D array of values.',\n    parameters: z.object({\n      range: RangeRefSchema.describe('Starting cell or range'),\n      values: z.array(z.array(CellValueSchema))\n        .describe('2D array of values. Rows are outer array, columns are inner.'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  clearCell: {\n    name: 'clearCell',\n    description: 'Clear the contents of a cell.',\n    parameters: z.object({\n      cell: CellRefSchema.describe('Cell reference'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  clearRange: {\n    name: 'clearRange',\n    description: 'Clear the contents of a range of cells.',\n    parameters: z.object({\n      range: RangeRefSchema.describe('Cell range to clear'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  insertRow: {\n    name: 'insertRow',\n    description: 'Insert a new row after the specified row.',\n    parameters: z.object({\n      afterRow: z.number().int().min(0).describe('Insert after this row index (0-based)'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  insertColumn: {\n    name: 'insertColumn',\n    description: 'Insert a new column after the specified column.',\n    parameters: z.object({\n      afterCol: z.union([\n        z.string().describe('Column letter (e.g., \"A\", \"B\", \"AA\")'),\n        z.number().int().min(0).describe('Column index (0-based)'),\n      ]).describe('Insert after this column'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  deleteRow: {\n    name: 'deleteRow',\n    description: 'Delete a row.',\n    parameters: z.object({\n      row: z.number().int().min(0).describe('Row index to delete'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  deleteColumn: {\n    name: 'deleteColumn',\n    description: 'Delete a column.',\n    parameters: z.object({\n      col: z.union([\n        z.string().describe('Column letter'),\n        z.number().int().min(0).describe('Column index'),\n      ]).describe('Column to delete'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  formatCells: {\n    name: 'formatCells',\n    description: 'Apply formatting to a range of cells.',\n    parameters: z.object({\n      range: RangeRefSchema.describe('Cell range to format'),\n      format: CellFormatSchema.describe('Formatting to apply'),\n      sheet: SheetRefSchema.optional().describe('Sheet name or index'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  addSheet: {\n    name: 'addSheet',\n    description: 'Add a new sheet to the workbook.',\n    parameters: z.object({\n      name: z.string().min(1).describe('Name for the new sheet'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  renameSheet: {\n    name: 'renameSheet',\n    description: 'Rename an existing sheet.',\n    parameters: z.object({\n      sheet: SheetRefSchema.describe('Sheet to rename'),\n      newName: z.string().min(1).describe('New sheet name'),\n    }),\n    documentTypes: ['calc'],\n  },\n\n  deleteSheet: {\n    name: 'deleteSheet',\n    description: 'Delete a sheet from the workbook.',\n    parameters: z.object({\n      sheet: SheetRefSchema.describe('Sheet to delete'),\n    }),\n    documentTypes: ['calc'],\n  },\n} as const satisfies Record<string, ToolDefinition>;\n\n// ============================================\n// Impress Tools (presentations)\n// ============================================\n\nexport const impressTools = {\n  getSlide: {\n    name: 'getSlide',\n    description: 'Get detailed content of a specific slide including title and text frames.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Zero-based slide index'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  getSlideCount: {\n    name: 'getSlideCount',\n    description: 'Get the total number of slides in the presentation.',\n    parameters: z.object({}),\n    documentTypes: ['impress'],\n  },\n\n  addSlide: {\n    name: 'addSlide',\n    description: 'Add a new slide to the presentation.',\n    parameters: z.object({\n      afterSlide: z.number().int().min(0).optional()\n        .describe('Insert after this slide index. Omit to append at end.'),\n      layout: SlideLayoutSchema.optional().describe('Slide layout to use'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  deleteSlide: {\n    name: 'deleteSlide',\n    description: 'Delete a slide from the presentation. Cannot delete the last slide.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Slide index to delete'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  duplicateSlide: {\n    name: 'duplicateSlide',\n    description: 'Create a copy of a slide. The copy is inserted after the original.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Slide index to duplicate'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  moveSlide: {\n    name: 'moveSlide',\n    description: 'Move a slide to a different position.',\n    parameters: z.object({\n      fromIndex: z.number().int().min(0).describe('Current slide index'),\n      toIndex: z.number().int().min(0).describe('Target position index'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  setSlideTitle: {\n    name: 'setSlideTitle',\n    description: 'Set or replace the title text of a slide.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Slide index'),\n      title: z.string().describe('New title text'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  setSlideBody: {\n    name: 'setSlideBody',\n    description: 'Set or replace the body text of a slide.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Slide index'),\n      body: z.string().describe('New body text'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  setSlideNotes: {\n    name: 'setSlideNotes',\n    description: 'Set speaker notes for a slide.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Slide index'),\n      notes: z.string().describe('Speaker notes text'),\n    }),\n    documentTypes: ['impress'],\n  },\n\n  setSlideLayout: {\n    name: 'setSlideLayout',\n    description: 'Change the layout of a slide.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Slide index'),\n      layout: SlideLayoutSchema.describe('New layout to apply'),\n    }),\n    documentTypes: ['impress'],\n  },\n} as const satisfies Record<string, ToolDefinition>;\n\n// ============================================\n// Draw Tools (vector graphics / PDFs)\n// ============================================\n\nexport const drawTools = {\n  getPage: {\n    name: 'getPage',\n    description: 'Get detailed content of a specific page including shapes.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Zero-based page index'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  getPageCount: {\n    name: 'getPageCount',\n    description: 'Get the total number of pages in the document.',\n    parameters: z.object({}),\n    documentTypes: ['draw'],\n  },\n\n  addPage: {\n    name: 'addPage',\n    description: 'Add a new page to the document.',\n    parameters: z.object({\n      afterPage: z.number().int().min(0).optional()\n        .describe('Insert after this page index. Omit to append at end.'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  deletePage: {\n    name: 'deletePage',\n    description: 'Delete a page from the document. Cannot delete the last page.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Page index to delete'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  duplicatePage: {\n    name: 'duplicatePage',\n    description: 'Create a copy of a page. The copy is inserted after the original.',\n    parameters: z.object({\n      index: z.number().int().min(0).describe('Page index to duplicate'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  addShape: {\n    name: 'addShape',\n    description: 'Add a shape to a page.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Page index'),\n      shapeType: ShapeTypeSchema.describe('Type of shape to create'),\n      bounds: RectangleSchema.describe('Position and size of the shape'),\n      text: z.string().optional().describe('Text content for the shape'),\n      fillColor: z.string().optional().describe('Fill color as hex (e.g., \"#FF0000\")'),\n      lineColor: z.string().optional().describe('Line/stroke color as hex'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  addLine: {\n    name: 'addLine',\n    description: 'Add a line to a page.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Page index'),\n      start: PositionSchema.describe('Start point of the line'),\n      end: PositionSchema.describe('End point of the line'),\n      lineColor: z.string().optional().describe('Line color as hex'),\n      lineWidth: z.number().positive().optional().describe('Line width in twips'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  deleteShape: {\n    name: 'deleteShape',\n    description: 'Delete a shape from a page.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Page index'),\n      shapeIndex: z.number().int().min(0).describe('Shape index on the page'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  setShapeText: {\n    name: 'setShapeText',\n    description: 'Set or replace the text content of a shape.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Page index'),\n      shapeIndex: z.number().int().min(0).describe('Shape index'),\n      text: z.string().describe('New text content'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  moveShape: {\n    name: 'moveShape',\n    description: 'Move a shape to a new position.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Page index'),\n      shapeIndex: z.number().int().min(0).describe('Shape index'),\n      position: PositionSchema.describe('New position'),\n    }),\n    documentTypes: ['draw'],\n  },\n\n  resizeShape: {\n    name: 'resizeShape',\n    description: 'Resize a shape.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Page index'),\n      shapeIndex: z.number().int().min(0).describe('Shape index'),\n      size: SizeSchema.describe('New size'),\n    }),\n    documentTypes: ['draw'],\n  },\n} as const satisfies Record<string, ToolDefinition>;\n\n// ============================================\n// High-Level Document Operations\n// ============================================\n\n/**\n * High-level tools for document conversion, export, and rendering.\n * These operate at the document/page level rather than content editing.\n */\nexport const documentTools = {\n  convertDocument: {\n    name: 'convertDocument',\n    description: 'Convert the entire document to a different format. Returns the converted document as binary data. Use this for format conversions like DOCX to PDF, XLSX to CSV, PPTX to PDF, etc.',\n    parameters: z.object({\n      outputFormat: OutputFormatSchema.describe('Target format for conversion'),\n      options: z.object({\n        pdfVersion: z.enum(['PDF/A-1b', 'PDF/A-2b', 'PDF/A-3b']).optional().describe('PDF/A compliance level for PDF output'),\n        quality: z.number().min(1).max(100).optional().describe('Quality for image formats (1-100)'),\n      }).optional().describe('Format-specific conversion options'),\n    }),\n    documentTypes: ['all'] as const,\n  },\n\n  renderPageToImage: {\n    name: 'renderPageToImage',\n    description: 'Render a specific page/slide to an image (PNG, JPG, or WebP). Useful for generating thumbnails, previews, or extracting visual content from documents.',\n    parameters: z.object({\n      pageIndex: z.number().int().min(0).describe('Zero-based page/slide index to render'),\n      format: z.enum(['png', 'jpg', 'webp']).default('png').describe('Output image format'),\n      width: z.number().int().min(1).max(4096).default(1024).describe('Output image width in pixels'),\n      height: z.number().int().min(0).max(4096).default(0).describe('Output image height in pixels (0 = auto based on aspect ratio)'),\n      quality: z.number().min(1).max(100).default(90).describe('Quality for JPG/WebP (1-100)'),\n    }),\n    documentTypes: ['all'] as const,\n  },\n\n  getPageCount: {\n    name: 'getPageCount',\n    description: 'Get the total number of pages, slides, or sheets in the document. For Writer documents, returns page count. For Calc, returns sheet count. For Impress/Draw, returns slide/page count.',\n    parameters: z.object({}),\n    documentTypes: ['all'] as const,\n  },\n\n  exportPageToPdf: {\n    name: 'exportPageToPdf',\n    description: 'Export a specific page or range of pages to PDF. Useful for extracting a subset of pages from a larger document.',\n    parameters: z.object({\n      startPage: z.number().int().min(0).describe('Starting page index (0-based)'),\n      endPage: z.number().int().min(0).optional().describe('Ending page index (0-based, inclusive). If omitted, exports only startPage.'),\n      options: z.object({\n        pdfVersion: z.enum(['PDF/A-1b', 'PDF/A-2b', 'PDF/A-3b']).optional().describe('PDF/A compliance level'),\n      }).optional(),\n    }),\n    documentTypes: ['all'] as const,\n  },\n\n  getDocumentMetadata: {\n    name: 'getDocumentMetadata',\n    description: 'Get document metadata including title, author, creation date, modification date, page count, and document type.',\n    parameters: z.object({}),\n    documentTypes: ['all'] as const,\n  },\n\n  setDocumentMetadata: {\n    name: 'setDocumentMetadata',\n    description: 'Set document metadata such as title, author, subject, and keywords.',\n    parameters: z.object({\n      title: z.string().optional().describe('Document title'),\n      author: z.string().optional().describe('Document author'),\n      subject: z.string().optional().describe('Document subject'),\n      keywords: z.array(z.string()).optional().describe('Document keywords for search/categorization'),\n    }),\n    documentTypes: ['all'] as const,\n  },\n\n  exportToHtml: {\n    name: 'exportToHtml',\n    description: 'Export the document to HTML format. Useful for web publishing or extracting formatted content.',\n    parameters: z.object({\n      includeImages: z.boolean().default(true).describe('Whether to embed images in the HTML'),\n      inlineStyles: z.boolean().default(true).describe('Whether to use inline CSS styles'),\n    }),\n    documentTypes: ['all'] as const,\n  },\n\n  extractText: {\n    name: 'extractText',\n    description: 'Extract all text content from the document as plain text. Useful for indexing, searching, or text analysis.',\n    parameters: z.object({\n      preserveFormatting: z.boolean().default(false).describe('Attempt to preserve basic formatting like paragraphs and lists'),\n      pageRange: z.object({\n        start: z.number().int().min(0).describe('Start page (0-based)'),\n        end: z.number().int().min(0).describe('End page (0-based, inclusive)'),\n      }).optional().describe('Extract text from specific page range only'),\n    }),\n    documentTypes: ['all'] as const,\n  },\n\n  printDocument: {\n    name: 'printDocument',\n    description: 'Generate print-ready output. Configures the document for printing with specified settings.',\n    parameters: z.object({\n      copies: z.number().int().min(1).max(999).default(1).describe('Number of copies'),\n      pageRange: z.string().optional().describe('Page range to print (e.g., \"1-5\", \"1,3,5\", \"all\")'),\n      orientation: z.enum(['portrait', 'landscape']).optional().describe('Page orientation'),\n      paperSize: z.enum(['letter', 'a4', 'legal', 'a3', 'a5']).optional().describe('Paper size'),\n    }),\n    documentTypes: ['all'] as const,\n  },\n} as const satisfies Record<string, ToolDefinition>;\n\n// ============================================\n// Combined Tools Map\n// ============================================\n\n/**\n * All available tools organized by document type\n */\nexport const allTools = {\n  common: commonTools,\n  writer: writerTools,\n  calc: calcTools,\n  impress: impressTools,\n  draw: drawTools,\n  document: documentTools,\n} as const;\n\n/**\n * Flat map of all tools by name\n */\nexport const toolsByName = {\n  ...commonTools,\n  ...writerTools,\n  ...calcTools,\n  ...impressTools,\n  ...drawTools,\n  ...documentTools,\n} as const;\n\n/**\n * Get tools available for a specific document type\n */\nexport function getToolsForDocumentType(docType: 'writer' | 'calc' | 'impress' | 'draw'): ToolDefinition[] {\n  const tools: ToolDefinition[] = [];\n\n  // Add common tools\n  for (const tool of Object.values(commonTools)) {\n    tools.push(tool);\n  }\n\n  // Add document-level tools (available for all document types)\n  for (const tool of Object.values(documentTools)) {\n    tools.push(tool);\n  }\n\n  // Add document-specific tools\n  const typeTools = {\n    writer: writerTools,\n    calc: calcTools,\n    impress: impressTools,\n    draw: drawTools,\n  }[docType];\n\n  for (const tool of Object.values(typeTools)) {\n    tools.push(tool);\n  }\n\n  return tools;\n}\n\n/**\n * Convert a Zod schema to JSON Schema format using Zod v4's native support\n */\nfunction zodToJsonSchema(schema: z.ZodTypeAny): Record<string, unknown> {\n  const jsonSchema = z.toJSONSchema(schema, { target: 'draft-7' });\n  // Remove the $schema property as it's not needed for LLM tools\n  const { $schema: _schema, ...rest } = jsonSchema as Record<string, unknown>;\n  return rest;\n}\n\n/**\n * Convert a tool definition to OpenAI-compatible function schema\n */\nexport function toOpenAIFunction(tool: ToolDefinition): {\n  name: string;\n  description: string;\n  parameters: Record<string, unknown>;\n} {\n  return {\n    name: tool.name,\n    description: tool.description,\n    parameters: zodToJsonSchema(tool.parameters),\n  };\n}\n\n/**\n * Convert a tool definition to Anthropic-compatible tool schema\n */\nexport function toAnthropicTool(tool: ToolDefinition): {\n  name: string;\n  description: string;\n  input_schema: Record<string, unknown>;\n} {\n  return {\n    name: tool.name,\n    description: tool.description,\n    input_schema: zodToJsonSchema(tool.parameters),\n  };\n}\n\n/**\n * Get all tools as OpenAI function definitions for a document type\n */\nexport function getOpenAIFunctions(docType: 'writer' | 'calc' | 'impress' | 'draw') {\n  return getToolsForDocumentType(docType).map(toOpenAIFunction);\n}\n\n/**\n * Get all tools as Anthropic tool definitions for a document type\n */\nexport function getAnthropicTools(docType: 'writer' | 'calc' | 'impress' | 'draw') {\n  return getToolsForDocumentType(docType).map(toAnthropicTool);\n}\n\n// ============================================\n// Type exports for tool parameters\n// ============================================\n\nexport type CommonToolName = keyof typeof commonTools;\nexport type WriterToolName = keyof typeof writerTools;\nexport type CalcToolName = keyof typeof calcTools;\nexport type ImpressToolName = keyof typeof impressTools;\nexport type DrawToolName = keyof typeof drawTools;\nexport type DocumentToolName = keyof typeof documentTools;\nexport type AllToolName = CommonToolName | WriterToolName | CalcToolName | ImpressToolName | DrawToolName | DocumentToolName;\n\n// Infer parameter types from zod schemas\nexport type ToolParameters<T extends AllToolName> = z.infer<(typeof toolsByName)[T]['parameters']>;\n","// src/editor/index.ts\nimport type { LOKBindings } from '../lok-bindings.js';\nimport { OfficeEditor } from './base.js';\nimport { WriterEditor } from './writer.js';\nimport { CalcEditor } from './calc.js';\nimport { ImpressEditor } from './impress.js';\nimport { DrawEditor } from './draw.js';\nimport type { OpenDocumentOptions } from './types.js';\n\n// LOK document type constants (from LibreOfficeKit)\nconst LOK_DOCTYPE_TEXT = 0;\nconst LOK_DOCTYPE_SPREADSHEET = 1;\nconst LOK_DOCTYPE_PRESENTATION = 2;\nconst LOK_DOCTYPE_DRAWING = 3;\n\n/**\n * Factory function to create the appropriate editor based on document type\n *\n * @param lok - LibreOfficeKit bindings instance\n * @param docPtr - Document pointer from lok.documentLoad()\n * @param options - Editor options (maxResponseChars, etc.)\n * @returns Typed editor instance (WriterEditor, CalcEditor, ImpressEditor, or DrawEditor)\n * @throws Error if document type is unsupported\n *\n * @example\n * ```typescript\n * const docPtr = lok.documentLoad('/tmp/document.docx');\n * const editor = createEditor(lok, docPtr);\n *\n * if (isWriterEditor(editor)) {\n *   // TypeScript knows editor has WriterEditor methods\n *   const result = editor.insertParagraph('Hello World');\n * }\n * ```\n */\nexport function createEditor(\n  lok: LOKBindings,\n  docPtr: number,\n  options?: OpenDocumentOptions\n): OfficeEditor {\n  const docType = lok.documentGetDocumentType(docPtr);\n\n  switch (docType) {\n    case LOK_DOCTYPE_TEXT:\n      return new WriterEditor(lok, docPtr, options);\n\n    case LOK_DOCTYPE_SPREADSHEET:\n      return new CalcEditor(lok, docPtr, options);\n\n    case LOK_DOCTYPE_PRESENTATION:\n      return new ImpressEditor(lok, docPtr, options);\n\n    case LOK_DOCTYPE_DRAWING:\n      return new DrawEditor(lok, docPtr, options);\n\n    default:\n      throw new Error(`Unsupported document type: ${docType}`);\n  }\n}\n\n// ============================================\n// Type Guards\n// ============================================\n\n/**\n * Type guard for WriterEditor\n */\nexport function isWriterEditor(editor: OfficeEditor): editor is WriterEditor {\n  return editor.getDocumentType() === 'writer';\n}\n\n/**\n * Type guard for CalcEditor\n */\nexport function isCalcEditor(editor: OfficeEditor): editor is CalcEditor {\n  return editor.getDocumentType() === 'calc';\n}\n\n/**\n * Type guard for ImpressEditor\n */\nexport function isImpressEditor(editor: OfficeEditor): editor is ImpressEditor {\n  return editor.getDocumentType() === 'impress';\n}\n\n/**\n * Type guard for DrawEditor\n */\nexport function isDrawEditor(editor: OfficeEditor): editor is DrawEditor {\n  return editor.getDocumentType() === 'draw';\n}\n\n// ============================================\n// Re-exports\n// ============================================\n\n// Export all types\nexport type {\n  OperationResult,\n  TruncationInfo,\n  OpenDocumentOptions,\n  TextPosition,\n  TextRange,\n  TextFormat,\n  Paragraph,\n  WriterStructure,\n  CellRef,\n  RangeRef,\n  ColRef,\n  SheetRef,\n  CellValue,\n  CellData,\n  CellFormat,\n  SheetInfo,\n  CalcStructure,\n  SlideLayout,\n  TextFrame,\n  SlideData,\n  SlideInfo,\n  ImpressStructure,\n  ShapeType,\n  ShapeData,\n  PageData,\n  PageInfo,\n  DrawStructure,\n  Rectangle,\n  Size,\n  Position,\n  DocumentMetadata,\n  DocumentStructure,\n  DocumentType,\n  SelectionRange,\n  FindOptions,\n} from './types.js';\n\n// Export all editor classes\nexport { OfficeEditor } from './base.js';\nexport { WriterEditor } from './writer.js';\nexport { CalcEditor } from './calc.js';\nexport { ImpressEditor } from './impress.js';\nexport { DrawEditor } from './draw.js';\n\n// Export LLM tool definitions\nexport {\n  // Tool collections\n  allTools,\n  toolsByName,\n  commonTools,\n  writerTools,\n  calcTools,\n  impressTools,\n  drawTools,\n  documentTools,\n  // Utility functions\n  getToolsForDocumentType,\n  toOpenAIFunction,\n  toAnthropicTool,\n  getOpenAIFunctions,\n  getAnthropicTools,\n} from './tools.js';\n\nexport type {\n  ToolDefinition,\n  CommonToolName,\n  WriterToolName,\n  CalcToolName,\n  ImpressToolName,\n  DrawToolName,\n  DocumentToolName,\n  AllToolName,\n  ToolParameters,\n} from './tools.js';\n","/**\n * LibreOffice WASM Document Converter\n *\n * A headless document conversion toolkit that uses LibreOffice\n * compiled to WebAssembly. Supports conversion between various\n * document formats without any UI dependencies.\n *\n * @packageDocumentation\n */\n\nexport { LibreOfficeConverter } from './converter-node.js';\nexport { WorkerConverter, createWorkerConverter } from './node.worker-converter.js';\nexport { SubprocessConverter, createSubprocessConverter } from './subprocess.worker-converter.js';\n\n// Image encoding utilities (uses sharp when available, falls back to pure JS)\nexport {\n  encodeImage,\n  rgbaToPng,\n  rgbaToJpeg,\n  rgbaToWebp,\n  isSharpAvailable,\n  getSharp,\n} from './image-utils.js';\nexport type { ImageEncodeOptions } from './image-utils.js';\n\nexport type {\n  ConversionOptions,\n  ConversionResult,\n  ImageOptions,\n  InputFormat,\n  LibreOfficeWasmOptions,\n  OutputFormat,\n  PdfOptions,\n  ProgressInfo,\n} from './types.js';\n\nexport {\n  ConversionError,\n  ConversionErrorCode,\n  FORMAT_FILTERS,\n  FORMAT_MIME_TYPES,\n  EXTENSION_TO_FORMAT,\n  // Conversion validation helpers\n  getValidOutputFormats,\n  isConversionValid,\n  getConversionErrorMessage,\n  INPUT_FORMAT_CATEGORY,\n  CATEGORY_OUTPUT_FORMATS,\n  // Dynamic document type helpers (use after loading document)\n  LOKDocumentType,\n  LOK_DOCTYPE_OUTPUT_FORMATS,\n  getOutputFormatsForDocType,\n  // Browser WASM path helpers (also useful for understanding paths)\n  createWasmPaths,\n  DEFAULT_WASM_BASE_URL,\n} from './types.js';\n\nexport type { DocumentCategory, WasmLoadPhase, WasmLoadProgress } from './types.js';\n\n// Export LOK constants for advanced usage\nexport {\n  LOK_MOUSEEVENT_BUTTONDOWN,\n  LOK_MOUSEEVENT_BUTTONUP,\n  LOK_MOUSEEVENT_MOVE,\n  LOK_KEYEVENT_KEYINPUT,\n  LOK_KEYEVENT_KEYUP,\n  LOK_SELTYPE_NONE,\n  LOK_SELTYPE_TEXT,\n  LOK_SELTYPE_CELL,\n  LOK_SETTEXTSELECTION_START,\n  LOK_SETTEXTSELECTION_END,\n  LOK_SETTEXTSELECTION_RESET,\n  LOK_DOCTYPE_TEXT,\n  LOK_DOCTYPE_SPREADSHEET,\n  LOK_DOCTYPE_PRESENTATION,\n  LOK_DOCTYPE_DRAWING,\n  LOK_DOCTYPE_OTHER,\n} from './lok-bindings.js';\n\nimport { LibreOfficeConverter } from './converter-node.js';\nimport { createSubprocessConverter } from './subprocess.worker-converter.js';\nimport type { ConversionOptions, ConversionResult, ImageOptions, LibreOfficeWasmOptions } from './types.js';\n\n/**\n * Image format options for exportAsImage\n */\nexport type ImageFormat = 'png' | 'jpg' | 'svg';\n\n// Detect if running in Node.js\nconst isNode = typeof process !== 'undefined' &&\n  process.versions != null &&\n  process.versions.node != null;\n\n/**\n * Create a configured LibreOffice converter instance\n *\n * @example\n * ```typescript\n * import { createConverter } from '@matbee/libreoffice-converter';\n *\n * const converter = await createConverter({\n *   wasmPath: './wasm',\n *   verbose: true,\n * });\n *\n * const pdfData = await converter.convert(docxBuffer, {\n *   outputFormat: 'pdf',\n * });\n * ```\n */\nexport async function createConverter(\n  options?: LibreOfficeWasmOptions\n): Promise<LibreOfficeConverter> {\n  const converter = new LibreOfficeConverter(options);\n  await converter.initialize();\n  return converter;\n}\n\n/**\n * Quick conversion utility - creates converter, converts, then destroys\n *\n * In Node.js, uses SubprocessConverter for clean process exit.\n * In browsers, uses LibreOfficeConverter directly.\n *\n * @example\n * ```typescript\n * import { convertDocument } from '@matbee/libreoffice-converter';\n *\n * const pdfData = await convertDocument(docxBuffer, {\n *   outputFormat: 'pdf',\n *   pdf: { pdfaLevel: 'PDF/A-2b' }\n * });\n * ```\n */\nexport async function convertDocument(\n  input: Uint8Array | ArrayBuffer | Buffer,\n  options: ConversionOptions,\n  converterOptions?: LibreOfficeWasmOptions\n): Promise<ConversionResult> {\n  // In Node.js, use subprocess for clean exit (no hanging pthread workers)\n  // SubprocessConverter only supports basic conversions, not image/page options\n  const isBasicConversion = !options.image;\n\n  if (isNode && isBasicConversion) {\n    const converter = await createSubprocessConverter(converterOptions);\n    try {\n      return await converter.convert(input, options);\n    } finally {\n      await converter.destroy();\n    }\n  }\n\n  // Browser or advanced conversion: use LibreOfficeConverter\n  const converter = await createConverter(converterOptions);\n  try {\n    return await converter.convert(input, options);\n  } finally {\n    await converter.destroy();\n  }\n}\n\n/**\n * Export document pages as images - creates converter, exports specified pages, then destroys\n *\n * @param input - Document buffer\n * @param pages - Page index or array of page indices to export (0-indexed)\n * @param format - Output format: 'png', 'jpg', or 'svg'\n * @param imageOptions - Image options (width, height, dpi)\n * @param converterOptions - Converter options (wasmPath, etc.)\n * @returns Array of ConversionResult, one per page\n *\n * @example\n * ```typescript\n * import { exportAsImage } from '@matbee/libreoffice-converter';\n *\n * // Export single page (0-indexed)\n * const [cover] = await exportAsImage(docxBuffer, 0, 'png');\n * fs.writeFileSync('cover.png', cover.data);\n *\n * // Export multiple pages\n * const slides = await exportAsImage(pptxBuffer, [0, 1, 2], 'png');\n * slides.forEach((img, i) => fs.writeFileSync(`slide-${i}.png`, img.data));\n *\n * // Export with options\n * const highRes = await exportAsImage(pptxBuffer, [0, 1, 2], 'png', {\n *   dpi: 300,\n *   width: 1920\n * });\n * ```\n */\nexport async function exportAsImage(\n  input: Uint8Array | ArrayBuffer | Buffer,\n  pages: number | number[],\n  format: ImageFormat = 'png',\n  imageOptions?: Omit<ImageOptions, 'pageIndex' | 'pages'>,\n  converterOptions?: LibreOfficeWasmOptions\n): Promise<ConversionResult[]> {\n  const pageArray = Array.isArray(pages) ? pages : [pages];\n  if (pageArray.length === 0) {\n    throw new Error('pages is required and must not be empty');\n  }\n  const converter = await createConverter(converterOptions);\n  try {\n    const results: ConversionResult[] = [];\n    for (const pageIndex of pageArray) {\n      const result = await converter.convert(input, {\n        outputFormat: format,\n        image: { ...imageOptions, pageIndex },\n      });\n      results.push(result);\n    }\n    return results;\n  } finally {\n    await converter.destroy();\n  }\n}\n\n/**\n * Check if a format is supported for input\n */\nexport function isInputFormatSupported(format: string): boolean {\n  return LibreOfficeConverter.getSupportedInputFormats().includes(format.toLowerCase());\n}\n\n/**\n * Check if a format is supported for output\n */\nexport function isOutputFormatSupported(format: string): boolean {\n  return LibreOfficeConverter.getSupportedOutputFormats().includes(format.toLowerCase() as OutputFormat);\n}\n\n/**\n * Check if a specific conversion path is supported\n * @param inputFormat The input document format (e.g., 'pdf', 'docx')\n * @param outputFormat The desired output format (e.g., 'pdf', 'docx')\n * @returns true if the conversion is supported\n * \n * @example\n * ```typescript\n * import { isConversionSupported } from '@matbee/libreoffice-converter';\n * \n * isConversionSupported('docx', 'pdf');  // true\n * isConversionSupported('pdf', 'docx');  // false - PDFs can't be converted to DOCX\n * isConversionSupported('xlsx', 'csv');  // true\n * ```\n */\nexport function isConversionSupported(inputFormat: string, outputFormat: string): boolean {\n  return LibreOfficeConverter.isConversionSupported(inputFormat, outputFormat);\n}\n\n/**\n * Get valid output formats for a given input format\n * @param inputFormat The input document format\n * @returns Array of valid output formats\n * \n * @example\n * ```typescript\n * import { getValidOutputFormatsFor } from '@matbee/libreoffice-converter';\n * \n * getValidOutputFormatsFor('docx');  // ['pdf', 'docx', 'doc', 'odt', 'rtf', 'txt', 'html', 'png', 'jpg', 'svg']\n * getValidOutputFormatsFor('pdf');   // ['pdf', 'png', 'jpg', 'svg', 'html']\n * getValidOutputFormatsFor('xlsx');  // ['pdf', 'xlsx', 'xls', 'ods', 'csv', 'html', 'png', 'jpg', 'svg']\n * ```\n */\nexport function getValidOutputFormatsFor(inputFormat: string): OutputFormat[] {\n  return LibreOfficeConverter.getValidOutputFormats(inputFormat);\n}\n\n// Re-export OutputFormat type for the isOutputFormatSupported function\nimport type { OutputFormat } from './types.js';\n\n// ============================================\n// Editor API (LLM-friendly document editing)\n// ============================================\n\nexport {\n  // Factory and type guards\n  createEditor,\n  isWriterEditor,\n  isCalcEditor,\n  isImpressEditor,\n  isDrawEditor,\n  // Editor classes\n  OfficeEditor,\n  WriterEditor,\n  CalcEditor,\n  ImpressEditor,\n  DrawEditor,\n  // LLM tool definitions\n  allTools,\n  toolsByName,\n  commonTools,\n  writerTools,\n  calcTools,\n  impressTools,\n  drawTools,\n  documentTools,\n  getToolsForDocumentType,\n  toOpenAIFunction,\n  toAnthropicTool,\n  getOpenAIFunctions,\n  getAnthropicTools,\n} from './editor/index.js';\n\nexport type {\n  // Operation result types\n  OperationResult,\n  TruncationInfo,\n  OpenDocumentOptions,\n  // Writer types\n  TextPosition,\n  TextRange,\n  TextFormat,\n  Paragraph,\n  WriterStructure,\n  // Calc types\n  CellRef,\n  RangeRef,\n  ColRef,\n  SheetRef,\n  CellValue,\n  CellData,\n  CellFormat,\n  SheetInfo,\n  CalcStructure,\n  // Impress types\n  SlideLayout,\n  TextFrame,\n  SlideData,\n  SlideInfo,\n  ImpressStructure,\n  // Draw types\n  ShapeType,\n  ShapeData,\n  PageData,\n  PageInfo,\n  DrawStructure,\n  // Common types\n  Rectangle,\n  Size,\n  Position,\n  DocumentMetadata,\n  DocumentStructure,\n  DocumentType,\n  SelectionRange,\n  FindOptions,\n  // LLM tool types\n  ToolDefinition,\n  CommonToolName,\n  WriterToolName,\n  CalcToolName,\n  ImpressToolName,\n  DrawToolName,\n  DocumentToolName,\n  AllToolName,\n  ToolParameters,\n} from './editor/index.js';\n"]}